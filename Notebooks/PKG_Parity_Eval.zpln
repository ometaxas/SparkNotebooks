{
 "paragraphs": [
  {
   "text": "%spark.conf\n\n# It is strongly recommended to set SPARK_HOME explictly instead of using the embedded spark of Zeppelin. As the function of embedded spark of Zeppelin is limited and can only run in local mode.\n\n#SPARK_HOME /home/ometaxas/Programs/spark-3.1.2-bin-hadoop3.2\nSPARK_HOME /home/ometaxas/Programs/spark-3.2.0-bin-hadoop3.2\n#SPARK_HOME /home/ometaxas/Programs/spark-3.3.1-bin-hadoop3\n\nSPARK_LOCAL_DIRS /media/ometaxas/nvme/spark\n\n#com.github.haifengl:smile-scala_2.12:2.5.3,com.databricks:spark-xml_2.12:0.10.0,com.github.mrpowers:spark-stringmetric_2.12:0.3.0\n\n#spark.jars /home/ometaxas/Programs/spark-3.1.2-bin-hadoop3.2/plugins/cudf-21.10.0-cuda11.jar, /home/ometaxas/Programs/spark-3.0\n#.1-bin-hadoop3.2/plugins/rapids-4-spark_2.12-21.10.0.jar\n\n#spark.sql.warehouse.dir /home/ometaxas/Programs/zeppelin-0.9.0-preview2-bin-all/spark-warehouse\n\n#spark.kryo.registrator com.nvidia.spark.rapids.GpuKryoRegistrator\nspark.serializer org.apache.spark.serializer.KryoSerializer\nspark.kryoserializer.buffer.max 1000M\nspark.driver.memory 80g\nspark.driver.maxResultSize 5g \n\n#spark.rapids.sql.concurrentGpuTasks=2\n#spark.rapids.sql.enabled true\n#spark.rapids.memory.pinnedPool.size 2G \n\n#spark.plugins com.nvidia.spark.SQLPlugin \n\n#spark.sql.autoBroadcastJoinThreshold 1\n#spark.sql.join.preferSortMergeJoin true\n#spark.locality.wait 0s \n#spark.sql.files.maxPartitionBytes 512m \nspark.sql.shuffle.partitions 50 \n \n#spark.executor.resource.gpu.amount=1\n\n#, /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/tmp\n                                             \n# /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/tmp,/media/datadisk/Datasets/Spark\n#,/media/datadisk/Datasets/Spark \n#/media/datadisk/Datasets/Spark\n\n# set executor memrory 110g\n# spark.executor.memory  60g\n\n\n# set executor number to be 6\n# spark.executor.instances  6\n\n\n# Uncomment the following line if you want to use yarn-cluster mode (It is recommended to use yarn-cluster mode after Zeppelin 0.8, as the driver will run on the remote host of yarn cluster which can mitigate memory pressure of zeppelin server)\n# master yarn-cluster\n\n# Uncomment the following line if you want to use yarn-client mode (It is not recommended to use it after 0.8. Because it would launch the driver in the same host of zeppelin server which will increase memory pressure of zeppelin server)\n# master yarn-client\n\n# Uncomment the following line to enable HiveContext, and also put hive-site.xml under SPARK_CONF_DIR\n# zeppelin.spark.useHiveContext true\n",
   "user": "anonymous",
   "dateUpdated": "2024-05-01 11:42:58.763",
   "progress": 0.0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12.0,
    "editorMode": "ace/mode/scala",
    "fontSize": 9.0,
    "results": {},
    "enabled": true,
    "editorHide": false
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670444422396_1109408681",
   "id": "paragraph_1670444422396_1109408681",
   "dateCreated": "2022-12-07T22:20:22+0200",
   "dateStarted": "2024-05-01 11:42:58.690",
   "dateFinished": "2024-05-01 11:42:58.762",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": []
   }
  },
  {
   "text": "%spark\nimport org.apache.commons.lang3.StringUtils\nimport java.util.Locale;\n\n  def shortNormNameString( fullName: String) : String = {\n\n      if (fullName != null) {\n          val normname = org.apache.commons.lang3.StringUtils.stripAccents(fullName.toLowerCase(Locale.ENGLISH))\n                  //.replaceAll(\"[^\\\\p{ASCII}]\", \"\")\n                  .replaceAll(\"[<>:´,’./\\\\'\\\\\\\";(){}!@#$%^&+‐–*\\\\\\\\-]+\", \"\")\n                  .replaceAll(\"Æ\", \"AE\")\n                  .replaceAll(\"Ð\", \"D\")\n                  .replaceAll(\"Ø\", \"O\")\n                  .replaceAll(\"Þ\", \"TH\")\n                  .replaceAll(\"ß\", \"ss\")\n                  .replaceAll(\"ð\", \"d\")\n                  .replaceAll(\"æ\", \"ae\")\n                  .replaceAll(\"ø\", \"o\")\n                  .replaceAll(\"þ\", \"th\")\n                  .replaceAll(\"Œ\", \"OE\")\n                  .replaceAll(\"œ\", \"oe\")\n                  .replaceAll(\"ƒ\", \"f\")\n                  .trim().split(\" \")\n\n\n          val shortName = if (normname.length == 1) normname(0) else normname(0).take(1) + normname(normname.length - 1)\n          return shortName\n      }\n      else null\n  }\n   \nval shortNormName = udf[String, String]((e:String) => {\n    \n    shortNormNameString(e)\n    \n})\n\nspark.udf.register(\"shortNormName\", shortNormName)\n\nval shortNormNameList = udf[Seq[String], Seq[String]]((e:Seq[String]) => {\n    if (e!=null && e.size>0) {\n        e.map{x=> shortNormNameString(x)}        \n    }\n    else e\n})\nspark.udf.register(\"shortNormNameList\", shortNormNameList)\n\nval normName = udf[String, String]((e:String) => {\n \n if (e!=null) {\n     org.apache.commons.lang3.StringUtils.stripAccents(e.toLowerCase(Locale.ENGLISH))\n             .replaceAll(\"[ <>:´,’./\\\\'\\\\\\\";(){}!@#$%^&+‐–*\\\\\\\\-]+\", \"\")\n             .replaceAll(\"Æ\", \"AE\")\n             .replaceAll(\"Ð\", \"D\")\n             .replaceAll(\"Ø\", \"O\")\n             .replaceAll(\"Þ\", \"TH\")\n             .replaceAll(\"ß\", \"ss\")\n             .replaceAll(\"ð\", \"d\")\n             .replaceAll(\"æ\", \"ae\")\n             .replaceAll(\"ø\", \"o\")\n             .replaceAll(\"þ\", \"th\")\n             .replaceAll(\"Œ\", \"OE\")\n             .replaceAll(\"œ\", \"oe\")\n             .replaceAll(\"ƒ\", \"f\")\n             .trim()\n }\n else e\n     \n})\n\nspark.udf.register(\"normName\", normName)\n\nval workAbstractFromInverted = udf[String, Option[Map[String, Seq[Long]]]]((e:Option[Map[String, Seq[Long]]]) => {\n    \n   \n   val list = e.getOrElse(Map()).toList.flatMap { x => x._2.toList.map { e => (x._1, e) } }\n    list.sortBy(_._2).map(_._1).mkString(\" \")\n})\n\nspark.udf.register(\"workAbstractFromInverted\", workAbstractFromInverted)\n\nval removeDoiPrefix = udf[String, String]((e:String) => {\n   if (e!=null) {\n       e.replace(\"https://doi.org/\", \"\")\n   }\n    else e\n})\nspark.udf.register(\"removeDoiPrefix\", removeDoiPrefix)\n\n\n\nval removeOpenAlexPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://openalex.org/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removeOpenAlexPrefix\", removeOpenAlexPrefix)\n\n\nval removeOpenAlexPrefixList = udf[Seq[String], Seq[String]]((e:Seq[String]) => {\n    if (e!=null && e.size>0) {\n        e.map{x=> if (x==null) null else x.replace(\"https://openalex.org/\", \"\")}        \n    }\n    else e\n})\nspark.udf.register(\"removeOpenAlexPrefixList\", removeOpenAlexPrefixList)\n\n\nval removeWikiDataPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://www.wikidata.org/wiki/\", \"\").replace(\"http://www.wikidata.org/wiki/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removeWikiDataPrefix\", removeWikiDataPrefix)\n\nval removeOrcidPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://orcid.org/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removeOrcidPrefix\", removeOrcidPrefix)\n\nval removePmcPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://pubmed.ncbi.nlm.nih.gov/\", \"\")\n    }\n    else e\n   \n})\nspark.udf.register(\"removePmcPrefix\", removePmcPrefix)\n\nval removePubmedPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://pubmed.ncbi.nlm.nih.gov/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removePubmedPrefix\", removePubmedPrefix)\n\n\n\n",
   "user": "anonymous",
   "dateUpdated": "2023-06-21 12:02:14.473",
   "progress": 0.0,
   "config": {
    "editorHide": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670430955490_1185020559",
   "id": "paragraph_1670430955490_1185020559",
   "dateCreated": "2022-12-07T18:35:55+0200",
   "dateStarted": "2023-06-21 12:02:01.118",
   "dateFinished": "2023-06-21 12:02:14.473",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "import org.apache.commons.lang3.StringUtils\nimport java.util.Locale\n\u001b[1m\u001b[34mshortNormNameString\u001b[0m: \u001b[1m\u001b[32m(fullName: String)String\u001b[0m\n\u001b[1m\u001b[34mshortNormName\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = SparkUserDefinedFunction($Lambda$2585/0x00007f214e6ff040@49599cb,StringType,List(Some(class[value[0]: string])),Some(class[value[0]: string]),None,true,true)\n\u001b[1m\u001b[34mshortNormNameList\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = SparkUserDefinedFunction($Lambda$2692/0x00007f214e2f4040@50c72c25,ArrayType(StringType,true),List(Some(class[value[0]: array<string>])),Some(class[value[0]: array<string>]),None,true,true)\n\u001b[1m\u001b[34mnormName\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = SparkUserDefinedFunctio...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "ERROR",
   "text": "%spark\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.storage.StorageLevel\n// cartesian 5m.44\n// broadcastJoin / array 1.04\n// sortMerge / array 1.14\n// 48sec using cartesian on DF i,j indices  63.5GB\n// 38sec broadcast cartesian on DF i,j indices 49GB\n\n//33sec with broadcast / renamed datasets / selecting only features 26.8GB !!\n\n//30K\n//3m 40s\n\nval OA_HOME = \"/media/ometaxas/nvme/datasets\"\n\n\nval signdf = spark.read\n        .json(s\"file://$OA_HOME/author_publication.json.zip\")         //30K\n        //.withColumn(\"id\",monotonically_increasing_id())\n\nprintln(\"signdf  cnt:\"+signdf.count())\nsigndf.printSchema()\nsigndf.show(10)\n        ",
   "id": "",
   "dateCreated": "2024-05-01 11:37:50.332",
   "config": {},
   "dateStarted": "2024-05-01 11:43:14.934",
   "dateUpdated": "2024-05-01 11:43:38.495",
   "dateFinished": "2024-05-01 11:43:38.494",
   "results": {
    "code": "ERROR",
    "msg": [
     {
      "type": "TEXT",
      "data": "org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 0.0 failed 1 times, most recent failure: Lost task 0.0 in stage 0.0 (TID 0) (omiros.station executor driver): java.io.CharConversionException: Invalid UTF-32 character 0x4b020414 (above 0x0010ffff) at char #2, byte #11)\n\tat com.fasterxml.jackson.core.io.UTF32Reader.reportInvalid(UTF32Reader.java:195)\n\tat com.fasterxml.jackson.core.io.UTF32Reader.read(UTF32Reader.java:158)\n\tat com.fasterxml.jackson.core.json.ReaderBasedJsonParser._loadMore(ReaderBasedJsonParser.java:255)\n\tat com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2389)\n\tat com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:677)\n\tat org.apache.spark.sql.catalyst.json.JsonInferSchema.$anonfun$infer$4(JsonInferSchema.scala:67)\n\tat org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2713)\n\tat org.apache.spark.sql.catalyst.json.JsonInferSchema.$anonfun$infer$2(JsonInferSchema.scala:66)\n\tat scala.collection.Iterator$$anon$11.nextCur(Iterator.scala:486)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:492)\n\tat scala.collection.Iterator.foreach(Iterator.scala:943)\n\tat scala.collection.Iterator.foreach$(Iterator.scala:943)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\n\tat scala.collection.TraversableOnce.reduceLeft(TraversableOnce.scala:237)\n\tat scala.collection.TraversableOnce.reduceLeft$(TraversableOnce.scala:220)\n\tat scala.collection.AbstractIterator.reduceLeft(Iterator.scala:1431)\n\tat scala.collection.TraversableOnce.reduceLeftOption(TraversableOnce.scala:249)\n\tat scala.collection.TraversableOnce.reduceLeftOption$(TraversableOnce.scala:248)\n\tat scala.collection.AbstractIterator.reduceLeftOption(Iterator.scala:1431)\n\tat scala.collection.TraversableOnce.reduceOption(TraversableOnce.scala:256)\n\tat scala.collection.TraversableOnce.reduceOption$(TraversableOnce.scala:256)\n\tat scala.collection.AbstractIterator.reduceOption(Iterator.scala:1431)\n\tat org.apache.spark.sql.catalyst.json.JsonInferSchema.$anonfun$infer$1(JsonInferSchema.scala:80)\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2(RDD.scala:863)\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2$adapted(RDD.scala:863)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:506)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1462)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:509)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:834)\n\nDriver stacktrace:\n  at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2403)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2352)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2351)\n  at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\n  at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\n  at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\n  at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2351)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1109)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1109)\n  at scala.Option.foreach(Option.scala:407)\n  at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1109)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2591)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2533)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2522)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:898)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2214)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2309)\n  at org.apache.spark.sql.catalyst.json.JsonInferSchema.infer(JsonInferSchema.scala:93)\n  at org.apache.spark.sql.execution.datasources.json.TextInputJsonDataSource$.$anonfun$inferFromDataset$5(JsonDataSource.scala:110)\n  at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\n  at org.apache.spark.sql.execution.datasources.json.TextInputJsonDataSource$.inferFromDataset(JsonDataSource.scala:110)\n  at org.apache.spark.sql.execution.datasources.json.TextInputJsonDataSource$.infer(JsonDataSource.scala:99)\n  at org.apache.spark.sql.execution.datasources.json.JsonDataSource.inferSchema(JsonDataSource.scala:65)\n  at org.apache.spark.sql.execution.datasources.json.JsonFileFormat.inferSchema(JsonFileFormat.scala:59)\n  at org.apache.spark.sql.execution.datasources.DataSource.$anonfun$getOrInferFileFormatSchema$11(DataSource.scala:210)\n  at scala.Option.orElse(Option.scala:447)\n  at org.apache.spark.sql.execution.datasources.DataSource.getOrInferFileFormatSchema(DataSource.scala:207)\n  at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:411)\n  at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:274)\n  at org.apache.spark.sql.DataFrameReader.$anonfun$load$3(DataFrameReader.scala:245)\n  at scala.Option.getOrElse(Option.scala:189)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:245)\n  at org.apache.spark.sql.DataFrameReader.json(DataFrameReader.scala:405)\n  at org.apache.spark.sql.DataFrameReader.json(DataFrameReader.scala:386)\n  ... 44 elided\nCaused by: java.io.CharConversionException: Invalid UTF-32 character 0x4b020414 (above 0x0010ffff) at char #2, byte #11)\n  at com.fasterxml.jackson.core.io.UTF32Reader.reportInvalid(UTF32Reader.java:195)\n  at com.fasterxml.jackson.core.io.UTF32Reader.read(UTF32Reader.java:158)\n  at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._loadMore(ReaderBasedJsonParser.java:255)\n  at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._skipWSOrEnd(ReaderBasedJsonParser.java:2389)\n  at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextToken(ReaderBasedJsonParser.java:677)\n  at org.apache.spark.sql.catalyst.json.JsonInferSchema.$anonfun$infer$4(JsonInferSchema.scala:67)\n  at org.apache.spark.util.Utils$.tryWithResource(Utils.scala:2713)\n  at org.apache.spark.sql.catalyst.json.JsonInferSchema.$anonfun$infer$2(JsonInferSchema.scala:66)\n  at scala.collection.Iterator$$anon$11.nextCur(Iterator.scala:486)\n  at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:492)\n  at scala.collection.Iterator.foreach(Iterator.scala:943)\n  at scala.collection.Iterator.foreach$(Iterator.scala:943)\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\n  at scala.collection.TraversableOnce.reduceLeft(TraversableOnce.scala:237)\n  at scala.collection.TraversableOnce.reduceLeft$(TraversableOnce.scala:220)\n  at scala.collection.AbstractIterator.reduceLeft(Iterator.scala:1431)\n  at scala.collection.TraversableOnce.reduceLeftOption(TraversableOnce.scala:249)\n  at scala.collection.TraversableOnce.reduceLeftOption$(TraversableOnce.scala:248)\n  at scala.collection.AbstractIterator.reduceLeftOption(Iterator.scala:1431)\n  at scala.collection.TraversableOnce.reduceOption(TraversableOnce.scala:256)\n  at scala.collection.TraversableOnce.reduceOption$(TraversableOnce.scala:256)\n  at scala.collection.AbstractIterator.reduceOption(Iterator.scala:1431)\n  at org.apache.spark.sql.catalyst.json.JsonInferSchema.$anonfun$infer$1(JsonInferSchema.scala:80)\n  at org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2(RDD.scala:863)\n  at org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2$adapted(RDD.scala:863)\n  at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\n  at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\n  at org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\n  at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\n  at org.apache.spark.scheduler.Task.run(Task.scala:131)\n  at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:506)\n  at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1462)\n  at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:509)\n  ... 3 more\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nval removeHttpPrefixList = udf[Seq[String], Seq[String]]((e:Seq[String]) => {\n    if (e!=null && e.size>0) {\n        e.map{x=> if (x==null) null else x.replace(\"https://www.\", \"\").replace(\"http://www.\", \"\").replace(\"www.\", \"\").replace(\"https://\", \"\").replace(\"http://\", \"\")}        \n    }\n    else e\n})\nspark.udf.register(\"removeHttpPrefixList\", removeHttpPrefixList)\nval inst_df = spark.read.parquet(\"/media/ometaxas/nvme/datasets/pkg/2023-05-03/institutions/\")\n        .withColumn(\"domains\", removeHttpPrefixList($\"webPages\"))        \n.cache()\n\n\ninst_df.printSchema\nprintln(\"inst_df cnt:\" + inst_df.count())\n//inst_df.show(20)\ninst_df.filter(array_contains(inst_df(\"domains\"),\"harvard.edu\")).show(false)\n",
   "id": "",
   "dateCreated": "2023-10-02 13:33:09.805",
   "config": {
    "title": true,
    "tableHide": false
   },
   "title": "Analyze Institution data",
   "dateStarted": "2023-10-02 14:39:18.855",
   "dateUpdated": "2023-10-02 14:39:26.471",
   "dateFinished": "2023-10-02 14:39:26.471",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- id: string (nullable = true)\n |-- pkgId: string (nullable = true)\n |-- ids: struct (nullable = true)\n |    |-- openAlex: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |    |-- mag: string (nullable = true)\n |    |-- ringgold: string (nullable = true)\n |    |-- ror: string (nullable = true)\n |    |-- grid: string (nullable = true)\n |    |-- wikidata: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |    |-- isni: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |    |-- fundref: array (nullable = true)\n |    |    |-- element: string (containsNull = true)\n |-- acronyms: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- alternativeNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- geo: struct (nullable = true)\n |    |-- city: string (nullable = true)\n |    |-- country: string (nullable = true)\n |    |-- countryCode: string (nullable = true)\n |    |-- location: struct (nullable = true)\n |    |    |-- latitude: double (nullable = true)\n |    |    |-- longitude: double (nullable = true)\n |    |-- postcode: string (nullable = true)\n |    |-- state: string (nullable = true)\n |    |-- stateCode: string (nullable = true)\n |-- conceptIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- conceptPkgIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- conceptsForPkgCore: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- pkdId: string (nullable = true)\n |-- name: string (nullable = true)\n |-- normalizedNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- parentInstitutions: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- pkgId: string (nullable = true)\n |    |    |-- ids: struct (nullable = true)\n |    |    |    |-- openalex: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- ror: string (nullable = true)\n |    |    |    |-- ringgold: string (nullable = true)\n |    |    |    |-- mag: string (nullable = true)\n |    |    |    |-- grid: string (nullable = true)\n |    |    |    |-- wikidata: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- fundref: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- isni: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |-- types: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- webPages: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- wikiPages: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- roleNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- affiliationCitationCount: long (nullable = true)\n |-- affiliationPaperCount: long (nullable = true)\n |-- affiliationHIndex: integer (nullable = true)\n |-- affiliationTopKConcepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- conceptPkgId: string (nullable = true)\n |    |    |-- paperCount: long (nullable = true)\n |    |    |-- scoreSum: double (nullable = true)\n |    |    |-- normalizedScore: double (nullable = true)\n |-- publisherCitationCount: long (nullable = true)\n |-- publisherPaperCount: long (nullable = true)\n |-- publisherHIndex: integer (nullable = true)\n |-- publisherTopKConcepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- conceptPkgId: string (nullable = true)\n |    |    |-- paperCount: long (nullable = true)\n |    |    |-- scoreSum: double (nullable = true)\n |    |    |-- normalizedScore: double (nullable = true)\n |-- domains: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\ninst_df cnt:109100\n+-------------+--------------------+--------------------+--------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+------------------------+---------------------+-----------------+-----------------------+----------------------+-------------------+---------------+---------------------+--------------------+\n|           id|               pkgId|                 ids|acronyms|    alternativeNames|                 geo|          conceptIds|       conceptPkgIds|  conceptsForPkgCore|              name|     normalizedNames|parentInstitutions|               types|            webPages|           wikiPages|           roleNames|affiliationCitationCount|affiliationPaperCount|affiliationHIndex|affiliationTopKConcepts|publisherCitationCount|publisherPaperCount|publisherHIndex|publisherTopKConcepts|             domains|\n+-------------+--------------------+--------------------+--------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+------------------------+---------------------+-----------------+-----------------------+----------------------+-------------------+---------------+---------------------+--------------------+\n|ror:03vek6s52|3dgClN1kVsjPYvNOQ...|{[I136199984, P43...|   [HMS]|[President and Fe...|{Cambridge, Unite...|[C71924100, C8680...|[3dgClJ7o690JPhzI...|[{3dgClJ7o690JPhz...|Harvard University|[harvard universi...|                []|[academic, Educat...|[www.harvard.edu,...|[http://en.wikipe...|[AFFILIATION, PUB...|                27592859|               451125|             1418|   [{3dgClJ7o690JPhz...|                   984|                289|             15| [{3dgCks9R1Ph3dN9...|[harvard.edu, har...|\n+-------------+--------------------+--------------------+--------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+------------------------+---------------------+-----------------+-----------------------+----------------------+-------------------+---------------+---------------------+--------------------+\n\n+-------------+---------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------+---------------------+-----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+------------------------+------------------------+---------------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+-------------------+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------+\n|id           |pkgId                |ids                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |acronyms|alternativeNames                                                                                                                                                                                                                                                                                                          |geo                                                                                              |conceptIds                                                                                                                                                                   |conceptPkgIds                                                                                                                                                                                                                                                                                                                                            |conceptsForPkgCore                                                                                                                                                                                                                                                                                                                                                                     |name              |normalizedNames                                                                                                                                                                                                                                                                                                                                             |parentInstitutions|types                |webPages                                                                                 |wikiPages                                                                                          |roleNames               |affiliationCitationCount|affiliationPaperCount|affiliationHIndex|affiliationTopKConcepts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |publisherCitationCount|publisherPaperCount|publisherHIndex|publisherTopKConcepts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |domains                                                   |\n+-------------+---------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------+---------------------+-----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+------------------------+------------------------+---------------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+-------------------+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------+\n|ror:03vek6s52|3dgClN1kVsjPYvNOQOxNS|{[I136199984, P4310316284], 136199984, 1812, 03vek6s52, grid.38142.3c, [Q13371, Q49121], [000000041936754X, 0000000403780882], [100007229, 100010520, 100009802, 100009868, 100008548, 100008549, 100008126, 100005724, 100005578, 100009116, 100008036, 100009345, 100005668, 100009403, 100010952, 100008024, 100005487, 100005473, 100005293, 100008035, 100006075, 100005915, 100005469, 100005650, 100005678, 100005692, 100005802, 100005856, 100005893, 100005941, 100006007, 100006011, 100006274, 100007230, 100007300, 100007877, 100007887, 100008263, 100005574, 100007299, 100006691, 100007301]}|[HMS]   |[President and Fellows of Harvard College, Harvard University, Harvard, Harvard-Universität, Universität Harvard, University of Harvard, Harvard Graduate School, harvard.edu, Universidad Harvard, Harvard University Medical School, Escuela Medica de Harvard, Facultad de Medicina de Harvard, Harvard Medical School]|{Cambridge, United States, US, {42.375099182128906, -71.1056137084961}, 02138, Massachusetts, MA}|[C71924100, C86803240, C126322002, C185592680, C54355233, C55493867, C142724271, C15744967, C121332964, C141071460, C33923547, C118552586, C41008148, C134018914, C104317684]|[3dgClJ7o690JPhzID9QW3, 3dgCkRbHxagwT7Tal79IL, 3dgCl7iIMmrwyVywvYNa8, 3dgClI6RQ459XdsaANyBR, 3dgClTaX705SUvk1jB0yB, 3dgClr7cVZeIcEJUNvSRE, 3dgCkMfgjlrDSowj8S565, 3dgCkXkEvVVUDrSUV2Tet, 3dgClRKeXVl7LVOIrWT2i, 3dgCkNhFTpxqJ4lQSecvZ, 3dgClecwaeE9U5AYofc9M, 3dgCkJAtT5heIhZYYR9Va, 3dgCkY6Z5pHAlBtvPSKyR, 3dgCkSLClyAuhoAeubE1j, 3dgCkqWLmBIQgLcvrBWcX]|[{3dgClJ7o690JPhzID9QW3}, {3dgCkRbHxagwT7Tal79IL}, {3dgCl7iIMmrwyVywvYNa8}, {3dgClI6RQ459XdsaANyBR}, {3dgClTaX705SUvk1jB0yB}, {3dgClr7cVZeIcEJUNvSRE}, {3dgCkMfgjlrDSowj8S565}, {3dgCkXkEvVVUDrSUV2Tet}, {3dgClRKeXVl7LVOIrWT2i}, {3dgCkNhFTpxqJ4lQSecvZ}, {3dgClecwaeE9U5AYofc9M}, {3dgCkJAtT5heIhZYYR9Va}, {3dgCkY6Z5pHAlBtvPSKyR}, {3dgCkSLClyAuhoAeubE1j}, {3dgCkqWLmBIQgLcvrBWcX}]|Harvard University|[harvard university, president and fellows of harvard college, HMS, harvard medical school, rowland institute at harvard, harvard, harvard universitat, universitat harvard, university of harvard, harvard graduate school, harvardedu, universidad harvard, harvard university medical school, escuela medica de harvard, facultad de medicina de harvard]|[]                |[academic, Education]|[www.harvard.edu, http://www.harvard.edu/, https://harvard.edu, https://hms.harvard.edu/]|[http://en.wikipedia.org/wiki/Harvard_University, https://en.wikipedia.org/wiki/Harvard_University]|[AFFILIATION, PUBLISHER]|27592859                |451125               |1418             |[{3dgClJ7o690JPhzID9QW3, 277178, 8422816.548818225, 0.09789968771991553}, {3dgCkRbHxagwT7Tal79IL, 193541, 8097028.978362627, 0.09411300885474329}, {3dgCl7iIMmrwyVywvYNa8, 161659, 2535873.2435872, 0.029474843385887208}, {3dgClTaX705SUvk1jB0yB, 88510, 1301733.942096602, 0.015130253126972413}, {3dgCkqWLmBIQgLcvrBWcX, 82199, 6521475.036152523, 0.07580010389780312}, {3dgClI6RQ459XdsaANyBR, 77840, 2549510.8282944937, 0.029633355123185497}, {3dgClr7cVZeIcEJUNvSRE, 77157, 1295138.8843216223, 0.015053597759623128}, {3dgCkY6Z5pHAlBtvPSKyR, 71608, 2112039.434359463, 0.024548558059827308}, {3dgCkXkEvVVUDrSUV2Tet, 61989, 2773701.7656450775, 0.032239160749966814}, {3dgCkMfgjlrDSowj8S565, 61609, 855120.6481636585, 0.009939198358750888}, {3dgClRKeXVl7LVOIrWT2i, 60918, 2709970.9832946826, 0.03149840809863132}, {3dgClpelOtLf5HQqXxK5p, 55075, 623620.1340311503, 0.00724843240068757}, {3dgCkftZyiImgCwTydEoi, 49181, 607347.3870328245, 0.007059291768186817}, {3dgCkNhFTpxqJ4lQSecvZ, 43187, 720284.5364489825, 0.00837197756583376}, {3dgCkJAtT5heIhZYYR9Va, 39972, 507004.24933945254, 0.005892988099089821}, {3dgCkSLClyAuhoAeubE1j, 39504, 440614.617565962, 0.0051213312333853395}, {3dgClecwaeE9U5AYofc9M, 38649, 1631104.7974135587, 0.01895858106130167}, {3dgClDxI32udMbEg53O43, 36768, 370878.94034928264, 0.004310782768643148}, {3dgClD2Ac4B3VA3O5WhPw, 35850, 597614.3086959112, 0.006946162706878818}, {3dgClVZYdrAygxIejEIAw, 34289, 307134.7882674777, 0.003569874718870285}, {3dgClXiuGzUkSnvVEgDxR, 34134, 1165088.551724718, 0.013542002810912716}, {3dgClHWHTKd9LwHN16PuV, 32468, 1263077.6107827635, 0.01468094466321947}, {3dgClCVbkoIMBVTIObt1i, 32338, 0.0, 0.0}, {3dgCkkDwXOXG2Ihf8rOkY, 31667, 1261184.7811555536, 0.014658944014346637}, {3dgCksXDwUn0vInDJ6toi, 30755, 1366331.4331931625, 0.015881079666905853}, {3dgClHNVJRu7llGPXTAaz, 28490, 582765.7153245714, 0.006773575230265887}, {3dgClD9Top7YnbU5cNc76, 26536, 681209.5409475206, 0.007917802904059017}, {3dgCkue8fURDKv7MWhQbN, 24989, 112410.2314758975, 0.0013065613496660862}, {3dgClYqVk4c3PPC0igVzo, 24947, 133159.35946047047, 0.0015477316444691069}, {3dgCkdRVips8iGeRAU4gE, 24798, 357756.9119456647, 0.004158263421282281}, {3dgClj1UmZc0feySFz8UW, 23829, 691790.6262646373, 0.008040788480472747}, {3dgCks9R1Ph3dN9P6oIWu, 23079, 1273758.463491722, 0.01480508985132002}, {3dgClqkPrqdANPKdUDrB2, 23031, 318092.3957661458, 0.0036972366703100943}, {3dgClAsKQF8VyDFaZRmE5, 22510, 229138.27336592486, 0.00266330927157046}, {3dgCkXXBB6qhh47qz9eEf, 22331, 290930.57978555415, 0.003381530720050638}, {3dgCkWHmbvmtD78Sp7TNj, 22269, 266818.1595648331, 0.003101268364091909}, {3dgCltDqrAffDRq0WUVDM, 19978, 302660.9805543644, 0.00351787496611606}, {3dgClCAwScAzl1Vdu5z6K, 19958, 219337.45900242796, 0.002549392904043515}, {3dgCltgturmx6qNzPPFSM, 19299, 146939.0916748608, 0.0017078955840294612}, {3dgClcWc0hGDH6eCu7rYN, 19084, 144679.4552616829, 0.0016816314836624994}, {3dgCko8TJD4qC52tlfylU, 18426, 104393.62289540058, 0.0012133830794218458}, {3dgClO2KlthZSb2uYQDst, 18099, 136474.3827367338, 0.0015862626681058458}, {3dgCkyDi9Q8N9L3czB96M, 17993, 156789.11002754496, 0.001822383857064271}, {3dgCkj37Z5tNmq4dYS3Dh, 17042, 477142.4321169984, 0.005545899620564471}, {3dgCloF8NA4pXNon8M8BE, 16697, 257477.2428192715, 0.0029926974570671657}, {3dgCkwPnxFL67FvlHI4nI, 16528, 388254.48826662434, 0.004512741425252955}, {3dgClUEJ6K0ZcclxdBUmy, 16522, 276540.83663210564, 0.0032142765298486613}, {3dgCkyXIuDrY1Yx4JrTX8, 16473, 167355.3983734657, 0.001945197446013844}, {3dgCkZOz0q3YTWtATLkG1, 16092, 153814.63945278423, 0.0017878111296739292}, {3dgCkgwD5poRX4s7icVHr, 15124, 1418743.4476057575, 0.01649027254366211}]|984                   |289                |15             |[{3dgCks9R1Ph3dN9P6oIWu, 261, 14404.911780031514, 0.3846075090681098}, {3dgClrlyIaWh2GR39Bzxs, 210, 2502.7048336499934, 0.06682158743500033}, {3dgCkXkEvVVUDrSUV2Tet, 80, 3579.6051114181782, 0.09557455306727378}, {3dgCkkDwXOXG2Ihf8rOkY, 48, 1911.6704928, 0.051041119697381815}, {3dgClXiuGzUkSnvVEgDxR, 44, 1501.842628342856, 0.04009881914722737}, {3dgClHNVJRu7llGPXTAaz, 44, 900.0242707720004, 0.02403042088479238}, {3dgCksXDwUn0vInDJ6toi, 34, 1510.4948375414626, 0.04032983094921739}, {3dgClPsa3vir4LZlEXzV7, 34, 126.14874097052626, 0.003368139546957098}, {3dgCkY6Z5pHAlBtvPSKyR, 26, 766.8560118043013, 0.020474861978870936}, {3dgClecwaeE9U5AYofc9M, 25, 1055.0756794565218, 0.028170254365364016}, {3dgCkbv9Neh8KtgkfgTHB, 22, 144.7111769063529, 0.0038637519017242607}, {3dgCko1kGqPwHnlvu41xZ, 21, 420.11659624199984, 0.011217007092177754}, {3dgCkpOYRTRpfLNiOopjT, 19, 190.708095629, 0.005091858023085519}, {3dgCkRbHxagwT7Tal79IL, 17, 711.2161900142856, 0.0189892927792514}, {3dgClbDbmIuAUaUcmRnSh, 16, 0.0, 0.0}, {3dgClrrvAcjI6F2QIS3pd, 14, 79.84604410999995, 0.0021318692264856286}, {3dgClnCV3g9Us29Fob3u1, 14, 98.20772462199999, 0.0026221214621025366}, {3dgClN70sCsM9rfi0uaAW, 12, 51.551618142857144, 0.001376415194006227}, {3dgClSdYiYqMRdpxBOsMx, 12, 98.69194182666666, 0.002635049939262177}, {3dgClRKeXVl7LVOIrWT2i, 11, 489.3410948528091, 0.013065283734461636}, {3dgClD9Top7YnbU5cNc76, 10, 256.71146402898535, 0.006854131301677414}, {3dgCkHsxf82TkgrSLEQ63, 10, 475.94512245714276, 0.01270761465232366}, {3dgClI6RQ459XdsaANyBR, 10, 327.5322235733334, 0.00874502770802831}, {3dgClHYQOSNP3si4ZSPhh, 9, 143.78005646999995, 0.0038388912210663927}, {3dgClXk4qNR9kelUBpDKG, 9, 32.08332085875, 8.566165698579357E-4}, {3dgCliqBsv3E0DRiLTUCG, 8, 295.8310024, 0.007898613103338082}, {3dgClr7cVZeIcEJUNvSRE, 8, 134.28607999999988, 0.003585404445372305}, {3dgClcowL87exxcKrjDzj, 8, 38.9628046075, 0.0010402970497307177}, {3dgCl1uaqmfEgFQ8NgtnL, 8, 172.949914992, 0.004617719081822029}, {3dgCkrdMoFDsvCHpKiwMa, 8, 12.297454830769233, 3.2833894039505194E-4}, {3dgCkwPnxFL67FvlHI4nI, 7, 164.4349841400001, 0.004390372577040609}, {3dgClqDxIJwuVK8zpv3Sz, 7, 177.9516911829999, 0.004751265243791821}, {3dgCloj9jthX8IuXzB04D, 7, 218.80009315161286, 0.005841907267184118}, {3dgCkfRbHOhHPfNYgeG9e, 7, 41.68572802293104, 0.001112998417721315}, {3dgCkanXvvDhyIU8Rq5k0, 7, 26.795266428, 7.154268511366671E-4}, {3dgCka4tvxa6iqZLctKnI, 7, 115.76886684300004, 0.0030909995273866596}, {3dgCle2OErFdBCjdMYA33, 6, 11.614722857142857, 3.1011016900461575E-4}, {3dgCkXbfINiDmHw1H2lxi, 6, 394.98250295999986, 0.01054593314479851}, {3dgClJ7o690JPhzID9QW3, 6, 182.32651687058816, 0.004868071985547988}, {3dgCkWIGeG0EfkRNo52eA, 6, 57.44280978599997, 0.0015337085240808297}, {3dgClfIxQ7fNyTLQtvrOt, 6, 98.34614138399996, 0.002625817154714822}, {3dgClj1UmZc0feySFz8UW, 6, 174.18875141999996, 0.00465079570179664}, {3dgClPfDx8ucpK3cuvXEj, 6, 9.576903042857143, 2.557008942606679E-4}, {3dgClpt614zwEHsoG6DwM, 6, 50.10554022857143, 0.0013378052786506317}, {3dgCkO5uQEKnJ9FnklBEP, 6, 14.97678756923077, 3.998764483118185E-4}, {3dgClZpEqGfOEt2YvOogV, 6, 6.580511175999999, 1.7569798763395693E-4}, {3dgClR70UPKFvmWpvrclI, 5, 4.5048319999999995, 1.2027787748704425E-4}, {3dgCls4CWysL00zLcnqRu, 5, 40.95932581034483, 0.001093603661971986}, {3dgCl0UxMxTxeAy7iFxiE, 5, 21.380004617796615, 5.708407274881243E-4}, {3dgCln9fmVQPFxNCwNtD1, 5, 94.63544484499998, 0.0025267424936154873}]|[harvard.edu, harvard.edu/, harvard.edu, hms.harvard.edu/]|\n+-------------+---------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------+---------------------+-----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+------------------------+------------------------+---------------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+-------------------+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------+\n\n\u001b[1m\u001b[34mremoveHttpPrefixList\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = SparkUserDefinedFunction($Lambda$6337/0x00007fb88938f040@666caa90,ArrayType(StringType,true),List(Some(class[value[0]: array<string>])),Some(class[value[0]: array<string>]),None,true,true)\n\u001b[1m\u001b[34minst_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [id: string, pkgId: string ... 23 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nval works_df = spark.read.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/workswithpkgid/\")\n.dropDuplicates()\n.cache()\n\n\nworks_df.printSchema\nprintln(\"works_df cnt:\" + works_df.count())\nworks_df.show(20)\n\n",
   "id": "",
   "dateCreated": "2023-06-17 11:58:27.694",
   "config": {
    "title": true
   },
   "title": "Read LUbos Output",
   "dateStarted": "2023-06-17 12:00:11.102",
   "dateUpdated": "2023-06-17 12:00:28.121",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- pkgId: string (nullable = true)\n |-- id: string (nullable = true)\n |-- ids: struct (nullable = true)\n |    |-- openAlex: string (nullable = true)\n |    |-- mag: string (nullable = true)\n |    |-- semanticScholar: string (nullable = true)\n |    |-- crossref: string (nullable = true)\n |    |-- pubmed: string (nullable = true)\n |    |-- pmc: string (nullable = true)\n |-- authorshipsIds: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- authorPosition: string (nullable = true)\n |    |    |-- authorPositionNo: integer (nullable = true)\n |    |    |-- authorId: string (nullable = true)\n |    |    |-- institutionIds: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- rawAffiliationString: string (nullable = true)\n |-- venueId: string (nullable = true)\n |-- altVenueIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- paperConceptIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- volume: string (nullable = true)\n |-- issue: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- title: string (nullable = true)\n |-- normalizedTitle: string (nullable = true)\n |-- firstPage: string (nullable = true)\n |-- lastPage: string (nullable = true)\n |-- docType: string (nullable = true)\n |-- openAccess: struct (nullable = true)\n |    |-- isOpenAccess: boolean (nullable = true)\n |    |-- openAccessStatus: string (nullable = true)\n |    |-- openAccessUrl: string (nullable = true)\n |-- isRetracted: boolean (nullable = true)\n |-- isParatext: boolean (nullable = true)\n |-- pubDate: string (nullable = true)\n |-- pubYear: long (nullable = true)\n |-- mesh: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- descriptorUi: string (nullable = true)\n |    |    |-- descriptorName: string (nullable = true)\n |    |    |-- qualifierUi: string (nullable = true)\n |    |    |-- qualifierName: string (nullable = true)\n |    |    |-- isMajorTopic: boolean (nullable = true)\n |-- paperVector: array (nullable = true)\n |    |-- element: double (containsNull = true)\n |-- abstractText: string (nullable = true)\n |-- citationCount: long (nullable = true)\n |-- references: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- countsByYear: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- citedByCount: long (nullable = true)\n |    |    |-- year: long (nullable = true)\n\nworks_df cnt:2398069\n+--------------------+-----------+--------------------+--------------------+-----------+-------------+--------------------+------+-----+----+----------------------------------------+--------------------+---------+--------+---------------+--------------------+-----------+----------+----------+-------+----+-----------+-------------------------------------+-------------+----------+------------+\n|               pkgId|         id|                 ids|      authorshipsIds|    venueId|  altVenueIds|     paperConceptIds|volume|issue| doi|                                   title|     normalizedTitle|firstPage|lastPage|        docType|          openAccess|isRetracted|isParatext|   pubDate|pubYear|mesh|paperVector|                         abstractText|citationCount|references|countsByYear|\n+--------------------+-----------+--------------------+--------------------+-----------+-------------+--------------------+------+-----+----+----------------------------------------+--------------------+---------+--------+---------------+--------------------+-----------+----------+----------+-------+----+-----------+-------------------------------------+-------------+----------+------------+\n|3dK6y8ZOqEDqHR64W...|W1000523663|{W1000523663, 100...|[{first, 0, A3030...|S4306548506|[S4306548506]|         [C41008148]|  null|    6|null|        在事业中寻找快乐——记南宁市200...|                    |       75|      76|journal-article|{false, closed, n...|      false|     false|2010-01-01|   2010|  []|       null|  近日,从广西武鸣县精神文明办获悉,...|            0|        []|        null|\n|3dK6vNOq1KwGN6sex...|W1000664856|{W1000664856, 100...|[{first, 0, A2160...|S4306515255|[S4306515255]|        [C121332964]|     7|    2|null|                    Prototypische his...|prototypische his...|       12|      14|journal-article|{false, closed, n...|      false|     false|1999-01-01|   1999|  []|       null|                                 null|            0|        []|        null|\n|3dK6zZgrdJh1d5t8e...|W1000833485|{W1000833485, 100...|[{first, 0, A2394...|S4306553350|[S4306553350]|                  []|  null|    1|null|       发展历程 构成要素 历史方位——中...|                    |       11|      14|journal-article|{false, closed, n...|      false|     false|2008-01-01|   2008|  []|       null|中国特色社会主义理论体系，就是包括...|            0|        []|        null|\n|3dK6xVSUAcEVGxqd7...|W1001516486|{W1001516486, 100...|[{first, 0, A2408...|       null|           []|         [C17744445]|    11|    2|null|      高职学院《公共关系》案例教学法初探|                    |       67|      69|journal-article|{false, closed, n...|      false|     false|2009-01-01|   2009|  []|       null|公共关系是高职学院的一门专业必修课...|            0|        []|        null|\n|3dK6wcHuJS6RE9DPy...|W1001875177|{W1001875177, 100...|[{first, 0, A2890...|S4306556619|[S4306556619]|         [C41008148]|    17|    2|null|           区域经济—资源—环境（Ec—R—E...|             ec r ev|       19|      24|journal-article|{false, closed, n...|      false|     false|1999-01-01|   1999|  []|       null|本文对区域Ｅｃ－Ｒ－Ｅｖ复合系统的...|            0|        []|        null|\n|3dZGbaWfW7XqjpNhx...|W1001920602|{W1001920602, 100...|[{first, 0, A4349...|       null|           []|[C537208039, C118...|  null| null|null|                    Potentials to dec...|potentials to dec...|       90|      99|journal-article|{false, closed, n...|      false|     false|2000-01-01|   2000|  []|       null|                                 null|            0|        []|        null|\n|3dK6yAj903hXKFEIZ...|W1001974098|{W1001974098, 100...|[{first, 0, A2408...|S4306524871|[S4306524871]|[C15708023, C1774...|     6|    1|null|                    Un nombre para la...|un nombre para la...|     null|    null|journal-article|{false, closed, n...|      false|     false|2002-01-01|   2002|  []|       null|                 En un plenario se...|            1|        []|        null|\n|3dK6yYq631YOjCzgY...|W1002279357|{W1002279357, 100...|[{first, 0, A9485...|S4306548432|[S4306548432]|         [C41008148]|  null|    2|null|      国内国外——广东艺术节引起的思考(续)|                    |       20|      22|journal-article|{false, closed, n...|      false|     false|1994-01-01|   1994|  []|       null|探索的几个途径。现实主义复归是一个...|            0|        []|        null|\n|3dZGbLUl30bT13dII...|W1002955365|{W1002955365, 100...|[{first, 0, A2638...|S4306556292|[S4306556292]|         [C41008148]|    45|    5|null|                P15^INK4b／MTS2对人肝...|         p ink b mts|      522|     525|journal-article|{false, closed, n...|      false|     false|2000-01-01|   2000|  []|       null|利用自行构建的稳定高表达Ｐ１５ＩＮ...|            0|        []|        null|\n|3dK6uQ884j0SCsDVr...|W1003519919|{W1003519919, 100...|[{first, 0, A4342...|S4306528755|[S4306528755]|[C173419221, C140...|    35|    1|null|                    The slaughter val...|the slaughter val...|     null|    null|journal-article|{false, closed, n...|      false|     false|1998-01-01|   1998|  []|       null|                                 null|            1|        []|        null|\n|3dZGc97cQNnbjNOwm...| W100419536|{W100419536, 1004...|[{first, 0, A4336...|S4306522910|[S4306522910]|[C2778282533, C20...|  null| null|null|                    Dielectric streng...|dielectric streng...|     null|    null|journal-article|{false, closed, n...|      false|     false|1983-01-01|   1983|  []|       null|                 The behavior of s...|            0|        []|        null|\n|3dK6yUAa4QHY5nkr9...|W1004381887|{W1004381887, 100...|[{first, 0, A1024...|S4306559350|[S4306559350]|         [C41008148]|  null|    1|null|   对高等教育哲学认识论与政治论的思考...|                   s|       11|      13|journal-article|{false, closed, n...|      false|     false|2008-01-01|   2008|  []|       null|在不同哲学观指导下，不同学者对高等...|            0|        []|        null|\n|3dK6vZdEWJGnaR4DD...|  W10051984|{W10051984, 10051...|[{first, 0, A3427...|       null|           []|[C33923547, C4100...|  1979| 1979|null|                    Teori soal penyel...|teori soal penyel...|        1|      99|journal-article|{false, closed, n...|      false|     false|1979-01-01|   1979|  []|       null|                                 null|            0|        []|        null|\n|3dK6wKelcbkgyYPb6...|W1005265703|{W1005265703, 100...|[{first, 0, A2407...|S4306558808|[S4306558808]|         [C41008148]|     2|    2|null|对《也谈用万用表测量交流电流》一文的修正|                    |       17|      17|journal-article|{false, closed, n...|      false|     false|2000-01-01|   2000|  []|       null|                                 null|            0|        []|        null|\n|3dK6yl5GtL54yT5pk...|W1005857535|{W1005857535, 100...|[{first, 0, A2403...|S4306543993|[S4306543993]|         [C41008148]|    21|   11|null|     论“问题教学”在高师公共教育学教学...|                    |       84|      86|journal-article|{false, closed, n...|      false|     false|2008-01-01|   2008|  []|       null|教学方法是制约公共教育学教学质量的...|            0|        []|        null|\n|3dK6yEnWJUNqORcI5...|W1005907960|{W1005907960, 100...|[{first, 0, A2312...|S4306554794|[S4306554794]|         [C41008148]|  null|    8|null|                          也论“回”与“次”|                    |       64|      66|journal-article|{false, closed, n...|      false|     false|2008-01-01|   2008|  []|       null|  本文就全国斌先生关于动量词“回”与...|            0|        []|        null|\n|3dK6xBJTExS9dSvwS...|W1006169443|{W1006169443, 100...|[{first, 0, A2098...|S4306557992|[S4306557992]|[C41008148, C1441...|    26|    2|null|      振叶寻根 直指词心——评《倦驼庵稼...|                    |       34|      37|journal-article|{false, closed, n...|      false|     false|2007-01-01|   2007|  []|       null|顾随《倦驼庵稼轩词说》是一部很重要...|            0|        []|        null|\n|3dK6zBESo2dH9UzS8...|W1006494726|{W1006494726, 100...|[{first, 0, A2262...|S4306540996|[S4306540996]|[C17744445, C1441...|    29|    3|null|      贸易、发展与WTO：多哈回合谈判的...|                 wto|       60|      71|journal-article|{false, closed, n...|      false|     false|2006-01-01|   2006|  []|       null|多哈回合谈判注定是如此的曲折。经过...|            0|        []|        null|\n|3dK6uZ1BOCaUMRyvc...|W1007089006|{W1007089006, 100...|[{first, 0, A4340...|S4306558406|[S4306558406]|         [C17744445]|  null|   12|null|     容忍度研究——对外汉语教学研究的另...|                    |      168|     169|journal-article|{false, closed, n...|      false|     false|2009-01-01|   2009|  []|       null|                                 null|            0|        []|        null|\n|3dK6wQI2BKNsCCzKQ...|W1007573464|{W1007573464, 100...|[{first, 0, A9737...|       null|           []|         [C71924100]|  null| null|null|                    Muntakhab Siwan A...|muntakhab siwan a...|     null|    null|journal-article|{false, closed, n...|      false|     false|1979-01-01|   1979|  []|       null|                                 null|            0|        []|        null|\n+--------------------+-----------+--------------------+--------------------+-----------+-------------+--------------------+------+-----+----+----------------------------------------+--------------------+---------+--------+---------------+--------------------+-----------+----------+----------+-------+----+-----------+-------------------------------------+-------------+----------+------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mworks_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [pkgId: string, id: string ... 24 more fields]\n"
     }
    ]
   },
   "dateFinished": "2023-06-17 12:00:28.121"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nimport org.apache.spark.sql.types._\nimport org.apache.commons.lang.StringUtils\nimport java.lang.Integer.parseInt\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.apache.spark.sql.functions.concat_ws;\nimport org.apache.spark.sql.functions.countDistinct;\nimport  org.apache.spark.sql.functions._\nimport org.apache.commons.lang3.StringUtils\nimport java.text.Normalizer;\nimport java.util.Locale;\nimport org.apache.spark.storage.StorageLevel;\n\n//org.apache.commons.lang3.StringUtils.stripAccents(input.toLowerCase(Locale.ENGLISH));\n\n\n//val jsondf = spark.read.json(\"/media/datadisk/Datasets/ORCiD/9988322/ORCID_2019_summaries/outgz/0.gz\")\n//val orcid_df = spark.read.json(\"/home/ometaxas/Datasets/orcidsample/\")\nval orcid_df = spark.read.json(\"/media/datadisk/Datasets/orcid/\")\n.select(lower($\"DOI\").as(\"doi\"), concat_ws(\" \", $\"firstName\",$\"surName\").as(\"ORCfullName\"), shortNormName( concat_ws(\" \", $\"firstName\",$\"surName\")).as(\"ORCshortNormName\"), normName(concat_ws(\" \", $\"firstName\",$\"surName\")).as(\"ORCnormName\"),  $\"pmID\".as(\"pmId\"), $\"orcId\")\n.dropDuplicates()\n//.persist(StorageLevel.DISK_ONLY)\n.cache()\n\n\norcid_df.printSchema\nprintln(\"ORCiD cnt:\" + orcid_df.count())\norcid_df.show(20)\n\norcid_df.write.parquet(\"/media/ometaxas/nvme/datasets/orcid/orcid_22_10.parquet\")         ",
   "id": "",
   "dateCreated": "2023-06-14 17:55:06.027",
   "config": {},
   "dateStarted": "2023-06-15 16:27:55.720",
   "dateUpdated": "2023-06-15 16:31:51.363",
   "dateFinished": "2023-06-15 16:31:51.363",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- doi: string (nullable = true)\n |-- ORCfullName: string (nullable = false)\n |-- ORCshortNormName: string (nullable = true)\n |-- ORCnormName: string (nullable = true)\n |-- pmId: string (nullable = true)\n |-- orcId: string (nullable = true)\n\nORCiD cnt:52839060\n+--------------------+-------------------+----------------+----------------+--------+-------------------+\n|                 doi|        ORCfullName|ORCshortNormName|     ORCnormName|    pmId|              orcId|\n+--------------------+-------------------+----------------+----------------+--------+-------------------+\n|10.1109/rtc.2012....|     Stefan Simrock|        ssimrock|   stefansimrock|        |0000-0002-1116-5316|\n|10.1109/sofe.2011...|     Stefan Simrock|        ssimrock|   stefansimrock|        |0000-0002-1116-5316|\n|10.1016/j.resusci...|        Ryan Morgan|         rmorgan|      ryanmorgan|27923692|0000-0003-1664-5316|\n|10.5194/amt-2021-176|     Jussi Leinonen|       jleinonen|   jussileinonen|        |0000-0002-6560-6316|\n|10.1261/rna.05449...|   Marshall Hampton|        mhampton| marshallhampton|        |0000-0002-9725-3316|\n|   10.1111/tpj.12184|   Marshall Hampton|        mhampton| marshallhampton|        |0000-0002-9725-3316|\n|  10.1037/rep0000073|       Jed McGiffin|       jmcgiffin|     jedmcgiffin|        |0000-0002-0657-7316|\n|10.1007/s11427-01...|      Jiaqiang Wang|           jwang|    jiaqiangwang|27225262|0000-0002-1758-3316|\n|10.1016/j.physlet...|        Yingjie wei|            ywei|      yingjiewei|        |0000-0001-9725-2316|\n|   10.1021/ci050085t|  Karin Kirchgatter|    kkirchgatter|karinkirchgatter|        |0000-0002-2449-2316|\n|10.3390/cryst8010038|       Markus Garst|          mgarst|     markusgarst|        |0000-0001-5390-3316|\n|10.4103/iju.iju_3...|       sohrab arora|          sarora|     sohrabarora|        |0000-0001-9903-9316|\n|10.1111/j.1600-07...|     Tomoki Maekawa|        tmaekawa|   tomokimaekawa|        |0000-0002-4597-1316|\n|10.1111/j.1460-24...|       Deen Freelon|        dfreelon|     deenfreelon|        |0000-0001-5055-0316|\n|  10.1111/jjns.12063|Chun Yin Andy Chong|          cchong|chunyinandychong|        |0000-0001-8679-9316|\n|10.1145/2465958.2...|  Thibault Langlois|       tlanglois|thibaultlanglois|        |0000-0002-0931-3316|\n|10.1016/j.ijtherm...|    Dario Ambrosini|      dambrosini|  darioambrosini|        |0000-0002-8905-0316|\n|10.1088/0143-0807...|    Dario Ambrosini|      dambrosini|  darioambrosini|        |0000-0002-8905-0316|\n|10.18047/poljo.24...|        Zoran Grgić|          zgrgic|      zorangrgic|        |0000-0003-1635-4316|\n|10.1021/acsomega....|       RIZWAN AHMED|          rahmed|     rizwanahmed|        |0000-0002-5921-4316|\n+--------------------+-------------------+----------------+----------------+--------+-------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.types._\nimport org.apache.commons.lang.StringUtils\nimport java.lang.Integer.parseInt\nimport org.slf4j.Logger\nimport org.slf4j.LoggerFactory\nimport org.apache.spark.sql.functions.concat_ws\nimport org.apache.spark.sql.functions.countDistinct\nimport org.apache.spark.sql.functions._\nimport org.apache.commons.lang3.StringUtils\nimport java.text.Normalizer\nimport java.util.Locale\nimport org.apache.spark.storage.StorageLevel\n\u001b[1m\u001b[34morcid_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [doi: string, ORCfullName: string ... 4 more fields]\n"
     }
    ]
   }
  },
  {
   "title": "S2 to Parquet",
   "text": "%spark\n\nval S2_HOME = \"/media/datadisk/Datasets/SemanticScholar/2023-05-23/papers\"\nval S2_sample = \"/media/datadisk/Datasets/SemanticScholar/2023-05-23/papers/20230526_070437_00020_2ck57_0ef4c1c6-b15e-40f0-9efc-9ef86990793c.gz\"\n\nimport  org.apache.spark.sql.functions._\n\n\n//Get Semantic Scholar articles \nval S2articlesdf = spark.read.json(s\"file://$S2_HOME\")\n\n//val S2articlesdf = spark.read.json(s\"file://$S2_sample\")\n//S2articlesdf.printSchema\n//S2articlesdf.show(5)\n//println(\"S2articlesdf  cnt:\"+S2articlesdf.count())\nS2articlesdf.write.mode(\"overwrite\").parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\n/*\n\nval S2subsetdf = S2articlesdf\n             //.join(broadcast(doisdf), lower(S2articlesdf(\"doi\"))===doisdf(\"doi\"), \"inner\")\n             //.filter(($\"magId\" =!= \"\") && ($\"magId\".isNotNull))\n             .select($\"title\", $\"id\",lower(S2articlesdf(\"doi\")).as(\"doi\"), $\"doiUrl\",$\"entities\", $\"magId\", $\"fieldsOfStudy\".as(\"S2fos\"), $\"pmid\".as(\"pmId\"), \n                 $\"inCitations\", $\"outCitations\", $\"authors\", $\"journalName\", $\"venue\", $\"year\", $\"paperAbstract\", $\"s2PdfUrl\", $\"s2Url\", $\"sources\")\n\n//S2subsetdf.printSchema\n//S2subsetdf.show(10,false)\nSubsetdf.write.mode(\"overwrite\").parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\n\n*/\n",
   "user": "anonymous",
   "dateUpdated": "2023-06-17 23:21:29.300",
   "progress": 96.0,
   "config": {
    "title": true,
    "editorHide": false
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=4"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=5"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1669640766588_871741978",
   "id": "paragraph_1669640766588_871741978",
   "dateCreated": "2022-11-28T15:06:06+0200",
   "dateStarted": "2023-06-17 22:48:54.718",
   "dateFinished": "2023-06-17 23:21:29.300",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mS2_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/datadisk/Datasets/SemanticScholar/2023-05-23/papers\n\u001b[1m\u001b[34mS2_sample\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/datadisk/Datasets/SemanticScholar/2023-05-23/papers/20230526_070437_00020_2ck57_0ef4c1c6-b15e-40f0-9efc-9ef86990793c.gz\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34mS2articlesdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<authorId:string,name:string>>, citationcount: bigint ... 15 more fields]\n"
     }
    ]
   }
  },
  {
   "title": "Count Authors & Pubs in S2",
   "text": "%spark\nimport org.apache.spark.sql.functions.countDistinct;\n\nval S2_df = spark.read.parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\n//val listValues = Seq(\"9444\",\"189538\",\"192656\",\"761215\",\"1388579\")\n//S2_df.filter($\"corpusid\".isin(listValues:_*)).show(false)\n\nprintln(\"S2_df  cnt:\"+S2_df.count())\n//207207224\nS2_df.printSchema()\n\nval stmp = S2_df.select($\"corpusid\", explode($\"authors.authorId\").as(\"authorId\"))\n        //.show(10)\n//stmp.filter($\"authorId\"===\"\"  && $\"authorId\".isNull)\n//stmp.select(countDistinct(array_max($\"authorId\"))).show(10)\nstmp.select(countDistinct($\"authorId\")).show(10)\n//79918913 \n",
   "user": "anonymous",
   "dateUpdated": "2023-06-18 11:20:15.295",
   "progress": 97.0,
   "config": {
    "title": true,
    "editorHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=12"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=13"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1669642964581_1924922475",
   "id": "paragraph_1669642964581_1924922475",
   "dateCreated": "2022-11-28T15:42:44+0200",
   "dateStarted": "2023-06-18 11:18:40.136",
   "dateFinished": "2023-06-18 11:20:15.294",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "S2_df  cnt:212251637\nroot\n |-- authors: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- authorId: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |-- citationcount: long (nullable = true)\n |-- corpusid: long (nullable = true)\n |-- externalids: struct (nullable = true)\n |    |-- ACL: string (nullable = true)\n |    |-- ArXiv: string (nullable = true)\n |    |-- CorpusId: string (nullable = true)\n |    |-- DBLP: string (nullable = true)\n |    |-- DOI: string (nullable = true)\n |    |-- MAG: string (nullable = true)\n |    |-- PubMed: string (nullable = true)\n |    |-- PubMedCentral: string (nullable = true)\n |-- influentialcitationcount: long (nullable = true)\n |-- isopenaccess: boolean (nullable = true)\n |-- journal: struct (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- pages: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- publicationdate: string (nullable = true)\n |-- publicationtypes: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- publicationvenueid: string (nullable = true)\n |-- referencecount: long (nullable = true)\n |-- s2fieldsofstudy: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- category: string (nullable = true)\n |    |    |-- source: string (nullable = true)\n |-- title: string (nullable = true)\n |-- updated: string (nullable = true)\n |-- url: string (nullable = true)\n |-- venue: string (nullable = true)\n |-- year: long (nullable = true)\n\n+------------------------+\n|count(DISTINCT authorId)|\n+------------------------+\n|                80574860|\n+------------------------+\n\nimport org.apache.spark.sql.functions.countDistinct\n\u001b[1m\u001b[34mS2_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<authorId:string,name:string>>, citationcount: bigint ... 15 more fields]\n\u001b[1m\u001b[34mstmp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [corpusid: bigint, authorId: string]\n"
     }
    ]
   }
  },
  {
   "title": "Open Alex to Parquet",
   "text": "%spark\n//import org.apache.spark.sql.types.{DataType, StructType}\nimport org.apache.spark.sql.types._                        \nimport org.apache.spark.sql.functions._   \n\nval OA_HOME = \"/media/datadisk/Datasets/OpenAlex/openalex-snapshot/data\"\nval WORKS_PATH = \"/works\"\n//val WORKS_PATH = \"/works/updated_date=2023-04-07\" \n\n//val WORKS_PATH = \"/sample1.json\"\n// /part_000.gz\"\n//val work_1 = spark.read.json(s\"$OA_HOME$WORKS_PATH\")\n//println(work_1.schema.json)\n\nval jsonStringfull =\"{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"abstract_inverted_index\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"apc_paid\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"apc_paid_usd\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"authorships\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"author\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"orcid\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"author_position\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"institutions\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_corresponding\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"raw_affiliation_string\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"raw_affiliation_strings\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"best_oa_location\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"landing_page_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"license\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"pdf_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"source\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization_lineage\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn_l\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"version\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"biblio\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"first_page\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issue\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"last_page\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"volume\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"cited_by_api_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"cited_by_count\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"concepts\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"level\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"score\\\",\\\"type\\\":\\\"double\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"wikidata\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"corresponding_author_ids\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"corresponding_institution_ids\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"counts_by_year\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"created_date\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"doi\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"grants\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"award_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"funder\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"funder_display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"ids\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"doi\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"openalex\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_paratext\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_retracted\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"language\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"locations\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"landing_page_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"license\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"pdf_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"source\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization_lineage\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn_l\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"version\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"mesh\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"open_access\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"any_repository_has_fulltext\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"oa_status\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"oa_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"primary_location\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"landing_page_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"license\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"pdf_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"source\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization_lineage\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn_l\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"version\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publication_date\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publication_year\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"referenced_works\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"related_works\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"summary_stats\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"2yr_cited_by_count\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"cited_by_count\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"title\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"updated_date\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]}\"\n\n\nval jsonStringfull_OLD = \"{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"abstract_inverted_index\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"alternate_host_venues\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn_l\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"license\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"version\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"authorships\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"author\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"orcid\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"author_position\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"institutions\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"country_code\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"ror\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_corresponding\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"raw_affiliation_string\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"best_oa_location\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"biblio\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"first_page\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issue\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"last_page\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"volume\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"cited_by_api_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"cited_by_count\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"concepts\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"level\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"score\\\",\\\"type\\\":\\\"double\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"wikidata\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"counts_by_year\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"cited_by_count\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"year\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"created_date\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"doi\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_venue\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn_l\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"license\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"version\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"ids\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"mag\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"openalex\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"pmid\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_paratext\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_retracted\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"locations\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"landing_page_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"license\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"pdf_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"source\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn_l\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"version\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"mesh\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"descriptor_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"descriptor_ui\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"is_major_topic\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"qualifier_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"qualifier_ui\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"open_access\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"boolean\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"oa_status\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"oa_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"primary_location\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"is_oa\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"landing_page_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"license\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"pdf_url\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"source\\\",\\\"type\\\":{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"display_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"host_organization\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"issn_l\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publisher_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"version\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publication_date\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"publication_year\\\",\\\"type\\\":\\\"long\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"referenced_works\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"related_works\\\",\\\"type\\\":{\\\"type\\\":\\\"array\\\",\\\"elementType\\\":\\\"string\\\",\\\"containsNull\\\":true},\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"title\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"type\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"updated_date\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]}\"\n\n\nval schemaFromJson =  DataType.fromJson(jsonStringfull).asInstanceOf[StructType]\n\nprintln(schemaFromJson)\n//val work_1 = spark.read.json(s\"$OA_HOME$WORKS_PATH\")\n//println(work_1.schema.json)\n\nval work_1 = spark.read.option(\"pathGlobFilter\", \"*.gz\").schema(schemaFromJson).json(s\"$OA_HOME$WORKS_PATH\")\n//val work_1 = spark.read.schema(schemaFromJson).json(s\"$OA_HOME$WORKS_PATH\")\n        \nimport org.apache.spark.sql.types._                        \nimport org.apache.spark.sql.functions._   \n\n//work_1.filter($\"abstract_inverted_index\".isNotNull).select($\"abstract_inverted_index\").show(10, false)\n\nwork_1.printSchema()\n//work_1.show(5, false)\n//work_1.select()\n//work_1.filter($\"authorships.institutions\".isNotNull).select($\"authorships.institutions\",$\"concepts.display_name\", $\"authorships.raw_affiliation_string\").show(30, false)\n\n\n\nval work = work_1\n        .withColumn(\"abstractInvertedMap\",from_json(col(\"abstract_inverted_index\"),MapType(StringType, ArrayType(LongType, true))))\n        .withColumn(\"abstract\", workAbstractFromInverted(col(\"abstractInvertedMap\")) )\n        .withColumn(\"abstract\", workAbstractFromInverted(col(\"abstractInvertedMap\")) )\n        \n       \n\n//work.filter($\"abstract_inverted_index\".isNotNull).select($\"abstract\", $\"abstractInvertedMap\", $\"abstract_inverted_index\").show(10, false)\n\n//work.filter($\"abstract_inverted_index\".isNotNull).drop($\"related_works\").drop($\"abstractInvertedMap\").drop($\"abstract_inverted_index\").drop($\"counts_by_year\").show(10)\n\nwork.drop($\"abstractInvertedMap\").drop($\"abstract_inverted_index\").drop($\"counts_by_year\")\n        //.filter($\"abstract_inverted_index\".isNotNull && $\"primary_location\".isNotNull).show(10)\n        .write.mode(\"overwrite\").parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\n\n",
   "user": "anonymous",
   "dateUpdated": "2023-06-18 15:38:00.473",
   "progress": 99.0,
   "config": {
    "title": true,
    "editorHide": false,
    "tableHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=183"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=184"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670076882653_1959674661",
   "id": "paragraph_1670076882653_1959674661",
   "dateCreated": "2022-12-03T16:14:42+0200",
   "dateStarted": "2023-06-18 12:04:53.356",
   "dateFinished": "2023-06-18 15:38:00.473",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "StructType(StructField(abstract_inverted_index,StringType,true), StructField(apc_paid,ArrayType(StringType,true),true), StructField(apc_paid_usd,StringType,true), StructField(authorships,ArrayType(StructType(StructField(author,StructType(StructField(display_name,StringType,true), StructField(id,StringType,true), StructField(orcid,StringType,true)),true), StructField(author_position,StringType,true), StructField(institutions,ArrayType(StringType,true),true), StructField(is_corresponding,BooleanType,true), StructField(raw_affiliation_string,StringType,true), StructField(raw_affiliation_strings,ArrayType(StringType,true),true)),true),true), StructField(best_oa_location,StructType(StructField(is_oa,BooleanType,true), StructField(landing_page_url,StringType,true), StructField(license,StringType,true), StructField(pdf_url,StringType,true), StructField(source,StructType(StructField(display_name,StringType,true), StructField(host_organization,StringType,true), StructField(host_organization_lineage,ArrayType(StringType,true),true), StructField(host_organization_name,StringType,true), StructField(id,StringType,true), StructField(issn,ArrayType(StringType,true),true), StructField(issn_l,StringType,true), StructField(publisher,StringType,true), StructField(publisher_id,StringType,true), StructField(type,StringType,true)),true), StructField(version,StringType,true)),true), StructField(biblio,StructType(StructField(first_page,StringType,true), StructField(issue,StringType,true), StructField(last_page,StringType,true), StructField(volume,StringType,true)),true), StructField(cited_by_api_url,StringType,true), StructField(cited_by_count,LongType,true), StructField(concepts,ArrayType(StructType(StructField(display_name,StringType,true), StructField(id,StringType,true), StructField(level,LongType,true), StructField(score,DoubleType,true), StructField(wikidata,StringType,true)),true),true), StructField(corresponding_author_ids,ArrayType(StringType,true),true), StructField(corresponding_institution_ids,ArrayType(StringType,true),true), StructField(counts_by_year,ArrayType(StringType,true),true), StructField(created_date,StringType,true), StructField(display_name,StringType,true), StructField(doi,StringType,true), StructField(grants,ArrayType(StructType(StructField(award_id,StringType,true), StructField(funder,StringType,true), StructField(funder_display_name,StringType,true)),true),true), StructField(id,StringType,true), StructField(ids,StructType(StructField(doi,StringType,true), StructField(openalex,StringType,true)),true), StructField(is_paratext,BooleanType,true), StructField(is_retracted,BooleanType,true), StructField(language,StringType,true), StructField(locations,ArrayType(StructType(StructField(is_oa,BooleanType,true), StructField(landing_page_url,StringType,true), StructField(license,StringType,true), StructField(pdf_url,StringType,true), StructField(source,StructType(StructField(display_name,StringType,true), StructField(host_organization,StringType,true), StructField(host_organization_lineage,ArrayType(StringType,true),true), StructField(host_organization_name,StringType,true), StructField(id,StringType,true), StructField(issn,ArrayType(StringType,true),true), StructField(issn_l,StringType,true), StructField(publisher,StringType,true), StructField(publisher_id,StringType,true), StructField(type,StringType,true)),true), StructField(version,StringType,true)),true),true), StructField(mesh,ArrayType(StringType,true),true), StructField(open_access,StructType(StructField(any_repository_has_fulltext,BooleanType,true), StructField(is_oa,BooleanType,true), StructField(oa_status,StringType,true), StructField(oa_url,StringType,true)),true), StructField(primary_location,StructType(StructField(is_oa,BooleanType,true), StructField(landing_page_url,StringType,true), StructField(license,StringType,true), StructField(pdf_url,StringType,true), StructField(source,StructType(StructField(display_name,StringType,true), StructField(host_organization,StringType,true), StructField(host_organization_lineage,ArrayType(StringType,true),true), StructField(host_organization_name,StringType,true), StructField(id,StringType,true), StructField(issn,ArrayType(StringType,true),true), StructField(issn_l,StringType,true), StructField(publisher,StringType,true), StructField(publisher_id,StringType,true), StructField(type,StringType,true)),true), StructField(version,StringType,true)),true), StructField(publication_date,StringType,true), StructField(publication_year,LongType,true), StructField(referenced_works,ArrayType(StringType,true),true), StructField(related_works,ArrayType(StringType,true),true), StructField(summary_stats,StructType(StructField(2yr_cited_by_count,LongType,true), StructField(cited_by_count,LongType,true)),true), StructField(title,StringType,true), StructField(type,StringType,true), StructField(updated_date,StringType,true))\nroot\n |-- abstract_inverted_index: string (nullable = true)\n |-- apc_paid: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- apc_paid_usd: string (nullable = true)\n |-- authorships: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- author: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- orcid: string (nullable = true)\n |    |    |-- author_position: string (nullable = true)\n |    |    |-- institutions: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- is_corresponding: boolean (nullable = true)\n |    |    |-- raw_affiliation_string: string (nullable = true)\n |    |    |-- raw_affiliation_strings: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |-- best_oa_location: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- landing_page_url: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- pdf_url: string (nullable = true)\n |    |-- source: struct (nullable = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- host_organization: string (nullable = true)\n |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- host_organization_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- issn: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- issn_l: string (nullable = true)\n |    |    |-- publisher: string (nullable = true)\n |    |    |-- publisher_id: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- biblio: struct (nullable = true)\n |    |-- first_page: string (nullable = true)\n |    |-- issue: string (nullable = true)\n |    |-- last_page: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- cited_by_api_url: string (nullable = true)\n |-- cited_by_count: long (nullable = true)\n |-- concepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- level: long (nullable = true)\n |    |    |-- score: double (nullable = true)\n |    |    |-- wikidata: string (nullable = true)\n |-- corresponding_author_ids: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- corresponding_institution_ids: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- counts_by_year: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- created_date: string (nullable = true)\n |-- display_name: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- grants: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- award_id: string (nullable = true)\n |    |    |-- funder: string (nullable = true)\n |    |    |-- funder_display_name: string (nullable = true)\n |-- id: string (nullable = true)\n |-- ids: struct (nullable = true)\n |    |-- doi: string (nullable = true)\n |    |-- openalex: string (nullable = true)\n |-- is_paratext: boolean (nullable = true)\n |-- is_retracted: boolean (nullable = true)\n |-- language: string (nullable = true)\n |-- locations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- is_oa: boolean (nullable = true)\n |    |    |-- landing_page_url: string (nullable = true)\n |    |    |-- license: string (nullable = true)\n |    |    |-- pdf_url: string (nullable = true)\n |    |    |-- source: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- host_organization: string (nullable = true)\n |    |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- host_organization_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- issn: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- issn_l: string (nullable = true)\n |    |    |    |-- publisher: string (nullable = true)\n |    |    |    |-- publisher_id: string (nullable = true)\n |    |    |    |-- type: string (nullable = true)\n |    |    |-- version: string (nullable = true)\n |-- mesh: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- open_access: struct (nullable = true)\n |    |-- any_repository_has_fulltext: boolean (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- oa_status: string (nullable = true)\n |    |-- oa_url: string (nullable = true)\n |-- primary_location: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- landing_page_url: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- pdf_url: string (nullable = true)\n |    |-- source: struct (nullable = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- host_organization: string (nullable = true)\n |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- host_organization_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- issn: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- issn_l: string (nullable = true)\n |    |    |-- publisher: string (nullable = true)\n |    |    |-- publisher_id: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- publication_date: string (nullable = true)\n |-- publication_year: long (nullable = true)\n |-- referenced_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- related_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- summary_stats: struct (nullable = true)\n |    |-- 2yr_cited_by_count: long (nullable = true)\n |    |-- cited_by_count: long (nullable = true)\n |-- title: string (nullable = true)\n |-- type: string (nullable = true)\n |-- updated_date: string (nullable = true)\n\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34mOA_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/datadisk/Datasets/OpenAlex/openalex-snapshot/data\n\u001b[1m\u001b[34mWORKS_PATH\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /works\n\u001b[1m\u001b[34mjsonStringfull\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = {\"type\":\"struct\",\"fields\":[{\"name\":\"abstract_inverted_index\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"apc_paid\",\"type\":{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"apc_paid_usd\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"authorships\",\"type\":{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"author\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"display_name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"id\",...\n"
     }
    ]
   }
  },
  {
   "title": "Stats for OpenAlex",
   "text": "%spark\nval works =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\n\n// Reduced reverse narrow channel effect in thin SOI nMOSFETs 10.1109/55.863111\n\n//works.filter(lower(removeDoiPrefix(works(\"doi\")))===\"10.1007/978-3-642-35236-2_48\" || lower(removeDoiPrefix(works(\"doi\")))===\"10.1109/55.863111\").show(false)\n\n\n//{null, null, 1388579, conf/amt/MaLTL12, 10.1007/978-3-642-35236-2_48, null, null, null}\n\n//works.select($\"authorships.institutions\", $\"authorships.raw_affiliation_string\").show(1000)\n\nworks.printSchema()\nprintln(\"cnt:\"+works.count())\n\nval workswithdoi = works.filter(($\"doi\" =!= \"\") && ($\"doi\".isNotNull))\nprintln(\"workswithdoi  cnt:\"+workswithdoi.count())\n//cnt:245016719\n//workswithdoi  cnt:140216633\n\nval works_author_is = works.select($\"id\", explode($\"authorships.author.id\").as(\"authorId\"))\nworks_author_is.select(countDistinct($\"authorId\")).show(10)\n//261178288\n\nval works_author_orcid = works.select($\"id\", explode($\"authorships.author.orcid\").as(\"orcid\")).filter(($\"orcid\" =!= \"\") && ($\"orcid\".isNotNull))\nworks_author_orcid.select(countDistinct($\"orcid\")).show(10)\nprintln(\"signatures with orcid cnt:\"+works_author_orcid.count())\n\nval retracted_cnt = works.filter($\"is_retracted\")\nprintln(\"retracted_cnt  cnt:\"+retracted_cnt.count())\n//9732\n\n//works.select($\"doi\", $\"ids.doi\").show(10)\n//works.show(10)\n\n/*\n\nval retracted_cnt2015 = works.filter($\"is_retracted\" && $\"publication_year\" === 2015)\nprintln(\"retracted_cnt2015  cnt:\"+retracted_cnt2015.count())\n\nval retracted_cnt2016 = works.filter($\"is_retracted\" && $\"publication_year\" === 2016)\nprintln(\"retracted_cnt2016  cnt:\"+retracted_cnt2016.count())\n\nval retracted_cnt2017 = works.filter($\"is_retracted\" && $\"publication_year\" === 2017)\nprintln(\"retracted_cnt2017  cnt:\"+retracted_cnt2017.count())\n\nval retracted_cnt2018 = works.filter($\"is_retracted\" && $\"publication_year\" === 2018)\nprintln(\"retracted_cnt2018  cnt:\"+retracted_cnt2018.count())\n\nval retracted_cnt2019 = works.filter($\"is_retracted\" && $\"publication_year\" === 2019)\nprintln(\"retracted_cnt2019  cnt:\"+retracted_cnt2019.count())\n\nval retracted_cnt2020 = works.filter($\"is_retracted\" && $\"publication_year\" === 2020)\nprintln(\"retracted_cnt2020  cnt:\"+retracted_cnt2020.count())\n\nval retracted_cnt2021 = works.filter($\"is_retracted\" && $\"publication_year\" === 2021)\nprintln(\"retracted_cnt2021  cnt:\"+retracted_cnt2021.count())\n*/\n//[{\"id\":\"https://openalex.org/V4306400349\",\"display_name\":\"The Pennsylvania State University - CiteSeer X\",\"type\":\"repository\",\"url\":\"https://ir.nctu.edu.tw:443/bitstream/11536/30284/1/000089132500014.pdf\",\"is_oa\":true,\"version\":\"publishedVersion\",\"license\":null}]\n\n//&& $\"publication_year\">2000\n\n/*\nval workswithabstract = works.filter(($\"host_venue.publisher\".contains(\"Wiley\") || $\"host_venue.publisher\".contains(\"wiley\")) && (($\"abstract_inverted_index\" =!= \"{}\") && ($\"abstract_inverted_index\".isNotNull)))\nprintln(\"workswithabstract  cnt:\"+workswithabstract.count())\n\nval worksnoabstract = works.filter(($\"host_venue.publisher\".contains(\"Wiley\") || $\"host_venue.publisher\".contains(\"wiley\"))  && (($\"abstract_inverted_index\" === \"{}\") || ($\"abstract_inverted_index\".isNull)))\nprintln(\"worksnoabstract  cnt:\"+worksnoabstract.count())\n*/\n\n//full\n//workswithabstract  cnt:8335978\n//worksnoabstract  cnt:152047\n    ",
   "user": "anonymous",
   "dateUpdated": "2023-06-21 12:05:57.652",
   "progress": 79.0,
   "config": {
    "title": true,
    "tableHide": false,
    "editorHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=185"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=186"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=187"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670091373327_110293791",
   "id": "paragraph_1670091373327_110293791",
   "dateCreated": "2022-12-03T20:16:13+0200",
   "dateStarted": "2023-06-21 12:03:09.804",
   "dateFinished": "2023-06-21 12:05:57.651",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- apc_paid: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- apc_paid_usd: string (nullable = true)\n |-- authorships: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- author: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- orcid: string (nullable = true)\n |    |    |-- author_position: string (nullable = true)\n |    |    |-- institutions: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- is_corresponding: boolean (nullable = true)\n |    |    |-- raw_affiliation_string: string (nullable = true)\n |    |    |-- raw_affiliation_strings: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |-- best_oa_location: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- landing_page_url: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- pdf_url: string (nullable = true)\n |    |-- source: struct (nullable = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- host_organization: string (nullable = true)\n |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- host_organization_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- issn: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- issn_l: string (nullable = true)\n |    |    |-- publisher: string (nullable = true)\n |    |    |-- publisher_id: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- biblio: struct (nullable = true)\n |    |-- first_page: string (nullable = true)\n |    |-- issue: string (nullable = true)\n |    |-- last_page: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- cited_by_api_url: string (nullable = true)\n |-- cited_by_count: long (nullable = true)\n |-- concepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- level: long (nullable = true)\n |    |    |-- score: double (nullable = true)\n |    |    |-- wikidata: string (nullable = true)\n |-- corresponding_author_ids: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- corresponding_institution_ids: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- created_date: string (nullable = true)\n |-- display_name: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- grants: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- award_id: string (nullable = true)\n |    |    |-- funder: string (nullable = true)\n |    |    |-- funder_display_name: string (nullable = true)\n |-- id: string (nullable = true)\n |-- ids: struct (nullable = true)\n |    |-- doi: string (nullable = true)\n |    |-- openalex: string (nullable = true)\n |-- is_paratext: boolean (nullable = true)\n |-- is_retracted: boolean (nullable = true)\n |-- language: string (nullable = true)\n |-- locations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- is_oa: boolean (nullable = true)\n |    |    |-- landing_page_url: string (nullable = true)\n |    |    |-- license: string (nullable = true)\n |    |    |-- pdf_url: string (nullable = true)\n |    |    |-- source: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- host_organization: string (nullable = true)\n |    |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- host_organization_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- issn: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- issn_l: string (nullable = true)\n |    |    |    |-- publisher: string (nullable = true)\n |    |    |    |-- publisher_id: string (nullable = true)\n |    |    |    |-- type: string (nullable = true)\n |    |    |-- version: string (nullable = true)\n |-- mesh: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- open_access: struct (nullable = true)\n |    |-- any_repository_has_fulltext: boolean (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- oa_status: string (nullable = true)\n |    |-- oa_url: string (nullable = true)\n |-- primary_location: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- landing_page_url: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- pdf_url: string (nullable = true)\n |    |-- source: struct (nullable = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- host_organization: string (nullable = true)\n |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- host_organization_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- issn: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- issn_l: string (nullable = true)\n |    |    |-- publisher: string (nullable = true)\n |    |    |-- publisher_id: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- publication_date: string (nullable = true)\n |-- publication_year: long (nullable = true)\n |-- referenced_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- related_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- summary_stats: struct (nullable = true)\n |    |-- 2yr_cited_by_count: long (nullable = true)\n |    |-- cited_by_count: long (nullable = true)\n |-- title: string (nullable = true)\n |-- type: string (nullable = true)\n |-- updated_date: string (nullable = true)\n |-- abstract: string (nullable = true)\n\ncnt:240790293\nworkswithdoi  cnt:146844018\n+------------------------+\n|count(DISTINCT authorId)|\n+------------------------+\n|               117896879|\n+------------------------+\n\n+---------------------+\n|count(DISTINCT orcid)|\n+---------------------+\n|              3817273|\n+---------------------+\n\nsignatures with orcid cnt:57081128\nretracted_cnt  cnt:12642\n\u001b[1m\u001b[34mworks\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [apc_paid: array<string>, apc_paid_usd: string ... 30 more fields]\n\u001b[1m\u001b[34mworkswithdoi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [apc_paid: array<string>, apc_paid_usd: string ... 30 more fields]\n\u001b[1m\u001b[34mworks_author_is\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [id: string, authorId: string]\n\u001b[1m\u001b[34mworks_author_orcid\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [id: string, orcid: string]\n\u001b[1m\u001b[34mretracted_cnt\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [apc_paid: array<string>, apc_paid_usd: string ... 30 more fields]\n"
     }
    ]
   }
  },
  {
   "text": "%spark\nval OAarticlesdf =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\nOAarticlesdf.printSchema()\n\n//{null, null, 1388579, conf/amt/MaLTL12, 10.1007/978-3-642-35236-2_48, null, null, null}\n\n//println(\"cnt:\"+works.count())\n\n//removeOpenAlexPrefix\n//removeOrcidPrefix\n//removeDoiPrefix\n\nval OAsubsetdf = OAarticlesdf             \n             .select($\"title\".as(\"OAtitle\"), removeOpenAlexPrefix($\"id\").as(\"OApaperId\"), lower(removeDoiPrefix(OAarticlesdf(\"doi\"))).as(\"OAdoi\"), $\"concepts\", $\"authorships\", $\"authorships.institutions\")      \n             .withColumn(\"OAfos_0_full\", expr(\"filter(concepts, concept -> concept.level == 0)\"))\n             .withColumn(\"OAfos_1_full\", expr(\"filter(concepts, concept -> concept.level == 1)\"))\n             .withColumn(\"OAfos_0\", $\"OAfos_0_full.display_name\")\n             .withColumn(\"OAfos_1\", $\"OAfos_1_full.display_name\")\n             \n//OAsubsetdf.select($\"OAfos_0_full.display_name\").show(20)\n//OAsubsetdf.show(20)\n//OAsubsetdf.printSchema()\n\n\n//Create pub - author rows\nval OAflatdf = OAsubsetdf.select($\"OAtitle\", $\"OApaperId\", $\"OAdoi\",   $\"OAfos_0\", $\"OAfos_1\", explode($\"authorships\").as(\"authorsflat\"), $\"authorships.author.display_name\".as(\"coAuthorName\"), \n    removeOpenAlexPrefixList($\"authorships.author.id\").as(\"coAuthorId\"))\n\nval OA_Pub_Authors = OAflatdf.select($\"OAtitle\", $\"OApaperId\", $\"OAdoi\", $\"OAfos_0\", $\"OAfos_1\", $\"OAmagId\", $\"authorsflat.author.display_name\".as(\"OAname\"), removeOpenAlexPrefix($\"authorsflat.author.id\").as(\"OAauthorId\"), \n    removeOrcidPrefix($\"authorsflat.author.orcid\").as(\"orcid\"),shortNormName($\"authorsflat.author.display_name\").as(\"OAshortNormName\"), normName( $\"authorsflat.author.display_name\").as(\"OAnormName\"),  \n    removeOpenAlexPrefixList($\"authorsflat.institutions.id\").as(\"affiliationsIds\"), $\"authorsflat.institutions.display_name\".as(\"affiliations\"),  $\"coAuthorId\", $\"coAuthorName\")\n//.persist(StorageLevel.DISK_ONLY)\n//.cache()\n\n//OA_Pub_Authors.printSchema\n//OA_Pub_Authors.show(10)\n\n//println(\"OA_Author_Pub_Cnt:\" + OA_Pub_Authors.count())\nOA_Pub_Authors.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/OA_S2/OA_Pub_Authors.parquet\")\n\n\n",
   "user": "anonymous",
   "dateUpdated": "2023-06-21 12:24:21.947",
   "progress": 99.0,
   "config": {
    "tableHide": false,
    "editorHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=38"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=39"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670146164745_1584457546",
   "id": "paragraph_1670146164745_1584457546",
   "dateCreated": "2022-12-04T11:29:24+0200",
   "dateStarted": "2023-06-21 12:24:21.484",
   "dateFinished": "2023-06-21 12:24:21.947",
   "status": "ERROR",
   "results": {
    "code": "ERROR",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- apc_paid: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- apc_paid_usd: string (nullable = true)\n |-- authorships: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- author: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- orcid: string (nullable = true)\n |    |    |-- author_position: string (nullable = true)\n |    |    |-- institutions: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- is_corresponding: boolean (nullable = true)\n |    |    |-- raw_affiliation_string: string (nullable = true)\n |    |    |-- raw_affiliation_strings: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |-- best_oa_location: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- landing_page_url: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- pdf_url: string (nullable = true)\n |    |-- source: struct (nullable = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- host_organization: string (nullable = true)\n |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- host_organization_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- issn: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- issn_l: string (nullable = true)\n |    |    |-- publisher: string (nullable = true)\n |    |    |-- publisher_id: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- biblio: struct (nullable = true)\n |    |-- first_page: string (nullable = true)\n |    |-- issue: string (nullable = true)\n |    |-- last_page: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- cited_by_api_url: string (nullable = true)\n |-- cited_by_count: long (nullable = true)\n |-- concepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- level: long (nullable = true)\n |    |    |-- score: double (nullable = true)\n |    |    |-- wikidata: string (nullable = true)\n |-- corresponding_author_ids: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- corresponding_institution_ids: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- created_date: string (nullable = true)\n |-- display_name: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- grants: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- award_id: string (nullable = true)\n |    |    |-- funder: string (nullable = true)\n |    |    |-- funder_display_name: string (nullable = true)\n |-- id: string (nullable = true)\n |-- ids: struct (nullable = true)\n |    |-- doi: string (nullable = true)\n |    |-- openalex: string (nullable = true)\n |-- is_paratext: boolean (nullable = true)\n |-- is_retracted: boolean (nullable = true)\n |-- language: string (nullable = true)\n |-- locations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- is_oa: boolean (nullable = true)\n |    |    |-- landing_page_url: string (nullable = true)\n |    |    |-- license: string (nullable = true)\n |    |    |-- pdf_url: string (nullable = true)\n |    |    |-- source: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- host_organization: string (nullable = true)\n |    |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- host_organization_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- issn: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- issn_l: string (nullable = true)\n |    |    |    |-- publisher: string (nullable = true)\n |    |    |    |-- publisher_id: string (nullable = true)\n |    |    |    |-- type: string (nullable = true)\n |    |    |-- version: string (nullable = true)\n |-- mesh: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- open_access: struct (nullable = true)\n |    |-- any_repository_has_fulltext: boolean (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- oa_status: string (nullable = true)\n |    |-- oa_url: string (nullable = true)\n |-- primary_location: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- landing_page_url: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- pdf_url: string (nullable = true)\n |    |-- source: struct (nullable = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- host_organization: string (nullable = true)\n |    |    |-- host_organization_lineage: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- host_organization_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- issn: array (nullable = true)\n |    |    |    |-- element: string (containsNull = true)\n |    |    |-- issn_l: string (nullable = true)\n |    |    |-- publisher: string (nullable = true)\n |    |    |-- publisher_id: string (nullable = true)\n |    |    |-- type: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- publication_date: string (nullable = true)\n |-- publication_year: long (nullable = true)\n |-- referenced_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- related_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- summary_stats: struct (nullable = true)\n |    |-- 2yr_cited_by_count: long (nullable = true)\n |    |-- cited_by_count: long (nullable = true)\n |-- title: string (nullable = true)\n |-- type: string (nullable = true)\n |-- updated_date: string (nullable = true)\n |-- abstract: string (nullable = true)\n\norg.apache.spark.sql.AnalysisException: cannot resolve 'OAmagId' given input columns: [OAdoi, OAfos_0, OAfos_0_full, OAfos_1, OAfos_1_full, OApaperId, OAtitle, authorsflat, authorships, concepts, institutions];\n'Project [OAtitle#7722, OApaperId#7723, OAdoi#7724, 'OAmagId, OAfos_0#7757, OAfos_1#7768, authorsflat#7785, authorships#7660.author.display_name AS coAuthorName#7781, UDF(authorships#7660.author.id) AS coAuthorId#7782]\n+- Generate explode(authorships#7660), false, [authorsflat#7785]\n   +- Project [OAtitle#7722, OApaperId#7723, OAdoi#7724, concepts#7665, authorships#7660, institutions#7725, OAfos_0_full#7738, OAfos_1_full#7747, OAfos_0#7757, OAfos_1_full#7747.display_name AS OAfos_1#7768]\n      +- Project [OAtitle#7722, OApaperId#7723, OAdoi#7724, concepts#7665, authorships#7660, institutions#7725, OAfos_0_full#7738, OAfos_1_full#7747, OAfos_0_full#7738.display_name AS OAfos_0#7757]\n         +- Project [OAtitle#7722, OApaperId#7723, OAdoi#7724, concepts#7665, authorships#7660, institutions#7725, OAfos_0_full#7738, filter(concepts#7665, lambdafunction((lambda concept#7748.level = cast(1 as bigint)), lambda concept#7748, false)) AS OAfos_1_full#7747]\n            +- Project [OAtitle#7722, OApaperId#7723, OAdoi#7724, concepts#7665, authorships#7660, institutions#7725, filter(concepts#7665, lambdafunction((lambda concept#7739.level = cast(0 as bigint)), lambda concept#7739, false)) AS OAfos_0_full#7738]\n               +- Project [title#7686 AS OAtitle#7722, UDF(id#7672) AS OApaperId#7723, lower(UDF(doi#7670)) AS OAdoi#7724, concepts#7665, authorships#7660, authorships#7660.institutions AS institutions#7725]\n                  +- Relation [apc_paid#7658,apc_paid_usd#7659,authorships#7660,best_oa_location#7661,biblio#7662,cited_by_api_url#7663,cited_by_count#7664L,concepts#7665,corresponding_author_ids#7666,corresponding_institution_ids#7667,created_date#7668,display_name#7669,doi#7670,grants#7671,id#7672,ids#7673,is_paratext#7674,is_retracted#7675,language#7676,locations#7677,mesh#7678,open_access#7679,primary_location#7680,publication_date#7681,... 8 more fields] parquet\n\n  at org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:54)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$$nestedInanonfun$checkAnalysis$1$2.applyOrElse(CheckAnalysis.scala:179)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$$nestedInanonfun$checkAnalysis$1$2.applyOrElse(CheckAnalysis.scala:175)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformUpWithPruning$2(TreeNode.scala:535)\n  at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformUpWithPruning(TreeNode.scala:535)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.$anonfun$transformExpressionsUpWithPruning$1(QueryPlan.scala:181)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.$anonfun$mapExpressions$1(QueryPlan.scala:193)\n  at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:193)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.recursiveTransform$1(QueryPlan.scala:204)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.$anonfun$mapExpressions$3(QueryPlan.scala:209)\n  at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:286)\n  at scala.collection.immutable.List.foreach(List.scala:431)\n  at scala.collection.TraversableLike.map(TraversableLike.scala:286)\n  at scala.collection.TraversableLike.map$(TraversableLike.scala:279)\n  at scala.collection.immutable.List.map(List.scala:305)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.recursiveTransform$1(QueryPlan.scala:209)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.$anonfun$mapExpressions$4(QueryPlan.scala:214)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:323)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.mapExpressions(QueryPlan.scala:214)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsUpWithPruning(QueryPlan.scala:181)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsUp(QueryPlan.scala:161)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:175)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1$adapted(CheckAnalysis.scala:94)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:263)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:94)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:91)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:172)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:195)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:330)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:192)\n  at org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:88)\n  at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\n  at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:196)\n  at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n  at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:196)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:88)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:86)\n  at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:78)\n  at org.apache.spark.sql.Dataset$.$anonfun$ofRows$1(Dataset.scala:90)\n  at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n  at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:88)\n  at org.apache.spark.sql.Dataset.withPlan(Dataset.scala:3734)\n  at org.apache.spark.sql.Dataset.select(Dataset.scala:1454)\n  ... 44 elided\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval S2articlesdf = spark.read.parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\n//println(\"S2_df  cnt:\"+S2_df.count())\n//207207224\nS2articlesdf.printSchema()\n\n\n\nval S2subsetdf = S2articlesdf\n             //.join(broadcast(doisdf), lower(S2articlesdf(\"doi\"))===doisdf(\"doi\"), \"inner\")\n             //.filter(($\"magId\" =!= \"\") && ($\"magId\".isNotNull))\n             .select($\"title\".as(\"S2title\"), $\"corpusid\".as(\"S2paperId\"), lower(S2articlesdf(\"externalids.DOI\")).as(\"S2doi\"), S2articlesdf(\"externalids.MAG\").as(\"S2magId\"), array_distinct($\"s2fieldsofstudy.category\").as(\"S2fos\"), $\"authors\")\n             \n//S2subsetdf.show(10)\n\n\n//Create pub - author rows\nval S2flatdf = S2subsetdf.select($\"S2title\", $\"S2paperId\", $\"S2doi\", $\"S2magId\",  $\"S2fos\", explode($\"authors\").as(\"authorsflat\"))\n\nval S2_Pub_Authors = S2flatdf.select($\"S2title\", $\"S2paperId\", $\"S2doi\", $\"S2fos\", $\"S2magId\", $\"authorsflat.name\".as(\"S2name\"), $\"authorsflat.authorId\".as(\"S2authorId\"), shortNormName($\"authorsflat.name\").as(\"S2shortNormName\"), normName( $\"authorsflat.name\").as(\"S2normName\"))\n//.persist(StorageLevel.DISK_ONLY)\n//.cache()\n\n//S2_Pub_Authors.printSchema\n//S2_Pub_Authors.show(5, false)\n\n//println(\"S2_Author_Pub_Cnt:\" + S2_Pub_Authors.count())\nS2_Pub_Authors.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/OA_S2/S2_Pub_Authors.parquet\")",
   "id": "",
   "dateCreated": "2023-03-03 09:33:22.500",
   "config": {},
   "dateStarted": "2023-03-03 09:34:35.783",
   "dateUpdated": "2023-03-03 09:59:52.322",
   "dateFinished": "2023-03-03 09:59:52.322",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- authors: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- authorId: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |-- citationcount: long (nullable = true)\n |-- corpusid: long (nullable = true)\n |-- externalids: struct (nullable = true)\n |    |-- ACL: string (nullable = true)\n |    |-- ArXiv: string (nullable = true)\n |    |-- CorpusId: string (nullable = true)\n |    |-- DBLP: string (nullable = true)\n |    |-- DOI: string (nullable = true)\n |    |-- MAG: string (nullable = true)\n |    |-- PubMed: string (nullable = true)\n |    |-- PubMedCentral: string (nullable = true)\n |-- influentialcitationcount: long (nullable = true)\n |-- isopenaccess: boolean (nullable = true)\n |-- journal: struct (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- pages: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- publicationdate: string (nullable = true)\n |-- publicationtypes: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- publicationvenueid: string (nullable = true)\n |-- referencecount: long (nullable = true)\n |-- s2fieldsofstudy: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- category: string (nullable = true)\n |    |    |-- source: string (nullable = true)\n |-- title: string (nullable = true)\n |-- updated: string (nullable = true)\n |-- url: string (nullable = true)\n |-- venue: string (nullable = true)\n |-- year: long (nullable = true)\n\n\u001b[1m\u001b[34mS2articlesdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<authorId:string,name:string>>, citationcount: bigint ... 15 more fields]\n\u001b[1m\u001b[34mS2subsetdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 4 more fields]\n\u001b[1m\u001b[34mS2flatdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 4 more fields]\n\u001b[1m\u001b[34mS2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 7 more fields]\n"
     }
    ]
   }
  },
  {
   "text": "%spark\nval OA_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/MAG_S2/OA_Pub_Authors.parquet\")\n                       .select( $\"OApaperId\", $\"OAdoi\", $\"OAmagId\".cast(\"string\").as(\"OAmagId\"), $\"OAauthorId\").cache()\n\nval S2_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/MAG_S2/S2_Pub_Authors.parquet\")\n                        .select( $\"S2paperId\", $\"S2doi\", $\"S2magId\", $\"S2authorId\").cache()\n\n\n\n\n//OA_Pub_Authors.show(10)\nprintln(\"OA_Author_Pub:\" + OA_Pub_Authors.count())\n\nval OA_Pub_AuthorsWithdoi = OA_Pub_Authors.filter(($\"OAdoi\" =!= \"\") && ($\"OAdoi\".isNotNull))\nprintln(\"OA_Pub_AuthorsWithdoi  cnt:\"+OA_Pub_AuthorsWithdoi.count())\n\nval OA_Pub_AuthorsWithMAG = OA_Pub_Authors.filter(($\"OAmagId\" =!= \"\") && ($\"OAmagId\".isNotNull))\nprintln(\"OA_Pub_AuthorsWithMAG  cnt:\"+OA_Pub_AuthorsWithMAG.count())\n\n\n\nprintln(\"S2_Author_Pub_Cnt:\" + S2_Pub_Authors.count())\n\nval S2_Pub_AuthorsWithdoi = S2_Pub_Authors.filter(($\"S2doi\" =!= \"\") && ($\"S2doi\".isNotNull))\nprintln(\"S2_Pub_AuthorsWithdoi  cnt:\"+S2_Pub_AuthorsWithdoi.count())\n\nval S2_Pub_AuthorsWithMAG = S2_Pub_Authors.filter(($\"S2magId\" =!= \"\") && ($\"S2magId\".isNotNull))\nprintln(\"S2_Pub_AuthorsWithMAG  cnt:\"+S2_Pub_AuthorsWithMAG.count())\n\n// ------------------------\n\nval OA_Pub_Authors_dois = OA_Pub_Authors.filter(($\"OAdoi\" =!= \"\") && ($\"OAdoi\".isNotNull)).select($\"OAdoi\", $\"OApaperId\").distinct()\nprintln(\"OA_Pub_Authors_dois  cnt:\"+OA_Pub_Authors_dois.count())\n\nval OA_Pub_Authors_magIds = OA_Pub_Authors.filter(($\"OAmagId\" =!= \"\") && ($\"OAmagId\".isNotNull)).select($\"OAmagId\", $\"OApaperId\").distinct()\nprintln(\"OA_Pub_Authors_magIds  cnt:\"+OA_Pub_Authors_magIds.count())\n\nval S2_Pub_Authors_dois = S2_Pub_Authors.select($\"S2doi\").distinct()\nprintln(\"S2_Pub_Authors_dois  cnt:\"+S2_Pub_Authors_dois.count())\n\nval S2_Pub_Authors_magIds = S2_Pub_Authors.select($\"S2magId\").distinct()\nprintln(\"S2_Pub_Authors_magIds  cnt:\"+S2_Pub_Authors_magIds.count())\n\n// ------------------------\n\nval OA_S2_dois = OA_Pub_Authors_dois.join(S2_Pub_Authors_dois, $\"OAdoi\" === $\"S2doi\", \"inner\")\nprintln(\"OA_S2_dois  cnt:\"+OA_S2_dois.count())\n\nval OA_S2_magIds = OA_Pub_Authors_magIds.join(S2_Pub_Authors_magIds, $\"OAmagId\" === $\"S2magId\", \"inner\")\nprintln(\"OA_S2_magIds  cnt:\"+OA_S2_magIds.count())\n\nval OA_S2_dois_OApaperIds = OA_S2_dois.select($\"OApaperId\")\nval OA_S2_magIds_OApaperIds = OA_S2_magIds.select($\"OApaperId\")\n\nprintln(\"OA_S2_paperIds  cnt:\"+OA_S2_dois_OApaperIds.union(OA_S2_magIds_OApaperIds).distinct().count())\n\n/*\n\nOA_Author_Pub:624800084\nOA_Pub_AuthorsWithdoi  cnt:405588770\nOA_Pub_AuthorsWithMAG  cnt:552899763\nS2_Author_Pub_Cnt:584285816\nS2_Pub_AuthorsWithdoi  cnt:382942793\nS2_Pub_AuthorsWithMAG  cnt:498240342\nOA_Pub_Authors_dois  cnt:123468517\nOA_Pub_Authors_magIds  cnt:203847100\nS2_Pub_Authors_dois  cnt:109156136\nS2_Pub_Authors_magIds  cnt:182173629\nOA_S2_dois  cnt:107538031\nOA_S2_magIds  cnt:174893627\nOA_S2_paperIds  cnt:190917883\n*/\n",
   "user": "anonymous",
   "dateUpdated": "2023-03-03 13:08:35.259",
   "progress": 0.0,
   "config": {
    "tableHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670241154785_142646609",
   "id": "paragraph_1670241154785_142646609",
   "dateCreated": "2022-12-05T13:52:34+0200",
   "dateStarted": "2023-03-03 12:43:49.065",
   "dateFinished": "2023-03-03 13:08:35.259",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "OA_Author_Pub:624800084\nOA_Pub_AuthorsWithdoi  cnt:405588770\nOA_Pub_AuthorsWithMAG  cnt:552899763\nS2_Author_Pub_Cnt:584285816\nS2_Pub_AuthorsWithdoi  cnt:382942793\nS2_Pub_AuthorsWithMAG  cnt:498240342\nOA_Pub_Authors_dois  cnt:123468517\nOA_Pub_Authors_magIds  cnt:203847100\nS2_Pub_Authors_dois  cnt:109156136\nS2_Pub_Authors_magIds  cnt:182173629\nOA_S2_dois  cnt:107538031\nOA_S2_magIds  cnt:174893627\nOA_S2_paperIds  cnt:190917883\n\u001b[1m\u001b[34mOA_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 2 more fields]\n\u001b[1m\u001b[34mS2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [S2paperId: bigint, S2doi: string ... 2 more fields]\n\u001b[1m\u001b[34mOA_Pub_AuthorsWithdoi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 2 more fields]\n\u001b[1m\u001b[34mOA_Pub_AuthorsWithMAG\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 2 more fields]\n\u001b[1m\u001b[34mS2_Pub_AuthorsWithdoi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [S2paperId: bigint, S2doi: string ... 2 more fields]\n\u001b[1m\u001b[34mS2_Pub_...\n"
     }
    ]
   }
  },
  {
   "text": "%spark\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n//works.filter(lower(removeDoiPrefix(works(\"doi\")))===\"10.1007/978-3-642-35236-2_48\" \n\nval OA_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/OA_Pub_Authors.parquet\")        \n        .select( $\"OApaperId\", $\"OAdoi\", $\"OAfos_0\", $\"OAfos_1\", $\"OAmagId\", $\"OAname\", $\"OAauthorId\",$\"orcid\",$\"OAshortNormName\",$\"OAnormName\",$\"affiliationsIds\", $\"coAuthorId\"  \n    ,shortNormNameList($\"coAuthorName\").as(\"coAuthorShortNormNames\"))\n         \n//\"affiliations\", \n\n//OA_Pub_Authors.show(10)\n\n\nval S2_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/S2_Pub_Authors.parquet\")\n\n//S2_Pub_Authors.show()\n\n//val listValues = Seq(\"208518325\",\"135545499\",\"111061630\",\"714390\",\"56222208\")\n//OA_S2_Pub_Authors.filter($\"corpusid\".isin(listValues:_*)).show()\n\n///OA_S2_Pub_Authors.filter(lower(removeDoiPrefix(works(\"doi\")))===\"10.1007/978-3-642-35236-2_48\" || lower(removeDoiPrefix(works(\"doi\")))===\"10.1109/55.863111\").show(false)\n\n//OA_Pub_Authors.show(10)\n//println(\"OA_Author_Pub:\" + OA_Pub_Authors.count())\n\n//S2_Pub_Authors.show(10)\n//println(\"S2_Pub_Authors:\" + S2_Pub_Authors.count())\n\n//repartitioning to avoid huge shuffling and speed-up sort-merge join ()\n//val OA_Pub_Authors = OA_Pub_Authors1.repartition(500, OA_Pub_Authors1.col(\"OAmagId\"))\n//val S2_Pub_Authors = S2_Pub_Authors1.repartition(500, S2_Pub_Authors1.col(\"S2magId\"))\n\n\nval OA_S2_Pub_Authors = OA_Pub_Authors\n                   .join(S2_Pub_Authors, $\"OAmagId\" === $\"S2magId\"  \n                           && ( $\"S2shortNormName\"=== $\"OAshortNormName\"   || \n                           (  jaro_winkler($\"OAnormName\", $\"S2normName\") > 0.70 && levenshtein($\"OAnormName\", $\"S2normName\")<4)  || \n                           soundex($\"OAnormName\") === soundex($\"S2normName\") )  \n                       , \"left_outer\")                    \n                   //.dropDuplicates()\n                    \n//OA_S2_Pub_Authors.printSchema()\n\n//println(\"Join_S2_Mag_auth_pubCnt:\"+OA_S2_Pub_Authors.count())\n//OA_S2_Pub_Authors.show()\n\nOA_S2_Pub_Authors.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors.parquet\")\n\n",
   "user": "anonymous",
   "dateUpdated": "2023-03-04 01:53:08.119",
   "progress": 7.0,
   "config": {
    "tableHide": true,
    "title": true
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=0"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=1"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=2"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=3"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=4"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=5"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670313076554_366402541",
   "id": "paragraph_1670313076554_366402541",
   "dateCreated": "2022-12-06T09:51:16+0200",
   "dateStarted": "2023-03-03 15:57:35.811",
   "dateFinished": "2023-03-04 01:53:08.119",
   "status": "FINISHED",
   "title": "Join OA S2 based on MAGID",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "import com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mOA_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 11 more fields]\n\u001b[1m\u001b[34mS2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 7 more fields]\n\u001b[1m\u001b[34mOA_S2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval OA_S2_Pub_Authors_magId =  spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors.parquet\")\n//OA_S2_Pub_Authors_magId.printSchema()\n//println(\"OA_S2_Pub_Authors_magId:\" + OA_S2_Pub_Authors_magId.count())\n\nval OA_S2_Pub_Authors_notMatched = OA_S2_Pub_Authors_magId.filter($\"S2paperId\".isNull && $\"OAdoi\" =!= \"\" && $\"OAdoi\".isNotNull)       \n//println(\"OA_S2_Pub_Authors_notMatched:\" + OA_S2_Pub_Authors_notMatched.count())\n//OA_S2_Pub_Authors.printSchema()\n        \nval OA_S2_Pub_Authors_matched = OA_S2_Pub_Authors_magId.filter( $\"S2paperId\".isNotNull  || $\"OAdoi\" === \"\" || $\"OAdoi\".isNull)\n//println(\"OA_S2_Pub_Authors_matched:\" + OA_S2_Pub_Authors_matched.count())\n\n\n\nval S2_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/S2_Pub_Authors.parquet\")\n//S2_Pub_Authors.printSchema()\n\nval OA_S2_Pub_Authors_doi= OA_S2_Pub_Authors_notMatched\n                   .join(S2_Pub_Authors, $\"OAdoi\" === S2_Pub_Authors(\"S2doi\")  \n                           && ( S2_Pub_Authors(\"S2shortNormName\")=== $\"OAshortNormName\"   || \n                           (  jaro_winkler($\"OAnormName\", S2_Pub_Authors(\"S2normName\")) > 0.70 && levenshtein($\"OAnormName\", S2_Pub_Authors(\"S2normName\"))<4) || soundex($\"OAnormName\") === soundex(S2_Pub_Authors(\"S2normName\"))  ) \n                       , \"left_outer\")              \n                    .select( $\"OApaperId\", $\"OAdoi\", $\"OAfos_0\", $\"OAfos_1\", $\"OAmagId\", $\"OAname\", $\"OAauthorId\",$\"orcid\",$\"OAshortNormName\",$\"OAnormName\",$\"affiliationsIds\", $\"coAuthorId\"  \n                    ,$\"coAuthorShortNormNames\", \n                        S2_Pub_Authors(\"S2title\"),S2_Pub_Authors(\"S2paperId\"),S2_Pub_Authors(\"S2doi\"),S2_Pub_Authors(\"S2fos\"),S2_Pub_Authors(\"S2magId\"),S2_Pub_Authors(\"S2name\"),S2_Pub_Authors(\"S2authorId\"),S2_Pub_Authors(\"S2shortNormName\"),S2_Pub_Authors(\"S2normName\"))\n\n\n\n\nval OA_S2_Pub_Authors_doi_mag = OA_S2_Pub_Authors_doi.union(OA_S2_Pub_Authors_matched)\n        \nOA_S2_Pub_Authors_doi_mag.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag.parquet\")\n        //.orderBy($\"OApaperId\", $\"OAauthorId\", )\n//println(\"OA_S2_Pub_Authors_doi:\" + OA_S2_Pub_Authors_doi.count())\n",
   "id": "",
   "dateCreated": "2022-12-09 09:27:21.249",
   "config": {
    "title": true
   },
   "title": "Join OA S2 based on DOI",
   "dateStarted": "2023-03-04 22:47:32.909",
   "dateUpdated": "2023-03-05 03:46:17.956",
   "dateFinished": "2023-03-05 03:46:17.956",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "import com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_magId\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_notMatched\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_matched\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mS2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 7 more fields]\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_doi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.s...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\nval OA_S2_Pub_Authors_doi_mag  =   spark.read\n        .parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag.parquet\")\n        .select($\"OApaperId\", $\"OAdoi\", $\"OAname\", $\"OAauthorId\", $\"orcid\", $\"OAshortNormName\", $\"OAnormName\", $\"affiliationsIds\", $\"coAuthorShortNormNames\", $\"S2authorId\", $\"S2doi\", $\"S2paperId\", $\"S2normName\")\n//OApaperId#42, OAdoi#43, OAfos_0#44, OAfos_1#45, OAmagId#46L, OAname#47, OAauthorId#48, orcid#49, OAshortNormName#50, OAnormName#51, affiliationsIds#52, coAuthorId#53, coAuthorShortNormNames#54, S2title#55, S2paperId#56L, S2doi#57, S2fos#58, S2magId#59, S2name#60, S2authorId#61, S2shortNormName#62, S2normName#63\n        //.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors.parquet\")\n        \n//println(\"OA_S2_Pub_Authors_doi_mag:\" + OA_S2_Pub_Authors_doi_mag.count())\n//OA_S2_Pub_Authors_doi_mag:640500335\n\n//val OA_S2_Pub_Authors_doi_mag = OA_S2_Pub_Authors_doi_mag_orig.repartition(200, OA_S2_Pub_Authors_doi_mag_orig.col(\"OApaperId\"))\n\n\nval w = Window.partitionBy($\"OApaperId\", $\"OAauthorId\").orderBy(levenshtein($\"OAnormName\", $\"S2normName\") , lit(1) - (soundex($\"OAnormName\") === soundex($\"S2normName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"OAnormName\", $\"S2normName\"))\n\n\nval OA_S2_Pub_Authors_doi_mag_dedup = OA_S2_Pub_Authors_doi_mag.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\n\nOA_S2_Pub_Authors_doi_mag_dedup.write.mode(\"overwrite\")\n        .parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n//.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\") no disk!!!\n\n\n//println(\"OA_S2_Pub_Authors_doi_mag_dedup:\" + OA_S2_Pub_Authors_doi_mag_dedup.count())\n\n",
   "id": "",
   "dateCreated": "2022-12-09 09:48:42.890",
   "config": {
    "title": true
   },
   "title": "Remove duplicates",
   "dateStarted": "2023-03-06 10:24:17.347",
   "dateUpdated": "2023-03-06 12:23:32.323",
   "dateFinished": "2023-03-06 12:23:32.323",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "import org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_doi_mag\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 11 more fields]\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@746ad55d\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_doi_mag_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 11 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval OA_S2_Pub_Authors_doi_mag_dedup =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\nval OA_S2_Pub_Authors =   spark.read\n        //.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n\nprintln(\"OA_S2_Pub_Authors_doi_mag_dedup:\" + OA_S2_Pub_Authors_doi_mag_dedup.count())\n\n\nprintln(\"OA_S2_Pub_Authors_doi_mag_S2_dedup:\" + OA_S2_Pub_Authors_doi_mag_dedup.filter(($\"S2authorId\" =!= \"\") && ($\"S2authorId\".isNotNull)).count())\n\n//OA_S2_Pub_Authors_doi_mag:640500335\n//OA_S2_Pub_Authors_doi_mag_dedup:623593941\n//OA_S2_Pub_Authors_doi_mag_S2_dedup:507200310",
   "id": "",
   "dateCreated": "2022-12-10 09:25:40.260",
   "config": {},
   "dateStarted": "2023-03-06 12:52:35.664",
   "dateUpdated": "2023-03-06 13:16:11.900",
   "dateFinished": "2023-03-06 13:16:11.900",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "OA_S2_Pub_Authors_doi_mag_dedup:623593941\nOA_S2_Pub_Authors_doi_mag_S2_dedup:507200310\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval OAarticlesdf_SIvsReg =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\n                .filter($\"doi\" isin (\"https://doi.org/10.1155/2022/4971844\", \"https://doi.org/10.1155/2022/4979231\", \"https://doi.org/10.1155/2023/6638755\", \"https://doi.org/10.1155/2023/4504474\")).cache()\n\n\nOAarticlesdf_SIvsReg.show(10, false)",
   "id": "",
   "dateCreated": "2023-04-03 13:50:41.756",
   "config": {},
   "dateStarted": "2023-04-03 14:27:28.124",
   "dateUpdated": "2023-04-03 14:45:31.655",
   "dateFinished": "2023-04-03 14:45:31.655",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+-------------------------------------------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+-----------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------------------------+-----------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|alternate_host_venues                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |authorships                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |best_oa_location                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |biblio             |cited_by_api_url                                       |cited_by_count|concepts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |created_date|display_name                                                                                                                                   |doi                                 |host_venue                                                                                                                                                                                                                                                                                                    |id                              |ids                                                                               |is_paratext|is_retracted|locations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |mesh                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |open_access                                                               |primary_location                                                                                                                                                                                                                                                                                                                                      |publication_date|publication_year|referenced_works                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |related_works                                                                                                                                                                                                                                                                                                                                       |title                                                                                                                                          |type           |updated_date|abstract                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------+-------------------------------------------------------+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+-----------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------+----------------------------------------------------------------------------------+-----------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|[{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, false, [2314-6133, 2314-6141], 2314-6133, null, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, null, null}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |[{{Kaibo Guo, https://openalex.org/A2893431902, https://orcid.org/0000-0002-6348-9785}, first, [{CN, Hangzhou First People's Hospital, https://openalex.org/I4210148790, https://ror.org/05pwsw714, healthcare}], null, Department of Oncology, Affiliated Hangzhou First People’s Hospital, Zhejiang University School of Medicine, Hangzhou 310006, China}, {{Yidan Lou, https://openalex.org/A4317256490, null}, middle, [{CN, Hangzhou First People's Hospital, https://openalex.org/I4210148790, https://ror.org/05pwsw714, healthcare}, {CN, Zhejiang University, https://openalex.org/I76130692, https://ror.org/00a2xv884, education}], null, Department of Oncology, Affiliated Hangzhou First People’s Hospital, Zhejiang University School of Medicine, Hangzhou 310006, China; Zhejiang University School of Medicine, Hangzhou 310006, China}, {{Song Zheng, https://openalex.org/A3041443371, https://orcid.org/0000-0003-0859-0968}, last, [{CN, Hangzhou First People's Hospital, https://openalex.org/I4210148790, https://ror.org/05pwsw714, healthcare}, {null, Department of Oncology, Affiliated Hangzhou Cancer Hospital, Zhejiang University School of Medicine, Hangzhou 310006, China, null, null, null}], null, Department of Oncology, Affiliated Hangzhou First People’s Hospital, Zhejiang University School of Medicine, Hangzhou 310006, China; Department of Oncology, Affiliated Hangzhou Cancer Hospital, Zhejiang University School of Medicine, Hangzhou 310006, China}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |{1, null, 12, 2023}|https://api.openalex.org/works?filter=cites:W4317033157|0             |[{Nomogram, https://openalex.org/C34626388, 2, 0.9908369, https://www.wikidata.org/wiki/Q721129}, {Medicine, https://openalex.org/C71924100, 0, 0.82701665, https://www.wikidata.org/wiki/Q11190}, {Proportional hazards model, https://openalex.org/C50382708, 2, 0.5984057, https://www.wikidata.org/wiki/Q223218}, {Oncology, https://openalex.org/C143998085, 1, 0.5839186, https://www.wikidata.org/wiki/Q162555}, {Intrahepatic Cholangiocarcinoma, https://openalex.org/C2909135397, 2, 0.5263285, https://www.wikidata.org/wiki/Q124292}, {Epidemiology, https://openalex.org/C107130276, 2, 0.51848996, https://www.wikidata.org/wiki/Q133805}, {Internal medicine, https://openalex.org/C126322002, 1, 0.5179259, https://www.wikidata.org/wiki/Q11180}, {Metastasis, https://openalex.org/C2779013556, 3, 0.51630586, https://www.wikidata.org/wiki/Q181876}, {Logistic regression, https://openalex.org/C151956035, 2, 0.5151416, https://www.wikidata.org/wiki/Q1132755}, {Surveillance, Epidemiology, and End Results, https://openalex.org/C2779391198, 4, 0.41028157, https://www.wikidata.org/wiki/Q7647035}, {Cancer, https://openalex.org/C121608353, 2, 0.34176633, https://www.wikidata.org/wiki/Q12078}, {Radiology, https://openalex.org/C126838900, 1, 0.32807857, https://www.wikidata.org/wiki/Q77604}, {Cancer registry, https://openalex.org/C2778527826, 3, 0.09019804, https://www.wikidata.org/wiki/Q1787017}]|2023-01-18  |Predictors of Distant Metastasis and Prognosis in Newly Diagnosed T1 Intrahepatic Cholangiocarcinoma                                           |https://doi.org/10.1155/2023/6638755|{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, false, [2314-6133, 2314-6141], 2314-6133, null, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, null, null}                                                                    |https://openalex.org/W4317033157|{null, https://openalex.org/W4317033157, https://pubmed.ncbi.nlm.nih.gov/36704724}|null       |false       |[{null, https://doi.org/10.1155/2023/6638755, null, null, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, null}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |[{Bile Duct Neoplasms, D001650, true, null, }, {Cholangiocarcinoma, D018281, true, null, }, {Bile Duct Neoplasms, D001650, false, pathology, Q000473}, {Bile Ducts, Intrahepatic, D001653, false, null, }, {Bile Ducts, Intrahepatic, D001653, false, pathology, Q000473}, {Cholangiocarcinoma, D018281, false, pathology, Q000473}, {Cholangiocarcinoma, D018281, false, diagnosis, Q000175}, {Humans, D006801, false, null, }, {Lymphatic Metastasis, D008207, false, pathology, Q000473}, {Lymphatic Metastasis, D008207, false, null, }, {Neoplasm Staging, D009367, false, null, }, {Nomograms, D049451, false, null, }, {Prognosis, D011379, false, null, }, {SEER Program, D018426, false, null, }]|{false, null, null}                                                       |{null, https://doi.org/10.1155/2023/6638755, null, null, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, null}                                                                     |2023-01-17      |2023            |[https://openalex.org/W1963271285, https://openalex.org/W1991701933, https://openalex.org/W2011387799, https://openalex.org/W2022470431, https://openalex.org/W2149686378, https://openalex.org/W2751705503, https://openalex.org/W2763492611, https://openalex.org/W2770576134, https://openalex.org/W2796889982, https://openalex.org/W2885645831, https://openalex.org/W2902473941, https://openalex.org/W2919806338, https://openalex.org/W2944354704, https://openalex.org/W2963704639, https://openalex.org/W3000723598, https://openalex.org/W3011488284, https://openalex.org/W3017110217, https://openalex.org/W3029135903, https://openalex.org/W3033473768, https://openalex.org/W3131583082, https://openalex.org/W3172943726, https://openalex.org/W3210595105, https://openalex.org/W4211248913, https://openalex.org/W4225151250]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |[https://openalex.org/W2946383260, https://openalex.org/W2998869388, https://openalex.org/W3157781791, https://openalex.org/W3206871846, https://openalex.org/W3214360919, https://openalex.org/W3216618929, https://openalex.org/W4221092943, https://openalex.org/W4225407755, https://openalex.org/W4239980826, https://openalex.org/W4306783310]|Predictors of Distant Metastasis and Prognosis in Newly Diagnosed T1 Intrahepatic Cholangiocarcinoma                                           |journal-article|2023-02-13  |Background. According to American Joint Committee on Cancer (AJCC) 8th staging system, T1 intrahepatic cholangiocarcinoma (T1 ICC) is considered a tumor with no vascular invasion. However, T1 ICC usually occurs distant metastasis (DM), and the clinical features of these patients could help clinicians identify the high-risk population. Methods. We reviewed 1959 newly diagnosed patients with T1 ICC from the Surveillance, Epidemiology, and End Results (SEER) database during 2004–2018. Logistic regression models and Cox proportional hazards models were conducted to predict the risk of DM and overall survival (OS), respectively, and then, web-based nomograms were constructed. Decision curve analysis (DCA) and clinical impact curves (CIC) were used to measure the clinical utility of the models. The low-, medium-, and high-risk groups were identified by calculating the summary of the risk points. Nomograms on the web were also created to help clinicians better use these prediction models. Results. Tumor size and lymph node metastasis accounted for the first two largest proportions among the DM nomogram scores, while surgery, DM, age at diagnosis, chemotherapy, and lymph node metastasis occupied the largest percentage in OS nomogram. DM nomogram was established for these newly diagnosed patients with T1 ICC, and OS nomogram was developed to visually predict the OS rate of 3, 5, and 10 years. The calibration curves revealed a valid predictive accuracy of nomograms, of which the C-index was 0.703 and 0.740, respectively, for good discrimination. DCAs, CICs, and risk subgroups showed the clinical validity of these nomograms. Two websites were created to make it easier to use these nomograms. Conclusions. Novel web-based nomograms predicting the risk of DM and OS for T1 ICC were constructed. These predictive tools might help clinicians make precise clinical strategies for each patient with T1 ICC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|[{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, true, [2314-6133, 2314-6141], 2314-6133, cc-by, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, https://downloads.hindawi.com/journals/bmri/2022/4971844.pdf, publishedVersion}, {PubMed Central, null, https://openalex.org/S2764455111, true, [], null, null, null, null, repository, https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8933085, publishedVersion}]                                                                                                                                                                                                                       |[{{Vit Kotheeranurak, https://openalex.org/A2885600185, https://orcid.org/0000-0002-9593-429X}, first, [{US, Memorial Hospital, https://openalex.org/I4210165704, https://ror.org/05jhpk184, healthcare}], null, Department of Orthopedics, Queen Savang Vadhana Memorial Hospital, Sriracha, Chonburi, Thailand.}, {{Wongthawat Liawrungrueang, https://openalex.org/A2948226168, https://orcid.org/0000-0002-4491-6569}, middle, [{TH, Chiang Mai University, https://openalex.org/I48076826, https://ror.org/05m2fqn25, education}], null, Spinal Unit, Orthopedic Department, Chiang Mai University, Chiang Mai, Thailand.}, {{Verapan Kuansongtham, https://openalex.org/A2963961972, null}, middle, [{TH, Bumrungrad International Hospital, https://openalex.org/I2799476192, https://ror.org/00ya08494, healthcare}], null, Spine Institute, Bumrungrad International Hospital, Bangkok, Thailand.}, {{Pornpavit Sriphirom, https://openalex.org/A2632352974, null}, middle, [{TH, Rangsit University, https://openalex.org/I89226531, https://ror.org/01cqcrc47, education}], null, Department of Orthopedics, Faculty of Medicine, Rangsit University, Pathum Thani, Thailand.}, {{Narongsak Bamrungthin, https://openalex.org/A2550627575, null}, middle, [{null, Pakchong Nana Hospital, Pak Chong, Nakhon Ratchasima, Thailand., null, null, null}], null, Pakchong Nana Hospital, Pak Chong, Nakhon Ratchasima, Thailand.}, {{Gun Keorochana, https://openalex.org/A1929034893, null}, middle, [{TH, Ramathibodi Hospital, https://openalex.org/I4210140007, https://ror.org/04884sy85, healthcare}], null, Orthopedic Department, Faculty of Medicine Ramathibodi Hospital, Mahidol University, Bangkok, Thailand.}, {{Pritsanai Pruttikul, https://openalex.org/A2197808251, null}, middle, [{TH, Lerdsin Hospital, https://openalex.org/I4210097165, https://ror.org/00q38e504, healthcare}], null, Department of Orthopedics, Lerdsin hospital, Bangkok, Thailand.}, {{Worawat Limthongkul, https://openalex.org/A2602291969, https://orcid.org/0000-0002-0116-8791}, middle, [{TH, Chulalongkorn University, https://openalex.org/I158708052, https://ror.org/028wp3y58, education}], null, Center of Excellence in Biomechanics and Innovative Spine Surgery, Chulalongkorn University, Bangkok, Thailand.}, {{Weerasak Singhatanadgige, https://openalex.org/A2470204231, https://orcid.org/0000-0001-7166-1381}, middle, [{TH, Chulalongkorn University, https://openalex.org/I158708052, https://ror.org/028wp3y58, education}], null, Center of Excellence in Biomechanics and Innovative Spine Surgery, Chulalongkorn University, Bangkok, Thailand.}, {{Suthipas Pongmanee, https://openalex.org/A2913639869, null}, middle, [{TH, Chiang Mai University, https://openalex.org/I48076826, https://ror.org/05m2fqn25, education}], null, Spinal Unit, Orthopedic Department, Chiang Mai University, Chiang Mai, Thailand.}, {{Rattalerk Arunakul, https://openalex.org/A2396110352, https://orcid.org/0000-0003-3473-8436}, middle, [{TH, Thammasat University, https://openalex.org/I108108428, https://ror.org/002yp7f20, education}], null, Department of Orthopaedics, Faculty of Medicine, Thammasat University, Thailand.}, {{Monchai Ruangchainikom, https://openalex.org/A1833692196, https://orcid.org/0000-0003-0525-6390}, middle, [{TH, Siriraj Hospital, https://openalex.org/I1332387789, https://ror.org/0331zs648, healthcare}], null, Department of Orthopaedic Surgery, Faculty of Medicine Siriraj Hospital, Mahidol University, Bangkok, Thailand.}, {{Phanunan Sasiprapha, https://openalex.org/A3083638694, null}, middle, [{TH, Udon Thani Hospital, https://openalex.org/I4210166311, https://ror.org/05jpj2w31, healthcare}], null, Orthopedic department, Udon Thani Hospital, Udon Thani, Thailand.}, {{Roongrath Chitragarn, https://openalex.org/A4221364367, null}, middle, [{null, Department of Orthopaedics, Phramongkutklao Hospital and College of Medicine, Bangkok, Thailand., null, null, null}], null, Department of Orthopaedics, Phramongkutklao Hospital and College of Medicine, Bangkok, Thailand.}, {{Saran Pairuchvej, https://openalex.org/A2586594479, null}, middle, [{US, Memorial Hospital, https://openalex.org/I4210165704, https://ror.org/05jhpk184, healthcare}], null, Department of Orthopedics, Queen Savang Vadhana Memorial Hospital, Sriracha, Chonburi, Thailand.}, {{Teerachat Tanasansomboon, https://openalex.org/A3019742556, https://orcid.org/0000-0002-2448-2118}, middle, [{null, Orthopedic department, Samutsakhon Hospital, Samutsakorn, Thailand., null, null, null}], null, Orthopedic department, Samutsakhon Hospital, Samutsakorn, Thailand.}, {{Khanathip Jitpakdee, https://openalex.org/A3148649839, https://orcid.org/0000-0003-2533-6398}, last, [{US, Memorial Hospital, https://openalex.org/I4210165704, https://ror.org/05jhpk184, healthcare}], null, Department of Orthopedics, Queen Savang Vadhana Memorial Hospital, Sriracha, Chonburi, Thailand.}]|{\"source\":{\"id\":\"https://openalex.org/S1010394304\",\"issn_l\":\"2314-6133\",\"issn\":[\"2314-6133\",\"2314-6141\"],\"display_name\":\"BioMed Research International\",\"publisher\":\"Hindawi Publishing Corporation\",\"host_organization\":\"https://openalex.org/P4310319869\",\"host_organization_name\":\"Hindawi Publishing Corporation\",\"publisher_id\":\"https://openalex.org/P4310319869\",\"type\":\"journal\"},\"pdf_url\":\"https://downloads.hindawi.com/journals/bmri/2022/4971844.pdf\",\"landing_page_url\":\"https://doi.org/10.1155/2022/4971844\",\"is_oa\":true,\"version\":\"publishedVersion\",\"license\":\"cc-by\"}|{1, null, 8, 2022} |https://api.openalex.org/works?filter=cites:W4221061737|0             |[{Medicine, https://openalex.org/C71924100, 0, 0.71242446, https://www.wikidata.org/wiki/Q11190}, {Demographics, https://openalex.org/C2780084366, 2, 0.60656834, https://www.wikidata.org/wiki/Q37732}, {Perspective (graphical), https://openalex.org/C12713177, 2, 0.53014815, https://www.wikidata.org/wiki/Q1900281}, {Orthopedic surgery, https://openalex.org/C68312169, 2, 0.47575542, https://www.wikidata.org/wiki/Q216685}, {General surgery, https://openalex.org/C61434518, 1, 0.39587453, https://www.wikidata.org/wiki/Q932510}, {Surgery, https://openalex.org/C141071460, 1, 0.38630712, https://www.wikidata.org/wiki/Q40821}, {Demography, https://openalex.org/C149923435, 1, 0.08351749, https://www.wikidata.org/wiki/Q37732}, {Artificial intelligence, https://openalex.org/C154945302, 1, 0.0, https://www.wikidata.org/wiki/Q11660}, {Sociology, https://openalex.org/C144024400, 0, 0.0, https://www.wikidata.org/wiki/Q21201}, {Computer science, https://openalex.org/C41008148, 0, 0.0, https://www.wikidata.org/wiki/Q21198}]                                                                                                                                                                                                                                                                                                                                                                                 |2022-04-03  |Surgeons’ Perspective, Learning Curve, Motivation, and Obstacles of Full-Endoscopic Spine Surgery in Thailand: Results From A Nationwide Survey|https://doi.org/10.1155/2022/4971844|{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, true, [2314-6133, 2314-6141], 2314-6133, cc-by, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, https://downloads.hindawi.com/journals/bmri/2022/4971844.pdf, publishedVersion}|https://openalex.org/W4221061737|{null, https://openalex.org/W4221061737, https://pubmed.ncbi.nlm.nih.gov/35309165}|false      |false       |[{true, https://doi.org/10.1155/2022/4971844, cc-by, https://downloads.hindawi.com/journals/bmri/2022/4971844.pdf, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, publishedVersion}, {true, https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8933085, null, null, {PubMed Central, https://openalex.org/I1299303238, https://openalex.org/S2764455111, null, null, null, null, repository}, publishedVersion}]                                                                                                                                                                                                                                                                                                    |[{Learning Curve, D059032, true, null, }, {Surgeons, D066231, true, null, }, {Humans, D006801, false, null, }, {Motivation, D009042, false, null, }, {Surveys and Questionnaires, D011795, false, null, }, {Thailand, D013785, false, null, }]                                                                                                                                                                                                                                                                                                                                                                                                                                                            |{true, gold, https://downloads.hindawi.com/journals/bmri/2022/4971844.pdf}|{true, https://doi.org/10.1155/2022/4971844, cc-by, https://downloads.hindawi.com/journals/bmri/2022/4971844.pdf, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, publishedVersion}|2022-03-11      |2022            |[https://openalex.org/W1987598277, https://openalex.org/W2157577898, https://openalex.org/W2269130999, https://openalex.org/W2570326583, https://openalex.org/W2647872856, https://openalex.org/W2912337384, https://openalex.org/W2951141584, https://openalex.org/W2981720900, https://openalex.org/W2982393075, https://openalex.org/W2990218507, https://openalex.org/W3032441129, https://openalex.org/W3087435864, https://openalex.org/W3179755079, https://openalex.org/W4206335334, https://openalex.org/W4225934342]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |[https://openalex.org/W214433981, https://openalex.org/W1989160339, https://openalex.org/W2002120878, https://openalex.org/W2003938723, https://openalex.org/W2047967234, https://openalex.org/W2118496982, https://openalex.org/W2439875401, https://openalex.org/W2519357708, https://openalex.org/W2525756941, https://openalex.org/W4238867864] |Surgeons’ Perspective, Learning Curve, Motivation, and Obstacles of Full-Endoscopic Spine Surgery in Thailand: Results From A Nationwide Survey|journal-article|2023-02-11  |To report a nationwide survey of the endoscopic spine surgeons across Thailand. Furthermore, the survey will be focused on the perspective of experience, learning curve, motivations, and obstacles at the beginning of their practices.The online survey consisting of 16 items was distributed to spine surgeons who are performing endoscopic spine surgery in Thailand via the Google forms web-based questionnaire to investigate participants' demographics, backgrounds, experience in endoscopic spine surgery, motivations, obstacles, and future perspectives. The data was recorded from January 7, 2020 to January 21, 2022. Descriptive statistics were used for analysis.A total of 42 surveys were submitted by 6 neurosurgeons (14.3%) and 36 orthopedic surgeons (85.7%). From the surgeons' perspective, the average number of cases that should be performed until one feels confident, consistently good outcomes, and has minimal complications was 27.44 ± 32.46 cases. For surgeons who starting the endoscopic spine practice, at least 3 workshop participation is needed. Personal interest (39 selected responses) and trending marketing or business purpose (25 selected responses) were the primary motivators for endoscopic spine surgery implementation. Lack of support (18 selected responses) and afraid of complications (16 selected responses) were pertinent obstacles to endoscopic spine surgery implementation.The trend of endoscopic spine surgery has continued to grow in Thailand, shown by the rate of implementation of endoscopic spine surgery reported by Thai spine surgeons. The number of appropriate cases until one feels confident was around 28 cases. The primary motivator and obstacles were personal interest and lack of support.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n|[{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, true, [2314-6133, 2314-6141], 2314-6133, cc-by, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, https://downloads.hindawi.com/journals/bmri/2022/4979231.pdf, publishedVersion}, {PubMed Central, null, https://openalex.org/S2764455111, true, [], null, null, null, null, repository, https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8957448, publishedVersion}]                                                                                                                                                                                                                       |[{{Bryan Zheng, https://openalex.org/A4207168927, https://orcid.org/0000-0002-7846-8389}, first, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}, {{Elias Shaaya, https://openalex.org/A2901047097, https://orcid.org/0000-0002-2243-7954}, middle, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}, {{Josh Feler, https://openalex.org/A4221428921, null}, middle, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}, {{Owen P. Leary, https://openalex.org/A2742883462, https://orcid.org/0000-0002-6282-828X}, middle, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}, {{Matthew Hagan, https://openalex.org/A2413112637, https://orcid.org/0000-0001-5395-843X}, middle, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}, {{Ankush I. Bajaj, https://openalex.org/A4220590197, https://orcid.org/0000-0003-1767-1698}, middle, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}, {{Jared Fridley, https://openalex.org/A2273701789, https://orcid.org/0000-0002-6336-5950}, middle, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}, {{Frank Hassel, https://openalex.org/A2516863246, null}, middle, [{null, Department of Spine Surgery, Loretto Hospital, Freiburg, Germany, null, null, null}], null, Department of Spine Surgery, Loretto Hospital, Freiburg, Germany}, {{Raymond J Gardocki, https://openalex.org/A980330644, null}, middle, [{US, Vanderbilt University Medical Center, https://openalex.org/I901861585, https://ror.org/05dq2gs74, healthcare}], null, Vanderbilt University Medical Center, Nashville, Tennessee, USA}, {{Ricardo Casal Grau, https://openalex.org/A4221428927, null}, middle, [{null, Casal Dots SLU and Asepeyo Hospital, Madrid, Spain, null, null, null}], null, Casal Dots SLU and Asepeyo Hospital, Madrid, Spain}, {{Kai-Uwe Lewandrowski, https://openalex.org/A2193435487, https://orcid.org/0000-0001-7842-2914}, middle, [{null, Center for Advanced Spine Care of Southern Arizona, Tucson, Arizona, USA, null, null, null}], null, Center for Advanced Spine Care of Southern Arizona, Tucson, Arizona, USA}, {{Albert E. Telfeian, https://openalex.org/A2232442012, https://orcid.org/0000-0002-5069-7112}, last, [{US, Brown University, https://openalex.org/I27804330, https://ror.org/05gq02987, education}], null, Department of Neurosurgery, Warren Alpert Medical School of Brown University, Providence, Rhode Island, USA}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |{\"source\":{\"id\":\"https://openalex.org/S1010394304\",\"issn_l\":\"2314-6133\",\"issn\":[\"2314-6133\",\"2314-6141\"],\"display_name\":\"BioMed Research International\",\"publisher\":\"Hindawi Publishing Corporation\",\"host_organization\":\"https://openalex.org/P4310319869\",\"host_organization_name\":\"Hindawi Publishing Corporation\",\"publisher_id\":\"https://openalex.org/P4310319869\",\"type\":\"journal\"},\"pdf_url\":\"https://downloads.hindawi.com/journals/bmri/2022/4979231.pdf\",\"landing_page_url\":\"https://doi.org/10.1155/2022/4979231\",\"is_oa\":true,\"version\":\"publishedVersion\",\"license\":\"cc-by\"}|{1, null, 9, 2022} |https://api.openalex.org/works?filter=cites:W4221013152|3             |[{Context (archaeology), https://openalex.org/C2779343474, 2, 0.6967957, https://www.wikidata.org/wiki/Q3109175}, {Medicine, https://openalex.org/C71924100, 0, 0.6173558, https://www.wikidata.org/wiki/Q11190}, {Endoscopy, https://openalex.org/C2778451229, 2, 0.5267291, https://www.wikidata.org/wiki/Q212809}, {Minimally invasive procedures, https://openalex.org/C2778643591, 2, 0.5145906, https://www.wikidata.org/wiki/Q1755504}, {Lumbar, https://openalex.org/C44575665, 2, 0.49926233, https://www.wikidata.org/wiki/Q1293405}, {Surgery, https://openalex.org/C141071460, 1, 0.49409774, https://www.wikidata.org/wiki/Q40821}, {SAFER, https://openalex.org/C2776654903, 2, 0.48060676, https://www.wikidata.org/wiki/Q2601463}, {Spinal fusion, https://openalex.org/C2780375110, 2, 0.4526985, https://www.wikidata.org/wiki/Q770609}, {Invasive surgery, https://openalex.org/C3019477240, 2, 0.41341126, https://www.wikidata.org/wiki/Q1755504}, {Computer science, https://openalex.org/C41008148, 0, 0.2288855, https://www.wikidata.org/wiki/Q21198}, {Biology, https://openalex.org/C86803240, 0, 0.05562207, https://www.wikidata.org/wiki/Q420}, {Paleontology, https://openalex.org/C151730666, 1, 0.0, https://www.wikidata.org/wiki/Q7205}, {Computer security, https://openalex.org/C38652104, 1, 0.0, https://www.wikidata.org/wiki/Q3510521}]                                                             |2022-04-03  |Endoscopic Techniques for Lumbar Interbody Fusion: Principles and Context                                                                      |https://doi.org/10.1155/2022/4979231|{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, true, [2314-6133, 2314-6141], 2314-6133, cc-by, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, https://downloads.hindawi.com/journals/bmri/2022/4979231.pdf, publishedVersion}|https://openalex.org/W4221013152|{null, https://openalex.org/W4221013152, https://pubmed.ncbi.nlm.nih.gov/35345525}|false      |false       |[{true, https://doi.org/10.1155/2022/4979231, cc-by, https://downloads.hindawi.com/journals/bmri/2022/4979231.pdf, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, publishedVersion}, {true, https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8957448, null, null, {PubMed Central, https://openalex.org/I1299303238, https://openalex.org/S2764455111, null, null, null, null, repository}, publishedVersion}]                                                                                                                                                                                                                                                                                                    |[{Lumbar Vertebrae, D008159, true, null, }, {Spinal Fusion, D013123, true, null, }, {Endoscopy, D004724, false, null, }, {Endoscopy, D004724, false, methods, Q000379}, {Lumbar Vertebrae, D008159, false, surgery, Q000601}, {Lumbar Vertebrae, D008159, false, diagnostic imaging, Q000000981}, {Lumbosacral Region, D008161, false, null, }, {Minimally Invasive Surgical Procedures, D019060, false, null, }, {Minimally Invasive Surgical Procedures, D019060, false, methods, Q000379}, {Spinal Fusion, D013123, false, methods, Q000379}]                                                                                                                                                          |{true, gold, https://downloads.hindawi.com/journals/bmri/2022/4979231.pdf}|{true, https://doi.org/10.1155/2022/4979231, cc-by, https://downloads.hindawi.com/journals/bmri/2022/4979231.pdf, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, publishedVersion}|2022-03-19      |2022            |[https://openalex.org/W54125082, https://openalex.org/W987354579, https://openalex.org/W1968637937, https://openalex.org/W1992477794, https://openalex.org/W2027969809, https://openalex.org/W2049798798, https://openalex.org/W2068300869, https://openalex.org/W2074958495, https://openalex.org/W2077684507, https://openalex.org/W2092441550, https://openalex.org/W2101542705, https://openalex.org/W2110116133, https://openalex.org/W2165770237, https://openalex.org/W2327897903, https://openalex.org/W2339341570, https://openalex.org/W2520096902, https://openalex.org/W2563623401, https://openalex.org/W2609234811, https://openalex.org/W2739536098, https://openalex.org/W2739760190, https://openalex.org/W2741094524, https://openalex.org/W2796165956, https://openalex.org/W2808973835, https://openalex.org/W2904404140, https://openalex.org/W2930388040, https://openalex.org/W2931949917, https://openalex.org/W2934799541, https://openalex.org/W2937269396, https://openalex.org/W2942953951, https://openalex.org/W2950074933, https://openalex.org/W2965967331, https://openalex.org/W2970268115, https://openalex.org/W2981748888, https://openalex.org/W2999292534, https://openalex.org/W3000606402, https://openalex.org/W3011099685, https://openalex.org/W3012509420, https://openalex.org/W3015579449, https://openalex.org/W3031389885, https://openalex.org/W3034263007, https://openalex.org/W3045544127, https://openalex.org/W3083410595, https://openalex.org/W3111466478, https://openalex.org/W3162617873, https://openalex.org/W3168963794, https://openalex.org/W3175482520, https://openalex.org/W3176166604, https://openalex.org/W3200853295, https://openalex.org/W3201149981, https://openalex.org/W3203209227, https://openalex.org/W4293108040, https://openalex.org/W4293420259]|[https://openalex.org/W126432628, https://openalex.org/W1968868836, https://openalex.org/W1978874741, https://openalex.org/W2002120878, https://openalex.org/W2057497042, https://openalex.org/W2145692272, https://openalex.org/W2301848560, https://openalex.org/W2529455929, https://openalex.org/W2580779735, https://openalex.org/W4280651597] |Endoscopic Techniques for Lumbar Interbody Fusion: Principles and Context                                                                      |journal-article|2023-02-19  |Endoscopic techniques in spine surgery are rapidly evolving, with operations becoming progressively safer and less invasive. Lumbar interbody fusion (LIF) procedures comprise many spine procedures that have benefited from endoscopic assistance and minimally invasive approaches. Though considerable variation exists within endoscopic LIF, similar principles and techniques are common to all types. Nonetheless, innovations continually emerge, requiring trainees and experienced surgeons to maintain familiarity with the domain and its possibilities. We present two illustrative cases of endoscopic transforaminal lumbar interbody fusion with a comprehensive literature review of the different approaches to endoscopic LIF procedures.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n|[{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, true, [2314-6133, 2314-6141], 2314-6133, cc-by, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, https://downloads.hindawi.com/journals/bmri/2023/4504474.pdf, publishedVersion}, {PubMed Central, null, https://openalex.org/S2764455111, true, [], null, null, null, null, repository, https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9881441, publishedVersion}, {Research Square (Research Square), null, https://openalex.org/S4306402450, true, [], null, cc-by, Research Square, null, repository, https://www.researchsquare.com/article/rs-1567849/latest.pdf, submittedVersion}]|[{{Wei Zhang, https://openalex.org/A4317265524, null}, first, [{CN, Third Affiliated Hospital of Guangzhou Medical University, https://openalex.org/I4210092091, https://ror.org/00fb35g87, healthcare}], null, Department of Pathology, Third Affiliated Hospital, Guangzhou Medical University, Guangzhou 510150, China}, {{Liu Li, https://openalex.org/A4317265525, null}, middle, [{CN, Third Affiliated Hospital of Guangzhou Medical University, https://openalex.org/I4210092091, https://ror.org/00fb35g87, healthcare}], null, Department of Gastroenterology, Third Affiliated Hospital, Guangzhou Medical University, Guangzhou 510150, China}, {{Piao-Piao Bian, https://openalex.org/A4317265526, null}, middle, [{CN, Third Affiliated Hospital of Guangzhou Medical University, https://openalex.org/I4210092091, https://ror.org/00fb35g87, healthcare}], null, Department of Pathology, Third Affiliated Hospital, Guangzhou Medical University, Guangzhou 510150, China}, {{Qiu-Ping Luo, https://openalex.org/A4317265527, null}, middle, [{CN, Third Affiliated Hospital of Guangzhou Medical University, https://openalex.org/I4210092091, https://ror.org/00fb35g87, healthcare}], null, Department of Pathology, Third Affiliated Hospital, Guangzhou Medical University, Guangzhou 510150, China}, {{Zhongtang Xiong, https://openalex.org/A2130794762, https://orcid.org/0000-0003-0979-4575}, last, [{CN, Third Affiliated Hospital of Guangzhou Medical University, https://openalex.org/I4210092091, https://ror.org/00fb35g87, healthcare}], null, Department of Pathology, Third Affiliated Hospital, Guangzhou Medical University, Guangzhou 510150, China}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |{\"source\":{\"id\":\"https://openalex.org/S1010394304\",\"issn_l\":\"2314-6133\",\"issn\":[\"2314-6133\",\"2314-6141\"],\"display_name\":\"BioMed Research International\",\"publisher\":\"Hindawi Publishing Corporation\",\"host_organization\":\"https://openalex.org/P4310319869\",\"host_organization_name\":\"Hindawi Publishing Corporation\",\"publisher_id\":\"https://openalex.org/P4310319869\",\"type\":\"journal\"},\"pdf_url\":\"https://downloads.hindawi.com/journals/bmri/2023/4504474.pdf\",\"landing_page_url\":\"https://doi.org/10.1155/2023/4504474\",\"is_oa\":true,\"version\":\"publishedVersion\",\"license\":\"cc-by\"}|{1, null, 21, 2023}|https://api.openalex.org/works?filter=cites:W4317037175|0             |[{Glioma, https://openalex.org/C2778227246, 2, 0.9142717, https://www.wikidata.org/wiki/Q1365309}, {Immunohistochemistry, https://openalex.org/C204232928, 2, 0.5703222, https://www.wikidata.org/wiki/Q899285}, {Oncology, https://openalex.org/C143998085, 1, 0.51808995, https://www.wikidata.org/wiki/Q162555}, {Immune system, https://openalex.org/C8891405, 2, 0.50580025, https://www.wikidata.org/wiki/Q1059}, {Cancer research, https://openalex.org/C502942594, 1, 0.4681599, https://www.wikidata.org/wiki/Q3421914}, {Immunotherapy, https://openalex.org/C2777701055, 3, 0.4506854, https://www.wikidata.org/wiki/Q1427096}, {Medicine, https://openalex.org/C71924100, 0, 0.44601068, https://www.wikidata.org/wiki/Q11190}, {Proportional hazards model, https://openalex.org/C50382708, 2, 0.43297046, https://www.wikidata.org/wiki/Q223218}, {Biology, https://openalex.org/C86803240, 0, 0.40544575, https://www.wikidata.org/wiki/Q420}, {Internal medicine, https://openalex.org/C126322002, 1, 0.3918438, https://www.wikidata.org/wiki/Q11180}, {Cancer, https://openalex.org/C121608353, 2, 0.31551453, https://www.wikidata.org/wiki/Q12078}, {Immunology, https://openalex.org/C203014093, 1, 0.15784028, https://www.wikidata.org/wiki/Q101929}]                                                                                                                                                                 |2023-01-18  |PLEKHA4 Is a Prognostic Biomarker and Correlated with Immune Infiltrates in Glioma                                                             |https://doi.org/10.1155/2023/4504474|{BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, true, [2314-6133, 2314-6141], 2314-6133, cc-by, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal, https://downloads.hindawi.com/journals/bmri/2023/4504474.pdf, publishedVersion}|https://openalex.org/W4317037175|{null, https://openalex.org/W4317037175, https://pubmed.ncbi.nlm.nih.gov/36714030}|false      |false       |[{true, https://doi.org/10.1155/2023/4504474, cc-by, https://downloads.hindawi.com/journals/bmri/2023/4504474.pdf, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, publishedVersion}, {true, https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9881441, null, null, {PubMed Central, https://openalex.org/I1299303238, https://openalex.org/S2764455111, null, null, null, null, repository}, publishedVersion}, {true, https://doi.org/10.21203/rs.3.rs-1567849/v2, cc-by, https://www.researchsquare.com/article/rs-1567849/latest.pdf, {Research Square (Research Square), https://openalex.org/I4210096694, https://openalex.org/S4306402450, null, null, Research Square, null, repository}, submittedVersion}]|[{Brain Neoplasms, D001932, true, null, }, {Glioma, D005910, true, null, }, {Intracellular Signaling Peptides and Proteins, D047908, true, null, }, {Melanoma, D008545, true, null, }, {B-Lymphocytes, D001402, false, null, }, {Brain Neoplasms, D001932, false, genetics, Q000235}, {Glioma, D005910, false, genetics, Q000235}, {Humans, D006801, false, null, }, {Intracellular Signaling Peptides and Proteins, D047908, false, genetics, Q000235}, {Prognosis, D011379, false, null, }, {Tumor Microenvironment, D059016, false, genetics, Q000235}, {Tumor Microenvironment, D059016, false, null, }]                                                                                              |{true, gold, https://downloads.hindawi.com/journals/bmri/2023/4504474.pdf}|{true, https://doi.org/10.1155/2023/4504474, cc-by, https://downloads.hindawi.com/journals/bmri/2023/4504474.pdf, {BioMed Research International, https://openalex.org/P4310319869, https://openalex.org/S1010394304, [2314-6133, 2314-6141], 2314-6133, Hindawi Publishing Corporation, https://openalex.org/P4310319869, journal}, publishedVersion}|2023-01-17      |2023            |[https://openalex.org/W30336109, https://openalex.org/W1495670272, https://openalex.org/W1548352846, https://openalex.org/W1950829641, https://openalex.org/W1966107523, https://openalex.org/W1977918192, https://openalex.org/W2012034410, https://openalex.org/W2027045581, https://openalex.org/W2044005459, https://openalex.org/W2104888509, https://openalex.org/W2106596862, https://openalex.org/W2130410032, https://openalex.org/W2159707944, https://openalex.org/W2263206910, https://openalex.org/W2314057593, https://openalex.org/W2507880739, https://openalex.org/W2595863515, https://openalex.org/W2596407299, https://openalex.org/W2598516816, https://openalex.org/W2604996547, https://openalex.org/W2607129810, https://openalex.org/W2607211817, https://openalex.org/W2613629789, https://openalex.org/W2678747063, https://openalex.org/W2749025438, https://openalex.org/W2750745141, https://openalex.org/W2795989238, https://openalex.org/W2797369293, https://openalex.org/W2945294727, https://openalex.org/W2966066761, https://openalex.org/W2966710588, https://openalex.org/W2966972334, https://openalex.org/W3015818456, https://openalex.org/W3026091230, https://openalex.org/W3048680533, https://openalex.org/W3086312535, https://openalex.org/W3096715224, https://openalex.org/W3124522131, https://openalex.org/W3127761268, https://openalex.org/W3154037490, https://openalex.org/W3174246647, https://openalex.org/W3196326021, https://openalex.org/W3203918618, https://openalex.org/W4206500940, https://openalex.org/W4221008030, https://openalex.org/W4243534230]                                                                                                                                                                                                           |[https://openalex.org/W1564894628, https://openalex.org/W2763883091, https://openalex.org/W3180780036, https://openalex.org/W4210825082, https://openalex.org/W4210855089, https://openalex.org/W4231359143, https://openalex.org/W4240016344, https://openalex.org/W4285804056, https://openalex.org/W4291367166, https://openalex.org/W4313340201]|PLEKHA4 Is a Prognostic Biomarker and Correlated with Immune Infiltrates in Glioma                                                             |journal-article|2023-02-16  |Objective. Gliomas are the most common and life-threatening intracranial tumors. Immune infiltration of the tumor microenvironment significantly affects tumor prognosis in glioma. Recently, PLEKHA4 was reported to be upregulated in melanoma and closely associated with tumor genesis and development, but its role in glioma is poorly understood. Our aim was to investigate the expression, functional role, and prognostic value of PLEKHA4 in glioma. Methods. The expression levels of PLEKHA4 in 33 types of cancer in the TCGA (The Cancer Genome Atlas) database were collected via the UCSC Xena browser. The clinical samples of glioma patients were downloaded from the TCGA database. Immunohistochemistry was used to verify PLEKHA4 expression in tumor tissues. We assessed the influence of PLEKHA4 on survival of glioma patients by survival module and GEPIA. Then, we downloaded datasets of glioma from TCGA and investigated the correlations between the clinical characteristics and PLEKHA4 expression using logistic regression. Moreover, we used TIMER to explore the collection of PLEKHA4 expression and immune infiltration level in glioma and to analyze cumulative survival in glioma. Gene Set Enrichment Analysis (GSEA) was performed using the TCGA dataset. Results. PLEKHA4 transcript levels were significantly upregulated in multiple cancer types, including gliomas. Moreover, immunohistochemical analysis verified that PLEKHA4 was overexpressed in gliomas compare to the corresponding normal tissues. Univariable survival and multivariate cox analysis show that increased PLEKHA4 expression significantly correlated with age, tumor grade, IDH mutation status, and 1p/19q codel status, and higher PLEKHA4 had shorter OS, DSS, and PFI. Specifically, PLEKHA4 expression level had significant positive correlations with infiltrating levels of B cell, CD4+ T cells, CD8+ T cells, macrophages, neutrophils, and DCs in glioma, and upregulation of PLEKHA4 expression was significantly related to immune cell biomarkers and immune checkpoint expression in glioma. In addition, several GO and Kyoto Encyclopedia of Genes and Genomes (KEGG) items associated with immune response, JAK STAT signal pathway, and cell cycle were significantly enriched in the high PLEKHA4 expression phenotype pathway. Conclusions. Our findings proposed that PLEKHA4 was an independent prognostic biomarker and correlated with immune infiltrates in glioma, and targeting PLEKHA4 might improve immunotherapy in glioma. Of course, these findings also need basic experiments and further clinical trials to confirm in the future.|"
     },
     {
      "type": "HTML",
      "data": "<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 102400 bytes. Learn more about <strong>ZEPPELIN_INTERPRETER_OUTPUT_LIMIT</strong></div>"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "ABORT",
   "text": "%spark\nOAarticlesdf_SIvsReg.show(5, false)",
   "id": "",
   "dateCreated": "2023-04-03 14:26:52.795",
   "config": {},
   "dateStarted": "2023-04-03 14:27:06.005",
   "dateUpdated": "2023-04-03 14:27:13.101",
   "results": {
    "code": "ERROR",
    "msg": [
     {
      "type": "TEXT",
      "data": "org.apache.spark.SparkException: Job 6129 cancelled part of cancelled job group zeppelin|anonymous|2HP7G3YDX|paragraph_1680521226085_2083985760\n  at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2403)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:2299)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleJobGroupCancelled$4(DAGScheduler.scala:1078)\n  at scala.runtime.java8.JFunction1$mcVI$sp.apply(JFunction1$mcVI$sp.java:23)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:79)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:1077)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:2553)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2533)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2522)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:898)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2214)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2235)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2254)\n  at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:476)\n  at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:429)\n  at org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:48)\n  at org.apache.spark.sql.Dataset.collectFromPlan(Dataset.scala:3715)\n  at org.apache.spark.sql.Dataset.$anonfun$head$1(Dataset.scala:2728)\n  at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3706)\n  at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\n  at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\n  at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\n  at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\n  at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3704)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2728)\n  at org.apache.spark.sql.Dataset.take(Dataset.scala:2935)\n  at org.apache.spark.sql.Dataset.getRows(Dataset.scala:287)\n  at org.apache.spark.sql.Dataset.showString(Dataset.scala:326)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:808)\n  ... 140 elided\n"
     }
    ]
   },
   "dateFinished": "2023-04-03 14:27:13.101"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%spark\n/*\nSI\n\nhttps://doi.org/10.1155/2022/4971844\n\nhttps://doi.org/10.1155/2022/4979231\n\nhttps://doi.org/10.1155/2022/8345736\n\nhttps://doi.org/10.1155/2022/8419739\n\n \n\nRegular issue\n\nhttps://doi.org/10.1155/2023/6638755\n\nhttps://doi.org/10.1155/2023/4504474\n\nhttps://doi.org/10.1155/2023/7126881\n\nhttps://doi.org/10.1155/2023/4371611\n */",
   "id": "",
   "dateCreated": "2023-04-03 13:53:57.271",
   "config": {}
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval  OA_S2_Pub_Authors =   spark.read\n        .parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n//.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n\n        .withColumn(\"affiliationId\", element_at($\"affiliationsIds\", 1))\n\n//OA_S2_Pub_Authors.printSchema()\n//println(\"OA_S2_Pub_Authors ACS:\" +  OA_S2_Pub_Authors.filter($\"affiliationId\"===\"I190567190\").select($\"OAdoi\").distinct().count())\n\n\nval OAarticlesdf =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\n                .select($\"id\", $\"doi\", $\"primary_location.source.publisher\",$\"primary_location.source.publisher_id\", $\"publication_year\", $\"cited_by_count\", $\"concepts\")\n            .withColumn(\"OAfos_0_1_full\", expr(\"filter(concepts, concept -> concept.level == 0 || concept.level == 1)\"))\n             //.withColumn(\"OAfos_1_full\", expr(\"filter(concepts, concept -> concept.level == 1)\"))\n             .withColumn(\"OAfos_0_1\", $\"OAfos_0_1_full.display_name\")\n             //.withColumn(\"OAfos_1\", $\"OAfos_1_full.display_name\")\n        .filter($\"primary_location.source.publisher_id\"===\"https://openalex.org/P4310320006\")\nOAarticlesdf.printSchema()\nOAarticlesdf.show(10, false)\n\n\nval OAarticlesdf_fos = OAarticlesdf.select($\"id\", explode($\"OAfos_0_1\").as(\"fos\"))\n\nOAarticlesdf_fos.groupBy($\"fos\")\n                  .agg(\n                                    \n                        count(\"id\").as(\"PubCnt\")\n                  ).orderBy($\"pubCnt\" desc).show(20)\n/*\n\nprintln(\"OAarticlesdf ACS:\" +  OAarticlesdf.count())\nOAarticlesdf.groupBy($\"publisher_id\")\n                  .agg(\n                      sum($\"cited_by_count\"),\n                      min($\"publication_year\"),\n                      max($\"publication_year\"),                 \n                        count(\"id\").as(\"PubCnt\")\n                  ).show()\n\nOAarticlesdf.filter($\"publication_year\"===1800).show(10)\n\n*/\n//1861421\n\n//{null, null, 1388579, conf/amt/MaLTL12, 10.1007/978-3-642-35236-2_48, null, null, null}\n\n//println(\"cnt:\"+works.count())\n\n//removeOpenAlexPrefix\n//removeOrcidPrefix\n//removeDoiPrefix\n/*\nval OAsubsetdf = OAarticlesdf             \n             .select($\"title\".as(\"OAtitle\"), removeOpenAlexPrefix($\"id\").as(\"OApaperId\"), lower(removeDoiPrefix(OAarticlesdf(\"doi\"))).as(\"OAdoi\"), OAarticlesdf(\"ids.mag\").as(\"OAmagId\"),$\"concepts\", $\"authorships\", $\"authorships.institutions\")      \n             .withColumn(\"OAfos_0_full\", expr(\"filter(concepts, concept -> concept.level == 0)\"))\n             .withColumn(\"OAfos_1_full\", expr(\"filter(concepts, concept -> concept.level == 1)\"))\n             .withColumn(\"OAfos_0\", $\"OAfos_0_full.display_name\")\n             .withColumn(\"OAfos_1\", $\"OAfos_1_full.display_name\")\n*/\n",
   "id": "",
   "dateCreated": "2023-03-28 14:09:20.021",
   "config": {},
   "dateStarted": "2023-03-29 11:01:32.994",
   "dateUpdated": "2023-03-29 11:07:41.367",
   "dateFinished": "2023-03-29 11:07:41.367",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mone feature warning; for details, enable `:setting -feature' or `:replay -feature'\nroot\n |-- id: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- publisher: string (nullable = true)\n |-- publisher_id: string (nullable = true)\n |-- publication_year: long (nullable = true)\n |-- cited_by_count: long (nullable = true)\n |-- concepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- level: long (nullable = true)\n |    |    |-- score: double (nullable = true)\n |    |    |-- wikidata: string (nullable = true)\n |-- OAfos_0_1_full: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- level: long (nullable = true)\n |    |    |-- score: double (nullable = true)\n |    |    |-- wikidata: string (nullable = true)\n |-- OAfos_0_1: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\n+--------------------------------+---------------------------------------+-------------------------+--------------------------------+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|id                              |doi                                    |publisher                |publisher_id                    |publication_year|cited_by_count|concepts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |OAfos_0_1_full                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |OAfos_0_1                                                                                                                                                                                                                                                                                                                                                                  |\n+--------------------------------+---------------------------------------+-------------------------+--------------------------------+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|https://openalex.org/W2056094227|https://doi.org/10.1021/bi8008906      |American Chemical Society|https://openalex.org/P4310320006|2008            |61            |[{Oxidative folding, https://openalex.org/C2775971385, 4, 0.887529, https://www.wikidata.org/wiki/Q7115637}, {Glutathione, https://openalex.org/C538909803, 3, 0.764776, https://www.wikidata.org/wiki/Q116907}, {Folding (DSP implementation), https://openalex.org/C2776545253, 2, 0.73862135, https://www.wikidata.org/wiki/Q5464292}, {Chemistry, https://openalex.org/C185592680, 0, 0.73296404, https://www.wikidata.org/wiki/Q2329}, {Protein folding, https://openalex.org/C204328495, 2, 0.68439543, https://www.wikidata.org/wiki/Q847556}, {Oxidative phosphorylation, https://openalex.org/C57600042, 2, 0.6009481, https://www.wikidata.org/wiki/Q227564}, {Thiol, https://openalex.org/C2781324293, 2, 0.5832119, https://www.wikidata.org/wiki/Q220410}, {Redox, https://openalex.org/C55904794, 2, 0.534887, https://www.wikidata.org/wiki/Q82682}, {Catalysis, https://openalex.org/C161790260, 2, 0.5345843, https://www.wikidata.org/wiki/Q82264}, {Yield (engineering), https://openalex.org/C134121241, 2, 0.51012856, https://www.wikidata.org/wiki/Q899301}, {Biophysics, https://openalex.org/C12554922, 1, 0.43016955, https://www.wikidata.org/wiki/Q7100}, {Disulfide bond, https://openalex.org/C27256138, 2, 0.419605, https://www.wikidata.org/wiki/Q1230226}, {Biochemistry, https://openalex.org/C55493867, 1, 0.3920779, https://www.wikidata.org/wiki/Q7094}, {Combinatorial chemistry, https://openalex.org/C21951064, 1, 0.3609311, https://www.wikidata.org/wiki/Q899212}, {Protein disulfide-isomerase, https://openalex.org/C5098756, 3, 0.24580866, https://www.wikidata.org/wiki/Q1641611}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.15041581, https://www.wikidata.org/wiki/Q11351}, {Enzyme, https://openalex.org/C181199279, 2, 0.097352, https://www.wikidata.org/wiki/Q8047}, {Materials science, https://openalex.org/C192562407, 0, 0.075377196, https://www.wikidata.org/wiki/Q228736}, {Biology, https://openalex.org/C86803240, 0, 0.06219706, https://www.wikidata.org/wiki/Q420}, {Electrical engineering, https://openalex.org/C119599485, 1, 0.0, https://www.wikidata.org/wiki/Q43035}, {Metallurgy, https://openalex.org/C191897082, 1, 0.0, https://www.wikidata.org/wiki/Q11467}, {Engineering, https://openalex.org/C127413603, 0, 0.0, https://www.wikidata.org/wiki/Q11023}]|[{Oxidative folding, https://openalex.org/C2775971385, 4, 0.887529, https://www.wikidata.org/wiki/Q7115637}, {Glutathione, https://openalex.org/C538909803, 3, 0.764776, https://www.wikidata.org/wiki/Q116907}, {Folding (DSP implementation), https://openalex.org/C2776545253, 2, 0.73862135, https://www.wikidata.org/wiki/Q5464292}, {Chemistry, https://openalex.org/C185592680, 0, 0.73296404, https://www.wikidata.org/wiki/Q2329}, {Protein folding, https://openalex.org/C204328495, 2, 0.68439543, https://www.wikidata.org/wiki/Q847556}, {Oxidative phosphorylation, https://openalex.org/C57600042, 2, 0.6009481, https://www.wikidata.org/wiki/Q227564}, {Thiol, https://openalex.org/C2781324293, 2, 0.5832119, https://www.wikidata.org/wiki/Q220410}, {Redox, https://openalex.org/C55904794, 2, 0.534887, https://www.wikidata.org/wiki/Q82682}, {Catalysis, https://openalex.org/C161790260, 2, 0.5345843, https://www.wikidata.org/wiki/Q82264}, {Yield (engineering), https://openalex.org/C134121241, 2, 0.51012856, https://www.wikidata.org/wiki/Q899301}, {Biophysics, https://openalex.org/C12554922, 1, 0.43016955, https://www.wikidata.org/wiki/Q7100}, {Disulfide bond, https://openalex.org/C27256138, 2, 0.419605, https://www.wikidata.org/wiki/Q1230226}, {Biochemistry, https://openalex.org/C55493867, 1, 0.3920779, https://www.wikidata.org/wiki/Q7094}, {Combinatorial chemistry, https://openalex.org/C21951064, 1, 0.3609311, https://www.wikidata.org/wiki/Q899212}, {Protein disulfide-isomerase, https://openalex.org/C5098756, 3, 0.24580866, https://www.wikidata.org/wiki/Q1641611}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.15041581, https://www.wikidata.org/wiki/Q11351}, {Enzyme, https://openalex.org/C181199279, 2, 0.097352, https://www.wikidata.org/wiki/Q8047}, {Materials science, https://openalex.org/C192562407, 0, 0.075377196, https://www.wikidata.org/wiki/Q228736}, {Biology, https://openalex.org/C86803240, 0, 0.06219706, https://www.wikidata.org/wiki/Q420}, {Electrical engineering, https://openalex.org/C119599485, 1, 0.0, https://www.wikidata.org/wiki/Q43035}, {Metallurgy, https://openalex.org/C191897082, 1, 0.0, https://www.wikidata.org/wiki/Q11467}, {Engineering, https://openalex.org/C127413603, 0, 0.0, https://www.wikidata.org/wiki/Q11023}]|[Oxidative folding, Glutathione, Folding (DSP implementation), Chemistry, Protein folding, Oxidative phosphorylation, Thiol, Redox, Catalysis, Yield (engineering), Biophysics, Disulfide bond, Biochemistry, Combinatorial chemistry, Protein disulfide-isomerase, Organic chemistry, Enzyme, Materials science, Biology, Electrical engineering, Metallurgy, Engineering]|\n|https://openalex.org/W2331073049|https://doi.org/10.1021/jo401597u      |American Chemical Society|https://openalex.org/P4310320006|2013            |22            |[{Chemistry, https://openalex.org/C185592680, 0, 0.9678198, https://www.wikidata.org/wiki/Q2329}, {Dye-sensitized solar cell, https://openalex.org/C48421929, 4, 0.70673704, https://www.wikidata.org/wiki/Q81121}, {Metal, https://openalex.org/C544153396, 2, 0.6395769, https://www.wikidata.org/wiki/Q11426}, {Photochemistry, https://openalex.org/C75473681, 1, 0.6176435, https://www.wikidata.org/wiki/Q188651}, {Substitution (logic), https://openalex.org/C2778220771, 2, 0.5373624, https://www.wikidata.org/wiki/Q1522579}, {Substitution reaction, https://openalex.org/C111185830, 2, 0.43087217, https://www.wikidata.org/wiki/Q503396}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.2867952, https://www.wikidata.org/wiki/Q11351}, {Electrode, https://openalex.org/C17525397, 2, 0.17046508, https://www.wikidata.org/wiki/Q176140}, {Physical chemistry, https://openalex.org/C147789679, 1, 0.13958207, https://www.wikidata.org/wiki/Q11372}, {Computer science, https://openalex.org/C41008148, 0, 0.0, https://www.wikidata.org/wiki/Q21198}, {Electrolyte, https://openalex.org/C68801617, 3, 0.0, https://www.wikidata.org/wiki/Q162908}, {Programming language, https://openalex.org/C199360897, 1, 0.0, https://www.wikidata.org/wiki/Q9143}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[{Chemistry, https://openalex.org/C185592680, 0, 0.9678198, https://www.wikidata.org/wiki/Q2329}, {Dye-sensitized solar cell, https://openalex.org/C48421929, 4, 0.70673704, https://www.wikidata.org/wiki/Q81121}, {Metal, https://openalex.org/C544153396, 2, 0.6395769, https://www.wikidata.org/wiki/Q11426}, {Photochemistry, https://openalex.org/C75473681, 1, 0.6176435, https://www.wikidata.org/wiki/Q188651}, {Substitution (logic), https://openalex.org/C2778220771, 2, 0.5373624, https://www.wikidata.org/wiki/Q1522579}, {Substitution reaction, https://openalex.org/C111185830, 2, 0.43087217, https://www.wikidata.org/wiki/Q503396}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.2867952, https://www.wikidata.org/wiki/Q11351}, {Electrode, https://openalex.org/C17525397, 2, 0.17046508, https://www.wikidata.org/wiki/Q176140}, {Physical chemistry, https://openalex.org/C147789679, 1, 0.13958207, https://www.wikidata.org/wiki/Q11372}, {Computer science, https://openalex.org/C41008148, 0, 0.0, https://www.wikidata.org/wiki/Q21198}, {Electrolyte, https://openalex.org/C68801617, 3, 0.0, https://www.wikidata.org/wiki/Q162908}, {Programming language, https://openalex.org/C199360897, 1, 0.0, https://www.wikidata.org/wiki/Q9143}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[Chemistry, Dye-sensitized solar cell, Metal, Photochemistry, Substitution (logic), Substitution reaction, Organic chemistry, Electrode, Physical chemistry, Computer science, Electrolyte, Programming language]                                                                                                                                                          |\n|https://openalex.org/W2076955220|https://doi.org/10.1021/cm060305y      |American Chemical Society|https://openalex.org/P4310320006|2006            |18            |[{Alkoxy group, https://openalex.org/C90150868, 3, 0.8820405, https://www.wikidata.org/wiki/Q39513}, {Membrane, https://openalex.org/C41625074, 2, 0.7683393, https://www.wikidata.org/wiki/Q176088}, {Tris, https://openalex.org/C2781014771, 2, 0.7100339, https://www.wikidata.org/wiki/Q413961}, {Ion, https://openalex.org/C145148216, 2, 0.61545175, https://www.wikidata.org/wiki/Q36496}, {Chemistry, https://openalex.org/C185592680, 0, 0.50798494, https://www.wikidata.org/wiki/Q2329}, {Polymer chemistry, https://openalex.org/C188027245, 1, 0.48643732, https://www.wikidata.org/wiki/Q750446}, {Materials science, https://openalex.org/C192562407, 0, 0.34324005, https://www.wikidata.org/wiki/Q228736}, {Chemical engineering, https://openalex.org/C42360764, 1, 0.3320485, https://www.wikidata.org/wiki/Q83588}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.29097164, https://www.wikidata.org/wiki/Q11351}, {Biochemistry, https://openalex.org/C55493867, 1, 0.07338849, https://www.wikidata.org/wiki/Q7094}, {Alkyl, https://openalex.org/C2780263894, 2, 0.057422638, https://www.wikidata.org/wiki/Q335268}, {Engineering, https://openalex.org/C127413603, 0, 0.0, https://www.wikidata.org/wiki/Q11023}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |[{Alkoxy group, https://openalex.org/C90150868, 3, 0.8820405, https://www.wikidata.org/wiki/Q39513}, {Membrane, https://openalex.org/C41625074, 2, 0.7683393, https://www.wikidata.org/wiki/Q176088}, {Tris, https://openalex.org/C2781014771, 2, 0.7100339, https://www.wikidata.org/wiki/Q413961}, {Ion, https://openalex.org/C145148216, 2, 0.61545175, https://www.wikidata.org/wiki/Q36496}, {Chemistry, https://openalex.org/C185592680, 0, 0.50798494, https://www.wikidata.org/wiki/Q2329}, {Polymer chemistry, https://openalex.org/C188027245, 1, 0.48643732, https://www.wikidata.org/wiki/Q750446}, {Materials science, https://openalex.org/C192562407, 0, 0.34324005, https://www.wikidata.org/wiki/Q228736}, {Chemical engineering, https://openalex.org/C42360764, 1, 0.3320485, https://www.wikidata.org/wiki/Q83588}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.29097164, https://www.wikidata.org/wiki/Q11351}, {Biochemistry, https://openalex.org/C55493867, 1, 0.07338849, https://www.wikidata.org/wiki/Q7094}, {Alkyl, https://openalex.org/C2780263894, 2, 0.057422638, https://www.wikidata.org/wiki/Q335268}, {Engineering, https://openalex.org/C127413603, 0, 0.0, https://www.wikidata.org/wiki/Q11023}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |[Alkoxy group, Membrane, Tris, Ion, Chemistry, Polymer chemistry, Materials science, Chemical engineering, Organic chemistry, Biochemistry, Alkyl, Engineering]                                                                                                                                                                                                            |\n|https://openalex.org/W2787979962|https://doi.org/10.1021/acs.est.8b00590|American Chemical Society|https://openalex.org/P4310320006|2018            |3             |[{Selection (genetic algorithm), https://openalex.org/C81917197, 2, 0.5937284, https://www.wikidata.org/wiki/Q628760}, {Virus, https://openalex.org/C2522874641, 2, 0.5161418, https://www.wikidata.org/wiki/Q808}, {RNA, https://openalex.org/C67705224, 3, 0.45472398, https://www.wikidata.org/wiki/Q11053}, {Virology, https://openalex.org/C159047783, 1, 0.4331718, https://www.wikidata.org/wiki/Q7215}, {Virus inactivation, https://openalex.org/C3018445481, 3, 0.42621547, https://www.wikidata.org/wiki/Q7935312}, {Environmental science, https://openalex.org/C39432304, 0, 0.38049906, https://www.wikidata.org/wiki/Q188847}, {Biology, https://openalex.org/C86803240, 0, 0.37879837, https://www.wikidata.org/wiki/Q420}, {Computational biology, https://openalex.org/C70721500, 1, 0.3393988, https://www.wikidata.org/wiki/Q177005}, {Computer science, https://openalex.org/C41008148, 0, 0.2719832, https://www.wikidata.org/wiki/Q21198}, {Genetics, https://openalex.org/C54355233, 1, 0.2504322, https://www.wikidata.org/wiki/Q7162}, {Artificial intelligence, https://openalex.org/C154945302, 1, 0.14279622, https://www.wikidata.org/wiki/Q11660}, {Gene, https://openalex.org/C104317684, 2, 0.104695976, https://www.wikidata.org/wiki/Q7187}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |[{Selection (genetic algorithm), https://openalex.org/C81917197, 2, 0.5937284, https://www.wikidata.org/wiki/Q628760}, {Virus, https://openalex.org/C2522874641, 2, 0.5161418, https://www.wikidata.org/wiki/Q808}, {RNA, https://openalex.org/C67705224, 3, 0.45472398, https://www.wikidata.org/wiki/Q11053}, {Virology, https://openalex.org/C159047783, 1, 0.4331718, https://www.wikidata.org/wiki/Q7215}, {Virus inactivation, https://openalex.org/C3018445481, 3, 0.42621547, https://www.wikidata.org/wiki/Q7935312}, {Environmental science, https://openalex.org/C39432304, 0, 0.38049906, https://www.wikidata.org/wiki/Q188847}, {Biology, https://openalex.org/C86803240, 0, 0.37879837, https://www.wikidata.org/wiki/Q420}, {Computational biology, https://openalex.org/C70721500, 1, 0.3393988, https://www.wikidata.org/wiki/Q177005}, {Computer science, https://openalex.org/C41008148, 0, 0.2719832, https://www.wikidata.org/wiki/Q21198}, {Genetics, https://openalex.org/C54355233, 1, 0.2504322, https://www.wikidata.org/wiki/Q7162}, {Artificial intelligence, https://openalex.org/C154945302, 1, 0.14279622, https://www.wikidata.org/wiki/Q11660}, {Gene, https://openalex.org/C104317684, 2, 0.104695976, https://www.wikidata.org/wiki/Q7187}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |[Selection (genetic algorithm), Virus, RNA, Virology, Virus inactivation, Environmental science, Biology, Computational biology, Computer science, Genetics, Artificial intelligence, Gene]                                                                                                                                                                                |\n|https://openalex.org/W2041703980|https://doi.org/10.1021/ja803795k      |American Chemical Society|https://openalex.org/P4310320006|2008            |38            |[{Chemistry, https://openalex.org/C185592680, 0, 0.9832449, https://www.wikidata.org/wiki/Q2329}, {Thioester, https://openalex.org/C2778834346, 3, 0.8612993, https://www.wikidata.org/wiki/Q422794}, {Moiety, https://openalex.org/C2776568683, 2, 0.84113634, https://www.wikidata.org/wiki/Q23005640}, {Catalysis, https://openalex.org/C161790260, 2, 0.5933226, https://www.wikidata.org/wiki/Q82264}, {Stereochemistry, https://openalex.org/C71240020, 1, 0.58295554, https://www.wikidata.org/wiki/Q186011}, {Reductive elimination, https://openalex.org/C2778815869, 3, 0.55583173, https://www.wikidata.org/wiki/Q25325213}, {Catalytic cycle, https://openalex.org/C63338738, 3, 0.5022714, https://www.wikidata.org/wiki/Q287862}, {Carbonylation, https://openalex.org/C168382676, 4, 0.48513636, https://www.wikidata.org/wiki/Q900377}, {Nuclear magnetic resonance spectroscopy, https://openalex.org/C66974803, 2, 0.43892258, https://www.wikidata.org/wiki/Q10359898}, {ATP synthase, https://openalex.org/C112243037, 3, 0.42930484, https://www.wikidata.org/wiki/Q22327117}, {Coenzyme A, https://openalex.org/C2779123261, 4, 0.4205989, https://www.wikidata.org/wiki/Q407635}, {Reaction intermediate, https://openalex.org/C105768512, 3, 0.4202594, https://www.wikidata.org/wiki/Q7458208}, {Enzyme, https://openalex.org/C181199279, 2, 0.19665575, https://www.wikidata.org/wiki/Q8047}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.1810588, https://www.wikidata.org/wiki/Q11351}, {Carbon monoxide, https://openalex.org/C512735826, 3, 0.14050582, https://www.wikidata.org/wiki/Q2025}, {Reductase, https://openalex.org/C134651460, 3, 0.0, https://www.wikidata.org/wiki/Q3100717}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[{Chemistry, https://openalex.org/C185592680, 0, 0.9832449, https://www.wikidata.org/wiki/Q2329}, {Thioester, https://openalex.org/C2778834346, 3, 0.8612993, https://www.wikidata.org/wiki/Q422794}, {Moiety, https://openalex.org/C2776568683, 2, 0.84113634, https://www.wikidata.org/wiki/Q23005640}, {Catalysis, https://openalex.org/C161790260, 2, 0.5933226, https://www.wikidata.org/wiki/Q82264}, {Stereochemistry, https://openalex.org/C71240020, 1, 0.58295554, https://www.wikidata.org/wiki/Q186011}, {Reductive elimination, https://openalex.org/C2778815869, 3, 0.55583173, https://www.wikidata.org/wiki/Q25325213}, {Catalytic cycle, https://openalex.org/C63338738, 3, 0.5022714, https://www.wikidata.org/wiki/Q287862}, {Carbonylation, https://openalex.org/C168382676, 4, 0.48513636, https://www.wikidata.org/wiki/Q900377}, {Nuclear magnetic resonance spectroscopy, https://openalex.org/C66974803, 2, 0.43892258, https://www.wikidata.org/wiki/Q10359898}, {ATP synthase, https://openalex.org/C112243037, 3, 0.42930484, https://www.wikidata.org/wiki/Q22327117}, {Coenzyme A, https://openalex.org/C2779123261, 4, 0.4205989, https://www.wikidata.org/wiki/Q407635}, {Reaction intermediate, https://openalex.org/C105768512, 3, 0.4202594, https://www.wikidata.org/wiki/Q7458208}, {Enzyme, https://openalex.org/C181199279, 2, 0.19665575, https://www.wikidata.org/wiki/Q8047}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.1810588, https://www.wikidata.org/wiki/Q11351}, {Carbon monoxide, https://openalex.org/C512735826, 3, 0.14050582, https://www.wikidata.org/wiki/Q2025}, {Reductase, https://openalex.org/C134651460, 3, 0.0, https://www.wikidata.org/wiki/Q3100717}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[Chemistry, Thioester, Moiety, Catalysis, Stereochemistry, Reductive elimination, Catalytic cycle, Carbonylation, Nuclear magnetic resonance spectroscopy, ATP synthase, Coenzyme A, Reaction intermediate, Enzyme, Organic chemistry, Carbon monoxide, Reductase]                                                                                                         |\n|https://openalex.org/W2322084340|https://doi.org/10.1021/ja208387q      |American Chemical Society|https://openalex.org/P4310320006|2011            |36            |[{Chemistry, https://openalex.org/C185592680, 0, 0.90940607, https://www.wikidata.org/wiki/Q2329}, {Electron paramagnetic resonance, https://openalex.org/C187961010, 2, 0.77636456, https://www.wikidata.org/wiki/Q260463}, {Adduct, https://openalex.org/C108204754, 2, 0.6096685, https://www.wikidata.org/wiki/Q353392}, {Nickel, https://openalex.org/C504270822, 2, 0.5902961, https://www.wikidata.org/wiki/Q744}, {Valence (chemistry), https://openalex.org/C168900304, 2, 0.50281566, https://www.wikidata.org/wiki/Q171407}, {Crystallography, https://openalex.org/C8010536, 1, 0.49536932, https://www.wikidata.org/wiki/Q160398}, {Hyperfine structure, https://openalex.org/C131538251, 2, 0.49342743, https://www.wikidata.org/wiki/Q1413102}, {Molecular orbital, https://openalex.org/C139358910, 3, 0.42959714, https://www.wikidata.org/wiki/Q725417}, {Computational chemistry, https://openalex.org/C147597530, 1, 0.3881339, https://www.wikidata.org/wiki/Q369472}, {Stereochemistry, https://openalex.org/C71240020, 1, 0.32826695, https://www.wikidata.org/wiki/Q186011}, {Molecule, https://openalex.org/C32909587, 2, 0.22038326, https://www.wikidata.org/wiki/Q11369}, {Nuclear magnetic resonance, https://openalex.org/C46141821, 1, 0.20862037, https://www.wikidata.org/wiki/Q209402}, {Atomic physics, https://openalex.org/C184779094, 1, 0.1493097, https://www.wikidata.org/wiki/Q26383}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.08526385, https://www.wikidata.org/wiki/Q11351}, {Physics, https://openalex.org/C121332964, 0, 0.0, https://www.wikidata.org/wiki/Q413}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |[{Chemistry, https://openalex.org/C185592680, 0, 0.90940607, https://www.wikidata.org/wiki/Q2329}, {Electron paramagnetic resonance, https://openalex.org/C187961010, 2, 0.77636456, https://www.wikidata.org/wiki/Q260463}, {Adduct, https://openalex.org/C108204754, 2, 0.6096685, https://www.wikidata.org/wiki/Q353392}, {Nickel, https://openalex.org/C504270822, 2, 0.5902961, https://www.wikidata.org/wiki/Q744}, {Valence (chemistry), https://openalex.org/C168900304, 2, 0.50281566, https://www.wikidata.org/wiki/Q171407}, {Crystallography, https://openalex.org/C8010536, 1, 0.49536932, https://www.wikidata.org/wiki/Q160398}, {Hyperfine structure, https://openalex.org/C131538251, 2, 0.49342743, https://www.wikidata.org/wiki/Q1413102}, {Molecular orbital, https://openalex.org/C139358910, 3, 0.42959714, https://www.wikidata.org/wiki/Q725417}, {Computational chemistry, https://openalex.org/C147597530, 1, 0.3881339, https://www.wikidata.org/wiki/Q369472}, {Stereochemistry, https://openalex.org/C71240020, 1, 0.32826695, https://www.wikidata.org/wiki/Q186011}, {Molecule, https://openalex.org/C32909587, 2, 0.22038326, https://www.wikidata.org/wiki/Q11369}, {Nuclear magnetic resonance, https://openalex.org/C46141821, 1, 0.20862037, https://www.wikidata.org/wiki/Q209402}, {Atomic physics, https://openalex.org/C184779094, 1, 0.1493097, https://www.wikidata.org/wiki/Q26383}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.08526385, https://www.wikidata.org/wiki/Q11351}, {Physics, https://openalex.org/C121332964, 0, 0.0, https://www.wikidata.org/wiki/Q413}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |[Chemistry, Electron paramagnetic resonance, Adduct, Nickel, Valence (chemistry), Crystallography, Hyperfine structure, Molecular orbital, Computational chemistry, Stereochemistry, Molecule, Nuclear magnetic resonance, Atomic physics, Organic chemistry, Physics]                                                                                                     |\n|https://openalex.org/W2325316164|https://doi.org/10.1021/ef501425h      |American Chemical Society|https://openalex.org/P4310320006|2015            |44            |[{Torrefaction, https://openalex.org/C162857116, 3, 0.9607277, https://www.wikidata.org/wiki/Q908322}, {Sewage sludge, https://openalex.org/C2780859252, 3, 0.7224786, https://www.wikidata.org/wiki/Q11888968}, {Environmental science, https://openalex.org/C39432304, 0, 0.63083816, https://www.wikidata.org/wiki/Q188847}, {Waste management, https://openalex.org/C548081761, 1, 0.6022384, https://www.wikidata.org/wiki/Q180388}, {Pulp and paper industry, https://openalex.org/C528095902, 1, 0.495417, https://www.wikidata.org/wiki/Q2283886}, {Sewage, https://openalex.org/C58790150, 2, 0.34141695, https://www.wikidata.org/wiki/Q10966166}, {Pyrolysis, https://openalex.org/C36759035, 2, 0.22141117, https://www.wikidata.org/wiki/Q176848}, {Environmental engineering, https://openalex.org/C87717796, 1, 0.15773156, https://www.wikidata.org/wiki/Q146326}, {Engineering, https://openalex.org/C127413603, 0, 0.08998522, https://www.wikidata.org/wiki/Q11023}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[{Torrefaction, https://openalex.org/C162857116, 3, 0.9607277, https://www.wikidata.org/wiki/Q908322}, {Sewage sludge, https://openalex.org/C2780859252, 3, 0.7224786, https://www.wikidata.org/wiki/Q11888968}, {Environmental science, https://openalex.org/C39432304, 0, 0.63083816, https://www.wikidata.org/wiki/Q188847}, {Waste management, https://openalex.org/C548081761, 1, 0.6022384, https://www.wikidata.org/wiki/Q180388}, {Pulp and paper industry, https://openalex.org/C528095902, 1, 0.495417, https://www.wikidata.org/wiki/Q2283886}, {Sewage, https://openalex.org/C58790150, 2, 0.34141695, https://www.wikidata.org/wiki/Q10966166}, {Pyrolysis, https://openalex.org/C36759035, 2, 0.22141117, https://www.wikidata.org/wiki/Q176848}, {Environmental engineering, https://openalex.org/C87717796, 1, 0.15773156, https://www.wikidata.org/wiki/Q146326}, {Engineering, https://openalex.org/C127413603, 0, 0.08998522, https://www.wikidata.org/wiki/Q11023}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[Torrefaction, Sewage sludge, Environmental science, Waste management, Pulp and paper industry, Sewage, Pyrolysis, Environmental engineering, Engineering]                                                                                                                                                                                                                 |\n|https://openalex.org/W2408785566|https://doi.org/10.1021/acsami.5b06781 |American Chemical Society|https://openalex.org/P4310320006|2015            |32            |[{Particle (ecology), https://openalex.org/C2778517922, 2, 0.6707363, https://www.wikidata.org/wiki/Q7140482}, {Membrane, https://openalex.org/C41625074, 2, 0.64669096, https://www.wikidata.org/wiki/Q176088}, {Materials science, https://openalex.org/C192562407, 0, 0.64276516, https://www.wikidata.org/wiki/Q228736}, {Lipid bilayer, https://openalex.org/C39944091, 3, 0.62645584, https://www.wikidata.org/wiki/Q423279}, {Biophysics, https://openalex.org/C12554922, 1, 0.61603075, https://www.wikidata.org/wiki/Q7100}, {Cell membrane, https://openalex.org/C2778106830, 3, 0.5005224, https://www.wikidata.org/wiki/Q29548}, {Membrane curvature, https://openalex.org/C2777278457, 4, 0.48036012, https://www.wikidata.org/wiki/Q6815124}, {Bilayer, https://openalex.org/C192157962, 3, 0.45281568, https://www.wikidata.org/wiki/Q4087243}, {Particle size, https://openalex.org/C187530423, 2, 0.4123767, https://www.wikidata.org/wiki/Q7140503}, {Chemistry, https://openalex.org/C185592680, 0, 0.23261288, https://www.wikidata.org/wiki/Q2329}, {Biochemistry, https://openalex.org/C55493867, 1, 0.14218533, https://www.wikidata.org/wiki/Q7094}, {Biology, https://openalex.org/C86803240, 0, 0.13937896, https://www.wikidata.org/wiki/Q420}, {Ecology, https://openalex.org/C18903297, 1, 0.0, https://www.wikidata.org/wiki/Q7150}, {Physical chemistry, https://openalex.org/C147789679, 1, 0.0, https://www.wikidata.org/wiki/Q11372}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[{Particle (ecology), https://openalex.org/C2778517922, 2, 0.6707363, https://www.wikidata.org/wiki/Q7140482}, {Membrane, https://openalex.org/C41625074, 2, 0.64669096, https://www.wikidata.org/wiki/Q176088}, {Materials science, https://openalex.org/C192562407, 0, 0.64276516, https://www.wikidata.org/wiki/Q228736}, {Lipid bilayer, https://openalex.org/C39944091, 3, 0.62645584, https://www.wikidata.org/wiki/Q423279}, {Biophysics, https://openalex.org/C12554922, 1, 0.61603075, https://www.wikidata.org/wiki/Q7100}, {Cell membrane, https://openalex.org/C2778106830, 3, 0.5005224, https://www.wikidata.org/wiki/Q29548}, {Membrane curvature, https://openalex.org/C2777278457, 4, 0.48036012, https://www.wikidata.org/wiki/Q6815124}, {Bilayer, https://openalex.org/C192157962, 3, 0.45281568, https://www.wikidata.org/wiki/Q4087243}, {Particle size, https://openalex.org/C187530423, 2, 0.4123767, https://www.wikidata.org/wiki/Q7140503}, {Chemistry, https://openalex.org/C185592680, 0, 0.23261288, https://www.wikidata.org/wiki/Q2329}, {Biochemistry, https://openalex.org/C55493867, 1, 0.14218533, https://www.wikidata.org/wiki/Q7094}, {Biology, https://openalex.org/C86803240, 0, 0.13937896, https://www.wikidata.org/wiki/Q420}, {Ecology, https://openalex.org/C18903297, 1, 0.0, https://www.wikidata.org/wiki/Q7150}, {Physical chemistry, https://openalex.org/C147789679, 1, 0.0, https://www.wikidata.org/wiki/Q11372}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[Particle (ecology), Membrane, Materials science, Lipid bilayer, Biophysics, Cell membrane, Membrane curvature, Bilayer, Particle size, Chemistry, Biochemistry, Biology, Ecology, Physical chemistry]                                                                                                                                                                     |\n|https://openalex.org/W1972564497|https://doi.org/10.1021/i160028a006    |American Chemical Society|https://openalex.org/P4310320006|1968            |1             |[{Boiling, https://openalex.org/C157777378, 2, 0.72936225, https://www.wikidata.org/wiki/Q41716}, {Nucleate boiling, https://openalex.org/C197194406, 4, 0.6125297, https://www.wikidata.org/wiki/Q7068214}, {Heat transfer, https://openalex.org/C50517652, 2, 0.5874026, https://www.wikidata.org/wiki/Q179635}, {Materials science, https://openalex.org/C192562407, 0, 0.49399954, https://www.wikidata.org/wiki/Q228736}, {Particle (ecology), https://openalex.org/C2778517922, 2, 0.4931185, https://www.wikidata.org/wiki/Q7140482}, {Thermodynamics, https://openalex.org/C97355855, 1, 0.4872645, https://www.wikidata.org/wiki/Q11473}, {Boiling heat transfer, https://openalex.org/C2987219539, 5, 0.47890747, https://www.wikidata.org/wiki/Q179635}, {Mechanics, https://openalex.org/C57879066, 1, 0.37994105, https://www.wikidata.org/wiki/Q41217}, {Chemical engineering, https://openalex.org/C42360764, 1, 0.3523972, https://www.wikidata.org/wiki/Q83588}, {Heat transfer coefficient, https://openalex.org/C29700514, 3, 0.24313611, https://www.wikidata.org/wiki/Q634340}, {Physics, https://openalex.org/C121332964, 0, 0.072137296, https://www.wikidata.org/wiki/Q413}, {Engineering, https://openalex.org/C127413603, 0, 0.054629296, https://www.wikidata.org/wiki/Q11023}, {Geology, https://openalex.org/C127313418, 0, 0.053563833, https://www.wikidata.org/wiki/Q1069}, {Oceanography, https://openalex.org/C111368507, 1, 0.0, https://www.wikidata.org/wiki/Q43518}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |[{Boiling, https://openalex.org/C157777378, 2, 0.72936225, https://www.wikidata.org/wiki/Q41716}, {Nucleate boiling, https://openalex.org/C197194406, 4, 0.6125297, https://www.wikidata.org/wiki/Q7068214}, {Heat transfer, https://openalex.org/C50517652, 2, 0.5874026, https://www.wikidata.org/wiki/Q179635}, {Materials science, https://openalex.org/C192562407, 0, 0.49399954, https://www.wikidata.org/wiki/Q228736}, {Particle (ecology), https://openalex.org/C2778517922, 2, 0.4931185, https://www.wikidata.org/wiki/Q7140482}, {Thermodynamics, https://openalex.org/C97355855, 1, 0.4872645, https://www.wikidata.org/wiki/Q11473}, {Boiling heat transfer, https://openalex.org/C2987219539, 5, 0.47890747, https://www.wikidata.org/wiki/Q179635}, {Mechanics, https://openalex.org/C57879066, 1, 0.37994105, https://www.wikidata.org/wiki/Q41217}, {Chemical engineering, https://openalex.org/C42360764, 1, 0.3523972, https://www.wikidata.org/wiki/Q83588}, {Heat transfer coefficient, https://openalex.org/C29700514, 3, 0.24313611, https://www.wikidata.org/wiki/Q634340}, {Physics, https://openalex.org/C121332964, 0, 0.072137296, https://www.wikidata.org/wiki/Q413}, {Engineering, https://openalex.org/C127413603, 0, 0.054629296, https://www.wikidata.org/wiki/Q11023}, {Geology, https://openalex.org/C127313418, 0, 0.053563833, https://www.wikidata.org/wiki/Q1069}, {Oceanography, https://openalex.org/C111368507, 1, 0.0, https://www.wikidata.org/wiki/Q43518}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |[Boiling, Nucleate boiling, Heat transfer, Materials science, Particle (ecology), Thermodynamics, Boiling heat transfer, Mechanics, Chemical engineering, Heat transfer coefficient, Physics, Engineering, Geology, Oceanography]                                                                                                                                          |\n|https://openalex.org/W1995483265|https://doi.org/10.1021/om040138g      |American Chemical Society|https://openalex.org/P4310320006|2005            |20            |[{Chemistry, https://openalex.org/C185592680, 0, 0.96620405, https://www.wikidata.org/wiki/Q2329}, {Phenylacetylene, https://openalex.org/C2778545935, 3, 0.7981602, https://www.wikidata.org/wiki/Q417321}, {Platinum, https://openalex.org/C518104683, 3, 0.50189996, https://www.wikidata.org/wiki/Q880}, {Cis–trans isomerism, https://openalex.org/C176788430, 2, 0.42888245, https://www.wikidata.org/wiki/Q283611}, {Structural isomer, https://openalex.org/C202235601, 2, 0.42776483, https://www.wikidata.org/wiki/Q7361732}, {Medicinal chemistry, https://openalex.org/C155647269, 1, 0.3592274, https://www.wikidata.org/wiki/Q243455}, {Stereochemistry, https://openalex.org/C71240020, 1, 0.3533979, https://www.wikidata.org/wiki/Q186011}, {Crystallography, https://openalex.org/C8010536, 1, 0.33867538, https://www.wikidata.org/wiki/Q160398}, {Catalysis, https://openalex.org/C161790260, 2, 0.18147534, https://www.wikidata.org/wiki/Q82264}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.09451887, https://www.wikidata.org/wiki/Q11351}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |[{Chemistry, https://openalex.org/C185592680, 0, 0.96620405, https://www.wikidata.org/wiki/Q2329}, {Phenylacetylene, https://openalex.org/C2778545935, 3, 0.7981602, https://www.wikidata.org/wiki/Q417321}, {Platinum, https://openalex.org/C518104683, 3, 0.50189996, https://www.wikidata.org/wiki/Q880}, {Cis–trans isomerism, https://openalex.org/C176788430, 2, 0.42888245, https://www.wikidata.org/wiki/Q283611}, {Structural isomer, https://openalex.org/C202235601, 2, 0.42776483, https://www.wikidata.org/wiki/Q7361732}, {Medicinal chemistry, https://openalex.org/C155647269, 1, 0.3592274, https://www.wikidata.org/wiki/Q243455}, {Stereochemistry, https://openalex.org/C71240020, 1, 0.3533979, https://www.wikidata.org/wiki/Q186011}, {Crystallography, https://openalex.org/C8010536, 1, 0.33867538, https://www.wikidata.org/wiki/Q160398}, {Catalysis, https://openalex.org/C161790260, 2, 0.18147534, https://www.wikidata.org/wiki/Q82264}, {Organic chemistry, https://openalex.org/C178790620, 1, 0.09451887, https://www.wikidata.org/wiki/Q11351}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |[Chemistry, Phenylacetylene, Platinum, Cis–trans isomerism, Structural isomer, Medicinal chemistry, Stereochemistry, Crystallography, Catalysis, Organic chemistry]                                                                                                                                                                                                        |\n+--------------------------------+---------------------------------------+-------------------------+--------------------------------+----------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 10 rows\n\n+--------------------+-------+\n|                 fos| PubCnt|\n+--------------------+-------+\n|           Chemistry|1559648|\n|   Organic chemistry| 968091|\n|   Materials science| 573154|\n|             Physics| 549894|\n|         Engineering| 453508|\n|        Biochemistry| 418125|\n|           Catalysis| 334541|\n|             Biology| 309601|\n|      Nanotechnology| 298176|\n|     Stereochemistry| 273879|\n|    Computer science| 259131|\n|   Quantum mechanics| 238649|\n|Chemical engineering| 234668|\n|  Physical chemistry| 210874|\n|  Composite material| 208055|\n|     Crystallography| 176876|\n|      Chromatography| 172521|\n| Inorganic chemistry| 171177|\n|             Polymer| 168121|\n|            Medicine| 160963|\n+--------------------+-------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mOA_S2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 12 more fields]\n\u001b[1m\u001b[34mOAarticlesdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [id: string, doi: string ... 7 more fields]\n\u001b[1m\u001b[34mOAarticlesdf_fos\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [id: string, fos: string]\n"
     }
    ]
   }
  },
  {
   "title": "Link S2AND Datasets",
   "text": "%spark\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval S2AND_HOME = \"/media/ometaxas/nvme/datasets/S2AND\"\n//val S2AND_HOME = \"/home/ometaxas/Projects/S2AND/S2AND/data/aminer\"\nimport  org.apache.spark.sql.functions._\n\nval aminersignatures = spark.read.json(s\"file://$S2AND_HOME/aminer-signatures.json\")\n                       .withColumn(\"dataset\", lit(\"aminer\"))\nval arnetminersignatures = spark.read.json(s\"file://$S2AND_HOME/arnetminer-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"arnetminer\"))\nval inspiresignatures = spark.read.json(s\"file://$S2AND_HOME/inspire-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"inspires\"))\nval zbmathsignatures = spark.read.json(s\"file://$S2AND_HOME/zbmath-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"zbmath\"))\nval pubmedsignatures = spark.read.json(s\"file://$S2AND_HOME/pubmed-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"pubmed\"))\nval kistisignatures = spark.read.json(s\"file://$S2AND_HOME/kisti-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"kisti\"))\nval qiansignatures = spark.read.json(s\"file://$S2AND_HOME/qian-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"qian\"))\n\nval S2ANDsignatures = aminersignatures.union(arnetminersignatures).union(inspiresignatures).union(zbmathsignatures).union(pubmedsignatures).union(kistisignatures).union(qiansignatures)\n        .withColumn(\"author_info_fullname\", concat($\"author_info_first\", lit(\" \"), $\"author_info_last\"))\n        .withColumn(\"author_info_normname\", normName($\"author_info_fullname\"))\n        .withColumn(\"author_info_shortnormname\", shortNormName($\"author_info_fullname\"))\n\nS2ANDsignatures.printSchema()\nprintln(\"S2ANDsignatures count: \" + S2ANDsignatures.count())\nS2ANDsignatures.groupBy($\"dataset\").count().show()\n\nval OA_S2_Pub_Authors =   spark.read\n        //.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n\n val OA_S2_S2AND_signatures = OA_S2_Pub_Authors\n                   .join(broadcast(S2ANDsignatures), $\"paper_id\" === $\"S2paperId\"  \n                           && ( $\"S2shortNormName\"=== $\"author_info_shortnormname\"   || (  jaro_winkler($\"author_info_normname\", $\"S2normName\") > 0.75 && levenshtein($\"author_info_normname\", $\"S2normName\")<4  )   || (soundex($\"author_info_normname\") === soundex($\"S2normName\"))) \n                       , \"inner\").cache()                    \n \nprintln(\"OA_S2_S2AND_signatures:\" + OA_S2_S2AND_signatures.count())\nOA_S2_S2AND_signatures.groupBy($\"dataset\").count().show()\n\nval w = Window.partitionBy($\"dataset\", $\"signature_id\").orderBy(levenshtein($\"S2normName\", $\"author_info_normname\") , lit(1) - (soundex($\"author_info_normname\") === soundex($\"S2normName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"author_info_normname\", $\"S2normName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA_S2_S2AND_signatures_dedup = OA_S2_S2AND_signatures.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\").cache()\n\nOA_S2_S2AND_signatures_dedup.write.mode(\"overwrite\").json(s\"file://$S2AND_HOME/OA_S2_S2AND_signatures_dedup.json\")\n\nprintln(\"OA_S2_S2AND_signatures_dedup:\" + OA_S2_S2AND_signatures_dedup.count())\nOA_S2_S2AND_signatures_dedup.groupBy($\"dataset\").count().show()\n\n/*\nOA_S2_S2AND_signatures:1158300\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 41266|\n|    zbmath| 14702|\n|      qian|  6763|\n|  inspires|910991|\n|arnetminer|  7419|\n|    aminer|174198|\n|    pubmed|  2961|\n+----------+------+\n\nOA_S2_S2AND_signatures_dedup:681010\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 37446|\n|      qian|  6081|\n|    zbmath| 14341|\n|  inspires|462700|\n|arnetminer|  6699|\n|    aminer|150930|\n|    pubmed|  2813|\n+----------+------+\n\n */",
   "user": "anonymous",
   "dateUpdated": "2022-12-12 19:08:40.278",
   "progress": 99.0,
   "config": {
    "title": true,
    "tableHide": true,
    "editorHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=0"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=1"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=2"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=3"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=4"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=5"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=6"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670444516598_748155554",
   "id": "paragraph_1670444516598_748155554",
   "dateCreated": "2022-12-07T22:21:56+0200",
   "dateStarted": "2022-12-12 18:46:36.747",
   "dateFinished": "2022-12-12 19:08:40.278",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- author_id: long (nullable = true)\n |-- author_info_affiliations: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- author_info_email: string (nullable = true)\n |-- author_info_first: string (nullable = true)\n |-- author_info_last: string (nullable = true)\n |-- author_info_middle: string (nullable = true)\n |-- author_info_position: long (nullable = true)\n |-- author_info_suffix: string (nullable = true)\n |-- paper_id: long (nullable = true)\n |-- signature_id: string (nullable = true)\n |-- dataset: string (nullable = false)\n |-- author_info_fullname: string (nullable = true)\n |-- author_info_normname: string (nullable = true)\n |-- author_info_shortnormname: string (nullable = true)\n\nS2ANDsignatures count: 766133\n+----------+------+\n|   dataset| count|\n+----------+------+\n|    aminer|157448|\n|arnetminer|  7144|\n|  inspires|536564|\n|    zbmath| 15181|\n|    pubmed|  2871|\n|     kisti| 40383|\n|      qian|  6542|\n+----------+------+\n\nOA_S2_S2AND_signatures:1158300\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 41266|\n|    zbmath| 14702|\n|      qian|  6763|\n|  inspires|910991|\n|arnetminer|  7419|\n|    aminer|174198|\n|    pubmed|  2961|\n+----------+------+\n\nOA_S2_S2AND_signatures_dedup:642908\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 27881|\n|    zbmath|  5870|\n|      qian|  2527|\n|  inspires|450866|\n|arnetminer|  2699|\n|    aminer|150930|\n|    pubmed|  2135|\n+----------+------+\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mS2AND_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/S2AND\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34maminersignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [author_id: bigint, author_info_affiliations: array<string> ... 9 more fields]\n\u001b[1m\u001b[34marnetminersignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [author_id: bigint, author_info_affiliations: array<string> ... 9 more fields]\n\u001b[1m\u001b[34minspiresignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [author_id: bigint, author_info_affiliations: array<string> ... 9 more fields]\n\u001b[1m\u001b[34mzbmathsignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataF...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.expressions.Window\n\nval simpleData = Seq((\"James\",\"Jamie\", 111), \n    (\"James\",\"james\", 111), \n    (\"James\",\"Jamis\", 111), \n    (\"James\",\"Jameson\", 111), \n    (\"James\", \"James11\", 111), \n    (\"maria\",\"Maria\", 222), \n    (\"maria\",\"moria\",222), \n    (\"maria\",\"maria1\",222),\n    (\"maria\",\"Marianna\",222)   \n    )\n  \n\nval df = simpleData.toDF(\"name1\",\"name2\", \"id\")\ndf.printSchema()\ndf.show(false)\n\nval w = Window.partitionBy($\"id\").orderBy(levenshtein($\"name1\", $\"name2\") , lit(1) - (soundex($\"name1\") === soundex($\"name2\")).cast(\"integer\"), lit(1)-jaro_winkler($\"name1\", $\"name2\"))\n        //.orderBy(levenshtein($\"s2AuthorNormName\", $\"authorNormName\"))\n\nval df1 = df\n.withColumn(\"levenshtein\",levenshtein($\"name1\", $\"name2\"))\n.withColumn(\"jaro_winkler\",lit(1)-jaro_winkler($\"name1\", $\"name2\"))\n.withColumn(\"soundex\", (soundex($\"name1\") === soundex($\"name2\")).cast(\"integer\"))\n.withColumn(\"rn\", row_number.over(w)) //.where($\"rn\" === 1).drop(\"rn\")\ndf1.show()\n\nval df_dedup = df.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\ndf_dedup.show()\n\n\n",
   "id": "",
   "dateCreated": "2022-12-11 17:26:26.588",
   "config": {
    "tableHide": true,
    "editorHide": true
   },
   "dateStarted": "2022-12-20 12:22:00.379",
   "dateUpdated": "2022-12-20 12:22:04.574",
   "dateFinished": "2022-12-20 12:22:04.574",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- name1: string (nullable = true)\n |-- name2: string (nullable = true)\n |-- id: integer (nullable = false)\n\n+-----+--------+---+\n|name1|name2   |id |\n+-----+--------+---+\n|James|Jamie   |111|\n|James|james   |111|\n|James|Jamis   |111|\n|James|Jameson |111|\n|James|James11 |111|\n|maria|Maria   |222|\n|maria|moria   |222|\n|maria|maria1  |222|\n|maria|Marianna|222|\n+-----+--------+---+\n\n+-----+--------+---+-----------+--------------------+-------+---+\n|name1|   name2| id|levenshtein|        jaro_winkler|soundex| rn|\n+-----+--------+---+-----------+--------------------+-------+---+\n|James|   Jamis|111|          1| 0.09333333333333327|      1|  1|\n|James|   james|111|          1|  0.1333333333333333|      1|  2|\n|James| James11|111|          2| 0.05714285714285716|      1|  3|\n|James| Jameson|111|          2| 0.05714285714285716|      0|  4|\n|James|   Jamie|111|          2| 0.09333333333333327|      0|  5|\n|maria|  maria1|222|          1|0.033333333333333326|      1|  1|\n|maria|   moria|222|          1|                0.12|      1|  2|\n|maria|   Maria|222|          1|  0.1333333333333333|      1|  3|\n|maria|Marianna|222|          4|  0.2333333333333334|      0|  4|\n+-----+--------+---+-----------+--------------------+-------+---+\n\n+-----+------+---+\n|name1| name2| id|\n+-----+------+---+\n|James| Jamis|111|\n|maria|maria1|222|\n+-----+------+---+\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.expressions.Window\n\u001b[1m\u001b[34msimpleData\u001b[0m: \u001b[1m\u001b[32mSeq[(String, String, Int)]\u001b[0m = List((James,Jamie,111), (James,james,111), (James,Jamis,111), (James,Jameson,111), (James,James11,111), (maria,Maria,222), (maria,moria,222), (maria,maria1,222), (maria,Marianna,222))\n\u001b[1m\u001b[34mdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [name1: string, name2: string ... 1 more field]\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@10640600\n\u001b[1m\u001b[34mdf1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [name1: string, name2...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n//val hindawi =   spark.read.options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(\"/media/ometaxas/nvme/datasets/OA_S2/phenom_30nov_author-2022.csv\")\nval hindawi =   spark.read.options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(\"/media/ometaxas/nvme/datasets/hindawi\")\n\nval hindawi_signatures =   hindawi.filter(($\"doi\" =!= \"\") && ($\"doi\".isNotNull))\n//.select( $\"doi\",$\"givenname\", $\"surname\", $\"orcid\".as(\"hindawi_orcid\"), $\"hindawi_userid\")\n//.withColumn(\"author_info_fullname\", concat($\"givenname\", lit(\" \"), $\"surname\"))\n  //      .withColumn(\"author_info_normname\", normName($\"author_info_fullname\"))\n    //    .withColumn(\"author_info_shortnormname\", shortNormName($\"author_info_fullname\"))\n\n\nhindawi.printSchema()\nhindawi.show(10)\nprintln(\"hindawi count: \" + hindawi.count())\nprintln(\"hindawi signatures: \" + hindawi_signatures.count())\n//.filter(($\"doi\" =!= \"\") && ($\"doi\".isNotNull))\nprintln(\"hindawi_ids:\" + hindawi.select( $\"hindawi_userid\").distinct().count())\nprintln(\"hindawi_signature_ids:\" + hindawi_signatures.select( $\"hindawi_userid\").distinct().count())\n\n\nval OA_S2_Pub_Authors =   spark.read\n        //.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\nOA_S2_Pub_Authors.printSchema()\n\n\n val OA_S2_hindawi_signatures = OA_S2_Pub_Authors\n                   .join(broadcast(hindawi), $\"OAdoi\" === $\"doi\"  \n                           && ($\"orcid\"===$\"hindawi_orcid\" || $\"OAshortNormName\"=== $\"author_info_shortnormname\"   || (  jaro_winkler($\"author_info_normname\", $\"OAnormName\") > 0.75 && levenshtein($\"author_info_normname\", $\"OAnormName\")<4  )   || (soundex($\"author_info_normname\") === soundex($\"OAnormName\"))) \n                       , \"inner\").cache()                    \n \nprintln(\"OA_S2_hindawi_signatures:\" + OA_S2_hindawi_signatures.count())\n\n\nval w = Window.partitionBy($\"doi\", $\"OAauthorId\").orderBy( lit(1) - ($\"orcid\" === $\"hindawi_orcid\").cast(\"integer\"), levenshtein($\"OAnormName\", $\"author_info_normname\") , lit(1) - (soundex($\"author_info_normname\") === soundex($\"OAnormName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"author_info_normname\", $\"OAnormName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA_S2_hindawi_signatures_dedup = OA_S2_hindawi_signatures.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\").cache()\n\nOA_S2_hindawi_signatures_dedup.write.mode(\"overwrite\").json(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_hindawi_signatures_dedup.json\")\n\nprintln(\"OA_S2_hindawi_signatures_dedup:\" + OA_S2_hindawi_signatures_dedup.count())\n\n// hindawi count: 125234\n// hindawi_ids:110820\n// OA_S2_hindawi_signatures:123796\n// OA_S2_hindawi_signatures_dedup:116664\n// OA_S2_hindawi_signatures_dedup_hind_ids:103454\n\n",
   "id": "",
   "dateCreated": "2022-12-16 16:37:39.266",
   "config": {
    "title": true,
    "editorHide": true,
    "tableHide": false
   },
   "title": "Link with Hindawi ",
   "dateStarted": "2023-02-13 11:15:08.285",
   "dateUpdated": "2023-02-13 11:15:14.664",
   "dateFinished": "2023-02-13 11:15:14.664",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- doi: string (nullable = true)\n |-- submission_date: string (nullable = true)\n |-- manuscript_title: string (nullable = true)\n |-- givenname: string (nullable = true)\n |-- surname: string (nullable = true)\n |-- domain: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- affiliation: string (nullable = true)\n |-- journal_name: string (nullable = true)\n |-- hindawi_userid: string (nullable = true)\n\n+--------------------+--------------------+--------------------+-----------+-------------+-------------+-------------------+--------------------+--------------------+--------------------+\n|                 doi|     submission_date|    manuscript_title|  givenname|      surname|       domain|              orcid|         affiliation|        journal_name|      hindawi_userid|\n+--------------------+--------------------+--------------------+-----------+-------------+-------------+-------------------+--------------------+--------------------+--------------------+\n|                null|2022-08-18 15:02:...|Correlation analy...|     Jinhua|         Zhou|  suda.edu.cn|               null|Department of Obs...| Journal of Oncology|0756acea-24bf-475...|\n|                null|2022-08-18 15:02:...|Correlation analy...|    Yanling|          Sun|      126.com|               null|Department of Obs...| Journal of Oncology|e509082c-8510-408...|\n|10.1155/2022/1000859|2022-08-03 12:00:...|Influence of Heat...|      Girma|       Eshete|    su.edu.et|0000-0002-6749-6149|Samara University...|Journal of Nanoma...|6393c02a-c0fe-472...|\n|10.1155/2022/1000859|2022-08-03 12:00:...|Influence of Heat...|   Muvvala |Chinnam Naidu|    gmail.com|0000-0003-4802-0863|   Andhra University|Journal of Nanoma...|2ac97c7a-96bd-418...|\n|10.1155/2022/1001354|2022-07-08 03:37:...|Therapeutic effec...|Zhongxiang |           Yu|       qq.com|               null|Department of Ort...|Evidence-Based Co...|1a86d461-7366-476...|\n|10.1155/2022/1001354|2022-07-08 03:37:...|Therapeutic effec...|  Shengming|           Xu|      126.com|               null|Department of Ort...|Evidence-Based Co...|e38aae71-0f80-48e...|\n|                null|2022-06-15 02:33:...|Design of Structu...|         Qi|        Zhang|       qq.com|               null|Shousong Intellig...|Computational Int...|64b57184-374c-4c7...|\n|                null|2022-06-15 02:33:...|Design of Structu...|    Jianlin|         Zhao|hnuahe.edu.cn|               null|Henan University ...|Computational Int...|8910021d-a1a1-486...|\n|                null|2022-05-16 02:38:...|Analysis of stude...|    Senrong|          Wei|     sina.com|               null| Chang'an University|Mathematical Prob...|dfc8696f-ff32-4ad...|\n|10.1155/2022/1002105|2022-06-07 08:03:...|study on the appl...|        Nan|          Liu|  sdca.edu.cn|0000-0001-5847-280X|ShanDong college ...|Mathematical Prob...|d34244a9-2d5e-4fd...|\n+--------------------+--------------------+--------------------+-----------+-------------+-------------+-------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\nhindawi count: 2124761\nhindawi signatures: 543431\nhindawi_ids:1173159\nhindawi_signature_ids:426572\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mhindawi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [doi: string, submission_date: string ... 8 more fields]\n\u001b[1m\u001b[34mhindawi_signatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [doi: string, submission_date: string ... 8 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nval hindawi_ids =   spark.read.options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(\"/media/ometaxas/nvme/datasets/OA_S2/phenom_30nov_author-2022.csv\")\n.filter(($\"doi\" =!= \"\") && ($\"doi\".isNotNull))\n.select( $\"hindawi_userid\").distinct()\nprintln(\"hindawi_ids:\" + hindawi_ids.count())\n\nval OA_S2_hindawi_signatures_dedup = spark.read.json(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_hindawi_signatures_dedup.json\")\nOA_S2_hindawi_signatures_dedup.printSchema()\nOA_S2_hindawi_signatures_dedup.show(5)\n\nval OA_S2_hindawi_signatures_dedup_hind_ids = OA_S2_hindawi_signatures_dedup.select( $\"hindawi_userid\").distinct()\nprintln(\"OA_S2_hindawi_signatures_dedup_hind_ids:\" + OA_S2_hindawi_signatures_dedup_hind_ids.count())\n",
   "id": "",
   "dateCreated": "2022-12-19 22:48:27.237",
   "config": {
    "editorHide": true,
    "tableHide": true
   },
   "dateStarted": "2022-12-20 13:31:55.737",
   "dateUpdated": "2022-12-20 13:31:59.609",
   "dateFinished": "2022-12-20 13:31:59.609",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "hindawi_ids:110820\nroot\n |-- OAauthorId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAfos_0: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- OAfos_1: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- OAmagId: long (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- OApaperId: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2fos: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2magId: string (nullable = true)\n |-- S2name: string (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2shortNormName: string (nullable = true)\n |-- S2title: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- author_info_fullname: string (nullable = true)\n |-- author_info_normname: string (nullable = true)\n |-- author_info_shortnormname: string (nullable = true)\n |-- coAuthorId: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- doi: string (nullable = true)\n |-- givenname: string (nullable = true)\n |-- hindawi_orcid: string (nullable = true)\n |-- hindawi_userid: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- surname: string (nullable = true)\n\n+-----------+--------------------+--------------------+--------------------+-------+----------------+-------------+-----------+---------------+----------+--------------------+--------------------+-------+------------+-----------+---------+---------------+--------------------+---------------+--------------------+--------------------+-------------------------+--------------------+----------------------+--------------------+----------+-------------------+--------------------+-------------------+-------+\n| OAauthorId|               OAdoi|             OAfos_0|             OAfos_1|OAmagId|          OAname|   OAnormName|  OApaperId|OAshortNormName|S2authorId|               S2doi|               S2fos|S2magId|      S2name| S2normName|S2paperId|S2shortNormName|             S2title|affiliationsIds|author_info_fullname|author_info_normname|author_info_shortnormname|          coAuthorId|coAuthorShortNormNames|                 doi| givenname|      hindawi_orcid|      hindawi_userid|              orcid|surname|\n+-----------+--------------------+--------------------+--------------------+-------+----------------+-------------+-----------+---------------+----------+--------------------+--------------------+-------+------------+-----------+---------+---------------+--------------------+---------------+--------------------+--------------------+-------------------------+--------------------+----------------------+--------------------+----------+-------------------+--------------------+-------------------+-------+\n|A4282387361|10.1155/2022/1012684|[Computer science...|[Artificial intel...|   null|    Babita Yadav|  babitayadav|W4283808101|         byadav|2054175413|10.1155/2022/1012684|          [Medicine]|   null|Babita Yadav|babitayadav|250298837|         byadav|ML-Based Texture ...|  [I3132695963]|       Babita  Yadav|         babitayadav|                   byadav|[A4282387360, A42...|  [ngarg, dsinha, b...|10.1155/2022/1012684|   Babita |0000-0003-4524-2452|566a802f-ee38-48b...|0000-0003-4524-2452|  Yadav|\n|A2946922922|10.1155/2022/1015310|[Chemistry, Biology]|[Pharmacology, Bi...|   null|Md. Abdul Hannan|mdabdulhannan|W4300816761|        mhannan|  32394613|10.1155/2022/1015310| [Biology, Medicine]|   null|   M. Hannan|    mhannan|252709428|        mhannan|Protective Mechan...|    [I24057909]|   Md. Abdul  Hannan|       mdabdulhannan|                  mhannan|[A2946922922, A43...|  [mhannan, asultan...|10.1155/2022/1015310|Md. Abdul |0000-0001-6640-4495|7aea7e4e-ef45-491...|0000-0001-6640-4495| Hannan|\n|A4229206078|10.1155/2022/1026129|[Materials scienc...|[Chemical enginee...|   null|    Tianming Liu|  tianmingliu|W4229012877|           tliu|2115347489|10.1155/2022/1026129|                null|   null|Tianming Liu|tianmingliu|248647610|           tliu|Copper Adsorption...|  [I3125743391]|        Tianming Liu|         tianmingliu|                     tliu|[A4229206076, A28...|  [lkong, xliu, glv...|10.1155/2022/1026129|  Tianming|               null|290b103e-71f5-432...|               null|    Liu|\n|A4299928259|10.1155/2022/1039393|[Medicine, Econom...|[Internal medicin...|   null|          Dan Pu|        danpu|W4298624669|            dpu|1959652464|10.1155/2022/1039393|[Medicine, Psycho...|   null| Dan-Ling Pu|  danlingpu|252647161|            dpu|Psychological Pro...|         [null]|              Dan Pu|               danpu|                      dpu|[A4299928258, A30...|  [cye, xxiong, yzh...|10.1155/2022/1039393|       Dan|               null|4c52c7fe-5d4f-4ed...|               null|     Pu|\n|A4283911730|10.1155/2022/1056869|[Computer science...|[Risk analysis (e...|   null|     Shenge Chen|   shengechen|W4283691177|          schen|2118529922|10.1155/2022/1056869|                null|   null|   Shen Chen|   shenchen|250137849|          schen|Dynamic Evaluatio...|    [I36234482]|        Shenge  Chen|          shengechen|                    schen|[A4283911729, A42...|         [lliu, schen]|10.1155/2022/1056869|   Shenge |               null|7e465e9f-092f-47d...|               null|   Chen|\n+-----------+--------------------+--------------------+--------------------+-------+----------------+-------------+-----------+---------------+----------+--------------------+--------------------+-------+------------+-----------+---------+---------------+--------------------+---------------+--------------------+--------------------+-------------------------+--------------------+----------------------+--------------------+----------+-------------------+--------------------+-------------------+-------+\nonly showing top 5 rows\n\nOA_S2_hindawi_signatures_dedup_hind_ids:103454\n\u001b[1m\u001b[34mhindawi_ids\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [hindawi_userid: string]\n\u001b[1m\u001b[34mOA_S2_hindawi_signatures_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OAauthorId: string, OAdoi: string ... 28 more fields]\n\u001b[1m\u001b[34mOA_S2_hindawi_signatures_dedup_hind_ids\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [hindawi_userid: string]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n//import org.apache.spark.sql.types.{DataType, StructType}\nimport org.apache.spark.sql.types._                        \n\n\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n//val file = \"/acm_signatures_sample.tsv\"\nval file = \"/report1.txt\"\n\nval acm_data_schema = \"{\\\"type\\\":\\\"struct\\\",\\\"fields\\\":[{\\\"name\\\":\\\"acm_doi\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"acm_author_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"person_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"acm_institution_id\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"acm_author_name\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"acm_publication_date\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"acm_pub_title\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}},{\\\"name\\\":\\\"acm_orcid\\\",\\\"type\\\":\\\"string\\\",\\\"nullable\\\":true,\\\"metadata\\\":{}}]}\"\n\nval schemaFromJson =  DataType.fromJson(acm_data_schema).asInstanceOf[StructType]\n\n//val acm_data =   spark.read.options(Map(\"sep\"->\"\\\\t\", \"header\"-> \"true\")).csv(s\"file://$path$file\")\nval acm_data =   spark.read.schema(schemaFromJson).options(Map(\"sep\"->\"|\", \"header\"-> \"false\")).csv(s\"file://$path$file\")\n.select(lower($\"acm_doi\").as(\"acm_doi\"), $\"acm_orcid\", $\"acm_author_id\", $\"acm_institution_id\", $\"acm_author_name\" )\nacm_data.printSchema()\nacm_data.show(10)\nprintln(\"acm_data count: \" + acm_data.count())\n\nprintln(\"acm_author_ids:\" + acm_data.select( $\"acm_author_id\").distinct().count())\nprintln(\"acm_institution_ids:\" + acm_data.select( $\"acm_institution_id\").distinct().count())\nprintln(\"acm_orcids:\" + acm_data.select( $\"acm_orcid\").distinct().count())\nprintln(\"acm_dois:\" + acm_data.select( $\"acm_doi\").distinct().count())\n/*\nacm_data count: 9607614\nprofile_dois:3202066\ninstitution_doi:27619\nORCID:192851\ndoi:3378738\n */\n\n//println(acm_data.schema.json)\n\n\n\nval acm_signatures =   acm_data.filter(($\"acm_doi\" =!= \"\") && ($\"acm_doi\".isNotNull))\n       .withColumn(\"acm_normname\", normName($\"acm_author_name\"))\n       .withColumn(\"acm_shortnormname\", shortNormName($\"acm_author_name\"))\n\nprintln(\"acm_signatures signatures: \" + acm_signatures.count())\n\n\n\n /*\n root\n |-- authorFinalPkgId: string (nullable = true)\n |-- signatureId: long (nullable = true)\n |-- soundex: string (nullable = true)\n |-- shortNormName: string (nullable = true)\n |-- conceptIdLevel0: string (nullable = true)\n |-- oaPaperId: string (nullable = true)\n |-- oaDoi: string (nullable = true)\n |-- oaAuthorName: string (nullable = true)\n |-- oaAuthorId: string (nullable = true)\n |-- orcId: string (nullable = true)\n |-- oaAffiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n \n  */\n\nval OA_S2_Pub_Authors =   spark.read\n        .parquet(\"/media/ometaxas/nvme/datasets/ACM/apReport2\")\n        .select( $\"oaDoi\".as(\"OAdoi\"), $\"orcId\".as(\"orcid\"), $\"authorFinalPkgId\".as(\"pkgAuthorId\"),$\"oaAuthorId\".as(\"oaAuthorId_old\"), $\"oaPaperId\", $\"oaAuthorName\", $\"oaAffiliationsIds\")\n        .withColumn(\"OAnormname\", normName($\"oaAuthorName\"))\n       .withColumn(\"OAshortnormname\", shortNormName($\"oaAuthorName\"))\n       .withColumn(\"oaAffiliationId\", element_at($\"oaAffiliationsIds\", 1))\n\n        //.select($\"authorFinalPkgId\".as(\"oaAuthorId\"), $\"shortNormName\".as(\"OAshortNormName\"),  )\n\n/*/\n\nval OA_S2_Pub_Authors =   spark.read\n        .parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n        //.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n        \n//.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n*/\nOA_S2_Pub_Authors.printSchema()\nOA_S2_Pub_Authors.show(50)\n\n\n\n val OA_S2_acm_signatures = OA_S2_Pub_Authors\n                   .join(broadcast(acm_signatures), $\"OAdoi\" === lower($\"acm_doi\")  \n                           && (OA_S2_Pub_Authors(\"orcid\")===acm_signatures(\"acm_orcid\") || $\"OAshortNormName\"=== $\"acm_shortnormname\"   || (  jaro_winkler($\"acm_normname\", $\"OAnormName\") > 0.75 && levenshtein($\"acm_normname\", $\"OAnormName\")<4  )   || (soundex($\"acm_normname\") === soundex($\"OAnormName\"))) \n                       , \"inner\").cache()                    \n \nprintln(\"OA_S2_acm_signatures:\" + OA_S2_acm_signatures.count())\n//OA_S2_acm_signatures.write.mode(\"overwrite\").parquet(s\"file://$path/OA_S2_acm_signatures.parquet\")\nOA_S2_acm_signatures.write.mode(\"overwrite\").parquet(s\"file://$path/pkg_acm_signatures.parquet\")\n\n\nval w = Window.partitionBy($\"OAdoi\", $\"OAauthorId\").orderBy( lit(1) - ($\"orcid\" === $\"acm_orcid\").cast(\"integer\"), levenshtein($\"OAnormName\", $\"acm_normname\") , lit(1) - (soundex($\"acm_normname\") === soundex($\"OAnormName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"acm_normname\", $\"OAnormName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA_S2_acm_signatures_dedup = OA_S2_acm_signatures.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\").cache()\n\n//OA_S2_acm_signatures_dedup.write.mode(\"overwrite\").parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\nOA_S2_acm_signatures_dedup.write.mode(\"overwrite\").parquet(s\"file://$path/pkg_acm_signatures_dedup.parquet\")\n\nprintln(\"OA_S2_acm_signatures_dedup:\" + OA_S2_acm_signatures_dedup.count())\n\n",
   "id": "",
   "dateCreated": "2023-03-03 14:56:36.555",
   "config": {
    "title": true,
    "tableHide": true
   },
   "dateStarted": "2023-03-15 10:00:30.288",
   "dateUpdated": "2023-03-15 10:14:14.330",
   "dateFinished": "2023-03-15 10:14:14.330",
   "title": "Match with ACM",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n\n+--------------------+---------+--------------------+--------------------+--------------------+\n|             acm_doi|acm_orcid|       acm_author_id|  acm_institution_id|     acm_author_name|\n+--------------------+---------+--------------------+--------------------+--------------------+\n|10.5555/209380.20...|     null|   10.1145/contrib-1|                null|           Anonymous|\n|      10.5555/559474|     null|   10.1145/contrib-1|                null|           Anonymous|\n|10.5555/571606.57...|     null|   10.1145/contrib-1|                null|           Anonymous|\n|     10.5555/2502755|     null|10.1145/contrib-6...|                null|           Ron Babin|\n|10.1016/j.mee.200...|     null|10.1145/contrib-8...|10.1145/instituti...|         C. Le Royer|\n|      10.5555/558122|     null|10.1145/contrib-8...|                null|  Michael R. Descour|\n|10.1016/0021-9991...|     null|10.1145/contrib-8...|                null|          P. Demaret|\n|10.5555/109930.10...|     null|10.1145/contrib-8...|                null|          D. Rogovin|\n|      10.5555/576311|     null|10.1145/contrib-8...|                null|    Mautice Halladay|\n|     10.5555/2611158|     null|10.1145/contrib-8...|                null|Amiya K. Chakravarty|\n+--------------------+---------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\nacm_data count: 9607614\nacm_author_ids:3202066\nacm_institution_ids:27619\nacm_orcids:192851\nacm_dois:3378730\nacm_signatures signatures: 9607614\nroot\n |-- OAdoi: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- pkgAuthorId: string (nullable = true)\n |-- oaAuthorId_old: string (nullable = true)\n |-- oaPaperId: string (nullable = true)\n |-- oaAuthorName: string (nullable = true)\n |-- oaAffiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- OAnormname: string (nullable = true)\n |-- OAshortnormname: string (nullable = true)\n |-- oaAffiliationId: string (nullable = true)\n\n+--------------------+-------------------+--------------------+--------------+-----------+---------------------+-----------------+----------------------+----------------+---------------+\n|               OAdoi|              orcid|         pkgAuthorId|oaAuthorId_old|  oaPaperId|         oaAuthorName|oaAffiliationsIds|            OAnormname| OAshortnormname|oaAffiliationId|\n+--------------------+-------------------+--------------------+--------------+-----------+---------------------+-----------------+----------------------+----------------+---------------+\n|                null|               null|3de79rs90QXkJb3gE...|    A100000270| W352742704|  Louis Laberge-Lebel|               []|     louislabergelebel|   llabergelebel|           null|\n|                null|               null|3de7BTa8SqwqxbKGK...|   A1000080742|W1487353576|               索天章|               []|                索天章|          索天章|           null|\n|                null|               null|3de7Ax7l3dV7yhpXG...|   A1000156274| W283066368|                 陈超|               []|                  陈超|            陈超|           null|\n|10.1016/0378-4347...|               null|3de7B2i0HCFPr3QGg...|   A1000121904|W2012191692|        Akira Okahira|    [I4210126322]|          akiraokahira|        aokahira|    I4210126322|\n|                null|               null|3de7B0lWMUwrkouXH...|   A1000105016|W1005013278|               任向东|               []|                任向东|          任向东|           null|\n|                null|               null|3de7Bzxvr7Lm5w2LQ...|   A1000304654| W350683705|         GUOZhong-min|               []|           guozhongmin|     guozhongmin|           null|\n|                null|               null|3de7C6gYsQdRtCWFu...|   A1000257685|W1027898510|               熊国青|               []|                熊国青|          熊国青|           null|\n|                null|               null|3de7A854B9GlyorT7...|   A1000299274|W1001364108|            Adam Leja|               []|              adamleja|           aleja|           null|\n|                null|               null|3de7C1PE7fdqxZgh6...|   A1000388655| W990870949| Anna Maria Thranhard|               []|    annamariathranhard|      athranhard|           null|\n|10.1097/ccm.00000...|0000-0002-5558-0503|3de79U4C3X1bmczvq...|    A100035833|W2209056371| Christine Bernsmeier|    [I4210158190]|   christinebernsmeier|     cbernsmeier|    I4210158190|\n|10.3384/diss.diva...|0000-0001-7329-7130|3de7B8whyRIz9XmXM...|    A100042365|W3094129870|    Andreas Skallberg|     [I102134673]|      andreasskallberg|      askallberg|     I102134673|\n|                null|               null|3de7AlrVOAzK4Gfnr...|   A1000465161| W949068214|               张金合|               []|                张金合|          张金合|           null|\n|10.3402/gha.v7.25127|               null|3de7AaIpjf8P0YWeZ...|   A1000616819|W2140286993|           E. Nabakwe|     [I147168166]|              enabakwe|        enabakwe|     I147168166|\n|                null|               null|3de7AO4XIhs3YbEvk...|   A1000698766| W639412675|               施珊珊|               []|                施珊珊|          施珊珊|           null|\n|10.1111/j.1749-66...|               null|3de79huJQzYKfM2xk...|    A100028492|W1993151640|       George Fountos|     [I194019607]|         georgefountos|        gfountos|     I194019607|\n|                null|0000-0003-2600-9276|3de7BiY98kOGKPv0F...|   A1000301072|W2797482304|    Roberto Realfonzo|               []|      robertorealfonzo|      rrealfonzo|           null|\n|                null|               null|3de7AfYPz1jXh0fcs...|   A1000540099|W1265431111|               方基兴|               []|                方基兴|          方基兴|           null|\n|                null|               null|3de7AMpojYDiKITgo...|   A1000303920| W943000088|                 朱训|               []|                  朱训|            朱训|           null|\n|                null|               null|3de7CaD9262WwrMIi...|   A1000880366|W1026086237|        TangRongchang|               []|         tangrongchang|   tangrongchang|           null|\n|10.3923/jas.2011....|               null|3de7B2w2th4XViUGB...|   A1000583025|W2055757218|     A. N. Ilia Anisa|               []|           aniliaanisa|          aanisa|           null|\n|                null|               null|3de7CJtabwMtEerSk...|   A1001083041| W943916419|      Marcin Machocki|     [I126469861]|        marcinmachocki|       mmachocki|     I126469861|\n|                null|               null|3de7BlCV7gGE881rQ...|   A1001208809|W2523697780|  Robert M. Guezuraga|               []|      robertmguezuraga|      rguezuraga|           null|\n|10.1016/j.aquacul...|0000-0002-4888-2677|3de7BSLVyOCMwJmcF...|   A1000995576|W4205824285| Somporn Techangam...|     [I158708052]|  somporntechangams...| stechangamsuwan|     I158708052|\n|                null|               null|3de7C9zxNnY24Zlwy...|   A1000927687|  W11267327|               黄振坤|               []|                黄振坤|          黄振坤|           null|\n|10.2478/v10009-01...|               null|3de7B7n3oaP47Okas...|   A1000744202|W2055906025| Sofia Celewicz-Go...|     [I149592570]|   sofiacelewiczgoldyn| scelewiczgoldyn|     I149592570|\n|                null|               null|3de7B5lVgGxiZQane...|   A1000971999|W1008026652|               韩胜朝|               []|                韩胜朝|          韩胜朝|           null|\n|                null|               null|3de7B7n3oaP47Okas...|   A1000744202|W2569959341| Sofia Celewicz-Go...|    [I3019092743]|   sofiacelewiczgoldyn| scelewiczgoldyn|    I3019092743|\n|    10.20377/jfr-695|0000-0001-6726-6952|3de79yWTuBbsI2Rn8...|   A1000505297|W3201367276|   Katrijn Delaruelle|      [I32597200]|     katrijndelaruelle|     kdelaruelle|      I32597200|\n|                null|               null|3de7BU4wCxI5gVGwf...|   A1001234950| W978151084|               赵光军|               []|                赵光军|          赵光军|           null|\n|                null|               null|3de7AdHqt9UYqLpHZ...|    A100017046|W2896716922|        E. Santovetti|               []|           esantovetti|     esantovetti|           null|\n|                null|               null|3de7CUJt0Pm58lOLA...|   A1001625715| W928577186|               洪松森|               []|                洪松森|          洪松森|           null|\n|10.1109/eurcon.20...|               null|3de7Adf3LBzmy2rFt...|    A100136606|W2121094235|       Mojca Ciglarič|     [I153976015]|         mojcaciglaric|       mciglaric|     I153976015|\n|                null|               null|3de7ANPt2L5ehcs86...|    A100096821|W1182947333|      Herbert Biebach|    [I4210087166]|        herbertbiebach|        hbiebach|    I4210087166|\n|10.1023/a:1009212...|               null|3de7AyDnXbHX4EiMU...|    A100063229| W315907985|          Lars Ödberg|               []|            larsodberg|         lodberg|           null|\n|                null|               null|3de79vDNwtQBdrL1X...|   A1001502467|W1836118110|               Г. Вик|               []|                  гвик|            гвик|           null|\n|10.3891/acta.chem...|               null|3de7ABYgp4JcdoS19...|    A100100232|W2016613380|       Curt R. Enzell|               []|           curtrenzell|         cenzell|           null|\n|10.1007/s12026-00...|               null|3de7AE3sU7e1s4LXF...|    A100104968|W1968382194|        Sarah Marktel|               []|          sarahmarktel|        smarktel|           null|\n|                null|               null|3de7AZ5TiwHgTd6OE...|   A1001497843|W1004717278|               洪鹏花|               []|                洪鹏花|          洪鹏花|           null|\n|                null|               null|3de7Av9PrTgSblpxB...|   A1001001643|W1043315773|                 谢丹|               []|                  谢丹|            谢丹|           null|\n|                null|               null|3de7Bzx9fRG04KaD4...|   A1001234734|W1040617024|               崔华东|               []|                崔华东|          崔华东|           null|\n|                null|               null|3de7BVVM3TLUW7RTD...|   A1001176712|W1031393699|               吴文学|               []|                吴文学|          吴文学|           null|\n|                null|               null|3de7By4N7Gx7AitG6...|   A1001746050|W1044507178|               王汝智|               []|                王汝智|          王汝智|           null|\n|                null|               null|3de79ueIKW5NXoW0p...|   A1002204015|W1429375700|スコット ジョンストン|               []|スコットジョンストン|スジョンストン|           null|\n|10.4018/978-1-522...|               null|3de7Bq1xPTkmkg2R0...|    A100083570|W2499335437|  Philipp Sonnleitner|     [I186903577]|    philippsonnleitner|    psonnleitner|     I186903577|\n|                null|               null|3de7BjZPglGPJorpP...|   A1001288121| W950935388|             芹沢博美|               []|              芹沢博美|        芹沢博美|           null|\n|10.1002/pola.1992...|               null|3de7A9UhNDRInYeq6...|    A100113190|W2013567464|         Reza Arshady|      [I47508984]|           rezaarshady|        rarshady|      I47508984|\n|                null|               null|3de7AMxiEL4GlqR59...|   A1001271393| W892154282|               金前文|               []|                金前文|          金前文|           null|\n|                null|               null|3de7BJF6o4pvMLjzj...|   A1001321173|W1462997995|               陈善志|               []|                陈善志|          陈善志|           null|\n|                null|0000-0002-4445-654X|3de7AlnVXcEaqPnAd...|    A100047927|W2728424289|         Jim Deuchars|               []|           jimdeuchars|       jdeuchars|           null|\n|                null|               null|3de7A9CTNssYvWMXk...|   A1001843350|W1136826847|               赵静一|               []|                赵静一|          赵静一|           null|\n+--------------------+-------------------+--------------------+--------------+-----------+---------------------+-----------------+----------------------+----------------+---------------+\nonly showing top 50 rows\n\nOA_S2_acm_signatures:7351515\nOA_S2_acm_signatures_dedup:6623436\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.types._\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34mfile\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /report1.txt\n\u001b[1m\u001b[34macm_data_schema\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = {\"type\":\"struct\",\"fields\":[{\"name\":\"acm_doi\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"acm_author_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"person_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"acm_institution_id\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"acm_author_name\",\"type\":\"string\",\"nullable\"...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\n//val OA_S2_acm_signatures = spark.read\n  //      .parquet(s\"file://$path/OA_S2_acm_signatures.parquet\")\n\n\nval w = Window.partitionBy($\"OAdoi\", $\"OAauthorId\").orderBy( lit(1) - ($\"orcid\" === $\"acm_orcid\").cast(\"integer\"), levenshtein($\"OAnormName\", $\"acm_normname\") , lit(1) - (soundex($\"acm_normname\") === soundex($\"OAnormName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"acm_normname\", $\"OAnormName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA_S2_acm_signatures_dedup = OA_S2_acm_signatures.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\").cache()\n\nOA_S2_acm_signatures_dedup.write.mode(\"overwrite\").parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\n\nprintln(\"OA_S2_acm_signatures_dedup:\" + OA_S2_acm_signatures_dedup.count())",
   "id": "",
   "dateCreated": "2023-03-06 13:58:16.951",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-03-06 14:03:58.090",
   "dateUpdated": "2023-03-06 14:04:30.937",
   "dateFinished": "2023-03-06 14:04:30.937",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "OA_S2_acm_signatures_dedup:6942999\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@9a3368d\n\u001b[1m\u001b[34mOA_S2_acm_signatures_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 18 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\nval acm_claimed_profiles =   spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).csv(s\"file://$path/claimed_profiles_report.tsv\")\nacm_claimed_profiles.printSchema()\n\nprintln(\"acm_claimed_profiles count: \" + acm_claimed_profiles.count())",
   "id": "",
   "dateCreated": "2023-03-06 15:10:43.604",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-03-06 15:11:53.084",
   "dateUpdated": "2023-03-06 15:11:53.464",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- profile_id: string (nullable = true)\n |-- client_id: string (nullable = true)\n\nacm_claimed_profiles count: 28192\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34macm_claimed_profiles\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [profile_id: string, client_id: string]\n"
     }
    ]
   },
   "dateFinished": "2023-03-06 15:11:53.464"
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n\nval OA_S2_acm_signatures_dedup_all =   spark.read    \n.parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\n.withColumn(\"oaAffiliationsId\", element_at($\"affiliationsIds\", 1))\n\n//val pkg_acm_signatures_dedup_all =   spark.read    \n//.parquet(s\"file://$path/pkg_acm_signatures_dedup.parquet\")\n  \n//val  OA_S2_pkg_acm_signatures_dedup_all = OA_S2_acm_signatures_dedup_all.join(pkg_acm_signatures_dedup_all, )\n \nprintln(\"non resolved acm_author signatures :\" + OA_S2_acm_signatures_dedup_all.filter($\"acm_author_id\".isNull).count())\nprintln(\"non resolved insitutions signatures :\" + OA_S2_acm_signatures_dedup_all.filter($\"acm_institution_id\".isNull).count())\nprintln(\"non resolved insitutions signatures :\" + OA_S2_acm_signatures_dedup_all.filter($\"oaAffiliationsId\".isNull).count())\n\nval OA_S2_acm_signatures_dedup = OA_S2_acm_signatures_dedup_all.filter($\"acm_author_id\".isNotNull)\nOA_S2_acm_signatures_dedup.printSchema()\n\nval acm_claimed_profiles =   spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).csv(s\"file://$path/claimed_profiles_report.tsv\")\n//acm_claimed_profiles.printSchema()\nprintln(\"acm_claimed_profiles count: \" + acm_claimed_profiles.count())\n\nval OA_S2_acm_signatures_dedup_claimed = OA_S2_acm_signatures_dedup.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" )\n\n/*\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n\npath: String = /media/ometaxas/nvme/datasets/ACM\nOA_S2_acm_signatures_dedup: org.apache.spark.sql.DataFrame = [OApaperId: string, OAdoi: string ... 18 more fields]\n */\n\n\nprintln(\"OA_S2_acm_signatures_dedup count: \" + OA_S2_acm_signatures_dedup.count())\nprintln(\"OAdois:\" + OA_S2_acm_signatures_dedup.select( $\"OAdoi\").distinct().count())\nprintln(\"acm_author_ids:\" + OA_S2_acm_signatures_dedup.select( $\"acm_author_id\").distinct().count())\n//println(\"PKGauthorIds:\" + OA_S2_acm_signatures_dedup.select( $\"pkgAuthorId\").distinct().count())\nprintln(\"OAauthorIds:\" + OA_S2_acm_signatures_dedup.select( $\"OAauthorId\").distinct().count())\n\nprintln(\"S2authorIds:\" + OA_S2_acm_signatures_dedup.select( $\"S2authorId\").distinct().count())\nprintln(\"acm_orcid:\" + OA_S2_acm_signatures_dedup.select( $\"acm_orcid\").distinct().count())\nprintln(\"orcid:\" + OA_S2_acm_signatures_dedup.select( $\"orcid\").distinct().count())\n\n\nprintln(\"affiliationsIds:\" + OA_S2_acm_signatures_dedup.select( $\"oaAffiliationsId\").distinct().count())\nprintln(\"acm_institution_id:\" + OA_S2_acm_signatures_dedup.select( $\"acm_institution_id\").distinct().count())\n\nprintln(\"OA_S2_acm_signatures_dedup_claimed count: \" + OA_S2_acm_signatures_dedup_claimed.count())\nprintln(\"claimed OAdois:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"OAdoi\").distinct().count())\nprintln(\"claimed acm_author_ids:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"acm_author_id\").distinct().count())\n//println(\"claimed pkgAuthorIds:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"pkgAuthorId\").distinct().count())\nprintln(\"claimed OAauthorIds:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"OAauthorId\").distinct().count())\nprintln(\"claimed S2authorIds:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"S2authorId\").distinct().count())\nprintln(\"claimed acm_orcid:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"acm_orcid\").distinct().count())\nprintln(\"claimed orcid:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"orcid\").distinct().count())\n\n\n/*\n\nOA_S2_acm_signatures_dedup count: 6942999\nOAdois:2366049\nacm_author_ids:2499558\nOAauthorIds:1862432\nS2authorIds:2001504\nacm_orcid:163281\norcid:439879\naffiliationsIds:66855\nacm_institution_id:26504\n */\n \n//.select( $\"OApaperId\", $\"OAdoi\", $\"OAfos_0\", $\"OAfos_1\", $\"OAmagId\", $\"OAname\", $\"OAauthorId\",$\"orcid\",$\"OAshortNormName\",$\"OAnormName\",$\"affiliationsIds\", $\"coAuthorId\"\n\n//analyze 1-1 & 1-many matches & compute parity profile count\nval pkgPerAcm =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\")                \n                .agg(\n                 countDistinct(\"OAauthorId\").as(\"OAauthorCnt\")\n                ,count(\"OAdoi\").as(\"acmAuthorPubCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAauthorId\")).as(\"OAauthorIds\"))\n                \n println(\"pkgPerAcm count: \" + pkgPerAcm.count())\n println(\"pkgPerAcm count 1-1: \" + pkgPerAcm.filter($\"OAauthorCnt\"===1).count())\n \n println(\"pkgPerAcm claimed profiles count: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).count())\n println(\"pkgPerAcm claimed profiles count 1-1: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"OAauthorCnt\"===1).count())\n  \n pkgPerAcm.orderBy($\"OAauthorCnt\" desc).show(20)\n \n \nval acmPerPkg =  OA_S2_acm_signatures_dedup.\n  groupBy($\"OAauthorId\")                \n                .agg(countDistinct(\"acm_author_id\").as(\"ACMauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"acm_author_id\")).as(\"acm_author_ids\")\n                ,count(\"OAdoi\").as(\"OAauthorPubCnt\")                \n                \n                )\n                \nprintln(\"acmPerPkg count: \" + acmPerPkg.count())\nprintln(\"acmPerPkg count 1-1: \" + acmPerPkg.filter($\"ACMauthorCnt\"===1).count())\n\n//println(\"acmPerPkg claimed profiles count: \" + acmPerPkg.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).count())\n//println(\"acmPerPkg claimed profiles count 1-1: \" + acmPerPkg.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ACMauthorCnt\"===1).count())\n\nacmPerPkg.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n/*\npkgPerAcm count: 2499558\npkgPerAcm count 1-1: 1717769\nacmPerPkg count: 1862432\nacmPerPkg count 1-1: 1144305\n*/\n/*\n val pkgPerAcm_claimed =  OA_S2_acm_signatures_dedup_claimed.\n  groupBy($\"acm_author_id\")                \n                .agg(countDistinct(\"OAauthorId\").as(\"OAauthorCnt\")\n                ,count(\"OAdoi\").as(\"acmAuthorPubCnt\")\n                //, collect_list(S2_MAG_df(\"OAauthorId\")).as(\"OAauthorIds\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAauthorId\")).as(\"OAauthorIds\"))\n                \n println(\"claimed pkgPerAcm count: \" + pkgPerAcm_claimed.count())\n println(\"clamed pkgPerAcm count 1-1: \" + pkgPerAcm_claimed.filter($\"OAauthorCnt\"===1).count())\n */\n \n//Find best match & compute similarity\nval acm2pkg =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\", $\"OAauthorId\")                \n                .agg(count(\"OAdoi\").as(\"commonPubCnt\"))\n                \nval w = Window.partitionBy($\"acm_author_id\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval acm2pkg_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"acm2pkg_bestMatch count: \" + acm2pkg_bestMatch.count())\n\nacm2pkg_bestMatch.printSchema()\npkgPerAcm.printSchema()\nacmPerPkg.printSchema()\nacm2pkg_bestMatch.show(20)\n\nval acm2pkg_bestMatch_ext = acm2pkg_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === acm2pkg_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"OAauthorId\") === acm2pkg_bestMatch(\"OAauthorId\"), \"inner\")\n.select(acm2pkg_bestMatch(\"acm_author_id\"), acm2pkg_bestMatch(\"OAauthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")   \n            .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n            .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n            .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \n               \n println(\"acm2pkg_bestMatch_ext count: \" + acm2pkg_bestMatch_ext.count())\n acm2pkg_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n acm2pkg_bestMatch_ext.show(20)            \n acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).show(20)\n //acm2pkg_bestMatch_ext.printSchema()                 \n\n//////////////////////////////////\n\n//Find best match & compute similarity\n\nval w1 = Window.partitionBy($\"OAauthorId\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval pkg2acm_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w1))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"pkg2acm_bestMatch count: \" + pkg2acm_bestMatch.count())\n//pkg2acm_bestMatch.printSchema()\n//pkg2acm_bestMatch.show(20)\n\n\nval pkg2acm_bestMatch_ext = pkg2acm_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === pkg2acm_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"OAauthorId\") === pkg2acm_bestMatch(\"OAauthorId\"), \"inner\")\n.select(pkg2acm_bestMatch(\"acm_author_id\"), pkg2acm_bestMatch(\"OAauthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")\n           .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n           .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n           .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \nprintln(\"pkg2acm_bestMatch_ext count: \" + pkg2acm_bestMatch_ext.count())\npkg2acm_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\npkg2acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n",
   "id": "",
   "dateCreated": "2023-03-03 20:08:02.966",
   "config": {
    "title": true,
    "tableHide": true,
    "editorHide": false
   },
   "title": "Analyze ACM - OA new Matching",
   "dateStarted": "2023-03-14 15:17:00.953",
   "dateUpdated": "2023-03-14 15:17:56.882",
   "dateFinished": "2023-03-14 15:17:56.882",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mfour feature warnings; for details, enable `:setting -feature' or `:replay -feature'\nnon resolved acm_author signatures :66838\nnon resolved insitutions signatures :1941905\nnon resolved insitutions signatures :1149578\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n |-- oaAffiliationsId: string (nullable = true)\n\nacm_claimed_profiles count: 28192\nOA_S2_acm_signatures_dedup count: 6876161\nOAdois:2303539\nacm_author_ids:2499557\nOAauthorIds:1847167\nS2authorIds:1984504\nacm_orcid:156683\norcid:436503\naffiliationsIds:37089\nacm_institution_id:26504\nOA_S2_acm_signatures_dedup_claimed count: 490124\nclaimed OAdois:372338\nclaimed acm_author_ids:26657\nclaimed OAauthorIds:40384\nclaimed S2authorIds:34208\nclaimed acm_orcid:6802\nclaimed orcid:13267\npkgPerAcm count: 2499557\npkgPerAcm count 1-1: 2314637\npkgPerAcm claimed profiles count: 26740\npkgPerAcm claimed profiles count 1-1: 18425\n+--------------------+-----------+---------------+--------------------+--------------------+\n|       acm_author_id|OAauthorCnt|acmAuthorPubCnt|        oaAuthorName|         OAauthorIds|\n+--------------------+-----------+---------------+--------------------+--------------------+\n|10.1145/contrib-8...|        116|            122|[Michalopoulos, D...|[A4268686004, A42...|\n|10.1145/contrib-9...|         89|             89|[Security and Com...|[A4309879400, A43...|\n|10.1145/contrib-8...|         86|            143|[T. S. Perry, T.S...|[A2974517177, A21...|\n|10.1145/contrib-8...|         70|             84|[G. Zorpette, Gle...|[A2974648614, A29...|\n|10.1145/contrib-8...|         70|             99|[L D Paulson, L.D...|[A2974008438, A29...|\n|10.1145/contrib-8...|         67|            291|[Lin-Qiang Chen, ...|[A2106043476, A21...|\n|10.1145/contrib-8...|         65|             72|[P. Green, Paul J...|[A4272320290, A25...|\n|10.1145/contrib-8...|         58|            188|[Jiunn-Yuan Lin, ...|[A2143061599, A21...|\n|10.1145/contrib-8...|         57|             70|[G.S. Axelby, Geo...|[A4208313011, A29...|\n|10.1145/contrib-8...|         51|             62|[S.M. Cherry, Ste...|[A2606043337, A29...|\n|10.1145/contrib-8...|         51|             86|[R.W. Lucky, R. W...|[A2973422904, A26...|\n|10.1145/contrib-8...|         43|             59|[Richard Comerfor...|[A2974327310, A29...|\n|10.1145/contrib-9...|         41|             41|[Wireless Communi...|[A4317709534, A43...|\n|10.1145/contrib-8...|         40|             52|        [B. Colwell]|[A2974467257, A29...|\n|10.1145/contrib-8...|         40|             52|[L. Geppert, Lind...|[A3034346294, A27...|\n|10.1145/contrib-8...|         39|             41|[A. M. McKenzie, ...|[A4212533942, A29...|\n|10.1145/contrib-8...|         39|             53|[R H Stern, Richa...|[A2973293772, A29...|\n|10.1145/contrib-8...|         39|             71|[F. Kamareddine, ...|[A4212363971, A42...|\n|10.1145/contrib-8...|         36|             43|[N.K. Bose, N. K....|[A4275430895, A42...|\n|10.1145/contrib-8...|         36|             36|[P.A. Kidwell, P....|[A2572315978, A29...|\n+--------------------+-----------+---------------+--------------------+--------------------+\nonly showing top 20 rows\n\nacmPerPkg count: 1847167\nacmPerPkg count 1-1: 1570406\n+-----------+------------+------------+--------------------+--------------+\n| OAauthorId|ACMauthorCnt|oaAuthorName|      acm_author_ids|OAauthorPubCnt|\n+-----------+------------+------------+--------------------+--------------+\n|A2240993880|        1476| [Jing Wang]|[10.1145/contrib-...|          1935|\n|A2244066162|        1473|  [Wei Wang]|[10.1145/contrib-...|          2109|\n|A2625744659|        1147|    [Yan Li]|[10.1145/contrib-...|          1513|\n|A2608928330|        1142| [Wei Zhang]|[10.1145/contrib-...|          1656|\n|A2777773917|        1027|    [Xin Li]|[10.1145/contrib-...|          1697|\n|A2776297621|        1017|  [Yang Liu]|[10.1145/contrib-...|          1489|\n|A2299437103|         952| [Lei Zhang]|[10.1145/contrib-...|          1539|\n|A2296726285|         934| [Yang Yang]|[10.1145/contrib-...|          1420|\n|A2603303308|         844| [Jian Yang]|[10.1145/contrib-...|          1317|\n|A2559461216|         836|   [Yu Wang]|[10.1145/contrib-...|          1196|\n|A2722169877|         818|  [Lei Wang]|[10.1145/contrib-...|          1065|\n|A3179542944|         788| [Jie Zhang]|[10.1145/contrib-...|          1180|\n|A2947008211|         785|  [Jun Wang]|[10.1145/contrib-...|          1203|\n|A2605572716|         767|    [Wei Li]|[10.1145/contrib-...|          1302|\n|A2701680931|         739|  [Yu Zhang]|[10.1145/contrib-...|           963|\n|A2506556770|         726|  [Xin Wang]|[10.1145/contrib-...|          1050|\n|A2922890431|         687|   [Li Wang]|[10.1145/contrib-...|           911|\n|A2949544653|         675|    [Hui Li]|[10.1145/contrib-...|           974|\n|A2502348156|         669|   [Jing Li]|[10.1145/contrib-...|           880|\n|A2256822898|         668| [Yan Zhang]|[10.1145/contrib-...|           916|\n+-----------+------------+------------+--------------------+--------------+\nonly showing top 20 rows\n\nacm2pkg_bestMatch count: 2499557\nroot\n |-- acm_author_id: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- commonPubCnt: long (nullable = false)\n\nroot\n |-- acm_author_id: string (nullable = true)\n |-- OAauthorCnt: long (nullable = false)\n |-- acmAuthorPubCnt: long (nullable = false)\n |-- oaAuthorName: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- OAauthorIds: array (nullable = false)\n |    |-- element: string (containsNull = false)\n\nroot\n |-- OAauthorId: string (nullable = true)\n |-- ACMauthorCnt: long (nullable = false)\n |-- oaAuthorName: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- acm_author_ids: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- OAauthorPubCnt: long (nullable = false)\n\n+--------------------+-----------+------------+\n|       acm_author_id| OAauthorId|commonPubCnt|\n+--------------------+-----------+------------+\n|10.1145/contrib-6...|A2344196465|           1|\n|10.1145/contrib-6...|A2532874717|           1|\n|10.1145/contrib-6...|A2046422333|           1|\n|10.1145/contrib-6...|A2911586015|           1|\n|10.1145/contrib-6...|A2294939611|           1|\n|10.1145/contrib-6...|A2276885486|           1|\n|10.1145/contrib-6...| A208357118|           1|\n|10.1145/contrib-6...|A2557016250|           4|\n|10.1145/contrib-6...|A2160899197|           1|\n|10.1145/contrib-8...|A2283952395|           1|\n|10.1145/contrib-8...|A1269691488|           5|\n|10.1145/contrib-8...|A2171035489|           2|\n|10.1145/contrib-8...|A2137801315|          20|\n|10.1145/contrib-8...|A2134171778|           5|\n|10.1145/contrib-8...|A2013331985|           5|\n|10.1145/contrib-8...|A2722589805|           1|\n|10.1145/contrib-8...|A2335502756|           3|\n|10.1145/contrib-8...|A2065936274|           3|\n|10.1145/contrib-8...|A2672646741|           1|\n|10.1145/contrib-8...|A2135979450|           1|\n+--------------------+-----------+------------+\nonly showing top 20 rows\n\nacm2pkg_bestMatch_ext count: 2499557\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.9766350764553843|     0.6529627504108183| 0.6357656883469271|\n+--------------------------+-----------------------+-------------------+\n\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.9488201600352246|     0.8484697851454143|  0.808564345829074|\n+--------------------------+-----------------------+-------------------+\n\n+--------------------+-----------+------------+---------------+--------------+---------------------+--------------------+--------------------+\n|       acm_author_id| OAauthorId|commonPubCnt|acmAuthorPubCnt|OAauthorPubCnt|ParityProfileCoverage|  PKGProfileCoverage|      jaccSimilarity|\n+--------------------+-----------+------------+---------------+--------------+---------------------+--------------------+--------------------+\n|10.1145/contrib-9...| A100146559|           1|              1|             1|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...|  A10029226|           5|              5|             5|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...| A100317766|           5|              5|             5|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...|A1009445038|           1|              1|             2|                  1.0|                 0.5|                 0.5|\n|10.1145/contrib-8...|A1009445038|           1|              1|             2|                  1.0|                 0.5|                 0.5|\n|10.1145/contrib-8...| A100988613|          64|             66|            70|   0.9696969696969697|  0.9142857142857143|  0.8888888888888888|\n|10.1145/contrib-9...| A100988613|           1|              1|            70|                  1.0|0.014285714285714285|0.014285714285714285|\n|10.1145/contrib-8...| A100988613|           3|              3|            70|                  1.0| 0.04285714285714286| 0.04285714285714286|\n|10.1145/contrib-9...| A100988613|           1|              1|            70|                  1.0|0.014285714285714285|0.014285714285714285|\n|10.1145/contrib-9...| A100988613|           1|              1|            70|                  1.0|0.014285714285714285|0.014285714285714285|\n|10.1145/contrib-9...|A1010707176|           1|              1|             1|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-9...| A101280830|           1|              1|             1|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...|A1012990301|           1|              1|             1|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...|A1013771555|           4|              4|             4|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...| A101476115|           1|              1|             1|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...| A101555852|           5|              6|             5|   0.8333333333333334|                 1.0|  0.8333333333333334|\n|10.1145/contrib-9...| A101614095|           1|              1|             1|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...| A101731620|           1|              1|             1|                  1.0|                 1.0|                 1.0|\n|10.1145/contrib-8...|A1018956698|           1|              1|             2|                  1.0|                 0.5|                 0.5|\n|10.1145/contrib-8...|A1018956698|           1|              1|             2|                  1.0|                 0.5|                 0.5|\n+--------------------+-----------+------------+---------------+--------------+---------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n+--------------------+-----------+------------+---------------+--------------+---------------------+-------------------+-------------------+--------------------+---------+\n|       acm_author_id| OAauthorId|commonPubCnt|acmAuthorPubCnt|OAauthorPubCnt|ParityProfileCoverage| PKGProfileCoverage|     jaccSimilarity|          profile_id|client_id|\n+--------------------+-----------+------------+---------------+--------------+---------------------+-------------------+-------------------+--------------------+---------+\n|10.1145/contrib-8...|A1056766277|          14|             15|            19|   0.9333333333333333| 0.7368421052631579|                0.7|10.1145/contrib-8...|  7317886|\n|10.1145/contrib-8...| A110314473|          26|             26|            26|                  1.0|                1.0|                1.0|10.1145/contrib-8...|  1712189|\n|10.1145/contrib-8...|A1121013121|          62|             63|            69|   0.9841269841269841| 0.8985507246376812| 0.8857142857142857|10.1145/contrib-8...|  9051784|\n|10.1145/contrib-8...|A1132879003|          13|             13|            13|                  1.0|                1.0|                1.0|10.1145/contrib-8...|  7538426|\n|10.1145/contrib-8...|A1136538269|           8|              8|             8|                  1.0|                1.0|                1.0|10.1145/contrib-8...|  1366458|\n|10.1145/contrib-8...| A117189672|          61|             63|            63|   0.9682539682539683| 0.9682539682539683| 0.9384615384615385|10.1145/contrib-8...|  7358549|\n|10.1145/contrib-8...|A1185234378|         110|            110|           111|                  1.0|  0.990990990990991|  0.990990990990991|10.1145/contrib-8...|   398362|\n|10.1145/contrib-8...|A1211614141|           2|              2|             3|                  1.0| 0.6666666666666666| 0.6666666666666666|10.1145/contrib-8...|  8360301|\n|10.1145/contrib-8...|A1246036369|          24|             32|            24|                 0.75|                1.0|               0.75|10.1145/contrib-8...|  9390077|\n|10.1145/contrib-8...| A142539024|          21|             21|            21|                  1.0|                1.0|                1.0|10.1145/contrib-8...|   987204|\n|10.1145/contrib-8...| A149061795|          33|             33|            33|                  1.0|                1.0|                1.0|10.1145/contrib-8...|  2738987|\n|10.1145/contrib-8...|A1541521638|          11|             14|            11|   0.7857142857142857|                1.0| 0.7857142857142857|10.1145/contrib-8...|  2010497|\n|10.1145/contrib-8...|  A17371083|          33|             34|            33|   0.9705882352941176|                1.0| 0.9705882352941176|10.1145/contrib-8...|  9481432|\n|10.1145/contrib-8...|A1770354363|          58|             58|            63|                  1.0| 0.9206349206349206| 0.9206349206349206|10.1145/contrib-8...|  7886695|\n|10.1145/contrib-8...|A1827031538|           9|             10|             9|                  0.9|                1.0|                0.9|10.1145/contrib-8...|  7726355|\n|10.1145/contrib-9...|  A18301080|          19|             19|            19|                  1.0|                1.0|                1.0|10.1145/contrib-9...|  7659578|\n|10.1145/contrib-8...|A1848648917|           1|              1|             1|                  1.0|                1.0|                1.0|10.1145/contrib-8...|  4421635|\n|10.1145/contrib-9...|A1851102623|           4|              4|             4|                  1.0|                1.0|                1.0|10.1145/contrib-9...|  7174846|\n|10.1145/contrib-8...|A1893993886|          59|             60|            65|   0.9833333333333333| 0.9076923076923077| 0.8939393939393939|10.1145/contrib-8...|  5296026|\n|10.1145/contrib-9...|A1893993886|           5|              5|            65|                  1.0|0.07692307692307693|0.07692307692307693|10.1145/contrib-9...|  9384347|\n+--------------------+-----------+------------+---------------+--------------+---------------------+-------------------+-------------------+--------------------+---------+\nonly showing top 20 rows\n\npkg2acm_bestMatch count: 1847167\npkg2acm_bestMatch_ext count: 1847167\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.8836585474461389|     0.9374811050165198| 0.8269150598418061|\n+--------------------------+-----------------------+-------------------+\n\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|         0.648451864798833|     0.9405485350554371| 0.6037402688592285|\n+--------------------------+-----------------------+-------------------+\n\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34mOA_S2_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 19 more fields]\n\u001b[1m\u001b[34mOA_S2_acm_signatures_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 19 more fields]\n\u001b[1m\u001b[34macm_claimed_profiles\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [profile_id: string, client_id: string]\n\u001b[1m\u001b[34mOA_S2_acm_signatures_dedup_claimed\u001b[0m: \u001b[1m\u001b[32mor...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n\nval OA_S2_acm_signatures_dedup_all =   spark.read    \n.parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\n.filter($\"acm_author_id\".isNotNull)\n\nOA_S2_acm_signatures_dedup_all.printSchema()\n\nval pkg_acm_signatures_dedup_all =   spark.read    \n.parquet(s\"file://$path/pkg_acm_signatures_dedup.parquet\")\n.filter($\"acm_author_id\".isNotNull)\n.select($\"acm_doi\".as(\"pkg_acm_doi\"), $\"pkgAuthorId\", $\"acm_author_id\".as(\"pkg_acm_author_id\"), $\"oaAffiliationId\".as(\"pkgAffiliationId\"))\n\npkg_acm_signatures_dedup_all.printSchema()\n\nprintln(\"OA_S2_acm_signatures_dedup_all :\" + OA_S2_acm_signatures_dedup_all.count())\nprintln(\"pkg_acm_signatures_dedup_all :\" + pkg_acm_signatures_dedup_all.count())\n\n\n//println(\"non resolved insitutions signatures :\" + OA_S2_acm_signatures_dedup_all.filter($\"oaAffiliationsId\".isNull).count())\n\n\nval pkg_OA_S2_acm_signatures_dedup_all = OA_S2_acm_signatures_dedup_all.join(pkg_acm_signatures_dedup_all, $\"pkg_acm_doi\" === $\"acm_doi\" && $\"acm_author_id\" === $\"pkg_acm_author_id\", \"leftouter\")\n.withColumn(\"pkgAuthorId\", concat($\"OAauthorId\", $\"pkgAuthorId\"  ))\n.drop($\"pkg_acm_author_id\")\n.drop($\"pkg_acm_doi\")\n\npkg_OA_S2_acm_signatures_dedup_all.show(20)\npkg_OA_S2_acm_signatures_dedup_all.printSchema()\n\nprintln(\"pkg_OA_S2_acm_signatures_dedup_all :\" + pkg_OA_S2_acm_signatures_dedup_all.count())\nprintln(\"pkg_acm_signatures_dedup_all :\" + pkg_OA_S2_acm_signatures_dedup_all.filter($\"pkgAuthorId\".isNotNull).count())\n",
   "id": "",
   "dateCreated": "2023-03-14 16:34:12.265",
   "config": {
    "editorHide": false,
    "tableHide": true
   },
   "dateStarted": "2023-03-15 15:13:42.602",
   "dateUpdated": "2023-03-15 15:13:51.899",
   "dateFinished": "2023-03-15 15:13:51.899",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n\nroot\n |-- pkg_acm_doi: string (nullable = true)\n |-- pkgAuthorId: string (nullable = true)\n |-- pkg_acm_author_id: string (nullable = true)\n |-- pkgAffiliationId: string (nullable = true)\n\nOA_S2_acm_signatures_dedup_all :6876161\npkg_acm_signatures_dedup_all :6560233\n+-----------+----------------+--------------------+-----------+-------------------+---------------+-----------------+--------------------+----------------------+----------+----------------+---------+----------+----------------+--------------------+--------------------+--------------------+--------------------+-----------------+-----------------+--------------------+----------------+\n|  OApaperId|           OAdoi|              OAname| OAauthorId|              orcid|OAshortNormName|       OAnormName|     affiliationsIds|coAuthorShortNormNames|S2authorId|           S2doi|S2paperId|S2normName|         acm_doi|           acm_orcid|       acm_author_id|  acm_institution_id|     acm_author_name|     acm_normname|acm_shortnormname|         pkgAuthorId|pkgAffiliationId|\n+-----------+----------------+--------------------+-----------+-------------------+---------------+-----------------+--------------------+----------------------+----------+----------------+---------+----------+----------------+--------------------+--------------------+--------------------+--------------------+-----------------+-----------------+--------------------+----------------+\n|W1997304384|10.1002/acs.1080|      Miroslav Kárný|A2038962917|0000-0002-7440-6041|         mkarny|    miroslavkarny|       [I4210119419]|   [mkarny, jandrysek]|   1762026|10.1002/acs.1080| 15748089|    mkarny|10.1002/acs.1080|                null|10.1145/contrib-8...|10.1145/instituti...|      Miroslav Kárný|    miroslavkarny|           mkarny|A20389629173de79x...|     I4210119419|\n|W1952620941|10.1002/acs.2326|           Cong Wang|A2297773618|0000-0003-0590-372X|          cwang|         congwang|         [I90610280]|        [tchen, cwang]|2116637835|10.1002/acs.2326| 10468910|  congwang|10.1002/acs.2326|                null|10.1145/contrib-9...|10.1145/instituti...|           Cong Wang|         congwang|            cwang|A22977736183de7Bz...|       I90610280|\n|W1934614089|10.1002/acs.2642|         Xuehai Wang|A2568159938|0000-0002-8723-7339|          xwang|       xuehaiwang|[I111599522, I421...|        [xwang, fding]|2000360287|10.1002/acs.2642|120674489|xuehaiwang|10.1002/acs.2642|                null|10.1145/contrib-9...|                null|         Xuehai Wang|       xuehaiwang|            xwang|A25681599383de7At...|      I111599522|\n|W2264177572|10.1002/acs.2649|          José Ragot|A2562987597|0000-0002-0114-5303|         jragot|        joseragot|       [I1294671590]|  [sbezzaoucha, bma...|  29988034|10.1002/acs.2649| 40045072|    jragot|10.1002/acs.2649|                null|10.1145/contrib-8...|                null|          José Ragot|        joseragot|           jragot|A25629875973de7BS...|     I1294671590|\n|W2283656744|10.1002/acs.2651|      Maria M. Seron|A2103463679|               null|         mseron|      mariamseron|       [I4210140143]|  [fsuryawan, jdona...|  97754137|10.1002/acs.2651|124795639|    mseron|10.1002/acs.2651|                null|10.1145/contrib-8...|10.1145/instituti...|         María Seron|       mariaseron|           mseron|A21034636793de7A6...|     I4210140143|\n|W2283656744|10.1002/acs.2651|     José A. De Doná| A497945216|0000-0002-6880-3227|          jdona|      joseadedona|       [I4210140143]|  [fsuryawan, jdona...|  34914691|10.1002/acs.2651|124795639|   jdedona|10.1002/acs.2651|                null|10.1145/contrib-8...|10.1145/instituti...|        José De Doná|       josededona|            jdona|A4979452163de7ApM...|     I4210140143|\n|W2531569435|10.1002/acs.2673|   Giovanni Indiveri|A2057282126|0000-0001-8683-2948|      gindiveri| giovanniindiveri|              [null]|   [dpalma, gindiveri]|   2429730|10.1002/acs.2673|125247625| gindiveri|10.1002/acs.2673|                null|10.1145/contrib-8...|10.1145/instituti...|   Giovanni Indiveri| giovanniindiveri|        gindiveri|A20572821263de7B7...|            null|\n|W2340448819|10.1002/acs.2679|       Mario Sassano|A2033349570|0000-0003-4525-4656|       msassano|     mariosassano|        [I116067653]|  [dcarnevale, sgal...|   1764871|10.1002/acs.2679|124978934|  msassano|10.1002/acs.2679|                null|10.1145/contrib-8...|10.1145/instituti...|          M. Sassano|         msassano|         msassano|A20333495703de79x...|      I116067653|\n|W2467779649|10.1002/acs.2697|       Antonio Loria|A2028427859|0000-0003-4223-9397|         aloria|     antonioloria|       [I1300957399]|  [dlopezaraujo, al...| 145565797|10.1002/acs.2697| 63832455|    aloria|10.1002/acs.2697|                null|10.1145/contrib-8...|10.1145/instituti...|       Antonio Loría|     antonioloria|           aloria|A20284278593de7AN...|     I1300957399|\n|W2526548677|10.1002/acs.2736|         G. Nagamani| A358196035|0000-0002-6405-2235|      gnagamani|        gnagamani|        [I880551032]|  [sramasamy, gnaga...| 144263429|10.1002/acs.2736|126201634| gnagamani|10.1002/acs.2736|                null|10.1145/contrib-8...|10.1145/instituti...|         G. Nagamani|        gnagamani|        gnagamani|A3581960353de7B22...|      I880551032|\n|W2547585821|10.1002/acs.2737|         Zhi-Jie Liu|A2141606802|0000-0001-7279-2893|           zliu|        zhijieliu|         [I82880672]|           [zliu, whe]|  49293094|10.1002/acs.2737|125521405| zhijieliu|10.1002/acs.2737|                null|10.1145/contrib-9...|10.1145/instituti...|          Zhijie Liu|        zhijieliu|             zliu|                null|            null|\n|W2619181799|10.1002/acs.2789|       Xiaohong Jiao|A2109818146|0000-0001-7276-6062|          xjiao|     xiaohongjiao|         [I39333907]|        [mfeng, xjiao]|   2643613|10.1002/acs.2789|113484508|     xjiao|10.1002/acs.2789|                null|10.1145/contrib-9...|10.1145/instituti...|       Xiaohong Jiao|     xiaohongjiao|            xjiao|A21098181463de7B8...|       I39333907|\n|W2794278984|10.1002/acs.2861|            Peng Yao|A2306134833|0000-0002-6188-0422|           pyao|          pengyao|              [null]|    [pyao, gliu, yliu]|2099667684|10.1002/acs.2861|125776222|   pengyao|10.1002/acs.2861|http://orcid.org/...|10.1145/contrib-9...|10.1145/instituti...|            Peng Yao|          pengyao|             pyao|                null|            null|\n|W2789380718|10.1002/acs.2864|           X. Q. Hao|A2128257881|               null|           xhao|            xqhao|        [I125839683]|  [jhou, zgong, pli...| 145922541|10.1002/acs.2864|126093739|xinhonghao|10.1002/acs.2864|                null|10.1145/contrib-8...|10.1145/instituti...|        Xin‐hong Hao|       xinhonghao|             xhao|A21282578813de7Ao...|      I125839683|\n|W2794180208|10.1002/acs.2873|             Fei Liu|A2604156506|0000-0001-7160-2605|           fliu|           feiliu|        [I111599522]|  [cxu, cahn, bhuan...| 144079361|10.1002/acs.2873|125626106|    feiliu|10.1002/acs.2873|                null|10.1145/contrib-9...|10.1145/instituti...|             Fei Liu|           feiliu|             fliu|A26041565063de7AJ...|      I111599522|\n|W2803165867|10.1002/acs.2891|    Ali Turker Kutay|A1866744245|0000-0002-7243-1390|         akutay|   aliturkerkutay|        [I201799495]|  [myayla, earabi, ...|   2922786|10.1002/acs.2891|126251698|   atkutay|10.1002/acs.2891|http://orcid.org/...|10.1145/contrib-9...|10.1145/instituti...|    Ali Turker Kutay|   aliturkerkutay|           akutay|A18667442453de79M...|      I201799495|\n|W2878984389|10.1002/acs.2899|           Long Xiao|A2779274346|0000-0002-5271-8554|          lxiao|         longxiao|         [I55712492]|  [lxiao, llu, pliu...|2110478140|10.1002/acs.2899|126363178|  longxiao|10.1002/acs.2899|http://orcid.org/...|10.1145/contrib-9...|10.1145/instituti...|           Long Xiao|         longxiao|            lxiao|A27792743463de7A7...|       I55712492|\n|W2878984389|10.1002/acs.2899|       Guoquan Huang|A2116087213|0000-0001-9932-0685|         ghuang|     guoquanhuang|         [I55712492]|  [lxiao, llu, pliu...|  39680655|10.1002/acs.2899|126363178|    ghuang|10.1002/acs.2899|                null|10.1145/contrib-9...|10.1145/instituti...|       Guoquan Huang|     guoquanhuang|           ghuang|A21160872133de7BG...|       I55712492|\n|W2883439300|10.1002/acs.2915|  Thanasis Vafeiadis|A2672576935|0000-0003-3682-7539|     tvafeiadis|thanasisvafeiadis|       [I4210093649]|  [tvafeiadis, svou...|   2140023|10.1002/acs.2915|126184633|tvafeiadis|10.1002/acs.2915|http://orcid.org/...|10.1145/contrib-9...|                null|        T. Vafeiadis|       tvafeiadis|       tvafeiadis|A26725769353de7CC...|     I4210093649|\n|W2885148853|10.1002/acs.2920|Michael A. Demetriou|A1716930021|0000-0001-8547-5774|     mdemetriou|michaelademetriou|        [I107077323]|          [mdemetriou]|   1716254|10.1002/acs.2920|125822577|mdemetriou|10.1002/acs.2920|http://orcid.org/...|10.1145/contrib-8...|10.1145/instituti...|Michael A. Demetriou|michaelademetriou|       mdemetriou|A17169300213de7B0...|      I107077323|\n+-----------+----------------+--------------------+-----------+-------------------+---------------+-----------------+--------------------+----------------------+----------+----------------+---------+----------+----------------+--------------------+--------------------+--------------------+--------------------+-----------------+-----------------+--------------------+----------------+\nonly showing top 20 rows\n\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n |-- pkgAuthorId: string (nullable = true)\n |-- pkgAffiliationId: string (nullable = true)\n\npkg_OA_S2_acm_signatures_dedup_all :6876161\npkg_acm_signatures_dedup_all :6527198\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34mOA_S2_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 18 more fields]\n\u001b[1m\u001b[34mpkg_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pkg_acm_doi: string, pkgAuthorId: string ... 2 more fields]\n\u001b[1m\u001b[34mpkg_OA_S2_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n\nval OA_S2_acm_signatures_dedup_all =   spark.read    \n.parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\n.filter($\"acm_author_id\".isNotNull)\n//.filter($\"pkgAuthorId\".isNotNull)\n.filter($\"S2authorId\".isNotNull)\n\n//OA_S2_acm_signatures_dedup_all.printSchema()\n\nval pkg_acm_signatures_dedup_all =   spark.read    \n.parquet(s\"file://$path/pkg_acm_signatures_dedup.parquet\")\n.filter($\"acm_author_id\".isNotNull)\n.select($\"acm_doi\".as(\"pkg_acm_doi\"), $\"pkgAuthorId\", $\"acm_author_id\".as(\"pkg_acm_author_id\"), $\"oaAuthorId_old\",  $\"oaAffiliationId\".as(\"pkgAffiliationId\"))\n\nprintln(\"non resolved acm_author signatures :\" + OA_S2_acm_signatures_dedup_all.filter($\"acm_author_id\".isNull).count())\n//pkg_acm_signatures_dedup_all.printSchema()\n\nprintln(\"OA_S2_acm_signatures_dedup_all :\" + OA_S2_acm_signatures_dedup_all.count())\nprintln(\"pkg_acm_signatures_dedup_all :\" + pkg_acm_signatures_dedup_all.count())\n\n\n//println(\"non resolved insitutions signatures :\" + OA_S2_acm_signatures_dedup_all.filter($\"oaAffiliationsId\".isNull).count())\n\n\nval pkg_OA_S2_acm_signatures_dedup_all = OA_S2_acm_signatures_dedup_all.join(pkg_acm_signatures_dedup_all, $\"pkg_acm_doi\" === $\"acm_doi\" && $\"acm_author_id\" === $\"pkg_acm_author_id\", \"leftouter\")\n//.withColumn(\"pkgAuthorId\", concat($\"S2authorId\", $\"pkgAuthorId\"  ))\n.drop($\"pkg_acm_author_id\")\n.drop($\"pkg_acm_doi\")\n\n//println(\"pkg_OA_S2_acm_signatures_dedup_all :\" + pkg_OA_S2_acm_signatures_dedup_all.count())\n\n\nval OA_S2_acm_signatures_dedup_pkg = pkg_OA_S2_acm_signatures_dedup_all.filter($\"pkgAuthorId\".isNotNull)\nprintln(\"OA_S2_acm_signatures_dedup_pkg :\" + OA_S2_acm_signatures_dedup_pkg.count())\n//OA_S2_acm_signatures_dedup_pkg.printSchema()\n\nval OA_S2_acm_signatures_dedup_fullname = OA_S2_acm_signatures_dedup_pkg.filter($\"OAshortNormName\" =!= $\"OAnormName\")\n\n\n//Compute related pubcount for each different norm name  \nval pkg_split_diffNames =  OA_S2_acm_signatures_dedup_fullname.\n  groupBy($\"pkgAuthorId\", $\"OAnormName\")                \n                .agg(count(\"OAdoi\").as(\"pkgNamePubCnt\"))\n                \n// create a window funciton to help us splitting the profiles based on the norm name                 \nval wpkg = Window.partitionBy($\"n_pkgAuthorId\").orderBy( $\"pkgNamePubCnt\" desc)\n        \n\nval pkg_split_diffNames_ids = pkg_split_diffNames\n.select($\"pkgAuthorId\".as(\"n_pkgAuthorId\"), $\"OAnormName\".as(\"n_OAnormName\"), $\"pkgNamePubCnt\")\n.withColumn(\"rn\", row_number.over(wpkg))\n.withColumn(\"newPkgAuthorId\", when($\"rn\"===1,$\"n_pkgAuthorId\")\n.otherwise(concat($\"n_pkgAuthorId\", $\"rn\")))\n//.cache()\n\npkg_split_diffNames_ids.show(20)\n\n//create subprofiles keeping the same pkgid for the most frequently encountered profile or when shortnormname===normname i.e., we only have the first letter of the first name  \n\nval OA_S2_acm_signatures_dedup = OA_S2_acm_signatures_dedup_pkg.join(pkg_split_diffNames_ids, $\"n_pkgAuthorId\"===$\"pkgAuthorId\" && $\"n_OAnormName\"===$\"OAnormName\", \"left\")\n.withColumn(\"pkgAuthorId\", when($\"OAnormName\"=== $\"OAshortNormName\" || $\"newPkgAuthorId\".isNull, $\"pkgAuthorId\")\n//.when($\"pkgNamePubCnt\">500 && $\"pkgAffiliationId\".isNotNull, concat($\"newPkgAuthorId\", $\"pkgAffiliationId\"))\n.otherwise($\"newPkgAuthorId\"))\n.drop(\"n_pkgAuthorId\")\n.drop(\"n_OAnormName\")\n.drop(\"pkgNamePubCnt\")\n.drop(\"newPkgAuthorId\")\n.drop(\"rn\")\n//.filter($\"OAshortNormName\"===\"yioannidis\")\n\nprintln(\"OA_S2_acm_signatures_dedup :\" + OA_S2_acm_signatures_dedup.count())\nOA_S2_acm_signatures_dedup.show(20)\n\nprintln(\"non resolved insitutions signatures :\" + OA_S2_acm_signatures_dedup.filter($\"acm_institution_id\".isNull).count())\nprintln(\"non resolved pkgAffiliationId signatures :\" + OA_S2_acm_signatures_dedup.filter($\"pkgAffiliationId\".isNull).count())\n//println(\"non resolved insitutions signatures :\" + pkg_OA_S2_acm_signatures_dedup_all.filter($\"oaAffiliationsId\".isNull).count())\n\n\nval acm_claimed_profiles =   spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).csv(s\"file://$path/claimed_profiles_report.tsv\")\n//acm_claimed_profiles.printSchema()\nprintln(\"acm_claimed_profiles count: \" + acm_claimed_profiles.count())\n\nval OA_S2_acm_signatures_dedup_claimed = OA_S2_acm_signatures_dedup.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" )\n//.filter($\"OAshortNormName\"===\"yioannidis\")\n\nOA_S2_acm_signatures_dedup_claimed.show(10)\n\n\nprintln(\"OA_S2_acm_signatures_dedup count: \" + OA_S2_acm_signatures_dedup.count())\nprintln(\"OAdois:\" + OA_S2_acm_signatures_dedup.select( $\"OAdoi\").distinct().count())\nprintln(\"acm_author_ids:\" + OA_S2_acm_signatures_dedup.select( $\"acm_author_id\").distinct().count())\nprintln(\"PKGauthorIds:\" + OA_S2_acm_signatures_dedup.select( $\"pkgAuthorId\").distinct().count())\nprintln(\"OAauthorIds:\" + OA_S2_acm_signatures_dedup.select( $\"OAauthorId\").distinct().count())\n\nprintln(\"S2authorIds:\" + OA_S2_acm_signatures_dedup.select( $\"S2authorId\").distinct().count())\nprintln(\"acm_orcid:\" + OA_S2_acm_signatures_dedup.select( $\"acm_orcid\").distinct().count())\nprintln(\"orcid:\" + OA_S2_acm_signatures_dedup.select( $\"orcid\").distinct().count())\nOA_S2_acm_signatures_dedup.select( $\"orcid\").distinct().show(10)\n\nprintln(\"affiliationsIds:\" + OA_S2_acm_signatures_dedup.select( $\"pkgAffiliationId\").distinct().count())\nprintln(\"acm_institution_id:\" + OA_S2_acm_signatures_dedup.select( $\"acm_institution_id\").distinct().count())\n\nprintln(\"OA_S2_acm_signatures_dedup_claimed count: \" + OA_S2_acm_signatures_dedup_claimed.count())\nprintln(\"claimed OAdois:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"OAdoi\").distinct().count())\nprintln(\"claimed acm_author_ids:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"acm_author_id\").distinct().count())\nprintln(\"claimed pkgAuthorIds:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"pkgAuthorId\").distinct().count())\nprintln(\"claimed OAauthorIds:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"OAauthorId\").distinct().count())\nprintln(\"claimed S2authorIds:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"S2authorId\").distinct().count())\nprintln(\"claimed acm_orcid:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"acm_orcid\").distinct().count())\nOA_S2_acm_signatures_dedup_claimed.select( $\"acm_orcid\").distinct().show(5)\n\nprintln(\"claimed orcid:\" + OA_S2_acm_signatures_dedup_claimed.select( $\"orcid\").distinct().count())\nOA_S2_acm_signatures_dedup_claimed.select( $\"orcid\").distinct().show(10)\n\n//analyze 1-1 & 1-many matches & compute parity profile count\nval pkgPerAcm =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\")                \n                .agg(\n                 countDistinct(\"pkgAuthorId\").as(\"pkgauthorCnt\")\n                 ,countDistinct(\"OAauthorId\").as(\"OAauthorCnt\")\n                 ,countDistinct(\"S2authorId\").as(\"S2authorCnt\")\n                ,count(\"OAdoi\").as(\"acmAuthorPubCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"pkgAuthorId\")).as(\"pkgAuthorIds\"))\n                \n println(\"pkgPerAcm count: \" + pkgPerAcm.count())\n println(\"pkgPerAcm count 1-1: \" + pkgPerAcm.filter($\"pkgauthorCnt\"===1).count())\n println(\"OAPerAcm count 1-1: \" + pkgPerAcm.filter($\"OAauthorCnt\"===1).count())\n println(\"S2PerAcm count 1-1: \" + pkgPerAcm.filter($\"S2authorCnt\"===1).count())\n \n println(\"pkgPerAcm claimed profiles count: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).count())\n println(\"pkgPerAcm claimed profiles count 1-1: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"pkgauthorCnt\"===1).count())\n println(\"OAPerAcm claimed profiles count 1-1: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"OAauthorCnt\"===1).count())\n println(\"S2PerAcm claimed profiles count 1-1: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"S2authorCnt\"===1).count())\n  \n \n \nval acmPerPkg =  OA_S2_acm_signatures_dedup.\n  groupBy($\"pkgAuthorId\")                \n                .agg(countDistinct(\"acm_author_id\").as(\"ACMauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"acm_author_id\")).as(\"acm_author_ids\")\n                ,count(\"OAdoi\").as(\"OAauthorPubCnt\")                \n                \n                )\n                \nprintln(\"acmPerPkg count: \" + acmPerPkg.count())\nprintln(\"acmPerPkg count 1-1: \" + acmPerPkg.filter($\"ACMauthorCnt\"===1).count())\n\npkgPerAcm.orderBy($\"pkgauthorCnt\" desc).show(20)\npkgPerAcm.orderBy($\"S2authorCnt\" desc).show(20)\nacmPerPkg.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n\n//Find best match & compute similarity\nval acm2pkg =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\", $\"pkgAuthorId\")                \n                .agg(count(\"OAdoi\").as(\"commonPubCnt\"))\n                \nval w = Window.partitionBy($\"acm_author_id\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval acm2pkg_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"acm2pkg_bestMatch count: \" + acm2pkg_bestMatch.count())\n\n//acm2pkg_bestMatch.printSchema()\n//pkgPerAcm.printSchema()\n//acmPerPkg.printSchema()\n//acm2pkg_bestMatch.show(20)\n\nval acm2pkg_bestMatch_ext = acm2pkg_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === acm2pkg_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"pkgAuthorId\") === acm2pkg_bestMatch(\"pkgAuthorId\"), \"inner\")\n.select(acm2pkg_bestMatch(\"acm_author_id\"), acm2pkg_bestMatch(\"pkgAuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")   \n            .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n            .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n            .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \n               \n println(\"acm2pkg_bestMatch_ext count: \" + acm2pkg_bestMatch_ext.count())\n acm2pkg_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n //acm2pkg_bestMatch_ext.show(20)            \n //acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).show(20)\n //acm2pkg_bestMatch_ext.printSchema()                 \n\n//////////////////////////////////\n\n//Find best match & compute similarity\n\nval w1 = Window.partitionBy($\"pkgAuthorId\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval pkg2acm_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w1))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"pkg2acm_bestMatch count: \" + pkg2acm_bestMatch.count())\n//pkg2acm_bestMatch.printSchema()\n//pkg2acm_bestMatch.show(20)\n\n\nval pkg2acm_bestMatch_ext = pkg2acm_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === pkg2acm_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"pkgAuthorId\") === pkg2acm_bestMatch(\"pkgAuthorId\"), \"inner\")\n.select(pkg2acm_bestMatch(\"acm_author_id\"), pkg2acm_bestMatch(\"pkgAuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")\n           .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n           .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n           .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \nprintln(\"pkg2acm_bestMatch_ext count: \" + pkg2acm_bestMatch_ext.count())\npkg2acm_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\npkg2acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n\n// <<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n\n///// ACM 2 S2 comparison ///////////////////////////\nval acmPerS2 =  OA_S2_acm_signatures_dedup.\n  groupBy($\"S2AuthorId\")                \n                .agg(countDistinct(\"acm_author_id\").as(\"ACMauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"acm_author_id\")).as(\"acm_author_ids\")\n                ,count(\"OAdoi\").as(\"OAauthorPubCnt\")                \n                \n                )\n                \nprintln(\"acmPerS2 count: \" + acmPerS2.count())\nprintln(\"acmPerS2 count 1-1: \" + acmPerS2.filter($\"ACMauthorCnt\"===1).count())\nacmPerS2.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n\n//Find best match & compute similarity\nval acm2S2 =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\", $\"S2AuthorId\")                \n                .agg(count(\"OAdoi\").as(\"commonPubCnt\"))\n                \nval wS2 = Window.partitionBy($\"acm_author_id\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval acm2S2_bestMatch = acm2S2.withColumn(\"rn\", row_number.over(wS2))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"acm2S2_bestMatch count: \" + acm2S2_bestMatch.count())\n\n\nval acm2S2_bestMatch_ext = acm2S2_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === acm2S2_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerS2, acmPerS2(\"S2AuthorId\") === acm2S2_bestMatch(\"S2AuthorId\"), \"inner\")\n.select(acm2S2_bestMatch(\"acm_author_id\"), acm2S2_bestMatch(\"S2AuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")   \n            .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n            .withColumn(\"S2ProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n            .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \n               \n println(\"acm2S2_bestMatch_ext count: \" + acm2S2_bestMatch_ext.count())\n acm2S2_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"S2ProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n acm2S2_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"S2ProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n           \n\n//////////////////////////////////\n\n//Find best match & compute similarity\n\nval wS21 = Window.partitionBy($\"S2AuthorId\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval S22acm_bestMatch = acm2S2.withColumn(\"rn\", row_number.over(wS21))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"S22acm_bestMatch count: \" + S22acm_bestMatch.count())\n\n\nval S22acm_bestMatch_ext = S22acm_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === S22acm_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerS2, acmPerS2(\"S2AuthorId\") === S22acm_bestMatch(\"S2AuthorId\"), \"inner\")\n.select(S22acm_bestMatch(\"acm_author_id\"), S22acm_bestMatch(\"S2AuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")\n           .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n           .withColumn(\"S2ProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n           .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \nprintln(\"S22acm_bestMatch_ext count: \" + S22acm_bestMatch_ext.count())\nS22acm_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"S2ProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\nS22acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"S2ProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n\n\n",
   "id": "",
   "dateCreated": "2023-03-03 20:08:02.966",
   "config": {
    "title": true,
    "tableHide": true,
    "editorHide": false
   },
   "title": "Analyze ACM - PKG Matching",
   "dateStarted": "2023-03-22 11:47:41.037",
   "dateUpdated": "2023-03-22 11:52:16.595",
   "dateFinished": "2023-03-22 11:52:16.595",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0m9 feature warnings; for details, enable `:setting -feature' or `:replay -feature'\nnon resolved acm_author signatures :0\nOA_S2_acm_signatures_dedup_all :6648673\npkg_acm_signatures_dedup_all :6560233\nOA_S2_acm_signatures_dedup_pkg :6517297\n+--------------------+----------------+-------------+---+--------------------+\n|       n_pkgAuthorId|    n_OAnormName|pkgNamePubCnt| rn|      newPkgAuthorId|\n+--------------------+----------------+-------------+---+--------------------+\n|3de79Cj5Xlkn9rgZb...|       alifaisal|            4|  1|3de79Cj5Xlkn9rgZb...|\n|3de79E6To4DehRA0Y...|        annipeng|            1|  1|3de79E6To4DehRA0Y...|\n|3de79ErwznztCtEgc...|ahmadkhajenezhad|            1|  1|3de79ErwznztCtEgc...|\n|3de79Eti8J5X0ZZeu...|       hongminlu|           19|  1|3de79Eti8J5X0ZZeu...|\n|3de79F88bTWlvK2yN...|    akshaydeepak|           13|  1|3de79F88bTWlvK2yN...|\n|3de79FK7ppRoULemp...|     alainfabian|            2|  1|3de79FK7ppRoULemp...|\n|3de79FdEJFCOmpipH...|    aafkefraaije|            2|  1|3de79FdEJFCOmpipH...|\n|3de79FnlBYZK3wF0o...|   akhileshkumar|           19|  1|3de79FnlBYZK3wF0o...|\n|3de79FnlBYZK3wF0o...|      ashokkumar|            2|  2|3de79FnlBYZK3wF0o...|\n|3de79Fx1E6UjXtIDt...|   alexandrlucas|            1|  1|3de79Fx1E6UjXtIDt...|\n|3de79FzqVx3rsTwXT...|      nadaaahmed|            1|  1|3de79FzqVx3rsTwXT...|\n|3de79G6rj1EsISVLm...|     konwellwang|            1|  1|3de79G6rj1EsISVLm...|\n|3de79GET589BMWRHj...|         abdiali|            1|  1|3de79GET589BMWRHj...|\n|3de79GS14tG79KNNN...|     andrejpetef|            1|  1|3de79GS14tG79KNNN...|\n|3de79GeCpKMejNNh5...|algirdasdeveikis|            4|  1|3de79GeCpKMejNNh5...|\n|3de79GeaoJNuUfT9E...|          danliu|            1|  1|3de79GeaoJNuUfT9E...|\n|3de79GhuMCEW4wOQl...|     aopittenger|            3|  1|3de79GhuMCEW4wOQl...|\n|3de79GhuMCEW4wOQl...|arthuropittenger|            1|  2|3de79GhuMCEW4wOQl...|\n|3de79HFXbBNvMG2kC...|     hyuckinkwon|            1|  1|3de79HFXbBNvMG2kC...|\n|3de79HKJTl7RAItNC...|      hicheonkim|            1|  1|3de79HKJTl7RAItNC...|\n+--------------------+----------------+-------------+---+--------------------+\nonly showing top 20 rows\n\nOA_S2_acm_signatures_dedup :6517297\n+-----------+----------------+--------------------+-----------+-------------------+---------------+--------------------+--------------------+----------------------+----------+----------------+---------+-----------------+----------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------------+--------------------+--------------+----------------+\n|  OApaperId|           OAdoi|              OAname| OAauthorId|              orcid|OAshortNormName|          OAnormName|     affiliationsIds|coAuthorShortNormNames|S2authorId|           S2doi|S2paperId|       S2normName|         acm_doi|           acm_orcid|       acm_author_id|  acm_institution_id|     acm_author_name|        acm_normname|acm_shortnormname|         pkgAuthorId|oaAuthorId_old|pkgAffiliationId|\n+-----------+----------------+--------------------+-----------+-------------------+---------------+--------------------+--------------------+----------------------+----------+----------------+---------+-----------------+----------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------------+--------------------+--------------+----------------+\n|W2340448819|10.1002/acs.2679|   Daniele Carnevale|A2171127902|0000-0001-6214-7938|     dcarnevale|    danielecarnevale|        [I116067653]|  [dcarnevale, sgal...|2068639188|10.1002/acs.2679|124978934|       dcarnevale|10.1002/acs.2679|                null|10.1145/contrib-8...|10.1145/instituti...|        D. Carnevale|          dcarnevale|       dcarnevale|3de79ReGknshNx8j2...|   A2171127902|      I116067653|\n|W2791058992|10.1002/acs.2868|   Daniele Carnevale|A2171127902|0000-0001-6214-7938|     dcarnevale|    danielecarnevale|        [I116067653]|  [mgnucci, mgospod...|2068639188|10.1002/acs.2868|125808802|       dcarnevale|10.1002/acs.2868|                null|10.1145/contrib-8...|10.1145/instituti...|        D. Carnevale|          dcarnevale|       dcarnevale|3de79ReGknshNx8j2...|   A2171127902|      I116067653|\n|W2915482049|10.1002/acs.2977|              Le Liu|A2144488270|0000-0002-6944-5417|           lliu|               leliu|         [I39333907]|  [lliu, nshao, mli...|   1804397|10.1002/acs.2977|127408203|            leliu|10.1002/acs.2977|https://orcid.org...|10.1145/contrib-9...|10.1145/instituti...|              Le Liu|               leliu|             lliu|3de79U77O2yDkk8ei...|   A2646423375|       I39333907|\n|W1568419197|10.1002/acs.2408|           Jian Xiao|A2681764515|0000-0001-7374-6506|          jxiao|            jianxiao|          [I4800084]|  [wxiang, jxiao, m...| 144770772|10.1002/acs.2408| 60924014|         jianxiao|10.1002/acs.2408|                null|10.1145/contrib-8...|10.1145/instituti...|           Jian Xiao|            jianxiao|            jxiao|3de79krHUzJH76TsD...|   A2681764515|        I4800084|\n|W2889376795|10.1002/acs.2924|          Qiang Shen|A2145529054|0000-0001-5289-3080|          qshen|           qiangshen|       [I4210130660]|  [qshen, jliu, xzh...|2069019246|10.1002/acs.2924|125607787|        qiangshen|10.1002/acs.2924|http://orcid.org/...|10.1145/contrib-9...|10.1145/instituti...|          Qiang Shen|           qiangshen|            qshen|3de79vuTS4hBZF7sC...|   A2906719448|     I4210130660|\n|W2808080600|10.1002/acs.2877| Missie Aguado-Rojas|A2288275438|0000-0003-3895-6449|   maguadorojas|   missieaguadorojas|              [null]|  [maguadorojas, pm...|1399593849|10.1002/acs.2877|125282865|missieaguadorojas|10.1002/acs.2877|http://orcid.org/...|10.1145/contrib-9...|10.1145/instituti...| Missie Aguado‐Rojas|   missieaguadorojas|     maguadorojas|3de79xlaySFFoukr4...|   A2288275438|            null|\n|W2467184026|10.1002/acs.2700|     Fayçal Ikhouane| A292140360|0000-0003-0616-3057|      fikhouane|      faycalikhouane|          [I9617848]|  [aradouane, fgiri...|   2044242|10.1002/acs.2700| 54039922|        fikhouane|10.1002/acs.2700|                null|10.1145/contrib-8...|10.1145/instituti...|     Faycal Ikhouane|      faycalikhouane|        fikhouane|3de79ykQHef2qFnIM...|    A292140360|        I9617848|\n|W2808080600|10.1002/acs.2877|Gerardo Espinosa-...|A2044327008|0000-0002-4891-2020| gespinosaperez|gerardoespinosaperez|          [I8961855]|  [maguadorojas, pm...|1398700989|10.1002/acs.2877|125282865|   gespinosaperez|10.1002/acs.2877|                null|10.1145/contrib-8...|10.1145/instituti...|Gerardo Espinosa‐...|gerardoespinosaperez|   gespinosaperez|3de7A29rJ0IlFodeY...|   A2044327008|        I8961855|\n|W1481513151|10.1002/acs.2336|        Changyun Wen|A2096567806|0000-0001-9530-360X|           cwen|         changyunwen|        [I172675005]|   [yzheng, cwen, zli]| 145678164|10.1002/acs.2336|118821694|             cwen|10.1002/acs.2336|                null|10.1145/contrib-8...|10.1145/instituti...|        Changyun Wen|         changyunwen|             cwen|3de7A2BJs52yNm9O9...|   A2096567806|      I172675005|\n|W2899349726|10.1002/acs.2945|Rushikesh Kamalap...|A2148734147|0000-0001-9963-5361|  rkamalapurkar|rushikeshkamalapu...|        [I115475287]|  [aparikh, rkamala...|   2096104|10.1002/acs.2945| 18051043|    rkamalapurkar|10.1002/acs.2945|                null|10.1145/contrib-8...|10.1145/instituti...|Rushikesh Kamalap...|rushikeshkamalapu...|    rkamalapurkar|3de7A4ghhruhMfLic...|   A2148734147|      I115475287|\n|W2791831702|10.1002/acs.2869|      Anusha Mannava|A1756557575|               null|       amannava|       anushamannava|         [I52357470]|  [amannava, aserrani]|   2980390|10.1002/acs.2869|125690439|         amannava|10.1002/acs.2869|                null|10.1145/contrib-9...|10.1145/instituti...|          A. Mannava|            amannava|         amannava|3de7A9yKldsr154zz...|   A3169559320|       I52357470|\n|W2798142424|10.1002/acs.2884|Mohamed Esmail Karar|A2575433946|0000-0002-0474-4723|         mkarar|  mohamedesmailkarar|         [I63601056]|              [mkarar]|   2433321|10.1002/acs.2884|126397293|          mekarar|10.1002/acs.2884|http://orcid.org/...|10.1145/contrib-8...|10.1145/instituti...|Mohamed Esmail Karar|  mohamedesmailkarar|           mkarar|3de7AISQp2K074VCS...|   A2575433946|       I63601056|\n|W2889956471|10.1002/acs.2929|         Wengang Yan|A2896465927|               null|           wyan|          wengangyan|         [I55712492]|          [wyan, yzhu]| 145596276|10.1002/acs.2929|125276643|       wengangyan|10.1002/acs.2929|http://orcid.org/...|10.1145/contrib-9...|10.1145/instituti...|         Wengang Yan|          wengangyan|             wyan|3de7AIeoSRfwplghN...|   A2896465927|       I55712492|\n|W2117897787|10.1002/acs.2340|      Andrea Serrani|A1389057362|0000-0003-3281-7341|       aserrani|       andreaserrani|         [I52357470]|            [aserrani]|   1690990|10.1002/acs.2340|123403327|         aserrani|10.1002/acs.2340|                null|10.1145/contrib-8...|10.1145/instituti...|          A. Serrani|            aserrani|         aserrani|3de7AJLtnxwlbZKlh...|   A1389057362|       I52357470|\n|W2791831702|10.1002/acs.2869|      Andrea Serrani|A1389057362|0000-0003-3281-7341|       aserrani|       andreaserrani|         [I52357470]|  [amannava, aserrani]|   1690990|10.1002/acs.2869|125690439|         aserrani|10.1002/acs.2869|http://orcid.org/...|10.1145/contrib-8...|10.1145/instituti...|          A. Serrani|            aserrani|         aserrani|3de7AJLtnxwlbZKlh...|   A1389057362|       I52357470|\n|W2883439300|10.1002/acs.2915|Georgios Stavropo...|A2604896909|0000-0002-8549-6855|  gstavropoulos|georgiosstavropoulos|[I174878644, I421...|  [tvafeiadis, svou...|  15784009|10.1002/acs.2915|126184633|    gstavropoulos|10.1002/acs.2915|                null|10.1145/contrib-9...|                null|     G. Stavropoulos|       gstavropoulos|    gstavropoulos|3de7AKswRorFz3f5E...|   A2558112589|      I174878644|\n|W2890729479|10.1002/acs.2933|       Emmanuel Nuño|A1995815971|0000-0003-2058-4579|          enuno|        emmanuelnuno|        [I193181351]|      [rortega, enuno]|   3047012|10.1002/acs.2933|126430958|     emmanuelnuno|10.1002/acs.2933|http://orcid.org/...|10.1145/contrib-8...|10.1145/instituti...|       Emmanuel Nuño|        emmanuelnuno|            enuno|3de7AOAfs1rGVzo2l...|   A1995815971|      I193181351|\n|W2554364914|10.1002/acs.2738|       Emmanuel Nuño|A1995815971|0000-0003-2058-4579|          enuno|        emmanuelnuno|        [I193181351]|  [enuno, caldana, ...|   3047012|10.1002/acs.2738| 55912741|     emmanuelnuno|10.1002/acs.2738|                null|10.1145/contrib-8...|10.1145/instituti...|       Emmanuel Nuño|        emmanuelnuno|            enuno|3de7AOAfs1rGVzo2l...|   A1995815971|      I193181351|\n|W2937230520|10.1002/acs.2992|    Andrey V. Savkin| A304661513|0000-0001-9390-6634|        asavkin|       andreyvsavkin|         [I31746571]|  [dbaig, rahmad, a...|   1810072|10.1002/acs.2992|146089649|          asavkin|10.1002/acs.2992|                null|10.1145/contrib-8...|10.1145/instituti...|       Andrey Savkin|        andreysavkin|          asavkin|3de7APWDezOOGl7HN...|    A304661513|       I31746571|\n|W2148036170|10.1002/acs.2574|  Arthur P. Berkhoff|A2040797105|               null|      aberkhoff|     arthurpberkhoff|         [I94624287]|   [sophem, aberkhoff]|   5330164|10.1002/acs.2574|122759742|        aberkhoff|10.1002/acs.2574|                null|10.1145/contrib-9...|                null|      A. P. Berkhoff|          apberkhoff|        aberkhoff|3de7AWIABUEaTJlNY...|   A2040797105|       I94624287|\n+-----------+----------------+--------------------+-----------+-------------------+---------------+--------------------+--------------------+----------------------+----------+----------------+---------+-----------------+----------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------------+--------------------+--------------+----------------+\nonly showing top 20 rows\n\nnon resolved insitutions signatures :1782979\nnon resolved pkgAffiliationId signatures :991362\nacm_claimed_profiles count: 28192\n+-----------+--------------------+------------------+-----------+-------------------+---------------+-----------------+---------------+----------------------+----------+--------------------+---------+-----------------+--------------------+---------+--------------------+--------------------+------------------+-----------------+-----------------+--------------------+--------------+----------------+--------------------+---------+\n|  OApaperId|               OAdoi|            OAname| OAauthorId|              orcid|OAshortNormName|       OAnormName|affiliationsIds|coAuthorShortNormNames|S2authorId|               S2doi|S2paperId|       S2normName|             acm_doi|acm_orcid|       acm_author_id|  acm_institution_id|   acm_author_name|     acm_normname|acm_shortnormname|         pkgAuthorId|oaAuthorId_old|pkgAffiliationId|          profile_id|client_id|\n+-----------+--------------------+------------------+-----------+-------------------+---------------+-----------------+---------------+----------------------+----------+--------------------+---------+-----------------+--------------------+---------+--------------------+--------------------+------------------+-----------------+-----------------+--------------------+--------------+----------------+--------------------+---------+\n|W2439008315|10.1007/s11263-01...|  Alyosha A. Efros|A3093242662|               null|         aefros|    alyoshaaefros|  [I1297971548]|   [aefros, atorralba]|   1763086|10.1007/s11263-01...| 13535985|     alexeiaefros|10.1007/s11263-01...|     null|10.1145/contrib-8...|10.1145/instituti...|     Alyosha Efros|     alyoshaefros|           aefros|3de79CBGQU3PV8wPS...|   A2505085511|     I1297971548|10.1145/contrib-8...|   222562|\n|W2286465138|10.1007/s10207-01...|Abdullah Almaatouq|A2996115161|0000-0002-8467-9123|     aalmaatouq|abdullahalmaatouq|    [I63966007]|  [aalmaatouq, eshm...|   3085084|10.1007/s10207-01...|  3189819|abdullahalmaatouq|10.1007/s10207-01...|     null|10.1145/contrib-8...|10.1145/instituti...|Abdullah Almaatouq|abdullahalmaatouq|       aalmaatouq|3de79FRX5Fs5c7XTn...|   A2996115161|       I63966007|10.1145/contrib-8...|   891618|\n|W1968676912|10.1145/2509352.2...|Abdullah Almaatouq|A2996115161|0000-0002-8467-9123|     aalmaatouq|abdullahalmaatouq|  [I1284598098]|  [aalmaatouq, falh...|   3085084|10.1145/2509352.2...| 11654719|abdullahalmaatouq|10.1145/2509352.2...|     null|10.1145/contrib-8...|10.1145/instituti...|Abdullah Almaatouq|abdullahalmaatouq|       aalmaatouq|3de79FRX5Fs5c7XTn...|   A2996115161|     I1284598098|10.1145/contrib-8...|   891618|\n|W1844628735|10.1007/978-3-319...|Abdullah Almaatouq|A2996115161|0000-0002-8467-9123|     aalmaatouq|abdullahalmaatouq|  [I1284598098]|  [mnouh, aalmaatou...|   3085084|10.1007/978-3-319...|   827138|abdullahalmaatouq|10.1007/978-3-319...|     null|10.1145/contrib-8...|10.1145/instituti...|Abdullah Almaatouq|abdullahalmaatouq|       aalmaatouq|3de79FRX5Fs5c7XTn...|   A2996115161|     I1284598098|10.1145/contrib-8...|   891618|\n|W2080083917|10.1145/2615569.2...|Abdullah Almaatouq|A2996115161|0000-0002-8467-9123|     aalmaatouq|abdullahalmaatouq|  [I1284598098]|  [aalmaatouq, aala...|   3085084|10.1145/2615569.2...|  2249607|abdullahalmaatouq|10.1145/2615569.2...|     null|10.1145/contrib-8...|10.1145/instituti...|Abdullah Almaatouq|abdullahalmaatouq|       aalmaatouq|3de79FRX5Fs5c7XTn...|   A2996115161|     I1284598098|10.1145/contrib-8...|   891618|\n|W2295527813|10.1145/2812428.2...|    Alena Kovarova|A2018537634|               null|      akovarova|    alenakovarova|   [I110757952]|  [lloch, pnavrat, ...|   3255415|10.1145/2812428.2...| 14291113|        akovarova|10.1145/2812428.2...|     null|10.1145/contrib-8...|                null|    Alena Kovarova|    alenakovarova|        akovarova|3de79GRQnXCkVG1N4...|   A2018537634|      I110757952|10.1145/contrib-8...|   494753|\n|W2039166397|10.1109/smap.2008.28|    Alena Kovarova|A2018537634|               null|      akovarova|    alenakovarova|   [I110757952]|  [lszalayova, akov...|   3255415|10.1109/smap.2008.28| 22736091|        akovarova|10.1109/smap.2008.28|     null|10.1145/contrib-8...|                null|    Alena Kovárová|    alenakovarova|        akovarova|3de79GRQnXCkVG1N4...|   A2018537634|      I110757952|10.1145/contrib-8...|   494753|\n|W2243405820|10.1145/2812428.2...|    Alena Kovarova|A2018537634|               null|      akovarova|    alenakovarova|   [I110757952]|  [fhlavacek, akova...|   3255415|10.1145/2812428.2...| 15271573|        akovarova|10.1145/2812428.2...|     null|10.1145/contrib-8...|                null|    Alena Kovarova|    alenakovarova|        akovarova|3de79GRQnXCkVG1N4...|   A2018537634|      I110757952|10.1145/contrib-8...|   494753|\n|W2554139914|10.1145/2983468.2...|    Alena Kovarova|A2018537634|               null|      akovarova|    alenakovarova|   [I110757952]|  [mliskovec, akova...|   3255415|10.1145/2983468.2...| 17636815|        akovarova|10.1145/2983468.2...|     null|10.1145/contrib-8...|10.1145/instituti...|    Alena Kovarova|    alenakovarova|        akovarova|3de79GRQnXCkVG1N4...|   A2018537634|      I110757952|10.1145/contrib-8...|   494753|\n|W2553586108|10.1145/2983468.2...|    Alena Kovarova|A2018537634|               null|      akovarova|    alenakovarova|   [I110757952]|       [fp, akovarova]|   3255415|10.1145/2983468.2...| 14757233|        akovarova|10.1145/2983468.2...|     null|10.1145/contrib-8...|10.1145/instituti...|    Alena Kovarova|    alenakovarova|        akovarova|3de79GRQnXCkVG1N4...|   A2018537634|      I110757952|10.1145/contrib-8...|   494753|\n+-----------+--------------------+------------------+-----------+-------------------+---------------+-----------------+---------------+----------------------+----------+--------------------+---------+-----------------+--------------------+---------+--------------------+--------------------+------------------+-----------------+-----------------+--------------------+--------------+----------------+--------------------+---------+\nonly showing top 10 rows\n\nOA_S2_acm_signatures_dedup count: 6517297\nOAdois:2217446\nacm_author_ids:2376731\nPKGauthorIds:1788971\nOAauthorIds:1716828\nS2authorIds:1942158\nacm_orcid:137410\norcid:417836\n+-------------------+\n|              orcid|\n+-------------------+\n|0000-0001-8778-3586|\n|0000-0002-3321-6137|\n|0000-0001-9426-934X|\n|0000-0001-5332-0487|\n|0000-0002-3312-1234|\n|0000-0002-2102-3653|\n|0000-0002-1898-0903|\n|0000-0001-7428-4980|\n|0000-0002-6594-3371|\n|0000-0003-4586-8527|\n+-------------------+\nonly showing top 10 rows\n\naffiliationsIds:36793\nacm_institution_id:26190\nOA_S2_acm_signatures_dedup_claimed count: 464497\nclaimed OAdois:353483\nclaimed acm_author_ids:26328\nclaimed pkgAuthorIds:32153\nclaimed OAauthorIds:36338\nclaimed S2authorIds:33681\nclaimed acm_orcid:6057\n+--------------------+\n|           acm_orcid|\n+--------------------+\n|http://orcid.org/...|\n| 0000-0001-8116-4522|\n|http://orcid.org/...|\n|http://orcid.org/...|\n| 0000-0001-5791-1890|\n+--------------------+\nonly showing top 5 rows\n\nclaimed orcid:12752\n+-------------------+\n|              orcid|\n+-------------------+\n|0000-0002-7337-6637|\n|0000-0001-6410-2848|\n|0000-0002-6662-417X|\n|0000-0002-2141-315X|\n|0000-0002-9396-7071|\n|0000-0002-9288-5648|\n|0000-0001-8116-4522|\n|0000-0002-3896-648X|\n|0000-0002-8273-6059|\n|0000-0001-9870-5858|\n+-------------------+\nonly showing top 10 rows\n\npkgPerAcm count: 2376731\npkgPerAcm count 1-1: 2268394\nOAPerAcm count 1-1: 2224178\nS2PerAcm count 1-1: 2282498\npkgPerAcm claimed profiles count: 26409\npkgPerAcm claimed profiles count 1-1: 21985\nOAPerAcm claimed profiles count 1-1: 19550\nS2PerAcm claimed profiles count 1-1: 21497\nacmPerPkg count: 1788971\nacmPerPkg count 1-1: 1537157\n+--------------------+------------+-----------+-----------+---------------+--------------------+--------------------+\n|       acm_author_id|pkgauthorCnt|OAauthorCnt|S2authorCnt|acmAuthorPubCnt|        oaAuthorName|        pkgAuthorIds|\n+--------------------+------------+-----------+-----------+---------------+--------------------+--------------------+\n|10.1145/contrib-8...|          65|         67|         14|            288|[Lin-Qiang Chen, ...|[3de7BJk0etY0BWjP...|\n|10.1145/contrib-8...|          54|         57|          5|            184|[Jiunn-Yuan Lin, ...|[3de7BqMWTJvlYqOx...|\n|10.1145/contrib-8...|          28|         28|          2|             91|[Letao Chen, Lixi...|[3de7B5rM8wR1r31n...|\n|10.1145/contrib-8...|          22|         23|          1|             55|[Haibo Ji, Hongwu...|[3de79ZbcZej10JJE...|\n|10.1145/contrib-8...|          21|         23|          3|             32|[Jiunn-Yuan Lin, ...|[3de7B85sN2D7vEFO...|\n|10.1145/contrib-8...|          20|         20|          3|             28|[Jinyong Lin, Jiu...|[3de7BoWZQ2LPI3Ld...|\n|10.1145/contrib-8...|          18|         10|         42|            217|[Lixin Zhang, Lij...|[3de79be35ynGscsM...|\n|10.1145/contrib-8...|          18|         18|          5|             54|[Li-Jun Chen, Lin...|[3de7BUjObhJR6rxj...|\n|10.1145/contrib-8...|          18|         19|          4|             60|[Juan Manuel Truj...|[3de7BLideNgsUusg...|\n|10.1145/contrib-8...|          17|         17|          5|             47|[Li-Chuan Chen, L...|[3de7BUjObhJR6rxj...|\n|10.1145/contrib-8...|          17|         17|          2|             31|[Jiunn-Yuan Lin, ...|[3de7BrM8DvxkZO5q...|\n|10.1145/contrib-8...|          16|          7|         29|            120|[Chunhui Chen, C....|[3de7AHx2ir5gdFsN...|\n|10.1145/contrib-8...|          16|         11|         12|             96|[José Luis Escace...|[3de7C3e8PTEzlqXU...|\n|10.1145/contrib-8...|          16|         16|          4|             51|[Lihua Chen, Lixi...|[3de7AU56go8A5z7p...|\n|10.1145/contrib-8...|          16|         17|          5|             72|[Lixiang Chen, Li...|[3de7BLO4NVLyUezI...|\n|10.1145/contrib-8...|          15|         16|          2|             21|[Jiunn-Yuan Lin, ...|[3de79T1rUUEElGIU...|\n|10.1145/contrib-8...|          14|          8|          6|             70|[Q.M. Jonathan Wu...|[3de7Ahz7jAdeXdsF...|\n|10.1145/contrib-8...|          14|         13|          1|             62|[Ling Chen, Lihe ...|[3de7APUMrC246exe...|\n|10.1145/contrib-8...|          14|         14|          2|             33|[Jie Lin, Jonatha...|[3de7AKh37ousYRIg...|\n|10.1145/contrib-8...|          14|         13|         36|            137|[Weiwei Wang, Wei...|[3de79m1WBG2wmEzH...|\n+--------------------+------------+-----------+-----------+---------------+--------------------+--------------------+\nonly showing top 20 rows\n\n+--------------------+------------+-----------+-----------+---------------+--------------------+--------------------+\n|       acm_author_id|pkgauthorCnt|OAauthorCnt|S2authorCnt|acmAuthorPubCnt|        oaAuthorName|        pkgAuthorIds|\n+--------------------+------------+-----------+-----------+---------------+--------------------+--------------------+\n|10.1145/contrib-8...|          11|         13|         45|            289|[Mingjing Li, Min...|[3de7BI8HkNtfxcge...|\n|10.1145/contrib-8...|           4|          2|         43|            241|  [Taoyu Li, Tao Li]|[3de7CHWypkQMe6uX...|\n|10.1145/contrib-8...|          18|         10|         42|            217|[Lixin Zhang, Lij...|[3de79be35ynGscsM...|\n|10.1145/contrib-8...|           4|          3|         41|            335|[Lixin Zhang, Lei...|[3de7AJJr7CB6dT5m...|\n|10.1145/contrib-8...|          14|         13|         36|            137|[Weiwei Wang, Wei...|[3de79m1WBG2wmEzH...|\n|10.1145/contrib-8...|           7|          7|         31|            292|[Qing X. Li, Q. L...|[3de7BHhy5WwKCVlW...|\n|10.1145/contrib-8...|           3|          5|         30|             84|[Wei, Wei, Wei We...|[3de79aZN8QMTygT2...|\n|10.1145/contrib-8...|          16|          7|         29|            120|[Chunhui Chen, C....|[3de7AHx2ir5gdFsN...|\n|10.1145/contrib-8...|           4|          4|         28|            110|[Yi Yang, Yang Yang]|[3de79vPrNuUoWySL...|\n|10.1145/contrib-8...|           1|          2|         26|            149|            [Xin Li]|[3de79ZOMSpzxDZck...|\n|10.1145/contrib-8...|           1|          3|         26|            180|         [Meng Wang]|[3de7CJ6kt7QlZN8R...|\n|10.1145/contrib-8...|           3|          2|         24|            167|[Muhammad Imran, ...|[3de7BKAcemvmqagq...|\n|10.1145/contrib-8...|           8|          9|         23|            215|[Fei-Yue Wang, Fu...|[3de7A6OfF2lBPsz6...|\n|10.1145/contrib-8...|          12|         11|         23|             92|[Jian-Ping Zhang,...|[3de7AEgxwNqV6QBn...|\n|10.1145/contrib-8...|           1|          1|         22|             79|            [Tao Li]|[3de7CHWypkQMe6uX...|\n|10.1145/contrib-8...|           1|          4|         21|            210|      [Neeraj Kumar]|[3de7B3z3rUJFyaae...|\n|10.1145/contrib-8...|           4|          4|         21|            339|[P.W. Shi, Peng S...|[3de7BIgD6hR2WSjN...|\n|10.1145/contrib-8...|           1|          4|         21|            128|          [Yang Liu]|[3de7AIBrdmKmH4u9...|\n|10.1145/contrib-8...|           2|          2|         20|             32|         [Wang Ping]|[3de7BDYEEnKDEzum...|\n|10.1145/contrib-8...|           1|          1|         20|             22|           [Wang Bo]|[3de7APQlDKTF6mAw...|\n+--------------------+------------+-----------+-----------+---------------+--------------------+--------------------+\nonly showing top 20 rows\n\n+--------------------+------------+--------------------+--------------------+--------------+\n|         pkgAuthorId|ACMauthorCnt|        oaAuthorName|      acm_author_ids|OAauthorPubCnt|\n+--------------------+------------+--------------------+--------------------+--------------+\n|3de7BhGDHPVQOprzL...|        1276|          [Wei Wang]|[10.1145/contrib-...|          1829|\n|3de7AIBrdmKmH4u9k...|         938|          [Yang Liu]|[10.1145/contrib-...|          1370|\n|3de7AJJr7CB6dT5mJ...|         855|         [Lei Zhang]|[10.1145/contrib-...|          1416|\n|3de7BAGOmaj3cd9do...|         813|          [Lei Wang]|[10.1145/contrib-...|          1062|\n|3de7AGAVAjBme8WBR...|         753| [G. Wang, Jun Wang]|[10.1145/contrib-...|          1164|\n|3de79LDy7W9kYezNa...|         733|         [Yang Yang]|[10.1145/contrib-...|          1135|\n|3de79ZOMSpzxDZckx...|         717|    [Xin LI, Xin Li]|[10.1145/contrib-...|          1219|\n|3de7Af0t0Q87uREZq...|         689|[Yu Zhang, Y. Zhang]|[10.1145/contrib-...|           903|\n|3de79H2Hg3CLFHAtH...|         655|          [Xin Wang]|[10.1145/contrib-...|           950|\n|3de79lP0decTL7vRT...|         640|         [Wei Zhang]|[10.1145/contrib-...|           894|\n|3de7AG4GYjjUBk3Em...|         633|[Yan Zhang, Y. Zh...|[10.1145/contrib-...|           869|\n|3de79HxPHMyBQ3b6q...|         625|[Jing Wang, JING ...|[10.1145/contrib-...|           758|\n|3de7A23QCHNhQ3rfB...|         620|           [Jing Li]|[10.1145/contrib-...|           817|\n|3de7CUZfxIFOFsJDv...|         617|         [Jun Zhang]|[10.1145/contrib-...|          1037|\n|3de7AemMGCQ25Ycdx...|         609|        [Jing Zhang]|[10.1145/contrib-...|           798|\n|3de7CbaR42YWYrASj...|         576|          [Hao Wang]|[10.1145/contrib-...|           798|\n|3de79rbfSRIcBtUxp...|         573|          [Yan Wang]|[10.1145/contrib-...|           808|\n|3de79YXcvRxNtdV6l...|         566|           [Yu Wang]|[10.1145/contrib-...|           873|\n|3de79be35ynGscsMs...|         560|          [Li Zhang]|[10.1145/contrib-...|           932|\n|3de7AEgxwNqV6QBny...|         559|         [Jie Zhang]|[10.1145/contrib-...|           849|\n+--------------------+------------+--------------------+--------------------+--------------+\nonly showing top 20 rows\n\nacm2pkg_bestMatch count: 2376731\nacm2pkg_bestMatch_ext count: 2376731\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.9855700691194155|     0.7056432271142055| 0.6943706770353584|\n+--------------------------+-----------------------+-------------------+\n\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.9696369735383513|     0.8852092391695967| 0.8603482711113665|\n+--------------------------+-----------------------+-------------------+\n\npkg2acm_bestMatch count: 1788971\npkg2acm_bestMatch_ext count: 1788971\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|         0.937151889982684|     0.9445093677507338| 0.8856261279716648|\n+--------------------------+-----------------------+-------------------+\n\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.8138754875938826|     0.9431378535599948| 0.7685030888176483|\n+--------------------------+-----------------------+-------------------+\n\nacmPerS2 count: 1942158\nacmPerS2 count 1-1: 1634209\n+----------+------------+--------------------+--------------------+--------------+\n|S2AuthorId|ACMauthorCnt|        oaAuthorName|      acm_author_ids|OAauthorPubCnt|\n+----------+------------+--------------------+--------------------+--------------+\n|  46276037|         263|[Jing Li, Jun Li,...|[10.1145/contrib-...|           354|\n|  47740650|         228|[J. Bradley Chen,...|[10.1145/contrib-...|           304|\n|  48379623|         224|[Yu Zhang, Y. Zha...|[10.1145/contrib-...|           286|\n|  36124320|         217|[Yuan Wang, Yan Z...|[10.1145/contrib-...|           277|\n|   9756930|         216|[Jung-wen Liu, Ju...|[10.1145/contrib-...|           257|\n|  46641573|         211|   [W. Liu, Wei Liu]|[10.1145/contrib-...|           436|\n|  46396571|         190|[Y. Y. Wang, Yang...|[10.1145/contrib-...|           307|\n|   1689115|         190|         [Tao Zhang]|[10.1145/contrib-...|           360|\n|  48016595|         184|[Haodong Wang, Ha...|[10.1145/contrib-...|           223|\n|   1683647|         179|[Xuejiao Chen, X....|[10.1145/contrib-...|           245|\n|   1688428|         173|[J. yang, Ji-yue ...|[10.1145/contrib-...|           264|\n|   1706574|         172|[HaoHai Li, Hao L...|[10.1145/contrib-...|           230|\n|  49528487|         165|[Hongfa Wang, H. ...|[10.1145/contrib-...|           236|\n|  49416173|         164|[Yin Wang, Yu Wan...|[10.1145/contrib-...|           202|\n|   1682816|         162|[Fei-Yue Wang, Fu...|[10.1145/contrib-...|           315|\n|  47558464|         153|[Ying Cheng, Ying...|[10.1145/contrib-...|           175|\n|  46393411|         152|[Yu Wang, Yi Wang...|[10.1145/contrib-...|           203|\n|  47825073|         152|[Wen Wang, Wubin ...|[10.1145/contrib-...|           189|\n|   2096527|         145|[G. Wang, Gangkun...|[10.1145/contrib-...|           354|\n|  46651287|         140|[Chao-Yi Li, C-Q....|[10.1145/contrib-...|           194|\n+----------+------------+--------------------+--------------------+--------------+\nonly showing top 20 rows\n\nacm2S2_bestMatch count: 2376731\nacm2S2_bestMatch_ext count: 2376731\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(S2ProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.9880082722569739|    0.7759368999010067| 0.7672121163317589|\n+--------------------------+----------------------+-------------------+\n\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(S2ProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.9661878209644923|    0.9119094821172642| 0.8841636448893002|\n+--------------------------+----------------------+-------------------+\n\nS22acm_bestMatch count: 1942158\nS22acm_bestMatch_ext count: 1942158\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(S2ProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.9487172329175109|    0.9379997643119524| 0.8916931960783593|\n+--------------------------+----------------------+-------------------+\n\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(S2ProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.7909215315597674|    0.9440156735921507|  0.751579197489723|\n+--------------------------+----------------------+-------------------+\n\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34mOA_S2_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 18 more fields]\n\u001b[1m\u001b[34mpkg_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pkg_acm_doi: string, pkgAuthorId: string ... 3 more fields]\n\u001b[1m\u001b[34mpkg_OA_S2_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 21 more fields]\n\u001b[1m\u001b[34mOA_S2_acm_sign...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\npkgPerAcm.orderBy($\"pkgauthorCnt\" desc).join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"left\" ).show(20,false)\npkgPerAcm.orderBy($\"S2authorCnt\" desc).join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"left\" ).show(20,false)\nacmPerPkg.orderBy($\"ACMauthorCnt\" desc).show(20,false)\nacmPerS2.orderBy($\"ACMauthorCnt\" desc).show(20,false)\n\n",
   "id": "",
   "dateCreated": "2023-03-18 14:54:16.811",
   "config": {},
   "dateStarted": "2023-03-22 10:55:09.752",
   "dateUpdated": "2023-03-22 10:55:30.507",
   "dateFinished": "2023-03-22 10:55:30.507",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mfour feature warnings; for details, enable `:setting -feature' or `:replay -feature'\n+---------------------------+------------+-----------+-----------+---------------+----------------------------------------------------+-----------------------------------------------------------------------+---------------------------+---------+\n|acm_author_id              |pkgauthorCnt|OAauthorCnt|S2authorCnt|acmAuthorPubCnt|oaAuthorName                                        |pkgAuthorIds                                                           |profile_id                 |client_id|\n+---------------------------+------------+-----------+-----------+---------------+----------------------------------------------------+-----------------------------------------------------------------------+---------------------------+---------+\n|10.1145/contrib-81100425758|3           |5          |3          |122            |[Yannis Ioannidis, Yanis Ioannidis, Y. E. Ioannidis]|[3de7AVaIRFi4d1gzxKUfT3, 3de7AVaIRFi4d1gzxKUfT, 3de7AVaIRFi4d1gzxKUfT2]|10.1145/contrib-81100425758|2446300  |\n|10.1145/contrib-81503688974|1           |1          |1          |1              |[Yannis Ioannidis]                                  |[3de7AVaIRFi4d1gzxKUfT]                                                |null                       |null     |\n|10.1145/contrib-99659436974|1           |1          |1          |1              |[Yannis Ioannidis]                                  |[3de7AVaIRFi4d1gzxKUfT]                                                |null                       |null     |\n|10.1145/contrib-99660532861|1           |1          |1          |1              |[Yannis Ioannidis]                                  |[3de7AVaIRFi4d1gzxKUfT]                                                |null                       |null     |\n+---------------------------+------------+-----------+-----------+---------------+----------------------------------------------------+-----------------------------------------------------------------------+---------------------------+---------+\n\n+---------------------------+------------+-----------+-----------+---------------+----------------------------------------------------+-----------------------------------------------------------------------+---------------------------+---------+\n|acm_author_id              |pkgauthorCnt|OAauthorCnt|S2authorCnt|acmAuthorPubCnt|oaAuthorName                                        |pkgAuthorIds                                                           |profile_id                 |client_id|\n+---------------------------+------------+-----------+-----------+---------------+----------------------------------------------------+-----------------------------------------------------------------------+---------------------------+---------+\n|10.1145/contrib-81100425758|3           |5          |3          |122            |[Yannis Ioannidis, Yanis Ioannidis, Y. E. Ioannidis]|[3de7AVaIRFi4d1gzxKUfT3, 3de7AVaIRFi4d1gzxKUfT, 3de7AVaIRFi4d1gzxKUfT2]|10.1145/contrib-81100425758|2446300  |\n|10.1145/contrib-81503688974|1           |1          |1          |1              |[Yannis Ioannidis]                                  |[3de7AVaIRFi4d1gzxKUfT]                                                |null                       |null     |\n|10.1145/contrib-99659436974|1           |1          |1          |1              |[Yannis Ioannidis]                                  |[3de7AVaIRFi4d1gzxKUfT]                                                |null                       |null     |\n|10.1145/contrib-99660532861|1           |1          |1          |1              |[Yannis Ioannidis]                                  |[3de7AVaIRFi4d1gzxKUfT]                                                |null                       |null     |\n+---------------------------+------------+-----------+-----------+---------------+----------------------------------------------------+-----------------------------------------------------------------------+---------------------------+---------+\n\n+----------------------+------------+------------------+--------------------------------------------------------------------------------------------------------------------+--------------+\n|pkgAuthorId           |ACMauthorCnt|oaAuthorName      |acm_author_ids                                                                                                      |OAauthorPubCnt|\n+----------------------+------------+------------------+--------------------------------------------------------------------------------------------------------------------+--------------+\n|3de7AVaIRFi4d1gzxKUfT |4           |[Yannis Ioannidis]|[10.1145/contrib-81100425758, 10.1145/contrib-99659436974, 10.1145/contrib-99660532861, 10.1145/contrib-81503688974]|123           |\n|3de7AVaIRFi4d1gzxKUfT3|1           |[Y. E. Ioannidis] |[10.1145/contrib-81100425758]                                                                                       |1             |\n|3de7AVaIRFi4d1gzxKUfT2|1           |[Yanis Ioannidis] |[10.1145/contrib-81100425758]                                                                                       |1             |\n+----------------------+------------+------------------+--------------------------------------------------------------------------------------------------------------------+--------------+\n\n+----------+------------+----------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+--------------+\n|S2AuthorId|ACMauthorCnt|oaAuthorName                                        |acm_author_ids                                                                                                      |OAauthorPubCnt|\n+----------+------------+----------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+--------------+\n|1684197   |4           |[Yannis Ioannidis, Yanis Ioannidis, Y. E. Ioannidis]|[10.1145/contrib-81100425758, 10.1145/contrib-99659436974, 10.1145/contrib-99660532861, 10.1145/contrib-81503688974]|120           |\n|2156374043|1           |[Yannis Ioannidis]                                  |[10.1145/contrib-81100425758]                                                                                       |4             |\n|2067233305|1           |[Yannis Ioannidis]                                  |[10.1145/contrib-81100425758]                                                                                       |1             |\n+----------+------------+----------------------------------------------------+--------------------------------------------------------------------------------------------------------------------+--------------+\n\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nOA_S2_acm_signatures_dedup.printSchema()",
   "id": "",
   "dateCreated": "2023-03-17 17:28:48.165",
   "config": {},
   "dateStarted": "2023-03-17 17:28:57.354",
   "dateUpdated": "2023-03-17 17:28:57.812",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n |-- pkgAuthorId: string (nullable = true)\n |-- oaAuthorId_old: string (nullable = true)\n |-- pkgAffiliationId: string (nullable = true)\n\n"
     }
    ]
   },
   "dateFinished": "2023-03-17 17:28:57.812"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n///// ACM 2 OA comparison ///////////////////////////\nval acmPerOA =  OA_S2_acm_signatures_dedup.\n  groupBy($\"OAAuthorId\")                \n                .agg(countDistinct(\"acm_author_id\").as(\"ACMauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"acm_author_id\")).as(\"acm_author_ids\")\n                ,count(\"OAdoi\").as(\"OAauthorPubCnt\")                \n                \n                )\n                \nprintln(\"acmPerOA count: \" + acmPerOA.count())\nprintln(\"acmPerOA count 1-1: \" + acmPerOA.filter($\"ACMauthorCnt\"===1).count())\nacmPerOA.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n\n//Find best match & compute similarity\nval acm2OA =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\", $\"OAAuthorId\")                \n                .agg(count(\"OAdoi\").as(\"commonPubCnt\"))\n                \nval wOA = Window.partitionBy($\"acm_author_id\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval acm2OA_bestMatch = acm2OA.withColumn(\"rn\", row_number.over(wOA))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"acm2OA_bestMatch count: \" + acm2OA_bestMatch.count())\n\n\nval acm2OA_bestMatch_ext = acm2OA_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === acm2OA_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerOA, acmPerOA(\"OAAuthorId\") === acm2OA_bestMatch(\"OAAuthorId\"), \"inner\")\n.select(acm2OA_bestMatch(\"acm_author_id\"), acm2OA_bestMatch(\"OAAuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")   \n            .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n            .withColumn(\"OAProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n            .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \n               \n println(\"acm2OA_bestMatch_ext count: \" + acm2OA_bestMatch_ext.count())\n acm2OA_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"OAProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n acm2OA_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"OAProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n           \n\n//////////////////////////////////\n\n//Find best match & compute similarity\n\nval wOA1 = Window.partitionBy($\"OAAuthorId\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA2acm_bestMatch = acm2OA.withColumn(\"rn\", row_number.over(wOA1))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"OA2acm_bestMatch count: \" + OA2acm_bestMatch.count())\n\n\nval OA2acm_bestMatch_ext = OA2acm_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === S22acm_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerOA, acmPerOA(\"OAAuthorId\") === OA2acm_bestMatch(\"OAAuthorId\"), \"inner\")\n.select(S22acm_bestMatch(\"acm_author_id\"), OA2acm_bestMatch(\"OAAuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")\n           .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n           .withColumn(\"OAProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n           .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \nprintln(\"OA2acm_bestMatch_ext count: \" + OA2acm_bestMatch_ext.count())\nOA2acm_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"OAProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\nOA2acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"OAProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n",
   "id": "",
   "dateCreated": "2023-03-17 15:12:00.584",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-03-17 15:15:53.175",
   "dateUpdated": "2023-03-17 15:16:56.367",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mthree feature warnings; for details, enable `:setting -feature' or `:replay -feature'\nacmPerOA count: 1716828\nacmPerOA count 1-1: 1451116\n+-----------+------------+------------+--------------------+--------------+\n| OAAuthorId|ACMauthorCnt|oaAuthorName|      acm_author_ids|OAauthorPubCnt|\n+-----------+------------+------------+--------------------+--------------+\n|A2240993880|        1439| [Jing Wang]|[10.1145/contrib-...|          1874|\n|A2244066162|        1343|  [Wei Wang]|[10.1145/contrib-...|          1906|\n|A2625744659|        1061|    [Yan Li]|[10.1145/contrib-...|          1405|\n|A2777773917|         971|    [Xin Li]|[10.1145/contrib-...|          1614|\n|A2776297621|         937|  [Yang Liu]|[10.1145/contrib-...|          1366|\n|A2299437103|         927| [Lei Zhang]|[10.1145/contrib-...|          1500|\n|A2296726285|         912| [Yang Yang]|[10.1145/contrib-...|          1382|\n|A2603303308|         811| [Jian Yang]|[10.1145/contrib-...|          1262|\n|A2559461216|         800|   [Yu Wang]|[10.1145/contrib-...|          1145|\n|A2722169877|         798|  [Lei Wang]|[10.1145/contrib-...|          1042|\n|A3179542944|         763| [Jie Zhang]|[10.1145/contrib-...|          1144|\n|A2947008211|         762|  [Jun Wang]|[10.1145/contrib-...|          1171|\n|A2608928330|         719| [Wei Zhang]|[10.1145/contrib-...|          1033|\n|A2701680931|         708|  [Yu Zhang]|[10.1145/contrib-...|           929|\n|A2506556770|         681|  [Xin Wang]|[10.1145/contrib-...|           988|\n|A2922890431|         664|   [Li Wang]|[10.1145/contrib-...|           877|\n|A2256822898|         644| [Yan Zhang]|[10.1145/contrib-...|           888|\n|A2502348156|         635|   [Jing Li]|[10.1145/contrib-...|           839|\n|A2564178022|         628|[Jing Zhang]|[10.1145/contrib-...|           817|\n|A2096219712|         623| [Jun Zhang]|[10.1145/contrib-...|          1032|\n+-----------+------------+------------+--------------------+--------------+\nonly showing top 20 rows\n\nacm2OA_bestMatch count: 2376731\nacm2OA_bestMatch_ext count: 2376731\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(OAProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.9797949725828583|     0.652423302437881| 0.6376467446087909|\n+--------------------------+----------------------+-------------------+\n\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(OAProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.9569469884751994|    0.8497115891773509| 0.8165580457351034|\n+--------------------------+----------------------+-------------------+\n\nOA2acm_bestMatch count: 1716828\nOA2acm_bestMatch_ext count: 1716828\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(OAProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.9029020881636433|    0.9354946541605279| 0.8438422585249903|\n+--------------------------+----------------------+-------------------+\n\n+--------------------------+----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(OAProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+----------------------+-------------------+\n|        0.7154403183472213|    0.9367299460540665| 0.6665792531482306|\n+--------------------------+----------------------+-------------------+\n\n\u001b[1m\u001b[34macmPerOA\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OAAuthorId: string, ACMauthorCnt: bigint ... 3 more fields]\n\u001b[1m\u001b[34macm2OA\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [acm_author_id: string, OAAuthorId: string ... 1 more field]\n\u001b[1m\u001b[34mwOA\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@64069d66\n\u001b[1m\u001b[34macm2OA_bestMatch\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [acm_author_id: string, OAAuthorId: string ... 1 more field]\n\u001b[1m\u001b[34macm2OA_bestMatch_ext\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [acm_author_id: string, OAAuthorId: string ... 6 more fields]\n\u001b[1m\u001b[34mwOA1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = or...\n"
     }
    ]
   },
   "dateFinished": "2023-03-17 15:16:56.367"
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nacmPerS2.orderBy($\"acmauthorCnt\" desc).show(20, false)",
   "id": "",
   "dateCreated": "2023-03-15 09:48:55.337",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2023-03-15 09:49:07.487",
   "dateUpdated": "2023-03-15 09:49:20.585",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mone feature warning; for details, enable `:setting -feature' or `:replay -feature'\n+----------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+\n|S2AuthorId|ACMauthorCnt|oaAuthorName                                                                                                                                                                                        |acm_author_ids                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |OAauthorPubCnt|\n+----------+------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+\n|46276037  |263         |[Jing Li, Jun Li, Jian Li, Junfeng Li, Junhui Li, J. C. Li, Jun Lin, Junfang Li]                                                                                                                    |[10.1145/contrib-81423595247, 10.1145/contrib-81537799856, 10.1145/contrib-89758728657, 10.1145/contrib-99658622306, 10.1145/contrib-99659142224, 10.1145/contrib-81387607228, 10.1145/contrib-99660239766, 10.1145/contrib-81423595237, 10.1145/contrib-99660350610, 10.1145/contrib-81100486294, 10.1145/contrib-81502750680, 10.1145/contrib-81502750640, 10.1145/contrib-99660350614, 10.1145/contrib-99659391137, 10.1145/contrib-99659391097, 10.1145/contrib-99659247681, 10.1145/contrib-99659390892, 10.1145/contrib-81384605180, 10.1145/contrib-99659390866, 10.1145/contrib-99659606901, 10.1145/contrib-99659843210, 10.1145/contrib-81392603211, 10.1145/contrib-99658659345, 10.1145/contrib-99660227982, 10.1145/contrib-99659761400, 10.1145/contrib-99659123040, 10.1145/contrib-99659391081, 10.1145/contrib-81474666548, 10.1145/contrib-99658683745, 10.1145/contrib-99660560729, 10.1145/contrib-81474666537, 10.1145/contrib-99660350849, 10.1145/contrib-81453626212, 10.1145/contrib-81464654072, 10.1145/contrib-99659312167, 10.1145/contrib-99660380361, 10.1145/contrib-81548009375, 10.1145/contrib-99659391176, 10.1145/contrib-81309499191, 10.1145/contrib-99660350715, 10.1145/contrib-99659336994, 10.1145/contrib-81453626152, 10.1145/contrib-99659391006, 10.1145/contrib-99660590096, 10.1145/contrib-99659391219, 10.1145/contrib-81482655940, 10.1145/contrib-99658622392, 10.1145/contrib-99659761429, 10.1145/contrib-81375612671, 10.1145/contrib-81322499768, 10.1145/contrib-81100486147, 10.1145/contrib-81442601369, 10.1145/contrib-99659231611, 10.1145/contrib-81488653062, 10.1145/contrib-99659391610, 10.1145/contrib-99659247708, 10.1145/contrib-99659390899, 10.1145/contrib-99659391573, 10.1145/contrib-81503673944, 10.1145/contrib-81452602487, 10.1145/contrib-99659044730, 10.1145/contrib-99659391079, 10.1145/contrib-81537796856, 10.1145/contrib-87658651657, 10.1145/contrib-99658771914, 10.1145/contrib-99659391333, 10.1145/contrib-99660485534, 10.1145/contrib-81387607186, 10.1145/contrib-99659391051, 10.1145/contrib-99660350659, 10.1145/contrib-99659391018, 10.1145/contrib-81453626292, 10.1145/contrib-81537801856, 10.1145/contrib-81318490396, 10.1145/contrib-99659391527, 10.1145/contrib-81492653298, 10.1145/contrib-99659391090, 10.1145/contrib-81490660672, 10.1145/contrib-99660227778, 10.1145/contrib-99658683757, 10.1145/contrib-81502750597, 10.1145/contrib-99660380367, 10.1145/contrib-81442601637, 10.1145/contrib-81423595239, 10.1145/contrib-99660227948, 10.1145/contrib-99660551909, 10.1145/contrib-81549368556, 10.1145/contrib-99659347419, 10.1145/contrib-81453626255, 10.1145/contrib-83358940457, 10.1145/contrib-99660643964, 10.1145/contrib-99660239743, 10.1145/contrib-99659761425, 10.1145/contrib-81548032075, 10.1145/contrib-99658702890, 10.1145/contrib-81309492072, 10.1145/contrib-99659124251, 10.1145/contrib-81100486276, 10.1145/contrib-81490660572, 10.1145/contrib-81558589656, 10.1145/contrib-99659391327, 10.1145/contrib-81423595251, 10.1145/contrib-99659391652, 10.1145/contrib-99660350670, 10.1145/contrib-81479658662, 10.1145/contrib-81453626225, 10.1145/contrib-99659727750, 10.1145/contrib-99660239762, 10.1145/contrib-99659391020, 10.1145/contrib-99659263459, 10.1145/contrib-81100486072, 10.1145/contrib-81384605160, 10.1145/contrib-99658622287, 10.1145/contrib-81496659062, 10.1145/contrib-81537798956, 10.1145/contrib-81548012987, 10.1145/contrib-99659391216, 10.1145/contrib-99659761386, 10.1145/contrib-99660650622, 10.1145/contrib-81456624382, 10.1145/contrib-81502750566, 10.1145/contrib-99659727763, 10.1145/contrib-81548009090, 10.1145/contrib-82658786757, 10.1145/contrib-81365597181, 10.1145/contrib-99660055540, 10.1145/contrib-99658622268, 10.1145/contrib-81350597946, 10.1145/contrib-99659312300, 10.1145/contrib-81453626129, 10.1145/contrib-99660351069, 10.1145/contrib-99659391520, 10.1145/contrib-81508701004, 10.1145/contrib-81474666509, 10.1145/contrib-81558589256, 10.1145/contrib-99659272904, 10.1145/contrib-99659791541, 10.1145/contrib-81502750674, 10.1145/contrib-99659791536, 10.1145/contrib-81558549356, 10.1145/contrib-81548041482, 10.1145/contrib-81317496400, 10.1145/contrib-99660499200, 10.1145/contrib-99660227925, 10.1145/contrib-81502750626, 10.1145/contrib-99658959451, 10.1145/contrib-81496659055, 10.1145/contrib-99659322966, 10.1145/contrib-99659659431, 10.1145/contrib-99659391217, 10.1145/contrib-81498657347, 10.1145/contrib-99659390984, 10.1145/contrib-81490660545, 10.1145/contrib-99658960715, 10.1145/contrib-99660532239, 10.1145/contrib-99660567677, 10.1145/contrib-99659391250, 10.1145/contrib-81367597836, 10.1145/contrib-81537796656, 10.1145/contrib-81442601373, 10.1145/contrib-99659391491, 10.1145/contrib-87658611857, 10.1145/contrib-99659606941, 10.1145/contrib-99659058312, 10.1145/contrib-99660369921, 10.1145/contrib-99660079251, 10.1145/contrib-81447601025, 10.1145/contrib-99659391145, 10.1145/contrib-99659390837, 10.1145/contrib-99660107220, 10.1145/contrib-99658771915, 10.1145/contrib-99659312379, 10.1145/contrib-81537797156, 10.1145/contrib-81309497512, 10.1145/contrib-99659081384, 10.1145/contrib-81496659066, 10.1145/contrib-99658689636, 10.1145/contrib-81474666491, 10.1145/contrib-99659391218, 10.1145/contrib-81453626218, 10.1145/contrib-99659391034, 10.1145/contrib-99660106982, 10.1145/contrib-99659449980, 10.1145/contrib-99659391220, 10.1145/contrib-81339512853, 10.1145/contrib-99659761423, 10.1145/contrib-82658771757, 10.1145/contrib-99659391654, 10.1145/contrib-81537803456, 10.1145/contrib-99659175729, 10.1145/contrib-99659097485, 10.1145/contrib-99659391096, 10.1145/contrib-99659923553, 10.1145/contrib-99659606942, 10.1145/contrib-99660539476, 10.1145/contrib-99660636941, 10.1145/contrib-82258983557, 10.1145/contrib-99659391086, 10.1145/contrib-99659727753, 10.1145/contrib-81492653303, 10.1145/contrib-99660350731, 10.1145/contrib-99659076478, 10.1145/contrib-99659391463, 10.1145/contrib-99659355234, 10.1145/contrib-81486653070, 10.1145/contrib-99659391265, 10.1145/contrib-99660485543, 10.1145/contrib-99660569409, 10.1145/contrib-99659391032, 10.1145/contrib-81502750688, 10.1145/contrib-81414603640, 10.1145/contrib-81490660627, 10.1145/contrib-99660106998, 10.1145/contrib-99659667518, 10.1145/contrib-99660227877, 10.1145/contrib-81496659040, 10.1145/contrib-99659391133, 10.1145/contrib-81474666473, 10.1145/contrib-81100486080, 10.1145/contrib-81387607168, 10.1145/contrib-99660590081, 10.1145/contrib-99659391604, 10.1145/contrib-99659376781, 10.1145/contrib-99659391048, 10.1145/contrib-99660350861, 10.1145/contrib-99659367901, 10.1145/contrib-99659391662, 10.1145/contrib-87259457057, 10.1145/contrib-99660079379, 10.1145/contrib-82459291357, 10.1145/contrib-99660106997, 10.1145/contrib-87058693757, 10.1145/contrib-99659825031, 10.1145/contrib-99658648470, 10.1145/contrib-81312484756, 10.1145/contrib-99659801747, 10.1145/contrib-99660727112, 10.1145/contrib-99660499182, 10.1145/contrib-99659391621, 10.1145/contrib-99659391144, 10.1145/contrib-99659058310, 10.1145/contrib-81549379256, 10.1145/contrib-81467643372, 10.1145/contrib-99658720804, 10.1145/contrib-99659205060, 10.1145/contrib-99659791649, 10.1145/contrib-99659391576, 10.1145/contrib-99658978431, 10.1145/contrib-99659449973, 10.1145/contrib-81333489424, 10.1145/contrib-99659391572, 10.1145/contrib-99659391401, 10.1145/contrib-81100486125, 10.1145/contrib-81548043195, 10.1145/contrib-99659390960, 10.1145/contrib-99659175776, 10.1145/contrib-81421603640, 10.1145/contrib-81453626257, 10.1145/contrib-99660227956, 10.1145/contrib-99659237421, 10.1145/contrib-99659263540, 10.1145/contrib-99660575127, 10.1145/contrib-81474666568]|354           |\n|47740650  |228         |[J. Bradley Chen, Jian Chen, J Chen, Jiangyu Chen, Jian-Shiu Chen, Jing M. Chen, Jing Chen, Jie Chen, J. C. Chen, Jieying Chen, Jie-Kun Chen, Biao Chen]                                            |[10.1145/contrib-81339493438, 10.1145/contrib-99659384403, 10.1145/contrib-81492651444, 10.1145/contrib-99660719998, 10.1145/contrib-99660360144, 10.1145/contrib-81309487286, 10.1145/contrib-99659384640, 10.1145/contrib-81474684748, 10.1145/contrib-99659384707, 10.1145/contrib-99659384241, 10.1145/contrib-81479655887, 10.1145/contrib-99659384322, 10.1145/contrib-99658649785, 10.1145/contrib-81375608859, 10.1145/contrib-81318488458, 10.1145/contrib-81496680539, 10.1145/contrib-81492651466, 10.1145/contrib-99658702558, 10.1145/contrib-81430629367, 10.1145/contrib-81548017796, 10.1145/contrib-99659384629, 10.1145/contrib-99659384483, 10.1145/contrib-99659384636, 10.1145/contrib-99659384758, 10.1145/contrib-99660734540, 10.1145/contrib-84459346257, 10.1145/contrib-81444603415, 10.1145/contrib-81556726356, 10.1145/contrib-99658649770, 10.1145/contrib-81492651465, 10.1145/contrib-99659384736, 10.1145/contrib-81100119112, 10.1145/contrib-81444603403, 10.1145/contrib-99659384701, 10.1145/contrib-81548780656, 10.1145/contrib-81508698890, 10.1145/contrib-81490683072, 10.1145/contrib-99659384482, 10.1145/contrib-81332492654, 10.1145/contrib-81758792257, 10.1145/contrib-99659384466, 10.1145/contrib-81384614045, 10.1145/contrib-81467660092, 10.1145/contrib-99659384635, 10.1145/contrib-99659384722, 10.1145/contrib-81482653983, 10.1145/contrib-99659384616, 10.1145/contrib-84459337457, 10.1145/contrib-99659384379, 10.1145/contrib-81556731156, 10.1145/contrib-99659384735, 10.1145/contrib-81385600904, 10.1145/contrib-81484651748, 10.1145/contrib-99658649755, 10.1145/contrib-81474684838, 10.1145/contrib-81502705633, 10.1145/contrib-99659384290, 10.1145/contrib-81442609223, 10.1145/contrib-81540817356, 10.1145/contrib-81467660107, 10.1145/contrib-81474684929, 10.1145/contrib-81496680728, 10.1145/contrib-99659384230, 10.1145/contrib-81375608856, 10.1145/contrib-81498655264, 10.1145/contrib-99659384767, 10.1145/contrib-99659384702, 10.1145/contrib-81490683067, 10.1145/contrib-99659384683, 10.1145/contrib-81492651457, 10.1145/contrib-81552165756, 10.1145/contrib-99659433527, 10.1145/contrib-81447598778, 10.1145/contrib-99659384388, 10.1145/contrib-99660553004, 10.1145/contrib-81540822056, 10.1145/contrib-99659384429, 10.1145/contrib-99659384393, 10.1145/contrib-81440597037, 10.1145/contrib-99660539253, 10.1145/contrib-81490682952, 10.1145/contrib-81487650684, 10.1145/contrib-84459345357, 10.1145/contrib-81502705653, 10.1145/contrib-81392614457, 10.1145/contrib-81408598645, 10.1145/contrib-99659613308, 10.1145/contrib-81331490299, 10.1145/contrib-81100119299, 10.1145/contrib-81385599932, 10.1145/contrib-81343490353, 10.1145/contrib-81456625539, 10.1145/contrib-81387600337, 10.1145/contrib-81548049167, 10.1145/contrib-99659384643, 10.1145/contrib-99659384413, 10.1145/contrib-99658639865, 10.1145/contrib-81502706575, 10.1145/contrib-99659384320, 10.1145/contrib-81482653964, 10.1145/contrib-81548009861, 10.1145/contrib-99660639544, 10.1145/contrib-81479655864, 10.1145/contrib-81342491147, 10.1145/contrib-99660720005, 10.1145/contrib-99659384615, 10.1145/contrib-99660562768, 10.1145/contrib-81350579208, 10.1145/contrib-81456625435, 10.1145/contrib-99660562749, 10.1145/contrib-81550252556, 10.1145/contrib-99660539239, 10.1145/contrib-81490682990, 10.1145/contrib-84459320257, 10.1145/contrib-81502705847, 10.1145/contrib-81442609261, 10.1145/contrib-81375608826, 10.1145/contrib-81339493315, 10.1145/contrib-81453645287, 10.1145/contrib-81392614424, 10.1145/contrib-99660553010, 10.1145/contrib-83458914057, 10.1145/contrib-81554891556, 10.1145/contrib-87059077857, 10.1145/contrib-81388598777, 10.1145/contrib-81330489156, 10.1145/contrib-81490682920, 10.1145/contrib-99659384292, 10.1145/contrib-81384614024, 10.1145/contrib-81100119328, 10.1145/contrib-99660601077, 10.1145/contrib-81392614492, 10.1145/contrib-87259652057, 10.1145/contrib-81444603408, 10.1145/contrib-81490683223, 10.1145/contrib-81442609222, 10.1145/contrib-81375608837, 10.1145/contrib-81309495279, 10.1145/contrib-81392614429, 10.1145/contrib-81501673608, 10.1145/contrib-81548014869, 10.1145/contrib-99659384423, 10.1145/contrib-81461652575, 10.1145/contrib-81508698884, 10.1145/contrib-99659032963, 10.1145/contrib-84459361157, 10.1145/contrib-99660370347, 10.1145/contrib-99659384781, 10.1145/contrib-81367593733, 10.1145/contrib-81435605278, 10.1145/contrib-81453645247, 10.1145/contrib-81363598696, 10.1145/contrib-99660683886, 10.1145/contrib-99659384330, 10.1145/contrib-99659384431, 10.1145/contrib-99658687634, 10.1145/contrib-81492651445, 10.1145/contrib-81317491808, 10.1145/contrib-81492651441, 10.1145/contrib-81474684720, 10.1145/contrib-81554922956, 10.1145/contrib-99659384651, 10.1145/contrib-99659384743, 10.1145/contrib-81548782956, 10.1145/contrib-81485651860, 10.1145/contrib-81556743256, 10.1145/contrib-81384614034, 10.1145/contrib-81496680661, 10.1145/contrib-82858614257, 10.1145/contrib-81540820756, 10.1145/contrib-81384614026, 10.1145/contrib-81467660085, 10.1145/contrib-81502706122, 10.1145/contrib-81387600380, 10.1145/contrib-99659384507, 10.1145/contrib-99659384377, 10.1145/contrib-84459347757, 10.1145/contrib-81387600382, 10.1145/contrib-81496680679, 10.1145/contrib-81387600376, 10.1145/contrib-81309496206, 10.1145/contrib-81492651476, 10.1145/contrib-81479655843, 10.1145/contrib-81496680571, 10.1145/contrib-81496680742, 10.1145/contrib-81384614050, 10.1145/contrib-81482653984, 10.1145/contrib-99659384589, 10.1145/contrib-81448597971, 10.1145/contrib-81503670970, 10.1145/contrib-99658622010, 10.1145/contrib-81430629712, 10.1145/contrib-82858612657, 10.1145/contrib-99658649794, 10.1145/contrib-81467660122, 10.1145/contrib-81387600339, 10.1145/contrib-81492651443, 10.1145/contrib-82658669157, 10.1145/contrib-81388598769, 10.1145/contrib-99660601076, 10.1145/contrib-99658649799, 10.1145/contrib-99659384409, 10.1145/contrib-81485651861, 10.1145/contrib-81552175756, 10.1145/contrib-99659384435, 10.1145/contrib-81550258556, 10.1145/contrib-81387600371, 10.1145/contrib-99658639867, 10.1145/contrib-81442609221, 10.1145/contrib-81416603420, 10.1145/contrib-99659384730, 10.1145/contrib-81408598614, 10.1145/contrib-81493654683, 10.1145/contrib-81486651228, 10.1145/contrib-81502705736, 10.1145/contrib-99659384372, 10.1145/contrib-81481647262, 10.1145/contrib-81435605286, 10.1145/contrib-99659384691, 10.1145/contrib-81387600379, 10.1145/contrib-99659384481, 10.1145/contrib-81550249456, 10.1145/contrib-99658741433, 10.1145/contrib-99659384671, 10.1145/contrib-81451599827, 10.1145/contrib-99660051458, 10.1145/contrib-81100118994, 10.1145/contrib-81385599929]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |304           |\n|48379623  |224         |[Yu Zhang, Y. Zhang, Ying Zhang, Yi Zhang, Yi Hong]                                                                                                                                                 |[10.1145/contrib-81317502607, 10.1145/contrib-99660643132, 10.1145/contrib-99659388278, 10.1145/contrib-99659388134, 10.1145/contrib-99659388053, 10.1145/contrib-99658738195, 10.1145/contrib-99660722469, 10.1145/contrib-99659388400, 10.1145/contrib-81467661029, 10.1145/contrib-99659387740, 10.1145/contrib-99659387938, 10.1145/contrib-99659783151, 10.1145/contrib-99658651341, 10.1145/contrib-99659388433, 10.1145/contrib-99660318260, 10.1145/contrib-99659264234, 10.1145/contrib-99658768861, 10.1145/contrib-81498654735, 10.1145/contrib-99660638903, 10.1145/contrib-99659388441, 10.1145/contrib-81501653530, 10.1145/contrib-99658623613, 10.1145/contrib-81553794956, 10.1145/contrib-99659387767, 10.1145/contrib-81538724956, 10.1145/contrib-81552708856, 10.1145/contrib-81758838057, 10.1145/contrib-99659611031, 10.1145/contrib-86158827957, 10.1145/contrib-99659388523, 10.1145/contrib-81408598733, 10.1145/contrib-99659388287, 10.1145/contrib-99659387403, 10.1145/contrib-81408598727, 10.1145/contrib-81496659161, 10.1145/contrib-99660318388, 10.1145/contrib-99659388435, 10.1145/contrib-81375612959, 10.1145/contrib-81548013461, 10.1145/contrib-99659388396, 10.1145/contrib-81442601526, 10.1145/contrib-89558691557, 10.1145/contrib-81492651368, 10.1145/contrib-99659387580, 10.1145/contrib-81508699035, 10.1145/contrib-99659388335, 10.1145/contrib-99659225732, 10.1145/contrib-84458828157, 10.1145/contrib-99659497274, 10.1145/contrib-99659387096, 10.1145/contrib-99659387221, 10.1145/contrib-81385601595, 10.1145/contrib-99659611108, 10.1145/contrib-99659783155, 10.1145/contrib-84458862457, 10.1145/contrib-99659124946, 10.1145/contrib-99659744516, 10.1145/contrib-81553047156, 10.1145/contrib-81490656713, 10.1145/contrib-81487649447, 10.1145/contrib-81387603195, 10.1145/contrib-99660562533, 10.1145/contrib-99659130852, 10.1145/contrib-81335500336, 10.1145/contrib-99659937166, 10.1145/contrib-99660149843, 10.1145/contrib-99660006206, 10.1145/contrib-99659388357, 10.1145/contrib-81414603932, 10.1145/contrib-81554873156, 10.1145/contrib-99660552304, 10.1145/contrib-99659388484, 10.1145/contrib-99659388452, 10.1145/contrib-81340494153, 10.1145/contrib-81361602529, 10.1145/contrib-99660318389, 10.1145/contrib-99659387242, 10.1145/contrib-99658623789, 10.1145/contrib-81500648653, 10.1145/contrib-84458812357, 10.1145/contrib-99659012902, 10.1145/contrib-99659387054, 10.1145/contrib-81387603202, 10.1145/contrib-81474661552, 10.1145/contrib-99660318899, 10.1145/contrib-99660318358, 10.1145/contrib-99659387721, 10.1145/contrib-99658627853, 10.1145/contrib-81508698995, 10.1145/contrib-81408598740, 10.1145/contrib-81498654760, 10.1145/contrib-99659012894, 10.1145/contrib-99659387167, 10.1145/contrib-99659085357, 10.1145/contrib-99659723326, 10.1145/contrib-81490656828, 10.1145/contrib-81501653629, 10.1145/contrib-99659387765, 10.1145/contrib-81408598737, 10.1145/contrib-99659387152, 10.1145/contrib-99659388367, 10.1145/contrib-99658651317, 10.1145/contrib-99659228470, 10.1145/contrib-99659387801, 10.1145/contrib-99658712264, 10.1145/contrib-99659276300, 10.1145/contrib-99659199425, 10.1145/contrib-81442601267, 10.1145/contrib-99660736694, 10.1145/contrib-81387603171, 10.1145/contrib-81464651917, 10.1145/contrib-99659388173, 10.1145/contrib-99659012881, 10.1145/contrib-81472650839, 10.1145/contrib-81500648674, 10.1145/contrib-99660150049, 10.1145/contrib-99659387996, 10.1145/contrib-81550789556, 10.1145/contrib-99659807934, 10.1145/contrib-99659387345, 10.1145/contrib-81317503233, 10.1145/contrib-81408598735, 10.1145/contrib-99659296262, 10.1145/contrib-99659387774, 10.1145/contrib-99659149082, 10.1145/contrib-81493653057, 10.1145/contrib-81388600284, 10.1145/contrib-81453621951, 10.1145/contrib-99659388531, 10.1145/contrib-99659387415, 10.1145/contrib-99659807951, 10.1145/contrib-81408598721, 10.1145/contrib-99658707375, 10.1145/contrib-99659388274, 10.1145/contrib-99660150051, 10.1145/contrib-99659045893, 10.1145/contrib-81440612532, 10.1145/contrib-81408598709, 10.1145/contrib-81538718656, 10.1145/contrib-99659005289, 10.1145/contrib-99660318594, 10.1145/contrib-81384601254, 10.1145/contrib-81351595394, 10.1145/contrib-81384601252, 10.1145/contrib-99659387381, 10.1145/contrib-99659076319, 10.1145/contrib-99659279633, 10.1145/contrib-99658623814, 10.1145/contrib-81309495605, 10.1145/contrib-99659251146, 10.1145/contrib-84458851757, 10.1145/contrib-99659387086, 10.1145/contrib-99659387990, 10.1145/contrib-99659083605, 10.1145/contrib-99658623938, 10.1145/contrib-87059067857, 10.1145/contrib-81372593150, 10.1145/contrib-99658627903, 10.1145/contrib-99658970332, 10.1145/contrib-81339527233, 10.1145/contrib-81554881056, 10.1145/contrib-81502750795, 10.1145/contrib-83358830757, 10.1145/contrib-99659387409, 10.1145/contrib-99658625612, 10.1145/contrib-81467661000, 10.1145/contrib-99660318840, 10.1145/contrib-99659387485, 10.1145/contrib-99659387241, 10.1145/contrib-81548709556, 10.1145/contrib-99660680273, 10.1145/contrib-81496659283, 10.1145/contrib-99659723221, 10.1145/contrib-99659388230, 10.1145/contrib-81460645435, 10.1145/contrib-81408598734, 10.1145/contrib-99659302499, 10.1145/contrib-99660318417, 10.1145/contrib-99659388076, 10.1145/contrib-99659387729, 10.1145/contrib-99659388501, 10.1145/contrib-99659388393, 10.1145/contrib-81447599557, 10.1145/contrib-99659165291, 10.1145/contrib-99659744543, 10.1145/contrib-99659304938, 10.1145/contrib-99659388519, 10.1145/contrib-99658686515, 10.1145/contrib-81557819356, 10.1145/contrib-81408598716, 10.1145/contrib-81492651399, 10.1145/contrib-81486651520, 10.1145/contrib-99659388288, 10.1145/contrib-81458652004, 10.1145/contrib-99659387176, 10.1145/contrib-99659110952, 10.1145/contrib-81423593271, 10.1145/contrib-99659111038, 10.1145/contrib-81490656815, 10.1145/contrib-81458652074, 10.1145/contrib-99660318148, 10.1145/contrib-81385601607, 10.1145/contrib-81552698456, 10.1145/contrib-81538715556, 10.1145/contrib-81548688356, 10.1145/contrib-99659387252, 10.1145/contrib-81456627100, 10.1145/contrib-99660240762, 10.1145/contrib-81474661572, 10.1145/contrib-81344491830, 10.1145/contrib-99659388479, 10.1145/contrib-99659203245, 10.1145/contrib-81384601183, 10.1145/contrib-81375612970, 10.1145/contrib-81339540359, 10.1145/contrib-99659387199, 10.1145/contrib-99659343515, 10.1145/contrib-81361602450, 10.1145/contrib-81375613067, 10.1145/contrib-99659221563, 10.1145/contrib-87358627157, 10.1145/contrib-99659388265, 10.1145/contrib-99659388148, 10.1145/contrib-81440612647]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |286           |\n|36124320  |217         |[Yuan Wang, Yan Zhang, Yong Zhang, Yuan Cun-dal, Y. Zhang, Yan Huang, Ying Zhang, Yanshen Yin]                                                                                                      |[10.1145/contrib-99659080076, 10.1145/contrib-99660017722, 10.1145/contrib-99659387149, 10.1145/contrib-99659611078, 10.1145/contrib-99659111702, 10.1145/contrib-99659228115, 10.1145/contrib-84458674057, 10.1145/contrib-99659387937, 10.1145/contrib-99659783177, 10.1145/contrib-99659744487, 10.1145/contrib-99659299663, 10.1145/contrib-99659357446, 10.1145/contrib-99659196552, 10.1145/contrib-99659016422, 10.1145/contrib-81318497240, 10.1145/contrib-81100126930, 10.1145/contrib-99659217634, 10.1145/contrib-81447599546, 10.1145/contrib-81500648689, 10.1145/contrib-81490656705, 10.1145/contrib-99660149799, 10.1145/contrib-99660034220, 10.1145/contrib-99659744519, 10.1145/contrib-99659387522, 10.1145/contrib-81414603907, 10.1145/contrib-99660318764, 10.1145/contrib-81492651380, 10.1145/contrib-99659070667, 10.1145/contrib-81496659138, 10.1145/contrib-81387603198, 10.1145/contrib-99658651337, 10.1145/contrib-99659027040, 10.1145/contrib-99659161644, 10.1145/contrib-81550803756, 10.1145/contrib-99659388499, 10.1145/contrib-81479657702, 10.1145/contrib-99659388333, 10.1145/contrib-99658970329, 10.1145/contrib-99658999500, 10.1145/contrib-81387603190, 10.1145/contrib-81493653058, 10.1145/contrib-81447599555, 10.1145/contrib-81387603150, 10.1145/contrib-99659723309, 10.1145/contrib-99659270689, 10.1145/contrib-81387603217, 10.1145/contrib-81453622004, 10.1145/contrib-81317502654, 10.1145/contrib-99660318865, 10.1145/contrib-99659388201, 10.1145/contrib-99659025768, 10.1145/contrib-81538722356, 10.1145/contrib-99660149977, 10.1145/contrib-99660591883, 10.1145/contrib-81387603181, 10.1145/contrib-81319505412, 10.1145/contrib-99659388330, 10.1145/contrib-99659264191, 10.1145/contrib-99659155701, 10.1145/contrib-99659229548, 10.1145/contrib-99659957638, 10.1145/contrib-81453622347, 10.1145/contrib-81458652198, 10.1145/contrib-81408596490, 10.1145/contrib-81557750556, 10.1145/contrib-87959402757, 10.1145/contrib-81490656823, 10.1145/contrib-99658990553, 10.1145/contrib-81440612354, 10.1145/contrib-82858780357, 10.1145/contrib-99659387961, 10.1145/contrib-99659360530, 10.1145/contrib-81387603172, 10.1145/contrib-99660711726, 10.1145/contrib-99659190813, 10.1145/contrib-81392603586, 10.1145/contrib-99658738267, 10.1145/contrib-99660318766, 10.1145/contrib-81335500456, 10.1145/contrib-99658716963, 10.1145/contrib-99660539672, 10.1145/contrib-81375612992, 10.1145/contrib-99659061461, 10.1145/contrib-81496659182, 10.1145/contrib-99659388071, 10.1145/contrib-99659312889, 10.1145/contrib-99659387352, 10.1145/contrib-99659388285, 10.1145/contrib-81461653183, 10.1145/contrib-81461653174, 10.1145/contrib-99659016449, 10.1145/contrib-99659387654, 10.1145/contrib-81490656766, 10.1145/contrib-99659388161, 10.1145/contrib-99658691921, 10.1145/contrib-99659152448, 10.1145/contrib-99659355335, 10.1145/contrib-81458652024, 10.1145/contrib-99659388096, 10.1145/contrib-81100127064, 10.1145/contrib-81553800056, 10.1145/contrib-99659388015, 10.1145/contrib-81557734556, 10.1145/contrib-99659387576, 10.1145/contrib-99659388065, 10.1145/contrib-81493653071, 10.1145/contrib-81493653093, 10.1145/contrib-81492651384, 10.1145/contrib-81100126679, 10.1145/contrib-99659388329, 10.1145/contrib-87059028757, 10.1145/contrib-87959386857, 10.1145/contrib-99660318820, 10.1145/contrib-99659388411, 10.1145/contrib-99659387357, 10.1145/contrib-99659025792, 10.1145/contrib-99660188225, 10.1145/contrib-81317502840, 10.1145/contrib-99659302677, 10.1145/contrib-81444604117, 10.1145/contrib-99660289569, 10.1145/contrib-99659807914, 10.1145/contrib-81550799956, 10.1145/contrib-84458696657, 10.1145/contrib-81508698949, 10.1145/contrib-81502750778, 10.1145/contrib-84458715657, 10.1145/contrib-81339540286, 10.1145/contrib-99660648693, 10.1145/contrib-99659387353, 10.1145/contrib-99659038976, 10.1145/contrib-99659276307, 10.1145/contrib-99659244162, 10.1145/contrib-99659016454, 10.1145/contrib-81508698955, 10.1145/contrib-81490656765, 10.1145/contrib-81501653387, 10.1145/contrib-99658686503, 10.1145/contrib-99659387380, 10.1145/contrib-81502750885, 10.1145/contrib-99658651339, 10.1145/contrib-99659251195, 10.1145/contrib-84458786557, 10.1145/contrib-99660486104, 10.1145/contrib-99659249473, 10.1145/contrib-81329493401, 10.1145/contrib-88158790057, 10.1145/contrib-99659388319, 10.1145/contrib-81467661069, 10.1145/contrib-99659592239, 10.1145/contrib-99659387679, 10.1145/contrib-81442601302, 10.1145/contrib-81464651906, 10.1145/contrib-99660318863, 10.1145/contrib-81430654408, 10.1145/contrib-99659208039, 10.1145/contrib-81467661065, 10.1145/contrib-99659497286, 10.1145/contrib-99659143401, 10.1145/contrib-99659450070, 10.1145/contrib-99658663372, 10.1145/contrib-99659602769, 10.1145/contrib-81453621933, 10.1145/contrib-81453622409, 10.1145/contrib-99658985366, 10.1145/contrib-84458934857, 10.1145/contrib-99658993109, 10.1145/contrib-99660562566, 10.1145/contrib-81554854656, 10.1145/contrib-81387603180, 10.1145/contrib-81493653059, 10.1145/contrib-99658763963, 10.1145/contrib-99660722479, 10.1145/contrib-81450593616, 10.1145/contrib-99660318425, 10.1145/contrib-81440612547, 10.1145/contrib-81552686556, 10.1145/contrib-81414603885, 10.1145/contrib-81100126747, 10.1145/contrib-99658716958, 10.1145/contrib-99658976271, 10.1145/contrib-81100126899, 10.1145/contrib-83458807757, 10.1145/contrib-99659388334, 10.1145/contrib-99659124674, 10.1145/contrib-99659589757, 10.1145/contrib-81502750824, 10.1145/contrib-99659357865, 10.1145/contrib-81554875156, 10.1145/contrib-99659387694, 10.1145/contrib-99660188201, 10.1145/contrib-99659388455, 10.1145/contrib-99659388284, 10.1145/contrib-81365595133, 10.1145/contrib-81100126707, 10.1145/contrib-81456627072, 10.1145/contrib-81317503144, 10.1145/contrib-81442601559, 10.1145/contrib-99659388374, 10.1145/contrib-81552673456, 10.1145/contrib-99659157867, 10.1145/contrib-81461653184, 10.1145/contrib-81493653086, 10.1145/contrib-81100126741, 10.1145/contrib-81538717156, 10.1145/contrib-99658953416, 10.1145/contrib-99659388057, 10.1145/contrib-87059102157, 10.1145/contrib-81500648665, 10.1145/contrib-81408596483, 10.1145/contrib-81414603873, 10.1145/contrib-99660188014, 10.1145/contrib-81440612394, 10.1145/contrib-99660625594, 10.1145/contrib-81309491213, 10.1145/contrib-81490656811, 10.1145/contrib-99659097312]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |277           |\n|9756930   |216         |[Jung-wen Liu, Fang Liu, Junjie Liu, Jun-Li Liu, J. B. Liu, Jun Liu]                                                                                                                                |[10.1145/contrib-99658719653, 10.1145/contrib-81392600742, 10.1145/contrib-81453623109, 10.1145/contrib-81392600720, 10.1145/contrib-99658997510, 10.1145/contrib-81408596723, 10.1145/contrib-81320492294, 10.1145/contrib-84458802857, 10.1145/contrib-99659952921, 10.1145/contrib-99658696319, 10.1145/contrib-99660115264, 10.1145/contrib-99660311721, 10.1145/contrib-99660680068, 10.1145/contrib-99660187532, 10.1145/contrib-81392600699, 10.1145/contrib-81375608610, 10.1145/contrib-99659906431, 10.1145/contrib-99659952934, 10.1145/contrib-99660622675, 10.1145/contrib-99659381248, 10.1145/contrib-99659381283, 10.1145/contrib-99658719651, 10.1145/contrib-81557354756, 10.1145/contrib-99659381677, 10.1145/contrib-81453623549, 10.1145/contrib-99659334932, 10.1145/contrib-99659788217, 10.1145/contrib-99659381552, 10.1145/contrib-99660094073, 10.1145/contrib-88159324657, 10.1145/contrib-99658762820, 10.1145/contrib-99659381067, 10.1145/contrib-81453623093, 10.1145/contrib-81392600734, 10.1145/contrib-87259231357, 10.1145/contrib-81387600194, 10.1145/contrib-99659956746, 10.1145/contrib-81309507597, 10.1145/contrib-81490660407, 10.1145/contrib-99659319480, 10.1145/contrib-81375608661, 10.1145/contrib-81552783756, 10.1145/contrib-99660311746, 10.1145/contrib-81501655759, 10.1145/contrib-99659381301, 10.1145/contrib-99658727821, 10.1145/contrib-81474658347, 10.1145/contrib-99659080752, 10.1145/contrib-99658719668, 10.1145/contrib-81453623168, 10.1145/contrib-81548024083, 10.1145/contrib-99660541269, 10.1145/contrib-81501655764, 10.1145/contrib-99660595438, 10.1145/contrib-81460646514, 10.1145/contrib-99659381311, 10.1145/contrib-99658687535, 10.1145/contrib-99660496181, 10.1145/contrib-99660115123, 10.1145/contrib-99659918032, 10.1145/contrib-99660187683, 10.1145/contrib-99660476337, 10.1145/contrib-81500650344, 10.1145/contrib-99659284315, 10.1145/contrib-81557402756, 10.1145/contrib-99660094041, 10.1145/contrib-99659381683, 10.1145/contrib-99659223128, 10.1145/contrib-99660115317, 10.1145/contrib-99660480325, 10.1145/contrib-81388598643, 10.1145/contrib-99660524497, 10.1145/contrib-99660115183, 10.1145/contrib-99660187660, 10.1145/contrib-81467660146, 10.1145/contrib-81405595300, 10.1145/contrib-99658985076, 10.1145/contrib-99660480320, 10.1145/contrib-99659381216, 10.1145/contrib-99659788236, 10.1145/contrib-99660187763, 10.1145/contrib-99659381694, 10.1145/contrib-81392600726, 10.1145/contrib-81484651796, 10.1145/contrib-81501655765, 10.1145/contrib-81550058956, 10.1145/contrib-99660592959, 10.1145/contrib-81100543099, 10.1145/contrib-81490660406, 10.1145/contrib-99660115111, 10.1145/contrib-81503670925, 10.1145/contrib-99660311789, 10.1145/contrib-99659381547, 10.1145/contrib-81375608650, 10.1145/contrib-81416603464, 10.1145/contrib-81100542797, 10.1145/contrib-99659275887, 10.1145/contrib-99660187698, 10.1145/contrib-99659381204, 10.1145/contrib-81550069256, 10.1145/contrib-99660093968, 10.1145/contrib-99659090512, 10.1145/contrib-81100543071, 10.1145/contrib-99660559711, 10.1145/contrib-81387600188, 10.1145/contrib-99658985077, 10.1145/contrib-81440610565, 10.1145/contrib-99660554837, 10.1145/contrib-99660311693, 10.1145/contrib-99660115278, 10.1145/contrib-81496658387, 10.1145/contrib-81474658396, 10.1145/contrib-99659381501, 10.1145/contrib-99658988344, 10.1145/contrib-81365593421, 10.1145/contrib-81392600709, 10.1145/contrib-99660532185, 10.1145/contrib-99659129213, 10.1145/contrib-81100542997, 10.1145/contrib-99660311926, 10.1145/contrib-99659135533, 10.1145/contrib-99659381681, 10.1145/contrib-81435605189, 10.1145/contrib-81440610535, 10.1145/contrib-81550046556, 10.1145/contrib-81315489996, 10.1145/contrib-99660368794, 10.1145/contrib-99660187535, 10.1145/contrib-99660311605, 10.1145/contrib-81387600193, 10.1145/contrib-99658673394, 10.1145/contrib-99658727824, 10.1145/contrib-99659381361, 10.1145/contrib-81553027756, 10.1145/contrib-99659066498, 10.1145/contrib-99659381579, 10.1145/contrib-99660115309, 10.1145/contrib-81557336156, 10.1145/contrib-81553705556, 10.1145/contrib-99660554871, 10.1145/contrib-99660622670, 10.1145/contrib-99660368793, 10.1145/contrib-81392600749, 10.1145/contrib-81385599752, 10.1145/contrib-81474658389, 10.1145/contrib-99659381526, 10.1145/contrib-99660115148, 10.1145/contrib-81464653039, 10.1145/contrib-81481647365, 10.1145/contrib-81384602807, 10.1145/contrib-81496658391, 10.1145/contrib-81508698869, 10.1145/contrib-99659381553, 10.1145/contrib-99659381443, 10.1145/contrib-99660187684, 10.1145/contrib-81100542875, 10.1145/contrib-81440610533, 10.1145/contrib-99660595446, 10.1145/contrib-81435605190, 10.1145/contrib-99660708458, 10.1145/contrib-99659381729, 10.1145/contrib-87358735657, 10.1145/contrib-81453623477, 10.1145/contrib-99660115114, 10.1145/contrib-81467660163, 10.1145/contrib-81438594937, 10.1145/contrib-99660093978, 10.1145/contrib-99660311568, 10.1145/contrib-81405595412, 10.1145/contrib-99658749307, 10.1145/contrib-99660045897, 10.1145/contrib-99659381735, 10.1145/contrib-99659496612, 10.1145/contrib-81444603341, 10.1145/contrib-99660311670, 10.1145/contrib-99659381472, 10.1145/contrib-99660311617, 10.1145/contrib-81100543094, 10.1145/contrib-99659381709, 10.1145/contrib-81461652594, 10.1145/contrib-82259422057, 10.1145/contrib-99659475542, 10.1145/contrib-99658648597, 10.1145/contrib-99659381448, 10.1145/contrib-81100542863, 10.1145/contrib-99659466025, 10.1145/contrib-99659240417, 10.1145/contrib-87958638557, 10.1145/contrib-81323493474, 10.1145/contrib-81453623399, 10.1145/contrib-81479655987, 10.1145/contrib-81442599069, 10.1145/contrib-99660187757, 10.1145/contrib-81440610561, 10.1145/contrib-99659381690, 10.1145/contrib-81435605175, 10.1145/contrib-81548017279, 10.1145/contrib-99659381609, 10.1145/contrib-99659381147, 10.1145/contrib-99659381491, 10.1145/contrib-81461652619, 10.1145/contrib-99659180509, 10.1145/contrib-99659381590, 10.1145/contrib-88159327057, 10.1145/contrib-99660187563, 10.1145/contrib-81320492717, 10.1145/contrib-99659381146, 10.1145/contrib-81375608616, 10.1145/contrib-81474658528, 10.1145/contrib-81100542898, 10.1145/contrib-81548034699, 10.1145/contrib-81555692156, 10.1145/contrib-81557345356, 10.1145/contrib-81502746071, 10.1145/contrib-81408596712, 10.1145/contrib-84458766257]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |257           |\n|46641573  |211         |[W. Liu, Wei Liu]                                                                                                                                                                                   |[10.1145/contrib-81387594410, 10.1145/contrib-99659620146, 10.1145/contrib-99659433102, 10.1145/contrib-99659165164, 10.1145/contrib-82259424757, 10.1145/contrib-81548034158, 10.1145/contrib-81387594416, 10.1145/contrib-99660142983, 10.1145/contrib-81496670540, 10.1145/contrib-99659620230, 10.1145/contrib-99659915559, 10.1145/contrib-81479645023, 10.1145/contrib-99660724733, 10.1145/contrib-99659365294, 10.1145/contrib-99659620198, 10.1145/contrib-81452596407, 10.1145/contrib-81435597695, 10.1145/contrib-81496670561, 10.1145/contrib-99658703127, 10.1145/contrib-83458712857, 10.1145/contrib-81496670539, 10.1145/contrib-99660600432, 10.1145/contrib-81361594373, 10.1145/contrib-81410593806, 10.1145/contrib-99660215946, 10.1145/contrib-99659620090, 10.1145/contrib-81375601129, 10.1145/contrib-99659187905, 10.1145/contrib-84459589357, 10.1145/contrib-81467646295, 10.1145/contrib-99659620238, 10.1145/contrib-81453637097, 10.1145/contrib-99659747023, 10.1145/contrib-81502769493, 10.1145/contrib-99660142971, 10.1145/contrib-99660543527, 10.1145/contrib-99659620128, 10.1145/contrib-81100526867, 10.1145/contrib-99659620206, 10.1145/contrib-81333489419, 10.1145/contrib-99658703142, 10.1145/contrib-99658620841, 10.1145/contrib-99658735572, 10.1145/contrib-99659620197, 10.1145/contrib-99659917684, 10.1145/contrib-81325489384, 10.1145/contrib-81501664030, 10.1145/contrib-81493645909, 10.1145/contrib-99660328192, 10.1145/contrib-99658966152, 10.1145/contrib-87258705057, 10.1145/contrib-99660328145, 10.1145/contrib-99659430791, 10.1145/contrib-81474677532, 10.1145/contrib-99658735548, 10.1145/contrib-81557543056, 10.1145/contrib-99659620143, 10.1145/contrib-81493645911, 10.1145/contrib-87058995757, 10.1145/contrib-99659156973, 10.1145/contrib-81479645018, 10.1145/contrib-99659160381, 10.1145/contrib-81547531056, 10.1145/contrib-81490668657, 10.1145/contrib-81442604767, 10.1145/contrib-81453636999, 10.1145/contrib-81474677518, 10.1145/contrib-81496670565, 10.1145/contrib-99659182129, 10.1145/contrib-81474677340, 10.1145/contrib-99658688884, 10.1145/contrib-99660537703, 10.1145/contrib-99658972871, 10.1145/contrib-81453637083, 10.1145/contrib-99659789657, 10.1145/contrib-81392607941, 10.1145/contrib-99659220950, 10.1145/contrib-99660328086, 10.1145/contrib-99659620267, 10.1145/contrib-81474677279, 10.1145/contrib-99660328169, 10.1145/contrib-99660014503, 10.1145/contrib-99660720842, 10.1145/contrib-99660328094, 10.1145/contrib-81548006780, 10.1145/contrib-99659269264, 10.1145/contrib-99659034632, 10.1145/contrib-99658640717, 10.1145/contrib-81452596412, 10.1145/contrib-99659397240, 10.1145/contrib-81319496035, 10.1145/contrib-99660365140, 10.1145/contrib-81442604768, 10.1145/contrib-99659301275, 10.1145/contrib-81548032166, 10.1145/contrib-99659620098, 10.1145/contrib-99660142929, 10.1145/contrib-99659620135, 10.1145/contrib-99659620132, 10.1145/contrib-99659620095, 10.1145/contrib-99658622953, 10.1145/contrib-99660028659, 10.1145/contrib-99659094913, 10.1145/contrib-81550727456, 10.1145/contrib-81456612448, 10.1145/contrib-81547529356, 10.1145/contrib-99658659141, 10.1145/contrib-99659620181, 10.1145/contrib-87058994757, 10.1145/contrib-99659620285, 10.1145/contrib-99660328168, 10.1145/contrib-81458644177, 10.1145/contrib-99659620115, 10.1145/contrib-81555744456, 10.1145/contrib-99659620239, 10.1145/contrib-81435597684, 10.1145/contrib-81453637087, 10.1145/contrib-99659082020, 10.1145/contrib-81467646315, 10.1145/contrib-81100526905, 10.1145/contrib-99660328133, 10.1145/contrib-99659620130, 10.1145/contrib-99659620296, 10.1145/contrib-99659620162, 10.1145/contrib-99659620092, 10.1145/contrib-99660215914, 10.1145/contrib-99660328147, 10.1145/contrib-81339514352, 10.1145/contrib-81375601156, 10.1145/contrib-99658729798, 10.1145/contrib-81453636952, 10.1145/contrib-87358776557, 10.1145/contrib-99659620269, 10.1145/contrib-81309492655, 10.1145/contrib-99660709861, 10.1145/contrib-82458861557, 10.1145/contrib-81385593080, 10.1145/contrib-81385593081, 10.1145/contrib-99659789651, 10.1145/contrib-81467646309, 10.1145/contrib-81487643521, 10.1145/contrib-99660328097, 10.1145/contrib-99658644954, 10.1145/contrib-99659708266, 10.1145/contrib-81453637080, 10.1145/contrib-99659571396, 10.1145/contrib-99660215895, 10.1145/contrib-99659110943, 10.1145/contrib-99659620131, 10.1145/contrib-99659620085, 10.1145/contrib-99659620100, 10.1145/contrib-99659397239, 10.1145/contrib-99658644991, 10.1145/contrib-81472643722, 10.1145/contrib-81467646314, 10.1145/contrib-99658966195, 10.1145/contrib-83058980257, 10.1145/contrib-88158700857, 10.1145/contrib-81100526936, 10.1145/contrib-99660600437, 10.1145/contrib-99660633674, 10.1145/contrib-99659620088, 10.1145/contrib-81363593784, 10.1145/contrib-81496670575, 10.1145/contrib-99659620157, 10.1145/contrib-99659620284, 10.1145/contrib-99659620106, 10.1145/contrib-99659620147, 10.1145/contrib-81467646302, 10.1145/contrib-99660215942, 10.1145/contrib-99658988097, 10.1145/contrib-81384611795, 10.1145/contrib-99660600439, 10.1145/contrib-99659789668, 10.1145/contrib-81492643437, 10.1145/contrib-81502769583, 10.1145/contrib-99659397227, 10.1145/contrib-81430663010, 10.1145/contrib-99659054921, 10.1145/contrib-87958613757, 10.1145/contrib-99659620199, 10.1145/contrib-99660552070, 10.1145/contrib-99660328105, 10.1145/contrib-99659822721, 10.1145/contrib-99659068269, 10.1145/contrib-99659342789, 10.1145/contrib-81430663011, 10.1145/contrib-99659111003, 10.1145/contrib-81553440556, 10.1145/contrib-99659747027, 10.1145/contrib-81387594429, 10.1145/contrib-99659397237, 10.1145/contrib-99660054186, 10.1145/contrib-99658703134, 10.1145/contrib-81501664009, 10.1145/contrib-81546551056, 10.1145/contrib-99659054926, 10.1145/contrib-81447595006, 10.1145/contrib-81447595127, 10.1145/contrib-81418594973, 10.1145/contrib-81317496508, 10.1145/contrib-99659620084, 10.1145/contrib-81474677355, 10.1145/contrib-99658656471, 10.1145/contrib-99659044070, 10.1145/contrib-99660328084, 10.1145/contrib-99659708246, 10.1145/contrib-81482644389, 10.1145/contrib-81442604775, 10.1145/contrib-99659620271, 10.1145/contrib-99658688870]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |436           |\n|1689115   |190         |[Tao Zhang]                                                                                                                                                                                         |[10.1145/contrib-99659749511, 10.1145/contrib-81461645275, 10.1145/contrib-99659096687, 10.1145/contrib-99659787290, 10.1145/contrib-99659510956, 10.1145/contrib-83059088257, 10.1145/contrib-99660227144, 10.1145/contrib-99659504011, 10.1145/contrib-81452604852, 10.1145/contrib-99659590836, 10.1145/contrib-81317502643, 10.1145/contrib-81456613524, 10.1145/contrib-99659405197, 10.1145/contrib-99659317892, 10.1145/contrib-99659590833, 10.1145/contrib-99660227165, 10.1145/contrib-99659590857, 10.1145/contrib-99659150878, 10.1145/contrib-99659590842, 10.1145/contrib-99658716448, 10.1145/contrib-81456613521, 10.1145/contrib-81442593053, 10.1145/contrib-81456613523, 10.1145/contrib-99659029969, 10.1145/contrib-81351595828, 10.1145/contrib-81482645412, 10.1145/contrib-82658642457, 10.1145/contrib-81488643577, 10.1145/contrib-99659590834, 10.1145/contrib-99659763789, 10.1145/contrib-81496644874, 10.1145/contrib-99659313872, 10.1145/contrib-99659405196, 10.1145/contrib-99659299033, 10.1145/contrib-99659343300, 10.1145/contrib-99660331729, 10.1145/contrib-99658761509, 10.1145/contrib-81502725477, 10.1145/contrib-99659827407, 10.1145/contrib-99660564385, 10.1145/contrib-99660574773, 10.1145/contrib-99659939448, 10.1145/contrib-99659405194, 10.1145/contrib-99659016392, 10.1145/contrib-99659063585, 10.1145/contrib-81488643578, 10.1145/contrib-84459648557, 10.1145/contrib-99659590906, 10.1145/contrib-99660048676, 10.1145/contrib-99659590905, 10.1145/contrib-99659590852, 10.1145/contrib-99658740158, 10.1145/contrib-99659590848, 10.1145/contrib-81482645418, 10.1145/contrib-81100114145, 10.1145/contrib-99658688762, 10.1145/contrib-81100114181, 10.1145/contrib-81100114156, 10.1145/contrib-99659590829, 10.1145/contrib-84459657557, 10.1145/contrib-99660048680, 10.1145/contrib-99658740163, 10.1145/contrib-99659590900, 10.1145/contrib-99659590861, 10.1145/contrib-81442593051, 10.1145/contrib-81474646688, 10.1145/contrib-81556691256, 10.1145/contrib-81479646218, 10.1145/contrib-81416595208, 10.1145/contrib-81553267556, 10.1145/contrib-81387595504, 10.1145/contrib-99659590878, 10.1145/contrib-99660331812, 10.1145/contrib-99658958820, 10.1145/contrib-81461645294, 10.1145/contrib-99659189168, 10.1145/contrib-99659590850, 10.1145/contrib-99659251058, 10.1145/contrib-99659848106, 10.1145/contrib-81508688271, 10.1145/contrib-99658999946, 10.1145/contrib-99659590884, 10.1145/contrib-99659029979, 10.1145/contrib-99660331773, 10.1145/contrib-99660227131, 10.1145/contrib-99659666154, 10.1145/contrib-81387595502, 10.1145/contrib-99658677248, 10.1145/contrib-81453611201, 10.1145/contrib-81100114163, 10.1145/contrib-99659798730, 10.1145/contrib-81490645143, 10.1145/contrib-99658985247, 10.1145/contrib-99659939450, 10.1145/contrib-81452604841, 10.1145/contrib-81392591701, 10.1145/contrib-99658958797, 10.1145/contrib-81458644739, 10.1145/contrib-99659763784, 10.1145/contrib-99658767934, 10.1145/contrib-99660519241, 10.1145/contrib-99659368450, 10.1145/contrib-81472644713, 10.1145/contrib-99659446680, 10.1145/contrib-81456613505, 10.1145/contrib-81552259356, 10.1145/contrib-99659590894, 10.1145/contrib-81482645419, 10.1145/contrib-81482645423, 10.1145/contrib-99660117417, 10.1145/contrib-99659706198, 10.1145/contrib-81546984156, 10.1145/contrib-99660543668, 10.1145/contrib-99660117392, 10.1145/contrib-81500642901, 10.1145/contrib-81453611195, 10.1145/contrib-99659590849, 10.1145/contrib-99660331731, 10.1145/contrib-99659590837, 10.1145/contrib-81453611183, 10.1145/contrib-99659590830, 10.1145/contrib-81472644711, 10.1145/contrib-99659590831, 10.1145/contrib-99659431332, 10.1145/contrib-84459654157, 10.1145/contrib-81461645291, 10.1145/contrib-99659590860, 10.1145/contrib-99660556256, 10.1145/contrib-99659590893, 10.1145/contrib-99658674308, 10.1145/contrib-99659787277, 10.1145/contrib-99658641930, 10.1145/contrib-99658622697, 10.1145/contrib-99659749507, 10.1145/contrib-99660227123, 10.1145/contrib-99659033979, 10.1145/contrib-99659590859, 10.1145/contrib-99659590877, 10.1145/contrib-99660331814, 10.1145/contrib-86159084957, 10.1145/contrib-81496644870, 10.1145/contrib-81453611188, 10.1145/contrib-99660574770, 10.1145/contrib-81387595516, 10.1145/contrib-99659590883, 10.1145/contrib-99660227168, 10.1145/contrib-99659242428, 10.1145/contrib-81548028497, 10.1145/contrib-99660331803, 10.1145/contrib-81556690456, 10.1145/contrib-81456613509, 10.1145/contrib-81552258856, 10.1145/contrib-99659590901, 10.1145/contrib-89558636757, 10.1145/contrib-81339539701, 10.1145/contrib-99659590882, 10.1145/contrib-99658652495, 10.1145/contrib-99659110508, 10.1145/contrib-81430638437, 10.1145/contrib-99660377668, 10.1145/contrib-81392591699, 10.1145/contrib-81490645158, 10.1145/contrib-99659590870, 10.1145/contrib-81456613514, 10.1145/contrib-81461645324, 10.1145/contrib-84459641857, 10.1145/contrib-99660688652, 10.1145/contrib-99659787276, 10.1145/contrib-99660117366, 10.1145/contrib-99658622684, 10.1145/contrib-81361595527, 10.1145/contrib-99659082780, 10.1145/contrib-99659198579, 10.1145/contrib-99658674333, 10.1145/contrib-81553472656, 10.1145/contrib-99659787284, 10.1145/contrib-81556691856, 10.1145/contrib-99658700375, 10.1145/contrib-81472644707, 10.1145/contrib-99658958818, 10.1145/contrib-81546985256, 10.1145/contrib-99659304051, 10.1145/contrib-99658973227, 10.1145/contrib-99660117385, 10.1145/contrib-99659224104, 10.1145/contrib-81474646706, 10.1145/contrib-99659553305, 10.1145/contrib-81100114202, 10.1145/contrib-81440596806, 10.1145/contrib-81490645151]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |360           |\n|46396571  |190         |[Y. Y. Wang, Yangxing Wang, Y. Wang, Yu Wang, Yunsheng Wang, Yangsheng Wang, Yangtao Wang, Yi Wang, Yonggang Cui, Meng Wang, Yang Wang]                                                             |[10.1145/contrib-81484644814, 10.1145/contrib-81350582343, 10.1145/contrib-99659392973, 10.1145/contrib-99660710199, 10.1145/contrib-87258657657, 10.1145/contrib-99659555098, 10.1145/contrib-81442595315, 10.1145/contrib-99660289298, 10.1145/contrib-81430595607, 10.1145/contrib-99659038762, 10.1145/contrib-82658991157, 10.1145/contrib-99660710188, 10.1145/contrib-81448594910, 10.1145/contrib-99659392383, 10.1145/contrib-81392592909, 10.1145/contrib-81375598612, 10.1145/contrib-99659392169, 10.1145/contrib-82458950557, 10.1145/contrib-81440600095, 10.1145/contrib-82658975657, 10.1145/contrib-99658983168, 10.1145/contrib-99659029560, 10.1145/contrib-99660231828, 10.1145/contrib-81453615444, 10.1145/contrib-99659497051, 10.1145/contrib-82458954357, 10.1145/contrib-81502656059, 10.1145/contrib-99659626016, 10.1145/contrib-81384593161, 10.1145/contrib-99659392579, 10.1145/contrib-99660593043, 10.1145/contrib-99658725319, 10.1145/contrib-81414594180, 10.1145/contrib-99659392124, 10.1145/contrib-99660649251, 10.1145/contrib-99659742289, 10.1145/contrib-99658976940, 10.1145/contrib-99659265213, 10.1145/contrib-99659392358, 10.1145/contrib-81479648578, 10.1145/contrib-99659392317, 10.1145/contrib-81479648654, 10.1145/contrib-81503652830, 10.1145/contrib-81503652812, 10.1145/contrib-99659392568, 10.1145/contrib-99659392604, 10.1145/contrib-99659393180, 10.1145/contrib-99659655377, 10.1145/contrib-99658623875, 10.1145/contrib-81444597065, 10.1145/contrib-81550508756, 10.1145/contrib-99660528813, 10.1145/contrib-99659392901, 10.1145/contrib-87258633257, 10.1145/contrib-99659766467, 10.1145/contrib-81430595610, 10.1145/contrib-99659392123, 10.1145/contrib-99658642191, 10.1145/contrib-99659392539, 10.1145/contrib-99659123243, 10.1145/contrib-87958702857, 10.1145/contrib-99660289016, 10.1145/contrib-99660231914, 10.1145/contrib-81331506648, 10.1145/contrib-99659570100, 10.1145/contrib-99660289120, 10.1145/contrib-82658962257, 10.1145/contrib-81466644893, 10.1145/contrib-99659726379, 10.1145/contrib-99658616497, 10.1145/contrib-99659391893, 10.1145/contrib-99660372673, 10.1145/contrib-99659392436, 10.1145/contrib-81351595589, 10.1145/contrib-81537983056, 10.1145/contrib-99659392292, 10.1145/contrib-99659318433, 10.1145/contrib-99659393004, 10.1145/contrib-99660231574, 10.1145/contrib-99659049659, 10.1145/contrib-81100232914, 10.1145/contrib-99660044168, 10.1145/contrib-99659069758, 10.1145/contrib-99660568399, 10.1145/contrib-99659299247, 10.1145/contrib-81496646124, 10.1145/contrib-99660736808, 10.1145/contrib-99659392955, 10.1145/contrib-81553253356, 10.1145/contrib-99659452152, 10.1145/contrib-82258857657, 10.1145/contrib-99658650311, 10.1145/contrib-99659392051, 10.1145/contrib-99659482127, 10.1145/contrib-99660659440, 10.1145/contrib-99660289620, 10.1145/contrib-81414594159, 10.1145/contrib-99660240040, 10.1145/contrib-81430595592, 10.1145/contrib-99658669677, 10.1145/contrib-99659223170, 10.1145/contrib-81498645563, 10.1145/contrib-99659433581, 10.1145/contrib-99659277061, 10.1145/contrib-99660372680, 10.1145/contrib-99659092712, 10.1145/contrib-99659392959, 10.1145/contrib-81435597151, 10.1145/contrib-99659392805, 10.1145/contrib-99659393074, 10.1145/contrib-99660528814, 10.1145/contrib-81408599825, 10.1145/contrib-99658743355, 10.1145/contrib-81456616081, 10.1145/contrib-99659049653, 10.1145/contrib-99659393326, 10.1145/contrib-81314486711, 10.1145/contrib-81387596635, 10.1145/contrib-99658999501, 10.1145/contrib-99659393043, 10.1145/contrib-99660289573, 10.1145/contrib-99660557963, 10.1145/contrib-81408599846, 10.1145/contrib-83358667457, 10.1145/contrib-99659393124, 10.1145/contrib-81498645568, 10.1145/contrib-99659228612, 10.1145/contrib-99659392580, 10.1145/contrib-99659234961, 10.1145/contrib-81479648574, 10.1145/contrib-81474650747, 10.1145/contrib-99659450109, 10.1145/contrib-99659392671, 10.1145/contrib-99660231689, 10.1145/contrib-99660568410, 10.1145/contrib-99659392428, 10.1145/contrib-99659392429, 10.1145/contrib-99660289063, 10.1145/contrib-99659352150, 10.1145/contrib-81387596559, 10.1145/contrib-99660372725, 10.1145/contrib-99659393334, 10.1145/contrib-99659392776, 10.1145/contrib-81474650739, 10.1145/contrib-81551613356, 10.1145/contrib-81387596581, 10.1145/contrib-81479648645, 10.1145/contrib-81456616090, 10.1145/contrib-81453615443, 10.1145/contrib-99658616565, 10.1145/contrib-81423596107, 10.1145/contrib-99659655352, 10.1145/contrib-99660577375, 10.1145/contrib-99659132024, 10.1145/contrib-81556790956, 10.1145/contrib-89758713557, 10.1145/contrib-99659049375, 10.1145/contrib-99658953120, 10.1145/contrib-99659392328, 10.1145/contrib-99659392273, 10.1145/contrib-99659392382, 10.1145/contrib-99659392100, 10.1145/contrib-81444597034, 10.1145/contrib-81408595487, 10.1145/contrib-81453615370, 10.1145/contrib-81482646606, 10.1145/contrib-99660289315, 10.1145/contrib-81461645320, 10.1145/contrib-99659275534, 10.1145/contrib-81551612156, 10.1145/contrib-99659393016, 10.1145/contrib-88159539357, 10.1145/contrib-99660162374, 10.1145/contrib-99658710054, 10.1145/contrib-99659440509, 10.1145/contrib-99658659092, 10.1145/contrib-99658650296, 10.1145/contrib-99659978131, 10.1145/contrib-88159521557, 10.1145/contrib-99660583787, 10.1145/contrib-99659392872, 10.1145/contrib-99659391899, 10.1145/contrib-99659393379, 10.1145/contrib-99660235581, 10.1145/contrib-99660289631, 10.1145/contrib-99659995257, 10.1145/contrib-99659393440, 10.1145/contrib-99659392798, 10.1145/contrib-81456615810, 10.1145/contrib-81100232541]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |307           |\n|48016595  |184         |[Haodong Wang, Haoyang Wang, Haiyan Wang, Hao Wang]                                                                                                                                                 |[10.1145/contrib-99659394215, 10.1145/contrib-99658974421, 10.1145/contrib-99659394247, 10.1145/contrib-81408592768, 10.1145/contrib-81537849556, 10.1145/contrib-99659394668, 10.1145/contrib-99659005470, 10.1145/contrib-81552818156, 10.1145/contrib-81387610656, 10.1145/contrib-99659393935, 10.1145/contrib-99659394685, 10.1145/contrib-99659393959, 10.1145/contrib-99659394630, 10.1145/contrib-81474666786, 10.1145/contrib-81384606713, 10.1145/contrib-99659394511, 10.1145/contrib-99659393917, 10.1145/contrib-99658685569, 10.1145/contrib-81501661259, 10.1145/contrib-81384606748, 10.1145/contrib-99659495509, 10.1145/contrib-81556768356, 10.1145/contrib-81456634566, 10.1145/contrib-81555939156, 10.1145/contrib-81496663239, 10.1145/contrib-99659393956, 10.1145/contrib-99659394536, 10.1145/contrib-81461659737, 10.1145/contrib-99659394287, 10.1145/contrib-81500652388, 10.1145/contrib-81435612090, 10.1145/contrib-99659394063, 10.1145/contrib-99659455731, 10.1145/contrib-99659845075, 10.1145/contrib-99659931894, 10.1145/contrib-99659974332, 10.1145/contrib-81472656758, 10.1145/contrib-99659394191, 10.1145/contrib-81556740456, 10.1145/contrib-81408592758, 10.1145/contrib-81444609045, 10.1145/contrib-81350581071, 10.1145/contrib-99660008265, 10.1145/contrib-81496663232, 10.1145/contrib-99659393919, 10.1145/contrib-81316490906, 10.1145/contrib-99659393914, 10.1145/contrib-99659740205, 10.1145/contrib-81548014494, 10.1145/contrib-81442605077, 10.1145/contrib-99658739600, 10.1145/contrib-99659495467, 10.1145/contrib-81375621768, 10.1145/contrib-81502759803, 10.1145/contrib-99660008256, 10.1145/contrib-99659740193, 10.1145/contrib-99658739605, 10.1145/contrib-99660341659, 10.1145/contrib-84459208857, 10.1145/contrib-81548014897, 10.1145/contrib-99659394655, 10.1145/contrib-99659394469, 10.1145/contrib-99659053229, 10.1145/contrib-99659394643, 10.1145/contrib-99659394239, 10.1145/contrib-99659394271, 10.1145/contrib-99660008271, 10.1145/contrib-81550921356, 10.1145/contrib-99659495495, 10.1145/contrib-99659837079, 10.1145/contrib-99660008261, 10.1145/contrib-81453632770, 10.1145/contrib-81490664767, 10.1145/contrib-81387610661, 10.1145/contrib-81456634400, 10.1145/contrib-81387610667, 10.1145/contrib-81444609083, 10.1145/contrib-99659393995, 10.1145/contrib-99659394631, 10.1145/contrib-99659394146, 10.1145/contrib-99659394020, 10.1145/contrib-81501661297, 10.1145/contrib-81442605163, 10.1145/contrib-84459270157, 10.1145/contrib-81548023663, 10.1145/contrib-99659394548, 10.1145/contrib-81440615743, 10.1145/contrib-81464658700, 10.1145/contrib-81438598366, 10.1145/contrib-99659394059, 10.1145/contrib-99659495499, 10.1145/contrib-81456634558, 10.1145/contrib-99659394161, 10.1145/contrib-99660374175, 10.1145/contrib-81385604437, 10.1145/contrib-81408592764, 10.1145/contrib-99660578855, 10.1145/contrib-87259227657, 10.1145/contrib-99659208017, 10.1145/contrib-86158923857, 10.1145/contrib-81408596118, 10.1145/contrib-81453632969, 10.1145/contrib-99659394678, 10.1145/contrib-81490664733, 10.1145/contrib-81508709042, 10.1145/contrib-81444609044, 10.1145/contrib-99659109586, 10.1145/contrib-99659394489, 10.1145/contrib-99658752197, 10.1145/contrib-99660489419, 10.1145/contrib-99659041057, 10.1145/contrib-99660008264, 10.1145/contrib-99659394608, 10.1145/contrib-99659394050, 10.1145/contrib-81436600307, 10.1145/contrib-81392603646, 10.1145/contrib-81350588558, 10.1145/contrib-81467658347, 10.1145/contrib-99658685562, 10.1145/contrib-81375621732, 10.1145/contrib-99659394692, 10.1145/contrib-81537850856, 10.1145/contrib-81487655837, 10.1145/contrib-99659394080, 10.1145/contrib-81313482075, 10.1145/contrib-81556779856, 10.1145/contrib-87059092257, 10.1145/contrib-99660008231, 10.1145/contrib-99659394535, 10.1145/contrib-81496663248, 10.1145/contrib-99659394276, 10.1145/contrib-99658614178, 10.1145/contrib-99659855268, 10.1145/contrib-99659394435, 10.1145/contrib-81490664764, 10.1145/contrib-99659848614, 10.1145/contrib-81408592755, 10.1145/contrib-99659393923, 10.1145/contrib-99658752203, 10.1145/contrib-81453632917, 10.1145/contrib-99659394473, 10.1145/contrib-99659394413, 10.1145/contrib-81496663150, 10.1145/contrib-87259213957, 10.1145/contrib-99659008731, 10.1145/contrib-81100220386, 10.1145/contrib-99660677991, 10.1145/contrib-99659394043, 10.1145/contrib-84459251257, 10.1145/contrib-99659394537, 10.1145/contrib-99659394070, 10.1145/contrib-99659394589, 10.1145/contrib-99658685564, 10.1145/contrib-99660341602, 10.1145/contrib-81387610638, 10.1145/contrib-81498660980, 10.1145/contrib-99658614244, 10.1145/contrib-81387610581, 10.1145/contrib-81501661264, 10.1145/contrib-99659394091, 10.1145/contrib-99659394051, 10.1145/contrib-81440615949, 10.1145/contrib-99660008249, 10.1145/contrib-99659393968, 10.1145/contrib-99659394069, 10.1145/contrib-81350600829, 10.1145/contrib-99658614169, 10.1145/contrib-99660374153, 10.1145/contrib-99660008268, 10.1145/contrib-87959058157, 10.1145/contrib-81384606728, 10.1145/contrib-99660008262, 10.1145/contrib-99660008257, 10.1145/contrib-99659005482, 10.1145/contrib-99659394689, 10.1145/contrib-81501661289, 10.1145/contrib-99658739598, 10.1145/contrib-99660604120, 10.1145/contrib-81418600502, 10.1145/contrib-81461660387, 10.1145/contrib-81537851156, 10.1145/contrib-99658961492, 10.1145/contrib-99660481293, 10.1145/contrib-99660662489]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |223           |\n|1683647   |179         |[Xuejiao Chen, X. R. Chen, Xi Ghen, Xi Chen, X. Chen, Xue-wen Chen]                                                                                                                                 |[10.1145/contrib-81496671628, 10.1145/contrib-81484647780, 10.1145/contrib-99660349404, 10.1145/contrib-81440600768, 10.1145/contrib-99659620552, 10.1145/contrib-99659073937, 10.1145/contrib-81442605655, 10.1145/contrib-99659023675, 10.1145/contrib-81453638563, 10.1145/contrib-99660183131, 10.1145/contrib-99660500029, 10.1145/contrib-99659450610, 10.1145/contrib-81553466356, 10.1145/contrib-81504682151, 10.1145/contrib-99660183105, 10.1145/contrib-99660182517, 10.1145/contrib-99660183109, 10.1145/contrib-99660182365, 10.1145/contrib-99658642666, 10.1145/contrib-81456617118, 10.1145/contrib-81440600759, 10.1145/contrib-99660183163, 10.1145/contrib-81555130756, 10.1145/contrib-99659494036, 10.1145/contrib-86158692857, 10.1145/contrib-99660182934, 10.1145/contrib-99660183234, 10.1145/contrib-99660005775, 10.1145/contrib-99660182957, 10.1145/contrib-99659774238, 10.1145/contrib-81474679378, 10.1145/contrib-99658630309, 10.1145/contrib-88158891857, 10.1145/contrib-81442605605, 10.1145/contrib-99660349252, 10.1145/contrib-99660182899, 10.1145/contrib-99659620654, 10.1145/contrib-87058826757, 10.1145/contrib-99658648623, 10.1145/contrib-99659620539, 10.1145/contrib-81496671635, 10.1145/contrib-99659620501, 10.1145/contrib-81758650657, 10.1145/contrib-99660486368, 10.1145/contrib-81492647227, 10.1145/contrib-99660182942, 10.1145/contrib-99658636495, 10.1145/contrib-81371590726, 10.1145/contrib-99660182889, 10.1145/contrib-99660183231, 10.1145/contrib-99660349158, 10.1145/contrib-81503659977, 10.1145/contrib-81484647777, 10.1145/contrib-83358803057, 10.1145/contrib-81442605601, 10.1145/contrib-81330489061, 10.1145/contrib-99659620682, 10.1145/contrib-99659873492, 10.1145/contrib-81440600782, 10.1145/contrib-81493648304, 10.1145/contrib-81550009956, 10.1145/contrib-99659620669, 10.1145/contrib-99659620512, 10.1145/contrib-99659725278, 10.1145/contrib-81456617105, 10.1145/contrib-99660182973, 10.1145/contrib-99660710149, 10.1145/contrib-99659620522, 10.1145/contrib-81553271456, 10.1145/contrib-81100107752, 10.1145/contrib-99660005789, 10.1145/contrib-99658684865, 10.1145/contrib-99658629234, 10.1145/contrib-99660183081, 10.1145/contrib-99660183279, 10.1145/contrib-81375602009, 10.1145/contrib-81496671627, 10.1145/contrib-81385596184, 10.1145/contrib-99659620608, 10.1145/contrib-81387594972, 10.1145/contrib-99659620543, 10.1145/contrib-81414608474, 10.1145/contrib-81553270556, 10.1145/contrib-81460650857, 10.1145/contrib-99660182948, 10.1145/contrib-81485647764, 10.1145/contrib-99659125215, 10.1145/contrib-99658657697, 10.1145/contrib-99660183219, 10.1145/contrib-99659620430, 10.1145/contrib-99660182924, 10.1145/contrib-81548013597, 10.1145/contrib-81552801156, 10.1145/contrib-81447596842, 10.1145/contrib-99660182353, 10.1145/contrib-99660182383, 10.1145/contrib-99658657704, 10.1145/contrib-99660182890, 10.1145/contrib-81485647760, 10.1145/contrib-99659620497, 10.1145/contrib-81442605466, 10.1145/contrib-81490674129, 10.1145/contrib-99658663776, 10.1145/contrib-99660182963, 10.1145/contrib-99660137486, 10.1145/contrib-99660649575, 10.1145/contrib-81493648314, 10.1145/contrib-81467652999, 10.1145/contrib-99659620584, 10.1145/contrib-81456617122, 10.1145/contrib-81484647778, 10.1145/contrib-99658767214, 10.1145/contrib-99659620700, 10.1145/contrib-99659019689, 10.1145/contrib-81451593598, 10.1145/contrib-99660183184, 10.1145/contrib-81482648808, 10.1145/contrib-99660182925, 10.1145/contrib-99660182901, 10.1145/contrib-81392608597, 10.1145/contrib-99660182857, 10.1145/contrib-99659011698, 10.1145/contrib-99660005785, 10.1145/contrib-99660183120, 10.1145/contrib-99659620638, 10.1145/contrib-81508691884, 10.1145/contrib-81485647759, 10.1145/contrib-87058822857, 10.1145/contrib-99660183039, 10.1145/contrib-99660183174, 10.1145/contrib-99658657706, 10.1145/contrib-81387594958, 10.1145/contrib-99660183185, 10.1145/contrib-99660005833, 10.1145/contrib-99659620473, 10.1145/contrib-99660182952, 10.1145/contrib-99660183246, 10.1145/contrib-99658684872, 10.1145/contrib-99660183018, 10.1145/contrib-81387594963, 10.1145/contrib-81474679275, 10.1145/contrib-99659620722, 10.1145/contrib-81479650047, 10.1145/contrib-99660005825, 10.1145/contrib-99660182923, 10.1145/contrib-81503659985, 10.1145/contrib-99660182902, 10.1145/contrib-99659620679, 10.1145/contrib-99660182979, 10.1145/contrib-99660182932, 10.1145/contrib-81492647240, 10.1145/contrib-99660349148, 10.1145/contrib-99658732902, 10.1145/contrib-99659620476, 10.1145/contrib-99660183005, 10.1145/contrib-99660182867, 10.1145/contrib-99660728096, 10.1145/contrib-87958930657, 10.1145/contrib-81485647757, 10.1145/contrib-99660525827, 10.1145/contrib-99660183143, 10.1145/contrib-81442605637, 10.1145/contrib-99660183075, 10.1145/contrib-99659620583, 10.1145/contrib-99659400316, 10.1145/contrib-99659620585, 10.1145/contrib-99660183054, 10.1145/contrib-99660182916, 10.1145/contrib-81467652983, 10.1145/contrib-81442605586, 10.1145/contrib-81552804056, 10.1145/contrib-81413596978, 10.1145/contrib-99660182863, 10.1145/contrib-81474679208, 10.1145/contrib-99660182875, 10.1145/contrib-99660183087, 10.1145/contrib-81464662579, 10.1145/contrib-81488659114, 10.1145/contrib-99659620610]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |245           |\n|1688428   |173         |[J. yang, Ji-yue Wang, Jian Yang, Jie Yang]                                                                                                                                                         |[10.1145/contrib-81442592932, 10.1145/contrib-81350600597, 10.1145/contrib-99658659886, 10.1145/contrib-99659594315, 10.1145/contrib-81500641540, 10.1145/contrib-99660600616, 10.1145/contrib-99660368054, 10.1145/contrib-99658699346, 10.1145/contrib-99659234687, 10.1145/contrib-99660368250, 10.1145/contrib-99660368133, 10.1145/contrib-99660681989, 10.1145/contrib-99659594294, 10.1145/contrib-99660367849, 10.1145/contrib-99660266359, 10.1145/contrib-99660368095, 10.1145/contrib-99660368107, 10.1145/contrib-99659779316, 10.1145/contrib-81485640977, 10.1145/contrib-99660368042, 10.1145/contrib-81759042157, 10.1145/contrib-99659594587, 10.1145/contrib-99660367599, 10.1145/contrib-99660368213, 10.1145/contrib-99660368229, 10.1145/contrib-87059826157, 10.1145/contrib-99660367604, 10.1145/contrib-87059835357, 10.1145/contrib-99660712322, 10.1145/contrib-81447592566, 10.1145/contrib-81474641315, 10.1145/contrib-99659779307, 10.1145/contrib-99659594338, 10.1145/contrib-99660368422, 10.1145/contrib-99660368142, 10.1145/contrib-99660266336, 10.1145/contrib-99660367863, 10.1145/contrib-99660368180, 10.1145/contrib-99659234699, 10.1145/contrib-81329493027, 10.1145/contrib-99660587840, 10.1145/contrib-99660367995, 10.1145/contrib-99660367558, 10.1145/contrib-99660568889, 10.1145/contrib-81350589970, 10.1145/contrib-99660212566, 10.1145/contrib-82458831557, 10.1145/contrib-99660368155, 10.1145/contrib-99660368342, 10.1145/contrib-99659594457, 10.1145/contrib-99660368615, 10.1145/contrib-81507682533, 10.1145/contrib-99659275871, 10.1145/contrib-99660367847, 10.1145/contrib-99660367548, 10.1145/contrib-99659779278, 10.1145/contrib-99660368523, 10.1145/contrib-99660368401, 10.1145/contrib-99660367834, 10.1145/contrib-99660730449, 10.1145/contrib-99660212686, 10.1145/contrib-99660266387, 10.1145/contrib-99660368488, 10.1145/contrib-99660367840, 10.1145/contrib-99658715175, 10.1145/contrib-99660368287, 10.1145/contrib-99660367845, 10.1145/contrib-99660367603, 10.1145/contrib-99660145190, 10.1145/contrib-99660368276, 10.1145/contrib-99659594293, 10.1145/contrib-99659801875, 10.1145/contrib-99660367660, 10.1145/contrib-99658762507, 10.1145/contrib-81496641316, 10.1145/contrib-99660368439, 10.1145/contrib-99660600608, 10.1145/contrib-99659594450, 10.1145/contrib-99660368030, 10.1145/contrib-99660368218, 10.1145/contrib-99660212768, 10.1145/contrib-99660367964, 10.1145/contrib-99660367835, 10.1145/contrib-99660368591, 10.1145/contrib-99660568891, 10.1145/contrib-99659779282, 10.1145/contrib-99659594655, 10.1145/contrib-99660368521, 10.1145/contrib-99660368181, 10.1145/contrib-99660368249, 10.1145/contrib-99658622118, 10.1145/contrib-99660367842, 10.1145/contrib-99660368525, 10.1145/contrib-99660498589, 10.1145/contrib-99660590896, 10.1145/contrib-99660368027, 10.1145/contrib-99658699307, 10.1145/contrib-99660368156, 10.1145/contrib-99659594301, 10.1145/contrib-99660367547, 10.1145/contrib-99660368275, 10.1145/contrib-99660212547, 10.1145/contrib-99660368247, 10.1145/contrib-99660368114, 10.1145/contrib-99660367636, 10.1145/contrib-99659045679, 10.1145/contrib-99660235371, 10.1145/contrib-84460003657, 10.1145/contrib-99659594303, 10.1145/contrib-99658965047, 10.1145/contrib-99659667015, 10.1145/contrib-99659594642, 10.1145/contrib-99660581067, 10.1145/contrib-99659853100, 10.1145/contrib-99659193249, 10.1145/contrib-99660368028, 10.1145/contrib-99659597869, 10.1145/contrib-99660368136, 10.1145/contrib-81375591532, 10.1145/contrib-99660368084, 10.1145/contrib-99659336054, 10.1145/contrib-99660368087, 10.1145/contrib-99660368198, 10.1145/contrib-99660368518, 10.1145/contrib-99660368527, 10.1145/contrib-81350589929, 10.1145/contrib-99660368220, 10.1145/contrib-99659779308, 10.1145/contrib-99660367981, 10.1145/contrib-81453606223, 10.1145/contrib-81474641311, 10.1145/contrib-81387591595, 10.1145/contrib-99660266308, 10.1145/contrib-99660368493, 10.1145/contrib-99660368115, 10.1145/contrib-99659594388, 10.1145/contrib-99660367666, 10.1145/contrib-99659594305, 10.1145/contrib-99660568888, 10.1145/contrib-99660367866, 10.1145/contrib-99660368228, 10.1145/contrib-99659833974, 10.1145/contrib-99659909613, 10.1145/contrib-99660368417, 10.1145/contrib-99660367653, 10.1145/contrib-99660212655, 10.1145/contrib-81490641613, 10.1145/contrib-81496641352, 10.1145/contrib-99660367563, 10.1145/contrib-83358639357, 10.1145/contrib-99659594374, 10.1145/contrib-99660075049, 10.1145/contrib-99660368145, 10.1145/contrib-99660368508, 10.1145/contrib-99660367937, 10.1145/contrib-99660367554, 10.1145/contrib-81502714950, 10.1145/contrib-99660368208, 10.1145/contrib-99659594306, 10.1145/contrib-81550091556, 10.1145/contrib-99660368007, 10.1145/contrib-99659135370, 10.1145/contrib-99659594443, 10.1145/contrib-99659743462, 10.1145/contrib-81447592561, 10.1145/contrib-81492640738, 10.1145/contrib-99660632809, 10.1145/contrib-99660145197, 10.1145/contrib-99660368485, 10.1145/contrib-99660367961, 10.1145/contrib-87259097757, 10.1145/contrib-99659594356, 10.1145/contrib-99660730441]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |264           |"
     },
     {
      "type": "HTML",
      "data": "<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 102400 bytes. Learn more about <strong>ZEPPELIN_INTERPRETER_OUTPUT_LIMIT</strong></div>"
     }
    ]
   },
   "dateFinished": "2023-03-15 09:49:20.585"
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nacmPerPkg.orderBy($\"acmauthorCnt\" desc).show(20, true)",
   "id": "",
   "dateCreated": "2023-03-15 09:48:54.074",
   "config": {
    "editorHide": true,
    "tableHide": true
   },
   "dateStarted": "2023-03-17 16:30:18.903",
   "dateUpdated": "2023-03-17 16:30:36.800",
   "dateFinished": "2023-03-17 16:30:36.800",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mone feature warning; for details, enable `:setting -feature' or `:replay -feature'\n+--------------------+------------+--------------------+--------------------+--------------+\n|         pkgAuthorId|ACMauthorCnt|        oaAuthorName|      acm_author_ids|OAauthorPubCnt|\n+--------------------+------------+--------------------+--------------------+--------------+\n|3de7BhGDHPVQOprzL...|        1276|          [Wei Wang]|[10.1145/contrib-...|          1829|\n|3de7AIBrdmKmH4u9k...|         938|          [Yang Liu]|[10.1145/contrib-...|          1370|\n|3de7AJJr7CB6dT5mJ...|         855|         [Lei Zhang]|[10.1145/contrib-...|          1416|\n|3de7BAGOmaj3cd9do...|         813|          [Lei Wang]|[10.1145/contrib-...|          1062|\n|3de7AGAVAjBme8WBR...|         753| [G. Wang, Jun Wang]|[10.1145/contrib-...|          1164|\n|3de79LDy7W9kYezNa...|         733|         [Yang Yang]|[10.1145/contrib-...|          1135|\n|3de79ZOMSpzxDZckx...|         717|    [Xin LI, Xin Li]|[10.1145/contrib-...|          1219|\n|3de7Af0t0Q87uREZq...|         689|[Yu Zhang, Y. Zhang]|[10.1145/contrib-...|           903|\n|3de79H2Hg3CLFHAtH...|         655|          [Xin Wang]|[10.1145/contrib-...|           950|\n|3de79lP0decTL7vRT...|         640|         [Wei Zhang]|[10.1145/contrib-...|           894|\n|3de7AG4GYjjUBk3Em...|         633|[Yan Zhang, Y. Zh...|[10.1145/contrib-...|           869|\n|3de79HxPHMyBQ3b6q...|         625|[Jing Wang, JING ...|[10.1145/contrib-...|           758|\n|3de7A23QCHNhQ3rfB...|         620|           [Jing Li]|[10.1145/contrib-...|           817|\n|3de7CUZfxIFOFsJDv...|         617|         [Jun Zhang]|[10.1145/contrib-...|          1037|\n|3de7AemMGCQ25Ycdx...|         609|        [Jing Zhang]|[10.1145/contrib-...|           798|\n|3de7CbaR42YWYrASj...|         576|          [Hao Wang]|[10.1145/contrib-...|           798|\n|3de79rbfSRIcBtUxp...|         573|          [Yan Wang]|[10.1145/contrib-...|           808|\n|3de79YXcvRxNtdV6l...|         566|           [Yu Wang]|[10.1145/contrib-...|           873|\n|3de79be35ynGscsMs...|         560|          [Li Zhang]|[10.1145/contrib-...|           932|\n|3de7AEgxwNqV6QBny...|         559|         [Jie Zhang]|[10.1145/contrib-...|           849|\n+--------------------+------------+--------------------+--------------------+--------------+\nonly showing top 20 rows\n\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\npkgPerAcm.orderBy($\"pkgauthorCnt\" desc).show(20, false)\n\n\n",
   "id": "",
   "dateCreated": "2023-03-14 18:59:28.979",
   "config": {
    "editorHide": true,
    "tableHide": true
   },
   "dateStarted": "2023-03-17 16:28:20.856",
   "dateUpdated": "2023-03-17 16:28:55.949",
   "dateFinished": "2023-03-17 16:28:55.949",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mone feature warning; for details, enable `:setting -feature' or `:replay -feature'\n+---------------------------+------------+-----------+-----------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|acm_author_id              |pkgauthorCnt|OAauthorCnt|S2authorCnt|acmAuthorPubCnt|oaAuthorName                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |pkgAuthorIds                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n+---------------------------+------------+-----------+-----------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|10.1145/contrib-81350582990|65          |67         |14         |288            |[Lin-Qiang Chen, Lixin Chen, Lidong Chen, Ling-Jyh Chen, Lixue Chen, Lisi Chen, Lih-Ju Chen, Lihong Chen, Li-Da Chen, Long Qing Chen, Liang-Chu Chen, Lingxiao Chen, Lu Chen, Liang-Wan Chen, Lan Chen, Liaoyuan Chen, Libing Chen, Liu Chen, Linggui Chen, Lincoln C. Chen, Lixiang Chen, Louis H. Y. Chen, Liang-Chun Chen, Lihui Chen, Lin X. Chen, Le-Yu Chen, Lianjun Chen, Lein Lein Chen, Ling Chen, Liang Chen, Lie-Wen Chen, Langxing Chen, Rui Chen, Liming Chen, Lina Chen, Li-Jun Chen, Lingen Chen, Li-Chuan Chen, Limei Chen, Lawson Chen, Liping Chen, Li-Ting Chen, Li Jia Chen, Liqun Chen, Lansun Chen, Lin-Lin Chen, Luzhao Chen, Liang-Gee Chen, Lanli Chen, Lingyu Chen, Lou Chen, Liang-Yu Chen, Longqian Chen, Li-Jen Chen, Lingyun Chen, Liangming Chen, Li Chen, Lijian Chen, Ligong Chen, Lei Chen, Ligang Chen, Lijia Chen, Litao Chen, Le Chen, Lian Chen, Lydia Y. Chen]|[3de7BJk0etY0BWjPieb2h29, 3de7BJk0etY0BWjPieb2h83, 3de7BJk0etY0BWjPieb2h5, 3de7BJk0etY0BWjPieb2h8, 3de7BJk0etY0BWjPieb2h74, 3de7BJk0etY0BWjPieb2h58, 3de7BJk0etY0BWjPieb2h88, 3de7BJk0etY0BWjPieb2h10, 3de7BJk0etY0BWjPieb2h46, 3de7BJk0etY0BWjPieb2h31, 3de7BJk0etY0BWjPieb2h84, 3de7BJk0etY0BWjPieb2h30, 3de7BJk0etY0BWjPieb2h2, 3de7BJk0etY0BWjPieb2h104, 3de7BJk0etY0BWjPieb2h81, 3de7BJk0etY0BWjPieb2h14, 3de7BJk0etY0BWjPieb2h86, 3de7BJk0etY0BWjPieb2h3, 3de7BJk0etY0BWjPieb2h22, 3de7BJk0etY0BWjPieb2h64, 3de7BJk0etY0BWjPieb2h97, 3de7BJk0etY0BWjPieb2h17, 3de7BJk0etY0BWjPieb2h24, 3de7BJk0etY0BWjPieb2h107, 3de7BJk0etY0BWjPieb2h91, 3de7BJk0etY0BWjPieb2h40, 3de7BJk0etY0BWjPieb2h43, 3de7BJk0etY0BWjPieb2h, 3de7BJk0etY0BWjPieb2h7, 3de7BJk0etY0BWjPieb2h18, 3de7BJk0etY0BWjPieb2h34, 3de7BJk0etY0BWjPieb2h37, 3de7BJk0etY0BWjPieb2h6, 3de7BJk0etY0BWjPieb2h96, 3de7BJk0etY0BWjPieb2h63, 3de7BJk0etY0BWjPieb2h108, 3de7BJk0etY0BWjPieb2h21, 3de7BJk0etY0BWjPieb2h54, 3de7BJk0etY0BWjPieb2h12, 3de7BJk0etY0BWjPieb2h73, 3de7BJk0etY0BWjPieb2h94, 3de7BJk0etY0BWjPieb2h39, 3de7BJk0etY0BWjPieb2h50, 3de7BJk0etY0BWjPieb2h4, 3de7BJk0etY0BWjPieb2h33, 3de7BJk0etY0BWjPieb2h13, 3de7BJk0etY0BWjPieb2h38, 3de7BJk0etY0BWjPieb2h16, 3de7BJk0etY0BWjPieb2h9, 3de7BJk0etY0BWjPieb2h55, 3de7BJk0etY0BWjPieb2h76, 3de7BJk0etY0BWjPieb2h47, 3de7BJk0etY0BWjPieb2h25, 3de7BJk0etY0BWjPieb2h52, 3de7BJk0etY0BWjPieb2h75, 3de7BJk0etY0BWjPieb2h15, 3de7BJk0etY0BWjPieb2h85, 3de7BJk0etY0BWjPieb2h32, 3de7BJk0etY0BWjPieb2h19, 3de7BJk0etY0BWjPieb2h72, 3de7BJk0etY0BWjPieb2h70, 3de7BJk0etY0BWjPieb2h93, 3de7BJk0etY0BWjPieb2h89, 3de7BJk0etY0BWjPieb2h11, 3de7BJk0etY0BWjPieb2h20]|\n|10.1145/contrib-81471640432|54          |57         |5          |184            |[Jiunn-Yuan Lin, Jonathan H. Lin, Jingyu Lin, Jiunn-Cherng Lin, Jinru Lin, Jainn-Jim Lin, Jin-Ming Lin, Jen Kou Lin, Jinxing Lin, J.-Y. Lin, Jiaping Lin, Jennifer S Lin, James C. Lin, Jr-Jiun Lin, Jyi-Tsong Lin, Jen-Der Lin, Jessica Lin, Jim J. Lin, Jiangwei Lin, Julie Lin, Jintong Lin, Jinxiu Lin, Jian-Sheng Lin, Jules Lin, Jianing Lin, Junxiu Lin, Jianzhong Lin, Jean-Pierre Lin, Ji Lin, Jingmei Lin, Jay Lin, Jacob J. Lin, Jeen-Shang Lin, Jintai Lin, Juhn-Jong Lin, Junhao Lin, Jephian C.-H. Lin, John C. Lin, Jia-Horng Lin, Jianguo Lin, Jimmy Lin, Jaw-Town Lin, Jim J.-C. Lin, Jialiang Lin, Jiahao Lin, Jian Lin, Jiang Lin, Jenshan Lin, Jiann T. Lin, Jianyi Lin, Jou-Wei Lin, Jeremy Lin, Justin Yifu Lin, Jun Lin]                                                                                                                                                      |[3de7BqMWTJvlYqOxVazk423, 3de7BqMWTJvlYqOxVazk421, 3de7BqMWTJvlYqOxVazk410, 3de7BqMWTJvlYqOxVazk432, 3de7BqMWTJvlYqOxVazk443, 3de7BqMWTJvlYqOxVazk47, 3de7BqMWTJvlYqOxVazk435, 3de7BqMWTJvlYqOxVazk444, 3de7BqMWTJvlYqOxVazk456, 3de7BqMWTJvlYqOxVazk44, 3de7BqMWTJvlYqOxVazk438, 3de7BqMWTJvlYqOxVazk45, 3de7BqMWTJvlYqOxVazk429, 3de7BqMWTJvlYqOxVazk445, 3de7BqMWTJvlYqOxVazk436, 3de7BqMWTJvlYqOxVazk424, 3de7BqMWTJvlYqOxVazk441, 3de7BqMWTJvlYqOxVazk446, 3de7BqMWTJvlYqOxVazk433, 3de7BqMWTJvlYqOxVazk430, 3de7BqMWTJvlYqOxVazk422, 3de7BqMWTJvlYqOxVazk442, 3de7BqMWTJvlYqOxVazk451, 3de7BqMWTJvlYqOxVazk49, 3de7BqMWTJvlYqOxVazk431, 3de7BqMWTJvlYqOxVazk413, 3de7BqMWTJvlYqOxVazk43, 3de7BqMWTJvlYqOxVazk415, 3de7BygsUXRoLoey33goa6, 3de7BqMWTJvlYqOxVazk440, 3de7BqMWTJvlYqOxVazk448, 3de7BqMWTJvlYqOxVazk411, 3de7BqMWTJvlYqOxVazk447, 3de7BqMWTJvlYqOxVazk455, 3de7BqMWTJvlYqOxVazk418, 3de7BqMWTJvlYqOxVazk434, 3de7BqMWTJvlYqOxVazk420, 3de7BqMWTJvlYqOxVazk439, 3de7BqMWTJvlYqOxVazk449, 3de7BqMWTJvlYqOxVazk454, 3de7BqMWTJvlYqOxVazk416, 3de7BqMWTJvlYqOxVazk452, 3de7BqMWTJvlYqOxVazk426, 3de7BqMWTJvlYqOxVazk419, 3de7BqMWTJvlYqOxVazk42, 3de7BqMWTJvlYqOxVazk46, 3de7BqMWTJvlYqOxVazk412, 3de7BqMWTJvlYqOxVazk414, 3de7BqMWTJvlYqOxVazk48, 3de7BqMWTJvlYqOxVazk4, 3de7BqMWTJvlYqOxVazk428, 3de7BqMWTJvlYqOxVazk450, 3de7BqMWTJvlYqOxVazk453, 3de7BqMWTJvlYqOxVazk437]                                                                                                                                                                                                                                                                                       |\n|10.1145/contrib-81388600864|28          |28         |2          |91             |[Letao Chen, Lixin Chen, Lang Chen, Liping Chen, Lujun Chen, Longwei Chen, Liqun Chen, Lihong Chen, Long Qing Chen, Lili Chen, Lu-Min Chen, Lu Chen, Liang-Gee Chen, Liang-Wan Chen, Lijuan Chen, Longhua Chen, Liu Chen, Liheng Chen, Li Chen, Lin X. Chen, Laiguo Chen, Luonan Chen, Lujie Chen, Liyao Chen, Liang Chen, Ling Chen, Lei Chen, Leiyi Chen]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |[3de7B5rM8wR1r31n2E5YM22, 3de7B5rM8wR1r31n2E5YM13, 3de7B5rM8wR1r31n2E5YM25, 3de7B5rM8wR1r31n2E5YM19, 3de7B5rM8wR1r31n2E5YM23, 3de7B5rM8wR1r31n2E5YM6, 3de7B5rM8wR1r31n2E5YM31, 3de7B5rM8wR1r31n2E5YM16, 3de7B5rM8wR1r31n2E5YM28, 3de7B5rM8wR1r31n2E5YM11, 3de7B5rM8wR1r31n2E5YM10, 3de7B5rM8wR1r31n2E5YM34, 3de7B5rM8wR1r31n2E5YM, 3de7B5rM8wR1r31n2E5YM27, 3de7B5rM8wR1r31n2E5YM7, 3de7B5rM8wR1r31n2E5YM18, 3de7B5rM8wR1r31n2E5YM17, 3de7B5rM8wR1r31n2E5YM33, 3de7B5rM8wR1r31n2E5YM4, 3de7B5rM8wR1r31n2E5YM5, 3de7B5rM8wR1r31n2E5YM30, 3de7B5rM8wR1r31n2E5YM12, 3de7B5rM8wR1r31n2E5YM21, 3de7B5rM8wR1r31n2E5YM32, 3de7B5rM8wR1r31n2E5YM20, 3de7B5rM8wR1r31n2E5YM3, 3de7B5rM8wR1r31n2E5YM8, 3de7B5rM8wR1r31n2E5YM2]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|10.1145/contrib-81453645580|22          |23         |1          |55             |[Haibo Ji, Hongwu Ji, Hui Ji, Hyeonso Ji, Hongjun Ji, Heng Ji, Hongwei Ji, Hongmei Ji, Hantao Ji, Huiming Ji, Hyunjin Ji, Hai-Feng Ji, Hong Ji, Honghai Ji, Hongbin Ji, Hua Ji, Haoyan Ji, Haiyan Ji, Hongli Ji, Haipeng Ji, Huijiao Ji, Hongbing Ji]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |[3de79ZbcZej10JJERWs4p17, 3de79ZbcZej10JJERWs4p4, 3de79ZbcZej10JJERWs4p, 3de79ZbcZej10JJERWs4p14, 3de79ZbcZej10JJERWs4p8, 3de79ZbcZej10JJERWs4p21, 3de79ZbcZej10JJERWs4p11, 3de79ZbcZej10JJERWs4p16, 3de79ZbcZej10JJERWs4p5, 3de79ZbcZej10JJERWs4p2, 3de79ZbcZej10JJERWs4p22, 3de79ZbcZej10JJERWs4p13, 3de79ZbcZej10JJERWs4p6, 3de79ZbcZej10JJERWs4p12, 3de79ZbcZej10JJERWs4p3, 3de79ZbcZej10JJERWs4p15, 3de79ZbcZej10JJERWs4p10, 3de79ZbcZej10JJERWs4p7, 3de79ZbcZej10JJERWs4p20, 3de79ZbcZej10JJERWs4p24, 3de79ZbcZej10JJERWs4p9, 3de79ZbcZej10JJERWs4p19]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|10.1145/contrib-81100222772|21          |23         |3          |32             |[Jiunn-Yuan Lin, Jingyu Lin, Jainn-Jim Lin, Jin-Guan Lin, Jen Kou Lin, Jia-Horng Lin, Jing Yang, Jingqiang Lin, James C. Lin, Jen-Kou Lin, Jianping Lin, Junda Lin, Jen-Der Lin, Jen Fin Lin, Jin-Ching Lin, Jing Wang, Jiunn Lee Lin, Jintong Lin, JAMES C. LIN, Jianzhong Lin, Jing Lin, Jun Lin, Jiuun-Yih Lin]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |[3de7B85sN2D7vEFOtr7xr23, 3de7B85sN2D7vEFOtr7xr3, 3de7B85sN2D7vEFOtr7xr6, 3de7B85sN2D7vEFOtr7xr5, 3de7B85sN2D7vEFOtr7xr20, 3de7B85sN2D7vEFOtr7xr25, 3de7B85sN2D7vEFOtr7xr14, 3de7B85sN2D7vEFOtr7xr18, 3de7B85sN2D7vEFOtr7xr24, 3de7B85sN2D7vEFOtr7xr4, 3de7B85sN2D7vEFOtr7xr13, 3de7B85sN2D7vEFOtr7xr11, 3de7B85sN2D7vEFOtr7xr10, 3de7B85sN2D7vEFOtr7xr21, 3de7B85sN2D7vEFOtr7xr7, 3de7B85sN2D7vEFOtr7xr8, 3de7B85sN2D7vEFOtr7xr12, 3de7B85sN2D7vEFOtr7xr, 3de7B85sN2D7vEFOtr7xr9, 3de7B85sN2D7vEFOtr7xr2, 3de7B85sN2D7vEFOtr7xr16]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|10.1145/contrib-81556497656|20          |20         |3          |28             |[Jinyong Lin, Jiunn-Yuan Lin, Jiaru Lin, Jianhua Lin, Jian-Xian Lin, Jainn-Jim Lin, Jin-Guan Lin, Jia-Horng Lin, Ji-Fan Lin, Jaw-Town Lin, Jim J.-C. Lin, Jian Lin, Juntang Lin, Jessica Lin, Jung-Fu Lin, Jintong Lin, Jonathan Feng-Shun Lin, Jianyi Lin, Jaung Geng Lin, Jun Lin]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |[3de7BoWZQ2LPI3Ldurwx610, 3de7BoWZQ2LPI3Ldurwx6, 3de7BoWZQ2LPI3Ldurwx67, 3de7BoWZQ2LPI3Ldurwx621, 3de7BoWZQ2LPI3Ldurwx62, 3de7BoWZQ2LPI3Ldurwx622, 3de7BoWZQ2LPI3Ldurwx69, 3de7BoWZQ2LPI3Ldurwx66, 3de7BoWZQ2LPI3Ldurwx616, 3de7BoWZQ2LPI3Ldurwx65, 3de7BoWZQ2LPI3Ldurwx618, 3de7BoWZQ2LPI3Ldurwx615, 3de7BoWZQ2LPI3Ldurwx63, 3de7BoWZQ2LPI3Ldurwx619, 3de7BoWZQ2LPI3Ldurwx620, 3de7BoWZQ2LPI3Ldurwx613, 3de7BoWZQ2LPI3Ldurwx68, 3de7BoWZQ2LPI3Ldurwx611, 3de7BoWZQ2LPI3Ldurwx614, 3de7BoWZQ2LPI3Ldurwx617]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n|10.1145/contrib-81100108711|18          |18         |5          |54             |[Li-Jun Chen, Linyu Chen, Linsong Chen, Ping He, Lidong Chen, Lihui Chen, Li Chen, Limin Chen, Long Qing Chen, Ling-Ling Chen, Ling Chen, Liang Chen, Liyi Chen, Lu Chen, Luyao Chen, Liming Chen, Li-Jen Chen, Lv Chen]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |[3de7BUjObhJR6rxjZvOZ519, 3de7BUjObhJR6rxjZvOZ546, 3de7BUjObhJR6rxjZvOZ58, 3de7BUjObhJR6rxjZvOZ525, 3de7BUjObhJR6rxjZvOZ552, 3de7BUjObhJR6rxjZvOZ551, 3de7BUjObhJR6rxjZvOZ520, 3de7BUjObhJR6rxjZvOZ55, 3de7BUjObhJR6rxjZvOZ59, 3de7BUjObhJR6rxjZvOZ533, 3de7BUjObhJR6rxjZvOZ529, 3de7BUjObhJR6rxjZvOZ518, 3de7BUjObhJR6rxjZvOZ53, 3de7BUjObhJR6rxjZvOZ516, 3de7BUjObhJR6rxjZvOZ52, 3de7BUjObhJR6rxjZvOZ5, 3de7BUjObhJR6rxjZvOZ550, 3de7BUjObhJR6rxjZvOZ56]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n|10.1145/contrib-81100217175|18          |19         |4          |60             |[Juan Manuel Trujillo Torres, J. Torres, Julián Ruiz Torres, Jacqueline M. Torres, Jordi Torres, João Paulo Machado Torres, Joaquim Torres, Juan P. Torres, Javiera Torres, Jose Torres, José Luiz Rodrigues Torres, Joaquín J. Torres, J. Alfaro Torres, José Ruiz Torres, Jorge B. Torres, Javier Torres, Jhan Sebastián Saavedra Torres, Joana Torres, Josep Lluís Torres]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |[3de7BLideNgsUusgSuJVk8, 3de7BLideNgsUusgSuJVk, 3de7BLideNgsUusgSuJVk9, 3de7BLideNgsUusgSuJVk12, 3de7BLideNgsUusgSuJVk17, 3de7BLideNgsUusgSuJVk10, 3de7BLideNgsUusgSuJVk7, 3de7BLideNgsUusgSuJVk19, 3de7BLideNgsUusgSuJVk13, 3de7BLideNgsUusgSuJVk6, 3de7BLideNgsUusgSuJVk18, 3de7BLideNgsUusgSuJVk5, 3de7BLideNgsUusgSuJVk4, 3de7BLideNgsUusgSuJVk3, 3de7BLideNgsUusgSuJVk16, 3de7BLideNgsUusgSuJVk15, 3de7BLideNgsUusgSuJVk11, 3de7BLideNgsUusgSuJVk2]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |\n|10.1145/contrib-81100121357|18          |10         |42         |217            |[Lixin Zhang, Lijuan Zhang, Libin Zhang, Li Zhang, Liyan Zhang, Lei Zhang, Lizhu Zhang, Lizheng Zhang, Liqin Zhang, Lixia Zhang]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |[3de79be35ynGscsMst0D3, 3de7BCARa762JLXH2abqb2, 3de7B3OJc31moWmwh1PnD, 3de7Bmf3iJLbSzn83ivHQ, 3de7BCARa762JLXH2abqb, 3de79gW8lInHvDapJBvMo2, 3de79gW8lInHvDapJBvMo, 3de7ApK9u4ITrX5iuQKI4, 3de7BKGZL8dxOrxPeQZlO3, 3de7BH9qlWISbLyibsvxF, 3de7CBdKoPHopU8Gz7fm7, 3de7AEUse0sCN0YyM0VYC, 3de7BUZRr4v3kDbmXuUYo, 3de79be35ynGscsMst0D32, 3de7CU7JHfXgo6YuIr7ik, 3de79s2TZ1CTnKLwae3lM, 3de7ASrwuPQvs5SCvNP2f, 3de79cKG28jfvgGYx3R1v2]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|10.1145/contrib-81440609282|17          |17         |2          |31             |[Jiunn-Yuan Lin, Jiaru Lin, Jen-Yu Lin, Jingyu Lin, Jia-Horng Lin, Jimmy Lin, Jianguo Lin, Jaw-Town Lin, Jim J.-C. Lin, Jauyn Grace Lin, James C. Lin, Jing-Yuan Lin, Jung-Fu Lin, Jiachuan Lin, Jianzhong Lin, Justin Yifu Lin, Jun Lin]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |[3de7BrM8DvxkZO5q3mNXj3, 3de7BrM8DvxkZO5q3mNXj21, 3de7BrM8DvxkZO5q3mNXj13, 3de7BrM8DvxkZO5q3mNXj16, 3de7BrM8DvxkZO5q3mNXj7, 3de7BrM8DvxkZO5q3mNXj2, 3de7BrM8DvxkZO5q3mNXj6, 3de7BrM8DvxkZO5q3mNXj4, 3de7BrM8DvxkZO5q3mNXj, 3de7BrM8DvxkZO5q3mNXj8, 3de7BrM8DvxkZO5q3mNXj10, 3de7BrM8DvxkZO5q3mNXj22, 3de7BrM8DvxkZO5q3mNXj9, 3de7BrM8DvxkZO5q3mNXj11, 3de7BrM8DvxkZO5q3mNXj17, 3de7BrM8DvxkZO5q3mNXj5, 3de7BrM8DvxkZO5q3mNXj14]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n|10.1145/contrib-81408598829|17          |17         |5          |47             |[Li-Chuan Chen, Liezun Chen, Li Chen, Lin X. Chen, Laiguo Chen, Liqun Chen, Le-Yu Chen, Longbang Chen, Lih-Juann Chen, Lijing Chen, Ling Chen, Liang Chen, Lie-Wen Chen, Lei Chen, Li-Hsun Chen, Liangying Peng, Longhua Chen]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |[3de7BUjObhJR6rxjZvOZ548, 3de7BUjObhJR6rxjZvOZ57, 3de7BUjObhJR6rxjZvOZ534, 3de7BUjObhJR6rxjZvOZ536, 3de7BUjObhJR6rxjZvOZ547, 3de7BUjObhJR6rxjZvOZ554, 3de7BUjObhJR6rxjZvOZ54, 3de7BUjObhJR6rxjZvOZ55, 3de7BUjObhJR6rxjZvOZ512, 3de7BUjObhJR6rxjZvOZ535, 3de7BUjObhJR6rxjZvOZ556, 3de7BUjObhJR6rxjZvOZ530, 3de7BUjObhJR6rxjZvOZ542, 3de7BUjObhJR6rxjZvOZ53, 3de7BUjObhJR6rxjZvOZ528, 3de7BUjObhJR6rxjZvOZ5, 3de7BUjObhJR6rxjZvOZ539]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|10.1145/contrib-81100108831|16          |16         |4          |51             |[Lihua Chen, Lixiang Chen, Lu-Yen Chen, Lidong Chen, Ling-Jyh Chen, Lin X. Chen, Long Qing Chen, Lihai Chen, Ling Chen, Liang Chen, Lei Chen, Lien-Chin Chen, Liang-Gee Chen, Lien-Fei Chen, Liang-Bi Chen, Le Chen]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |[3de7AU56go8A5z7pwqsIl8, 3de7AU56go8A5z7pwqsIl17, 3de7AU56go8A5z7pwqsIl12, 3de7AU56go8A5z7pwqsIl7, 3de7AU56go8A5z7pwqsIl3, 3de7AU56go8A5z7pwqsIl6, 3de7AU56go8A5z7pwqsIl10, 3de7AU56go8A5z7pwqsIl5, 3de7AU56go8A5z7pwqsIl11, 3de7AU56go8A5z7pwqsIl18, 3de7AU56go8A5z7pwqsIl2, 3de7AU56go8A5z7pwqsIl14, 3de7AU56go8A5z7pwqsIl16, 3de7AU56go8A5z7pwqsIl, 3de7AU56go8A5z7pwqsIl4, 3de7AU56go8A5z7pwqsIl9]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n|10.1145/contrib-81323488898|16          |17         |5          |72             |[Lixiang Chen, Lingyun Chen, Liping Chen, Li Chen, Lin X. Chen, Lianchang Chen, Ligong Chen, Lihong Chen, Lin-Lin Chen, Long Qing Chen, Liang Chen, Ling Chen, Liu Chen, Longjian Chen, Ling-Yang Chen, Lieping Chen]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |[3de7BLO4NVLyUezIfTwkz4, 3de7BLO4NVLyUezIfTwkz58, 3de7BLO4NVLyUezIfTwkz29, 3de7BLO4NVLyUezIfTwkz63, 3de7BLO4NVLyUezIfTwkz9, 3de7BLO4NVLyUezIfTwkz2, 3de7BLO4NVLyUezIfTwkz19, 3de7BLO4NVLyUezIfTwkz, 3de7BLO4NVLyUezIfTwkz22, 3de7BLO4NVLyUezIfTwkz12, 3de7BLO4NVLyUezIfTwkz17, 3de7BLO4NVLyUezIfTwkz53, 3de7BLO4NVLyUezIfTwkz48, 3de7BLO4NVLyUezIfTwkz25, 3de7BLO4NVLyUezIfTwkz5, 3de7BLO4NVLyUezIfTwkz6]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n|10.1145/contrib-81100380131|16          |11         |12         |96             |[Jose M. Garcia, Jose A. García, J. M. Vizan Garcia, José Luis García, Joso M. Garcia, José M. García, Javier García, José García, Juan-Miguel Gracia, José Manuel Sánchez García, José Luis Escacena Carrasco]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |[3de7C3e8PTEzlqXUkRruX, 3de7B5d7ZQB6nnIQq29nU2, 3de7AI8e7DB8bNyaX441p, 3de7B5d7ZQB6nnIQq29nU3, 3de79vSyym0a6JfvY24tj2, 3de7B5d7ZQB6nnIQq29nU5, 3de7AI8e7DB8bNyaX441p3, 3de7BhhztOBnzz4Ndpn6J5, 3de7AI8e7DB8bNyaX441p2, 3de7B5d7ZQB6nnIQq29nU4, 3de79en6t5uxnt0gYeUCI2, 3de79UAL4HGnY3KqbKEvq, 3de7B5d7ZQB6nnIQq29nU, 3de79vSyym0a6JfvY24tj, 3de7B5d7ZQB6nnIQq29nU6, 3de7AXx0KprPWtOLPG3YC]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n|10.1145/contrib-81456614839|16          |7          |29         |120            |[Chunhui Chen, C.L.P. Chen, C.L. Philip Chen, Chao-Lieh Chen, C. L. Philip Chen]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |[3de7AHx2ir5gdFsN7mvF5, 3de7AMRFnnggk2SDF32jn, 3de7AiaeDfAiOk8g1U0Bi, 3de7ATuHWpQHenJA5NcSB, 3de7AttKwvSOCkAwppUhX, 3de7ATdJvqAzNpmo3g243, 3de7AdMcoQWxNRJXJJAva, 3de7ArtjTO97qczd5EnYM, 3de7B9oQ3FgdOztOxo8WD2, 3de7Am6ECNor1irna6CwP, 3de7B84Pav9R0GhTAicP3, 3de7AlBUc4hxxkZQTrFQD, 3de7AlBUc4hxxkZQTrFQD2, 3de7AiUbhgOuu0rDKjIhg, 3de7BXGpDrxQZWIlmUTOJ, 3de7B9oQ3FgdOztOxo8WD]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |\n|10.1145/contrib-81451598857|15          |16         |2          |21             |[Jiunn-Yuan Lin, Jiaru Lin, Jin Lin, Jintai Lin, Juin-Ming Lu, J. Lin, Jia-Horng Lin, Jimmy Lin, Ju-Li Lin, Jung-Chih Lin, Jin-Ching Lin, Jai-Ming Lin, Jintong Lin, Jianzhong Lin, Ji Lin, Jun Lin]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |[3de79T1rUUEElGIU5Upus6, 3de79T1rUUEElGIU5Upus13, 3de79T1rUUEElGIU5Upus5, 3de79T1rUUEElGIU5Upus12, 3de7ALhdLoK875jCcA9dA, 3de79T1rUUEElGIU5Upus18, 3de79T1rUUEElGIU5Upus9, 3de79T1rUUEElGIU5Upus, 3de79T1rUUEElGIU5Upus2, 3de79T1rUUEElGIU5Upus11, 3de79T1rUUEElGIU5Upus8, 3de79T1rUUEElGIU5Upus3, 3de79T1rUUEElGIU5Upus15, 3de79T1rUUEElGIU5Upus16, 3de79T1rUUEElGIU5Upus10]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |\n|10.1145/contrib-81490680576|14          |17         |3          |52             |[Bao-gen Xie, Bing Xie, Benyin Xie, Biye Xie, Bin-Bin Xie, Bo Xie, Bijun Xie, Beixin Xie, Binping Xie, Bosun Xie, Bai-Song Xie, Bang-Hu Xie, Baode Xie]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |[3de7AedUHMJIPh84nYiXm, 3de7AedUHMJIPh84nYiXm8, 3de7AedUHMJIPh84nYiXm15, 3de7AedUHMJIPh84nYiXm6, 3de7AedUHMJIPh84nYiXm5, 3de7AedUHMJIPh84nYiXm10, 3de7AUgjEdvKF2cDOgAOh, 3de7AedUHMJIPh84nYiXm2, 3de7AedUHMJIPh84nYiXm9, 3de7AedUHMJIPh84nYiXm3, 3de7AedUHMJIPh84nYiXm16, 3de7AedUHMJIPh84nYiXm20, 3de7AedUHMJIPh84nYiXm18, 3de7AedUHMJIPh84nYiXm11]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n|10.1145/contrib-81440613607|14          |8          |6          |70             |[Q.M. Jonathan Wu, Q M J Wu, Qinghua Wu, Q. M. Jonathan Wu, Qingqiang Guo, Qiuwen Wu, Q. M. J. Wu]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |[3de7BCS5US1nTkHLaNQlh, 3de7Ahz7jAdeXdsF8Ch5T, 3de7BImLi2uWNWIeSfhqZ4, 3de7BMGMbMJcWQlKgtEwA, 3de7BIsaXkRX4907mkrTx, 3de7BZp298p3DEdtrS7nD, 3de7AjFOW1QhCMrujfHV93, 3de7BMGMbMJcWQlKgtEwA2, 3de7Bl8nClKhdsQZOf7h4, 3de7BImLi2uWNWIeSfhqZ, 3de7BMGMbMJcWQlKgtEwA3, 3de7BCXMCnhwGkPETVCvT, 3de7BImLi2uWNWIeSfhqZ3, 3de7AjFOW1QhCMrujfHV9]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |\n|10.1145/contrib-81472653313|14          |13         |1          |62             |[Ling Chen, Lihe Chen, Liang-Chieh Chen, Lu Chen, Lei Chen, Lixin Chen, Li Chen, Liming Chen, Lin X. Chen, Liben Chen, Lydia Y. Chen, Lydia Chen, Long Qing Chen]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |[3de7APUMrC246exegqX9B, 3de7APUMrC246exegqX9B7, 3de7APUMrC246exegqX9B5, 3de7AWRE81XMPiaiYBRo42, 3de7APUMrC246exegqX9B6, 3de7AWRE81XMPiaiYBRo4, 3de7APUMrC246exegqX9B4, 3de7APUMrC246exegqX9B2, 3de7APUMrC246exegqX9B11, 3de7APUMrC246exegqX9B10, 3de7APUMrC246exegqX9B8, 3de7AWRE81XMPiaiYBRo43, 3de7APUMrC246exegqX9B3, 3de7APUMrC246exegqX9B9]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n|10.1145/contrib-81452601906|14          |13         |36         |137            |[Weiwei Wang, Weiqun Wang, Weili Wang, W. H. Wang, Weichao Wang, WangWei, Weilin Wang, Wei-Hua Wang, Weize Wang, Wei Wang, W. Wang]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |[3de79m1WBG2wmEzH0zfpw, 3de7AcvouD9fNuSOaf99m, 3de7AJJr7CB6dT5mJaA962, 3de7BYw9UGcZqLC9iKBu9, 3de7A3RgvJL5umy8h0lqO, 3de7C4fUqUPiRJrW0ozqn, 3de7B8RE1HGM2omTFpdNY3, 3de7Atcre005RBQD7mOqa, 3de79rSPSakoEIDUfEg43, 3de7BtGTPC4BNolp3mGmD2, 3de7AhgP4P4beTnheklR2, 3de7C4fUqUPiRJrW0ozqn2, 3de7AkXEijxzI9dRNyQyC, 3de7BhGDHPVQOprzLFhoQ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n+---------------------------+------------+-----------+-----------+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nval thresholds: Array[Double] = Array(Double.MinValue, 1.0) ++ Array(2.0, 3.0) ++ Array(4.0, 10.0) ++ (((20.0 until 50.0 by 10).toArray ).map(_.toDouble))++ (((50.0 until 500.0 by 50).toArray ++ Array(500.0, 1000.0)++ Array(2000.0, 5000.0) ++ Array(Double.MaxValue)).map(_.toDouble))\n\n// Convert DataFrame to RDD and calculate histogram values\nval _tmpHist = pkgPerAcm\n    .select($\"acmAuthorPubCnt\" cast \"double\")\n    .rdd.map(r => r.getDouble(0))\n    .histogram(thresholds)\n\n// Result DataFrame contains `from`, `to` range and the `value`.\nval histogram = sc.parallelize((thresholds, thresholds.tail, _tmpHist).zipped.toList).toDF(\"from\", \"to\", \"value\")\nhistogram.show(30,false)\n\n// Convert DataFrame to RDD and calculate histogram values\nval _tmpHist2 = acmPerPkg\n    .select($\"OAauthorPubCnt\" cast \"double\")\n    .rdd.map(r => r.getDouble(0))\n    .histogram(thresholds)\n\n// Result DataFrame contains `from`, `to` range and the `value`.\nval histogram2 = sc.parallelize((thresholds, thresholds.tail, _tmpHist2).zipped.toList).toDF(\"from\", \"to\", \"value\")\nhistogram2.show(30,false)\n\n// Convert DataFrame to RDD and calculate histogram values\nval _tmpHistS2 = acmPerS2\n    .select($\"OAauthorPubCnt\" cast \"double\")\n    .rdd.map(r => r.getDouble(0))\n    .histogram(thresholds)\n\n// Result DataFrame contains `from`, `to` range and the `value`.\nval histogramS2 = sc.parallelize((thresholds, thresholds.tail, _tmpHistS2).zipped.toList).toDF(\"from\", \"to\", \"value\")\nhistogramS2.show(30,false)\n\n// Convert DataFrame to RDD and calculate histogram values\nval _tmpHistOA = acmPerOA\n    .select($\"OAauthorPubCnt\" cast \"double\")\n    .rdd.map(r => r.getDouble(0))\n    .histogram(thresholds)\n\n// Result DataFrame contains `from`, `to` range and the `value`.\nval histogramOA = sc.parallelize((thresholds, thresholds.tail, _tmpHistOA).zipped.toList).toDF(\"from\", \"to\", \"value\")\nhistogramOA.show(30,false)",
   "id": "",
   "dateCreated": "2023-03-09 17:48:47.112",
   "config": {
    "editorHide": false,
    "tableHide": false,
    "title": true
   },
   "dateStarted": "2023-03-17 17:45:18.899",
   "dateUpdated": "2023-03-17 17:45:50.574",
   "dateFinished": "2023-03-17 17:45:50.573",
   "title": "Analyze Pub Counts ",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mtwo deprecations (since 2.12.6); for details, enable `:setting -deprecation' or `:replay -deprecation'\n+-----------------------+----------------------+-------+\n|from                   |to                    |value  |\n+-----------------------+----------------------+-------+\n|-1.7976931348623157E308|1.0                   |0      |\n|1.0                    |2.0                   |1632452|\n|2.0                    |3.0                   |308894 |\n|3.0                    |4.0                   |127475 |\n|4.0                    |10.0                  |201247 |\n|10.0                   |20.0                  |61492  |\n|20.0                   |30.0                  |19591  |\n|30.0                   |40.0                  |9268   |\n|40.0                   |50.0                  |5287   |\n|50.0                   |100.0                 |8624   |\n|100.0                  |150.0                 |1629   |\n|150.0                  |200.0                 |479    |\n|200.0                  |250.0                 |172    |\n|250.0                  |300.0                 |65     |\n|300.0                  |350.0                 |23     |\n|350.0                  |400.0                 |22     |\n|400.0                  |450.0                 |3      |\n|450.0                  |500.0                 |1      |\n|500.0                  |1000.0                |7      |\n|1000.0                 |2000.0                |0      |\n|2000.0                 |5000.0                |0      |\n|5000.0                 |1.7976931348623157E308|0      |\n+-----------------------+----------------------+-------+\n\n+-----------------------+----------------------+-------+\n|from                   |to                    |value  |\n+-----------------------+----------------------+-------+\n|-1.7976931348623157E308|1.0                   |0      |\n|1.0                    |2.0                   |1083620|\n|2.0                    |3.0                   |263173 |\n|3.0                    |4.0                   |119405 |\n|4.0                    |10.0                  |204213 |\n|10.0                   |20.0                  |65650  |\n|20.0                   |30.0                  |21663  |\n|30.0                   |40.0                  |10560  |\n|40.0                   |50.0                  |6281   |\n|50.0                   |100.0                 |10591  |\n|100.0                  |150.0                 |2272   |\n|150.0                  |200.0                 |772    |\n|200.0                  |250.0                 |329    |\n|250.0                  |300.0                 |147    |\n|300.0                  |350.0                 |81     |\n|350.0                  |400.0                 |62     |\n|400.0                  |450.0                 |32     |\n|450.0                  |500.0                 |22     |\n|500.0                  |1000.0                |89     |\n|1000.0                 |2000.0                |9      |\n|2000.0                 |5000.0                |0      |\n|5000.0                 |1.7976931348623157E308|0      |\n+-----------------------+----------------------+-------+\n\n+-----------------------+----------------------+-------+\n|from                   |to                    |value  |\n+-----------------------+----------------------+-------+\n|-1.7976931348623157E308|1.0                   |0      |\n|1.0                    |2.0                   |1142219|\n|2.0                    |3.0                   |313171 |\n|3.0                    |4.0                   |140793 |\n|4.0                    |10.0                  |228779 |\n|10.0                   |20.0                  |67842  |\n|20.0                   |30.0                  |21240  |\n|30.0                   |40.0                  |10096  |\n|40.0                   |50.0                  |5785   |\n|50.0                   |100.0                 |9468   |\n|100.0                  |150.0                 |1860   |\n|150.0                  |200.0                 |550    |\n|200.0                  |250.0                 |214    |\n|250.0                  |300.0                 |67     |\n|300.0                  |350.0                 |25     |\n|350.0                  |400.0                 |31     |\n|400.0                  |450.0                 |7      |\n|450.0                  |500.0                 |1      |\n|500.0                  |1000.0                |10     |\n|1000.0                 |2000.0                |0      |\n|2000.0                 |5000.0                |0      |\n|5000.0                 |1.7976931348623157E308|0      |\n+-----------------------+----------------------+-------+\n\n+-----------------------+----------------------+-------+\n|from                   |to                    |value  |\n+-----------------------+----------------------+-------+\n|-1.7976931348623157E308|1.0                   |0      |\n|1.0                    |2.0                   |1039432|\n|2.0                    |3.0                   |242218 |\n|3.0                    |4.0                   |113190 |\n|4.0                    |10.0                  |200273 |\n|10.0                   |20.0                  |67067  |\n|20.0                   |30.0                  |22339  |\n|30.0                   |40.0                  |10934  |\n|40.0                   |50.0                  |6453   |\n|50.0                   |100.0                 |10922  |\n|100.0                  |150.0                 |2372   |\n|150.0                  |200.0                 |792    |\n|200.0                  |250.0                 |363    |\n|250.0                  |300.0                 |155    |\n|300.0                  |350.0                 |89     |\n|350.0                  |400.0                 |65     |\n|400.0                  |450.0                 |36     |\n|450.0                  |500.0                 |20     |\n|500.0                  |1000.0                |92     |\n|1000.0                 |2000.0                |16     |\n|2000.0                 |5000.0                |0      |\n|5000.0                 |1.7976931348623157E308|0      |\n+-----------------------+----------------------+-------+\n\n\u001b[1m\u001b[34mthresholds\u001b[0m: \u001b[1m\u001b[32mArray[Double]\u001b[0m = Array(-1.7976931348623157E308, 1.0, 2.0, 3.0, 4.0, 10.0, 20.0, 30.0, 40.0, 50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 1000.0, 2000.0, 5000.0, 1.7976931348623157E308)\n\u001b[1m\u001b[34m_tmpHist\u001b[0m: \u001b[1m\u001b[32mArray[Long]\u001b[0m = Array(0, 1632452, 308894, 127475, 201247, 61492, 19591, 9268, 5287, 8624, 1629, 479, 172, 65, 23, 22, 3, 1, 7, 0, 0, 0)\n\u001b[1m\u001b[34mhistogram\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [from: double, to: double ... 1 more field]\n\u001b[1m\u001b[34m_tmpHist2\u001b[0m: \u001b[1m\u001b[32mArray[Long]\u001b[0m = Array(0, 1083620, 263173, 119405, 204213, 65650, 21663, 10560, 6281, 10591, 2272, 772, 329, 147, 81, 62, 32, 22, 89, 9, 0, 0)\n\u001b[1m\u001b[34mhistogram2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [from: double, to: ...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "size": {
        "height": 391.0
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n//acm2pkg_bestMatch_ext.show(20)\n\nprintln(\"acm2pkg_bestMatch_ext total count: \" + acm2pkg_bestMatch_ext.count())\nprintln(\"acm2pkg_bestMatch_ext = 1 count: \" + acm2pkg_bestMatch_ext.filter($\"ParityProfileCoverage\" === 1).count())\nprintln(\"acm2OA_bestMatch_ext = 1 count: \" + acm2OA_bestMatch_ext.filter($\"ParityProfileCoverage\" === 1).count())\nprintln(\"acm2S2_bestMatch_ext = 1 count: \" + acm2S2_bestMatch_ext.filter($\"ParityProfileCoverage\" === 1).count())\n\nprintln(\"jacc pkg2acm_bestMatch_ext = 1 count: \" + pkg2acm_bestMatch_ext.filter($\"jaccSimilarity\" === 1).count())\nprintln(\"jacc OA2acm_bestMatch_ext = 1 count: \" + OA2acm_bestMatch_ext.filter($\"jaccSimilarity\" === 1).count())\nprintln(\"jacc S22acm_bestMatch_ext = 1 count: \" + S22acm_bestMatch_ext.filter($\"jaccSimilarity\" === 1).count())\n\nprintln(\"claimed acm2pkg_bestMatch_ext total count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).count())\nprintln(\"claimed  acm2pkg_bestMatch_ext = 1 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" === 1).count())\nprintln(\"claimed  acm2OA_bestMatch_ext = 1 count: \" + acm2OA_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" === 1).count())\nprintln(\"claimed  acm2S2_bestMatch_ext = 1 count: \" + acm2S2_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" === 1).count())\n\nprintln(\"claimed jacc pkg2acm_bestMatch_ext = 1 count: \" + pkg2acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" === 1).count())\nprintln(\"claimed jacc OA2acm_bestMatch_ext = 1 count: \" + OA2acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" === 1).count())\nprintln(\"claimed jacc S22acm_bestMatch_ext = 1 count: \" + S22acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" === 1).count())\n\n\n",
   "id": "",
   "dateCreated": "2023-03-06 15:53:41.996",
   "config": {
    "editorHide": false,
    "tableHide": true
   },
   "dateStarted": "2023-03-17 20:01:17.336",
   "dateUpdated": "2023-03-17 20:01:34.055",
   "dateFinished": "2023-03-17 20:01:34.055",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "acm2pkg_bestMatch_ext total count: 2376731\nacm2pkg_bestMatch_ext = 1 count: 2268402\nacm2OA_bestMatch_ext = 1 count: 2224178\nacm2S2_bestMatch_ext = 1 count: 2282498\njacc pkg2acm_bestMatch_ext = 1 count: 1371708\njacc OA2acm_bestMatch_ext = 1 count: 1211601\njacc S22acm_bestMatch_ext = 1 count: 1503234\nclaimed acm2pkg_bestMatch_ext total count: 26409\nclaimed  acm2pkg_bestMatch_ext = 1 count: 21985\nclaimed  acm2OA_bestMatch_ext = 1 count: 19550\nclaimed  acm2S2_bestMatch_ext = 1 count: 21497\nclaimed jacc pkg2acm_bestMatch_ext = 1 count: 15118\nclaimed jacc OA2acm_bestMatch_ext = 1 count: 12700\nclaimed jacc S22acm_bestMatch_ext = 1 count: 15352\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n//acm2pkg_bestMatch_ext.show(20)\n\nprintln(\"acm2pkg_bestMatch_ext total count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).count())\nprintln(\"acm2pkg_bestMatch_ext = 1 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" === 1).count())\nprintln(\"acm2pkg_bestMatch_ext > 0.9 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" >= 0.9 && $\"ParityProfileCoverage\" < 1).count())\nprintln(\"acm2pkg_bestMatch_ext > 0.8 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" >= 0.8 && $\"ParityProfileCoverage\" < 0.9).count())\nprintln(\"acm2pkg_bestMatch_ext > 0.7 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" >= 0.7 && $\"ParityProfileCoverage\" < 0.8).count())\nprintln(\"acm2pkg_bestMatch_ext > 0.6 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" >= 0.6 && $\"ParityProfileCoverage\" < 0.7).count())\nprintln(\"acm2pkg_bestMatch_ext > 0.5 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" >= 0.5 && $\"ParityProfileCoverage\" < 0.6).count())\nprintln(\"acm2pkg_bestMatch_ext <0.5 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"ParityProfileCoverage\" < 0.5).count())\n\nprintln(\"acm2pkg_bestMatch_ext jaccSimilarity = 1 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" === 1).count())\nprintln(\"acm2pkg_bestMatch_ext jaccSimilarity > 0.9 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" >= 0.9 && $\"jaccSimilarity\" < 1).count())\nprintln(\"acm2pkg_bestMatch_ext jaccSimilarity > 0.8 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" >= 0.8 && $\"jaccSimilarity\" < 0.9).count())\nprintln(\"acm2pkg_bestMatch_ext jaccSimilarity > 0.7 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" >= 0.7 && $\"jaccSimilarity\" < 0.8).count())\nprintln(\"acm2pkg_bestMatch_ext jaccSimilarity > 0.6 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" >= 0.6 && $\"jaccSimilarity\" < 0.7).count())\nprintln(\"acm2pkg_bestMatch_ext jaccSimilarity > 0.5 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" >= 0.5 && $\"jaccSimilarity\" < 0.6).count())\nprintln(\"acm2pkg_bestMatch_ext jaccSimilarity < 0.5 count: \" + acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"jaccSimilarity\" < 0.5).count())\n\n\n//acm2pkg_bestMatch_ext.filter($\"similarity2Parity\" < 0.5).show(20)\n\n//println(\"acm2pkg_bestMatch_ext > 0.8 count: \" + acm2pkg_bestMatch_ext.filter($\"similarity2Parity\" > 0.8).count())\n//println(\"acm2pkg_bestMatch_ext > 0.8 count: \" + acm2pkg_bestMatch_ext.filter($\"similarity2Parity\" > 0.8).count())\n\n",
   "id": "",
   "dateCreated": "2023-03-06 15:53:41.996",
   "config": {
    "editorHide": false,
    "tableHide": true
   },
   "dateStarted": "2023-03-17 19:48:10.884",
   "dateUpdated": "2023-03-17 19:48:35.981",
   "dateFinished": "2023-03-17 19:48:35.981",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "acm2pkg_bestMatch_ext total count: 26409\nacm2pkg_bestMatch_ext = 1 count: 21985\nacm2pkg_bestMatch_ext > 0.9 count: 2031\nacm2pkg_bestMatch_ext > 0.8 count: 901\nacm2pkg_bestMatch_ext > 0.7 count: 429\nacm2pkg_bestMatch_ext > 0.6 count: 485\nacm2pkg_bestMatch_ext > 0.5 count: 475\nacm2pkg_bestMatch_ext <0.5 count: 103\nacm2pkg_bestMatch_ext jaccSimilarity = 1 count: 15118\nacm2pkg_bestMatch_ext jaccSimilarity > 0.9 count: 3253\nacm2pkg_bestMatch_ext jaccSimilarity > 0.8 count: 2110\nacm2pkg_bestMatch_ext jaccSimilarity > 0.7 count: 1139\nacm2pkg_bestMatch_ext jaccSimilarity > 0.6 count: 1157\nacm2pkg_bestMatch_ext jaccSimilarity > 0.5 count: 1229\nacm2pkg_bestMatch_ext jaccSimilarity < 0.5 count: 2403\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%spark\n// get online data \nval path_online = \"/media/ometaxas/nvme/datasets/ACM/online_res_acm_content_2nd_test\"\n\nval online_profiles =   spark.read    \n .json(s\"file://$path_online\")\n\n\nonline_profiles.printSchema()\nprintln(\"online_profiles count: \" + online_profiles.count())\n\nval online_profiles_explode = online_profiles.select($\"doi\", explode($\"authors\").as(\"authorship\"))\n//online_profiles_explode.printSchema()\n\nval online_signatures   = online_profiles_explode.select($\"doi\".as(\"ol_doi\"), $\"authorship.institutions.resolvedData.openalexId\".as(\"ol_pkginstitutionId\"), $\"authorship.resolvedData.name\".as(\"ol_authorName\"), $\"authorship.resolvedData.openalexId\".as(\"ol_OAAuthorId\"), $\"authorship.resolvedData.orcidId\")\n//online_signatures.printSchema()\nonline_signatures.show(10)\nprintln(\"online_signatures :\" + online_signatures.count())\n\nval OAPerPKGIds =  OA_S2_acm_signatures_dedup.\n                groupBy($\"OAauthorId_old\")                \n                .agg(\n                countDistinct(\"oaAuthorId\").as(\"OAauthorCnt\")                 \n                ,countDistinct(\"pkgAuthorId\").as(\"pkgauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"oaAuthorId\")).as(\"oaAuthorIds\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"pkgAuthorId\")).as(\"pkgAuthorIds\"))\n                \nprintln(\"OAPerPKGIds :\" + OAPerPKGIds.count())\nprintln(\"OAPerPKGIds OAauthorCnt>1 :\" + OAPerPKGIds.filter($\"OAauthorCnt\">1).count())\nprintln(\"OAPerPKGIds pkgauthorCnt>1 :\" + OAPerPKGIds.filter($\"pkgauthorCnt\">1).count())\nprintln(\"OAPerPKGIds pkgauthorCnt=0 :\" + OAPerPKGIds.filter($\"pkgauthorCnt\"===0).count())\n\nval online_signatures_pkg = online_signatures.join(OAPerPKGIds, OAPerPKGIds(\"OAauthorId_old\")===online_signatures(\"ol_OAAuthorId\"), \"inner\")\n.select($\"ol_doi\", $\"ol_pkginstitutionId\", $\"ol_authorName\", $\"ol_OAAuthorId\", $\"pkgAuthorIds\", $\"pkgauthorCnt\")\n\nonline_signatures_pkg.show(10)\nprintln(\"online_signatures_pkg :\" + online_signatures_pkg.count())\nprintln(\"online_signatures_pkg pkgauthorCnt>1 :\" + online_signatures_pkg.filter($\"pkgauthorCnt\">1).count())\nprintln(\"ol_OAAuthorId  found:\" + online_signatures_pkg.select( $\"ol_OAAuthorId\").distinct().count())\n\n\nval online_signatures_pkg_notfound = online_signatures.join(OAPerPKGIds, OAPerPKGIds(\"OAauthorId_old\")===online_signatures(\"ol_OAAuthorId\") ,\"left_anti\")\n.select($\"ol_doi\", $\"ol_pkginstitutionId\", $\"ol_authorName\", $\"ol_OAAuthorId\")\n\nonline_signatures_pkg_notfound.show(20)\nprintln(\"ol_OAAuthorId Not found:\" + online_signatures_pkg_notfound.select( $\"ol_OAAuthorId\").distinct().count())\n\n\n",
   "id": "",
   "dateCreated": "2023-03-17 11:15:37.295",
   "config": {}
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n\nval OA_S2_acm_signatures_dedup_all =   spark.read    \n.parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\n.filter($\"acm_author_id\".isNotNull)\n//.filter($\"pkgAuthorId\".isNotNull)\n.filter($\"S2authorId\".isNotNull)\n\n//OA_S2_acm_signatures_dedup_all.printSchema()\n\nval pkg_acm_signatures_dedup_all =   spark.read    \n.parquet(s\"file://$path/pkg_acm_signatures_dedup.parquet\")\n.filter($\"acm_author_id\".isNotNull)\n.select($\"acm_doi\".as(\"pkg_acm_doi\"), $\"pkgAuthorId\", $\"acm_author_id\".as(\"pkg_acm_author_id\"), $\"oaAuthorId_old\",  $\"oaAffiliationId\".as(\"pkgAffiliationId\"))\n\nval pkg_OA_S2_acm_signatures_dedup_all = OA_S2_acm_signatures_dedup_all.join(pkg_acm_signatures_dedup_all, $\"pkg_acm_doi\" === $\"acm_doi\" && $\"acm_author_id\" === $\"pkg_acm_author_id\", \"leftouter\")\n//.withColumn(\"pkgAuthorId\", concat($\"S2authorId\", $\"pkgAuthorId\"  ))\n.drop($\"pkg_acm_author_id\")\n.drop($\"pkg_acm_doi\")\n\n//pkg_OA_S2_acm_signatures_dedup_all.printSchema()\n\nprintln(\"pkg_OA_S2_acm_signatures_dedup_all :\" + pkg_OA_S2_acm_signatures_dedup_all.count())\n\nval OA_S2_acm_signatures_dedup = pkg_OA_S2_acm_signatures_dedup_all.filter($\"pkgAuthorId\".isNotNull)\nprintln(\"OA_S2_acm_signatures_dedup :\" + OA_S2_acm_signatures_dedup.count())\n\nprintln(\"OAauthorId_olds:\" + OA_S2_acm_signatures_dedup.select( $\"OAauthorId_old\").distinct().count())\nprintln(\"oaAuthorIds:\" + OA_S2_acm_signatures_dedup.select( $\"oaAuthorId\").distinct().count())\n\n\nprintln(\"non resolved insitutions signatures :\" + OA_S2_acm_signatures_dedup.filter($\"acm_institution_id\".isNull).count())\nprintln(\"non resolved pkgAffiliationId signatures :\" + OA_S2_acm_signatures_dedup.filter($\"pkgAffiliationId\".isNull).count())\n//println(\"non resolved insitutions signatures :\" + pkg_OA_S2_acm_signatures_dedup_all.filter($\"oaAffiliationsId\".isNull).count())\n\n\n\n//analyze 1-1 & 1-many matches & compute parity profile count\nval pkgPerAcm =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\")                \n                .agg(\n                 countDistinct(\"pkgAuthorId\").as(\"pkgauthorCnt\")\n                 ,countDistinct(\"OAauthorId\").as(\"OAauthorCnt\")\n                 ,countDistinct(\"S2authorId\").as(\"S2authorCnt\")\n                ,count(\"OAdoi\").as(\"acmAuthorPubCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"pkgAuthorId\")).as(\"pkgAuthorIds\"))\n                \n println(\"pkgPerAcm count: \" + pkgPerAcm.count())\n println(\"pkgPerAcm count 1-1: \" + pkgPerAcm.filter($\"pkgauthorCnt\"===1).count())\n println(\"OAPerAcm count 1-1: \" + pkgPerAcm.filter($\"OAauthorCnt\"===1).count())\n println(\"S2PerAcm count 1-1: \" + pkgPerAcm.filter($\"S2authorCnt\"===1).count())\n \n println(\"pkgPerAcm claimed profiles count: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).count())\n println(\"pkgPerAcm claimed profiles count 1-1: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"pkgauthorCnt\"===1).count())\n println(\"OAPerAcm claimed profiles count 1-1: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"OAauthorCnt\"===1).count())\n println(\"S2PerAcm claimed profiles count 1-1: \" + pkgPerAcm.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).filter($\"S2authorCnt\"===1).count())\n  \n pkgPerAcm.orderBy($\"pkgauthorCnt\" desc).show(20)\n pkgPerAcm.orderBy($\"S2authorCnt\" desc).show(20)\n \n \nval acmPerPkg =  OA_S2_acm_signatures_dedup.\n  groupBy($\"pkgAuthorId\")                \n                .agg(countDistinct(\"acm_author_id\").as(\"ACMauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"acm_author_id\")).as(\"acm_author_ids\")\n                ,count(\"OAdoi\").as(\"OAauthorPubCnt\")                \n                \n                )\n                \nprintln(\"acmPerPkg count: \" + acmPerPkg.count())\nprintln(\"acmPerPkg count 1-1: \" + acmPerPkg.filter($\"ACMauthorCnt\"===1).count())\nacmPerPkg.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n\n//Find best match & compute similarity\nval acm2pkg =  OA_S2_acm_signatures_dedup.\n  groupBy($\"acm_author_id\", $\"pkgAuthorId\")                \n                .agg(count(\"OAdoi\").as(\"commonPubCnt\"))\n                \nval w = Window.partitionBy($\"acm_author_id\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval acm2pkg_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"acm2pkg_bestMatch count: \" + acm2pkg_bestMatch.count())\n\n//acm2pkg_bestMatch.printSchema()\n//pkgPerAcm.printSchema()\n//acmPerPkg.printSchema()\n//acm2pkg_bestMatch.show(20)\n\nval acm2pkg_bestMatch_ext = acm2pkg_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === acm2pkg_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"pkgAuthorId\") === acm2pkg_bestMatch(\"pkgAuthorId\"), \"inner\")\n.select(acm2pkg_bestMatch(\"acm_author_id\"), acm2pkg_bestMatch(\"pkgAuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")   \n            .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n            .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n            .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \n               \n println(\"acm2pkg_bestMatch_ext count: \" + acm2pkg_bestMatch_ext.count())\n acm2pkg_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n //acm2pkg_bestMatch_ext.show(20)            \n //acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).show(20)\n //acm2pkg_bestMatch_ext.printSchema()                 \n\n//////////////////////////////////\n\n//Find best match & compute similarity\n\nval w1 = Window.partitionBy($\"pkgAuthorId\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval pkg2acm_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w1))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"pkg2acm_bestMatch count: \" + pkg2acm_bestMatch.count())\n//pkg2acm_bestMatch.printSchema()\n//pkg2acm_bestMatch.show(20)\n\n\nval pkg2acm_bestMatch_ext = pkg2acm_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === pkg2acm_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"pkgAuthorId\") === pkg2acm_bestMatch(\"pkgAuthorId\"), \"inner\")\n.select(pkg2acm_bestMatch(\"acm_author_id\"), pkg2acm_bestMatch(\"pkgAuthorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")\n           .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n           .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n           .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \nprintln(\"pkg2acm_bestMatch_ext count: \" + pkg2acm_bestMatch_ext.count())\npkg2acm_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\npkg2acm_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n*/",
   "id": "",
   "dateCreated": "2023-03-03 20:08:02.966",
   "config": {
    "title": true,
    "tableHide": true,
    "editorHide": false
   },
   "title": "Analyze ACM - PKG Online Matching",
   "dateStarted": "2023-03-15 22:55:29.347",
   "dateUpdated": "2023-03-15 22:56:14.917",
   "dateFinished": "2023-03-15 22:56:14.917",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "pkg_OA_S2_acm_signatures_dedup_all :6648673\nOA_S2_acm_signatures_dedup :6517297\nOAauthorId_olds:2550989\noaAuthorIds:1716828\nroot\n |-- authors: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- institutions: array (nullable = true)\n |    |    |    |-- element: struct (containsNull = true)\n |    |    |    |    |-- resolvedData: struct (nullable = true)\n |    |    |    |    |    |-- funderfIds: array (nullable = true)\n |    |    |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |    |    |-- isniIds: array (nullable = true)\n |    |    |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |    |    |-- name: string (nullable = true)\n |    |    |    |    |    |-- openalexId: string (nullable = true)\n |    |    |    |    |    |-- pkgId: string (nullable = true)\n |    |    |    |    |    |-- ringgoldId: string (nullable = true)\n |    |    |    |    |    |-- rorId: string (nullable = true)\n |    |    |    |    |    |-- score: double (nullable = true)\n |    |    |    |    |    |-- wikidataIds: array (nullable = true)\n |    |    |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |    |-- uniqueId: string (nullable = true)\n |    |    |    |    |-- xmlName: string (nullable = true)\n |    |    |-- resolvedData: struct (nullable = true)\n |    |    |    |-- name: string (nullable = true)\n |    |    |    |-- openalexId: string (nullable = true)\n |    |    |    |-- orcidId: string (nullable = true)\n |    |    |    |-- pkgId: string (nullable = true)\n |    |    |    |-- s2Id: string (nullable = true)\n |    |    |    |-- score: double (nullable = true)\n |    |    |-- uniqueId: string (nullable = true)\n |    |    |-- xmlName: string (nullable = true)\n |    |    |-- xmlOrcidId: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- institutions: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- resolvedData: struct (nullable = true)\n |    |    |    |-- funderfIds: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- isniIds: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |    |-- name: string (nullable = true)\n |    |    |    |-- openalexId: string (nullable = true)\n |    |    |    |-- pkgId: string (nullable = true)\n |    |    |    |-- ringgoldId: string (nullable = true)\n |    |    |    |-- rorId: string (nullable = true)\n |    |    |    |-- score: double (nullable = true)\n |    |    |    |-- wikidataIds: array (nullable = true)\n |    |    |    |    |-- element: string (containsNull = true)\n |    |    |-- uniqueId: string (nullable = true)\n |    |    |-- xmlName: string (nullable = true)\n |-- title: string (nullable = true)\n\nonline_profiles count: 1058\n+--------------------+--------------------+-------------+-------------+-------+\n|              ol_doi| ol_pkginstitutionId|ol_authorName|ol_OAAuthorId|orcidId|\n+--------------------+--------------------+-------------+-------------+-------+\n|10.1016/j.mee.202...|[I4210165038, I19...|Tiantian Luan|  A4310087715|   null|\n|10.1016/j.mee.202...|         [I19820366]| Qimeng Jiang|  A4310087716|   null|\n|10.1016/j.mee.202...|[I4210165038, I19...|    Sen Huang|  A4207711584|   null|\n|10.1016/j.mee.202...|[I4210165038, I19...|  Xinhua Wang|  A4209010951|   null|\n|10.1016/j.mee.202...|[I4210165038, I19...|      Hao Jin|  A2505131037|   null|\n|10.1016/j.mee.202...|         [I19820366]|  Fuqiang Guo|  A4310087720|   null|\n|10.1016/j.mee.202...|[I4210165038, I19...|     Yixu Yao|  A4310087721|   null|\n|10.1016/j.mee.202...|         [I19820366]|      Jie Fan|  A4284532492|   null|\n|10.1016/j.mee.202...|         [I19820366]|    Haibo Yin|  A4310087723|   null|\n|10.1016/j.mee.202...|[I4210165038, I19...|       Ke Wei|  A2915033192|   null|\n+--------------------+--------------------+-------------+-------------+-------+\nonly showing top 10 rows\n\nonline_signatures :3606\nOAPerPKGIds :2550989\nOAPerPKGIds OAauthorCnt>1 :73284\nOAPerPKGIds pkgauthorCnt>1 :5258\nOAPerPKGIds pkgauthorCnt=0 :0\n+--------------------+-------------------+-------------------+-------------+--------------------+------------+\n|              ol_doi|ol_pkginstitutionId|      ol_authorName|ol_OAAuthorId|        pkgAuthorIds|pkgauthorCnt|\n+--------------------+-------------------+-------------------+-------------+--------------------+------------+\n|10.1177/016555152...|               null|Paul Hugh Cleverley|  A1985521374|[3de7AXDTwBkA5z8d...|           1|\n|10.1145/3584367.3...|       [I305801656]| Krzysztof Michalak|  A2006858807|[3de7AxQBHkZ9eLr8...|           1|\n|10.1016/j.cmpb.20...|       [I187531555]|  Nebojsa Malesevic|  A2035115909|[3de7BKrbkbWDeEz2...|           1|\n|10.1145/3572549.3...|      [I4210092206]|    Xabier Valencia|  A2059419917|[3de7BO3anVmqTcHy...|           1|\n|10.1007/s10514-02...|       [I859038795]|       Jason Ziglar|  A2091876919|[3de79kx8LhnP6TF3...|           1|\n|     10.1145/3544493|       [I154099455]|       Xuemeng Song|  A2130365661|[3de7BFJ7JWLGUB4v...|           1|\n|10.1145/3572549.3...|      [I2802076133]|  Frank Hopfgartner|  A2169642663|[3de7CIaaOtgnA8Zg...|           1|\n|10.1145/3572848.3...|       [I157725225]|        Serif Yesil|  A2223569657|[3de7BYEHt1LkZA8B...|           1|\n|10.1007/s10796-02...|       [I193662353]|     Armel Lefebvre|  A2294496411|[3de7AA0HlllJPAs6...|           1|\n|10.1145/3572848.3...|        [I16285277]|          Zhen Peng|  A2307282288|[3de7A6oUos6guoRB...|           1|\n+--------------------+-------------------+-------------------+-------------+--------------------+------------+\nonly showing top 10 rows\n\nonline_signatures_pkg :1329\nonline_signatures_pkg pkgauthorCnt>1 :2\nol_OAAuthorId  found:1322\n+--------------------+--------------------+-----------------+-------------+\n|              ol_doi| ol_pkginstitutionId|    ol_authorName|ol_OAAuthorId|\n+--------------------+--------------------+-----------------+-------------+\n|10.1504/ijbis.202...|        [I132359460]|  Tanmoy Dasgupta|  A2144884918|\n|10.1145/3572549.3...|         [I75390827]|       Ying Shang|  A2198345677|\n|10.1016/j.mejo.20...|         [I36399199]|   Jin Dong Zhang|  A2223781297|\n|10.1016/j.sigpro....|[I4210136793, nul...|         Fei Zhou|  A2303227680|\n|10.1504/ijics.202...|        [I290401418]|     Nayana Hegde|  A2306087875|\n|10.1016/j.procs.2...|        [I165831266]|     Ankit Sharma|  A2344790286|\n|10.1016/j.specom....|         [I17145004]|       Huang Ping|  A2384531949|\n|10.1007/s10044-02...|         [I96733725]|          Lai Wei|  A2420141081|\n|10.1016/j.jbi.202...|       [I4210136793]|      Liang Xiang|  A2434474108|\n|10.1007/s00521-02...|        [I143413998]|Yang Liu Yang Liu|  A2435308817|\n|10.1007/s11227-02...|[I161350542, I161...|       Wenlong Fu|  A2499208942|\n|     10.1145/3567419|        [I165143802]|     Han Chan Lee|  A2505053894|\n|10.1016/j.csi.202...|         [I55022517]|    Xiaotong Wang|  A2505731402|\n|10.1016/j.patcog....|         [I36399199]|  Jian Jiang Yang|  A2507173325|\n|10.1016/j.tcs.202...|         [I59028903]|          Bin Liu|  A2579436263|\n|     10.1145/3565798|        [I154099455]|         Xue Dong|  A2581176048|\n|10.1007/s10878-00...|         [I76835614]|   Maggie X Cheng|  A2583609568|\n|10.1016/j.ins.202...|         [I10535382]|        Qian Bian|  A2584709744|\n|10.1287/ijoc.2022...|         [I82497590]|      Alice Smith|  A2612775782|\n|10.1007/s10514-02...|        [I859038795]|  Alfred L. Wicks|  A2624758880|\n+--------------------+--------------------+-----------------+-------------+\nonly showing top 20 rows\n\nol_OAAuthorId Not found:2239\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34mOA_S2_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 18 more fields]\n\u001b[1m\u001b[34mpkg_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pkg_acm_doi: string, pkgAuthorId: string ... 3 more fields]\n\u001b[1m\u001b[34mpkg_OA_S2_acm_signatures_dedup_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 21 more fields]\n\u001b[1m\u001b[34mOA_S2_acm_sign...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\n\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n\n\n\nval online_profiles =   spark.read    \n .json(s\"file://$path/online_res_acm_content_2nd_test\")\n\n//OA_S2_acm_signatures_dedup.printSchema()\n\n//online_profiles.printSchema()\n\nprintln(\"online_profiles count: \" + online_profiles.count())\n\n//online_profiles.select($\"authors.resolveddata.name\", $\"authors.resolveddata.openalexid\", $\"doi\").show(10)\n\nval online_profiles_explode = online_profiles.select($\"doi\", explode($\"authors\").as(\"authorship\"))\n//online_profiles_explode.printSchema()\n\nval online_signatures   = online_profiles_explode.select($\"doi\".as(\"ol_doi\"), $\"authorship.institutions.resolvedData.openalexId\".as(\"ol_institutionId\"), $\"authorship.resolvedData.name\".as(\"ol_authorName\"), $\"authorship.resolvedData.openalexId\".as(\"ol_OAAuthorId\"), $\"authorship.resolvedData.orcidId\".as(\"ol_orcid\"))\n.withColumn(\"ol_normname\", normName($\"ol_authorName\"))\n.withColumn(\"ol_shortnormname\", shortNormName($\"ol_authorName\"))\n\n\n//online_signatures.printSchema()\n//online_signatures.show(10)\nprintln(\"online_signatures total count: \" + online_signatures.count())\n\n\nval OA_S2_acm_signatures_dedup =   spark.read    \n.parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\n.filter($\"acm_author_id\".isNotNull)\n.filter($\"OAauthorId\".isNotNull)\n.filter($\"S2authorId\".isNotNull && $\"S2authorId\"=!=\"null\")\n\n//val OA_S2_acm_signatures_dedup = OA_S2_acm_signatures_dedup_all\n//.filter($\"acm_author_id\".isNotNull)\n//.filter($\"pkgAuthorId\".isNotNull)\n//.filter($\"S2authorId\".isNotNull)\n\n//OA_S2_acm_signatures_dedup.printSchema()\n\nval OA_S2_acm_signatures_ol = OA_S2_acm_signatures_dedup\n                   .join(broadcast(online_signatures), $\"OAdoi\" === lower($\"ol_doi\")  \n                           && (OA_S2_acm_signatures_dedup(\"OAauthorId\")===online_signatures(\"ol_OAAuthorId\") ||OA_S2_acm_signatures_dedup(\"orcid\")===online_signatures(\"ol_orcid\") || $\"OAshortNormName\"=== $\"ol_shortnormname\"   || (  jaro_winkler($\"ol_normname\", $\"OAnormName\") > 0.75 && levenshtein($\"ol_normname\", $\"OAnormName\")<4  )   || (soundex($\"ol_normname\") === soundex($\"OAnormName\"))) \n                       , \"inner\")\n                       .select($\"OAdoi\", $\"OApaperId\", $\"OAauthorId\", $\"orcid\", $\"OAname\",  $\"affiliationsIds\", $\"S2authorId\", $\"acm_author_id\", $\"acm_orcid\",  $\"acm_institution_id\", $\"ol_institutionId\", $\"ol_OAAuthorId\", $\"ol_orcid\", $\"ol_authorName\")\n                       .withColumn(\"affiliationId\", element_at($\"affiliationsIds\", 1))\n                       .withColumn(\"ol_affiliationId\", element_at($\"ol_institutionId\", 1))\n                       .filter($\"acm_author_id\".isNotNull)\n                       .filter($\"OAauthorId\".isNotNull)\n                       .filter($\"S2authorId\".isNotNull  && $\"S2authorId\"=!=\"null\")\n                       .cache() \n                       \nprintln(\"OA_S2_acm_signatures_ol joined to OA_S2_ACM:\" + OA_S2_acm_signatures_ol.count())\n\n//println(\"OA_S2_acm_signatures_ol acm_author_id is null:\" + OA_S2_acm_signatures_ol.filter($\"acm_author_id\".isNull).count())\n//println(\"OA_S2_acm_signatures_ol S2authorId is null:\" + OA_S2_acm_signatures_ol.filter($\"S2authorId\".isNull).count())\nprintln(\"OA_S2_acm_signatures_ol acm_institution_id is null:\" + OA_S2_acm_signatures_ol.filter($\"acm_institution_id\".isNull).count())\nprintln(\"OA_S2_acm_signatures_ol affiliationId is null:\" + OA_S2_acm_signatures_ol.filter($\"affiliationId\".isNull).count())\nprintln(\"OA_S2_acm_signatures_ol ol_affiliationId is null:\" + OA_S2_acm_signatures_ol.filter($\"ol_affiliationId\".isNull).count())\n\nprintln(\"OA_S2_acm_signatures_ol OAauthorId= ol_OAAuthorId:\" + OA_S2_acm_signatures_ol.filter($\"OAauthorId\"===$\"ol_OAAuthorId\").count())\nprintln(\"OA_S2_acm_signatures_ol affiliationId = ol_affiliationId:\" + OA_S2_acm_signatures_ol.filter($\"affiliationId\"===$\"ol_affiliationId\").count())\n\n                                       \nval acm_author_ids = OA_S2_acm_signatures_ol.select( $\"acm_author_id\".as(\"ol_acm_author_id\")).distinct();\nval OAauthorIds = OA_S2_acm_signatures_ol.select( $\"OAauthorId\".as(\"ol_OAauthorId\")).distinct();\nval S2authorIds = OA_S2_acm_signatures_ol.select( $\"S2authorId\".as(\"ol_S2authorId\")).distinct();\n \nprintln(\"OAdois:\" + OA_S2_acm_signatures_ol.select( $\"OAdoi\").distinct().count())\nprintln(\"acm_author_ids:\" + acm_author_ids.count())\nprintln(\"OAauthorIds:\" + OAauthorIds.count())\nprintln(\"S2authorIds:\" + S2authorIds.count())\n\nprintln(\"ol_OAAuthorId:\" + OA_S2_acm_signatures_ol.select( $\"ol_OAAuthorId\").distinct().count())\nprintln(\"acm_orcid:\" + OA_S2_acm_signatures_ol.select( $\"acm_orcid\").distinct().count())\nprintln(\"orcid:\" + OA_S2_acm_signatures_ol.select( $\"orcid\").distinct().count())\n\n\nval OA_S2_acm_signatures_dedup_ol_acm =  OA_S2_acm_signatures_dedup.join(broadcast(acm_author_ids),$\"ol_acm_author_id\" === $\"acm_author_id\", \"inner\" )\n.drop(\"ol_acm_author_id\")\nprintln(\"OA_S2_acm_signatures_dedup_ol_acm:\" + OA_S2_acm_signatures_dedup_ol_acm.count())\n\n\nval OA_S2_acm_signatures_dedup_ol_s2 =  OA_S2_acm_signatures_dedup.join(broadcast(S2authorIds),$\"ol_S2authorId\" === $\"S2authorId\", \"inner\" )\n.drop(\"ol_S2authorId\")\nprintln(\"OA_S2_acm_signatures_dedup_ol_s2:\" + OA_S2_acm_signatures_dedup_ol_s2.count())\n\n\nval OA_S2_acm_signatures_dedup_ol_oa =  OA_S2_acm_signatures_dedup.join(broadcast(OAauthorIds),$\"ol_OAauthorId\" === $\"OAauthorId\", \"inner\" )\n.drop(\"ol_OAauthorId\")\nprintln(\"OA_S2_acm_signatures_dedup_ol_oa:\" + OA_S2_acm_signatures_dedup_ol_oa.count())\n\n\n//val OA_S2_acm_signatures_dedup_ol = OA_S2_acm_signatures_dedup_ol_acm.union(OA_S2_acm_signatures_dedup_ol_s2).distinct()\n//println(\"OA_S2_acm_signatures_dedup_ol:\" + OA_S2_acm_signatures_dedup_ol.count())\n\nval OA_S2_acm_signatures_dedup_ol = OA_S2_acm_signatures_dedup_ol_acm.union(OA_S2_acm_signatures_dedup_ol_s2).distinct()\nprintln(\"OA_S2_acm_signatures_dedup_ol:\" + OA_S2_acm_signatures_dedup_ol.count())\n\n\nprintln(\"acm_author_ids:\" + OA_S2_acm_signatures_dedup_ol.select( $\"acm_author_id\").distinct().count())\n//println(\"PKGauthorIds:\" + OA_S2_acm_signatures_dedup.select( $\"pkgAuthorId\").distinct().count())\nprintln(\"OAauthorIds:\" + OA_S2_acm_signatures_dedup_ol.select( $\"OAauthorId\").distinct().count())\n//println(\"ol_OAAuthorId:\" + OA_S2_acm_signatures_dedup_ol.select( $\"ol_OAAuthorId\").distinct().count())\nprintln(\"S2authorIds:\" + OA_S2_acm_signatures_dedup_ol.select( $\"S2authorId\").distinct().count())\nprintln(\"acm_orcid:\" + OA_S2_acm_signatures_dedup_ol.select( $\"acm_orcid\").distinct().count())\nprintln(\"orcid:\" + OA_S2_acm_signatures_dedup_ol.select( $\"orcid\").distinct().count())\n\n\n//analyze 1-1 & 1-many matches & compute parity profile count\nval pkgPerAcm =  OA_S2_acm_signatures_dedup_ol.\n  groupBy($\"acm_author_id\")                \n                .agg(                 \n                 countDistinct(\"OAauthorId\").as(\"OAauthorCnt\")\n                 ,countDistinct(\"S2authorId\").as(\"S2authorCnt\")\n                 //,countDistinct(\"ol_OAAuthorId\").as(\"ol_OAAuthorIdCnt\")                 \n                ,count(\"OAdoi\").as(\"acmAuthorPubCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                )\n                \n println(\"pkgPerAcm count: \" + pkgPerAcm.count())\n println(\"pkgPerAcm acmAuthorPubCnt=1 count: \" + pkgPerAcm.filter($\"acmAuthorPubCnt\"===1).count())\n println(\"pkgPerAcm acmAuthorPubCnt=1 in ol records count: \" + pkgPerAcm.join(broadcast(acm_author_ids), $\"acm_author_id\"===$\"ol_acm_author_id\", \"inner\").filter($\"acmAuthorPubCnt\"===1).count())\n \n println(\"OAPerAcm count 1-1: \" + pkgPerAcm.filter($\"OAauthorCnt\"===1).count())\n println(\"S2PerAcm count 1-1: \" + pkgPerAcm.filter($\"S2authorCnt\"===1).count())\n //println(\"ol_OAAuthorIdCnt count 1-1: \" + pkgPerAcm.filter($\"ol_OAAuthorIdCnt\"===1).count())\n \nval acmPerPkg =  OA_S2_acm_signatures_dedup_ol.\n  groupBy($\"S2authorId\")                \n                .agg(countDistinct(\"acm_author_id\").as(\"ACMauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup_ol(\"OAname\")).as(\"oaAuthorName\")\n                , collect_set(OA_S2_acm_signatures_dedup_ol(\"acm_author_id\")).as(\"acm_author_ids\")\n                ,count(\"OAdoi\").as(\"OAauthorPubCnt\")                \n                \n                )\n                \nprintln(\"acmPerPkg count: \" + acmPerPkg.count())\nprintln(\"acmPerPkg OAauthorPubCnt=1 count: \" + acmPerPkg.filter($\"OAauthorPubCnt\"===1).count())\nprintln(\"acmPerPkg OAauthorPubCnt=1 in ol records count: \" + acmPerPkg.join(broadcast(S2authorIds), $\"S2authorId\"===$\"ol_S2authorId\", \"inner\").filter($\"OAauthorPubCnt\"===1).count())\n\nprintln(\"acmPerPkg count 1-1: \" + acmPerPkg.filter($\"ACMauthorCnt\"===1).count())\nacmPerPkg.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n\n//Find best match & compute similarity\nval acm2pkg =  OA_S2_acm_signatures_dedup_ol.\n  groupBy($\"acm_author_id\", $\"S2authorId\")                \n                .agg(count(\"OAdoi\").as(\"commonPubCnt\"))\n                \nval w = Window.partitionBy($\"acm_author_id\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval acm2pkg_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"acm2pkg_bestMatch count: \" + acm2pkg_bestMatch.count())\n\n//acm2pkg_bestMatch.printSchema()\n//pkgPerAcm.printSchema()\n//acmPerPkg.printSchema()\n//acm2pkg_bestMatch.show(20)\n\nval acm2pkg_bestMatch_ext = acm2pkg_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === acm2pkg_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"S2authorId\") === acm2pkg_bestMatch(\"S2authorId\"), \"inner\")\n.select(acm2pkg_bestMatch(\"acm_author_id\"), acm2pkg_bestMatch(\"S2authorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")   \n            .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n            .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n            .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \n               \n println(\"acm2pkg_bestMatch_ext count: \" + acm2pkg_bestMatch_ext.count())\n acm2pkg_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n //acm2pkg_bestMatch_ext.show(20)            \n //acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).show(20)\n //acm2pkg_bestMatch_ext.printSchema()                 \n\n//////////////////////////////////\n\n//Find best match & compute similarity\n\nval w1 = Window.partitionBy($\"S2authorId\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval pkg2acm_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w1))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"pkg2acm_bestMatch count: \" + pkg2acm_bestMatch.count())\n//pkg2acm_bestMatch.printSchema()\n//pkg2acm_bestMatch.show(20)\n\n\nval pkg2acm_bestMatch_ext = pkg2acm_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === pkg2acm_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"S2authorId\") === pkg2acm_bestMatch(\"S2authorId\"), \"inner\")\n.select(pkg2acm_bestMatch(\"acm_author_id\"), pkg2acm_bestMatch(\"S2authorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")\n           .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n           .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n           .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \nprintln(\"pkg2acm_bestMatch_ext count: \" + pkg2acm_bestMatch_ext.count())\npkg2acm_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n\n\n\n/* S2 based matching\n\nonline_signatures count: 3606\nOA_S2_acm_signatures_ol:2380\nOA_S2_acm_signatures_ol:730\nOA_S2_acm_signatures_ol:609\nOAdois:737\nacm_author_ids:2296\nOAauthorIds:2301\nS2authorIds:2290\nacm_orcid:364\norcid:754\nOA_S2_acm_signatures_dedup_ol_acm:28036\nOA_S2_acm_signatures_dedup_ol_s2:28955\nOA_S2_acm_signatures_dedup_ol:35578\nacm_author_ids:5759\nOAauthorIds:4616\nS2authorIds:3020\nacm_orcid:1094\norcid:1545\n\npkgPerAcm count: 5759\nOAPerAcm count 1-1: 4668\nS2PerAcm count 1-1: 5366\nacmPerPkg count: 3020\nacmPerPkg count 1-1: 2194\n\n \nacm2pkg_bestMatch count: 5759\nacm2pkg_bestMatch_ext count: 5748\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|         0.979168964193414|    0.39918062572108265| 0.3806021805497027|\n+--------------------------+-----------------------+-------------------+\n\npkg2acm_bestMatch count: 3020\npkg2acm_bestMatch_ext count: 3008\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.7575354165292568|     0.9040444610137337| 0.6679883462392842|\n+--------------------------+-----------------------+-------------------+\n\n*/\n",
   "id": "",
   "dateCreated": "2023-03-06 22:29:24.578",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2023-03-19 19:33:06.795",
   "dateUpdated": "2023-03-19 19:35:28.680",
   "dateFinished": "2023-03-19 19:35:28.680",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mthree feature warnings; for details, enable `:setting -feature' or `:replay -feature'\nonline_profiles count: 1058\nonline_signatures total count: 3606\nOA_S2_acm_signatures_ol joined to OA_S2_ACM:2380\nOA_S2_acm_signatures_ol acm_institution_id is null:187\nOA_S2_acm_signatures_ol affiliationId is null:1612\nOA_S2_acm_signatures_ol ol_affiliationId is null:253\nOA_S2_acm_signatures_ol OAauthorId= ol_OAAuthorId:730\nOA_S2_acm_signatures_ol affiliationId = ol_affiliationId:609\nOAdois:737\nacm_author_ids:2296\nOAauthorIds:2301\nS2authorIds:2290\nol_OAAuthorId:2303\nacm_orcid:364\norcid:754\nOA_S2_acm_signatures_dedup_ol_acm:27356\nOA_S2_acm_signatures_dedup_ol_s2:28651\nOA_S2_acm_signatures_dedup_ol_oa:40510\nOA_S2_acm_signatures_dedup_ol:34594\nacm_author_ids:5758\nOAauthorIds:4521\nS2authorIds:3019\nacm_orcid:1064\norcid:1529\npkgPerAcm count: 5758\npkgPerAcm acmAuthorPubCnt=1 count: 3868\npkgPerAcm acmAuthorPubCnt=1 in ol records count: 1019\nOAPerAcm count 1-1: 4687\nS2PerAcm count 1-1: 5366\nacmPerPkg count: 3019\nacmPerPkg OAauthorPubCnt=1 count: 1132\nacmPerPkg OAauthorPubCnt=1 in ol records count: 768\nacmPerPkg count 1-1: 2194\n+----------+------------+--------------------+--------------------+--------------+\n|S2authorId|ACMauthorCnt|        oaAuthorName|      acm_author_ids|OAauthorPubCnt|\n+----------+------------+--------------------+--------------------+--------------+\n|  46276037|         274|[Jing Li, Jun Li,...|[10.1145/contrib-...|           365|\n|  47740650|         235|[J. Bradley Chen,...|[10.1145/contrib-...|           311|\n|  48379623|         228|[Yu Zhang, Y. Zha...|[10.1145/contrib-...|           291|\n|   1688428|         177|[J. yang, Ji-yue ...|[10.1145/contrib-...|           271|\n| 144142354|         124|[Rui Zhang, Ruiha...|[10.1145/contrib-...|           188|\n|   1682058|         107|[Haopu Zhang, Hao...|[10.1145/contrib-...|           126|\n|   1690341|          58|[Larence T. Yang,...|[10.1145/contrib-...|           411|\n|  40457423|          55|[Boyang Li, Yang ...|[10.1145/contrib-...|            77|\n|  47067803|          53|         [Hao Jiang]|[10.1145/contrib-...|            96|\n| 101829183|          39|[Wei ZHOU, Wei-ca...|[10.1145/contrib-...|            53|\n|  50212920|          36|         [Fan Zhang]|[10.1145/contrib-...|            58|\n|  40478976|          30|[Jungcheng Liu, J...|[10.1145/contrib-...|            32|\n|  47909531|          30|           [Yan Liu]|[10.1145/contrib-...|            45|\n| 145837053|          29|[Mohsen Guizani, ...|[10.1145/contrib-...|           291|\n| 144335971|          28|[Xiaojiang Du, Xi...|[10.1145/contrib-...|           157|\n|  46399556|          27|[Yanggege Liu, Bi...|[10.1145/contrib-...|            32|\n|  34767970|          23|[Jinde Cao, Junwe...|[10.1145/contrib-...|           373|\n|  46509200|          22|[Jing-zhuan Zhao,...|[10.1145/contrib-...|            25|\n| 144018867|          18|[Tao Liu, Qian Li...|[10.1145/contrib-...|            26|\n|   1747316|          18|[H. Fujita, Hiroy...|[10.1145/contrib-...|           177|\n+----------+------------+--------------------+--------------------+--------------+\nonly showing top 20 rows\n\nacm2pkg_bestMatch count: 5758\nacm2pkg_bestMatch_ext count: 5758\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.9826669704970042|     0.4029410023423049|0.38729465820867215|\n+--------------------------+-----------------------+-------------------+\n\npkg2acm_bestMatch count: 3019\npkg2acm_bestMatch_ext count: 3019\n+--------------------------+-----------------------+-------------------+\n|avg(ParityProfileCoverage)|avg(PKGProfileCoverage)|avg(jaccSimilarity)|\n+--------------------------+-----------------------+-------------------+\n|        0.7659251306762528|      0.907631376782605| 0.6791357396045128|\n+--------------------------+-----------------------+-------------------+\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34monline_profiles\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<institutions:array<struct<resolvedData:struct<funderfIds:array<string>,isniIds:array<string>,name:string,openalexId:string,pkgId:string,ringgoldId:string,rorId:string,score:double,wikidataIds:array<string>>,uniqueId:string,xmlName:string>>,resolvedData:struct<name:string,openalexId:string,orcidId:string,pkgId:string,s2Id:string,score:double>,uniqueId:string,xmlName:string,xmlOrcidId:string...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\n\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n\n\n\nval online_profiles =   spark.read    \n .json(s\"file://$path/online_res_acm_content_2nd_test\")\n\n//OA_S2_acm_signatures_dedup.printSchema()\n\n//online_profiles.printSchema()\n\nprintln(\"online_profiles count: \" + online_profiles.count())\n\n//online_profiles.select($\"authors.resolveddata.name\", $\"authors.resolveddata.openalexid\", $\"doi\").show(10)\n\nval online_profiles_explode = online_profiles.select($\"doi\", explode($\"authors\").as(\"authorship\"))\n//online_profiles_explode.printSchema()\n\nval online_signatures   = online_profiles_explode.select($\"doi\".as(\"ol_doi\"), $\"authorship.institutions.resolvedData.openalexId\".as(\"ol_institutionId\"), $\"authorship.resolvedData.name\".as(\"ol_authorName\"), $\"authorship.resolvedData.openalexId\".as(\"ol_OAAuthorId\"), $\"authorship.resolvedData.orcidId\".as(\"ol_orcid\"))\n.withColumn(\"ol_normname\", normName($\"ol_authorName\"))\n.withColumn(\"ol_shortnormname\", shortNormName($\"ol_authorName\"))\n\n\n//online_signatures.printSchema()\n//online_signatures.show(10)\nprintln(\"online_signatures total count: \" + online_signatures.count())\n\n\nval OA_S2_acm_signatures =   spark.read    \n.parquet(s\"file://$path/OA_S2_acm_signatures_dedup.parquet\")\n.withColumn(\"affiliationId\", element_at($\"affiliationsIds\", 1))                       \n                  .withColumn(\"acm_author_id_int\",  regexp_replace($\"acm_author_id\", \"10.1145/contrib-\", \"\"))\n.filter($\"acm_author_id\".isNotNull)\n.filter($\"OAauthorId\".isNotNull)\n.filter($\"S2authorId\".isNotNull && $\"S2authorId\"=!=\"null\")\n\nval w = Window.partitionBy($\"OAdoi\", $\"OAauthorId\").orderBy( lit(1) - ($\"orcid\" === $\"acm_orcid\").cast(\"integer\"), levenshtein($\"OAnormName\", $\"acm_normname\") , lit(1) - (soundex($\"acm_normname\") === soundex($\"OAnormName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"acm_normname\", $\"OAnormName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA_S2_acm_signatures_dedup = OA_S2_acm_signatures.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\n//.cache()\n\n//val OA_S2_acm_signatures_dedup = OA_S2_acm_signatures_dedup_all\n//.filter($\"acm_author_id\".isNotNull)\n//.filter($\"pkgAuthorId\".isNotNull)\n//.filter($\"S2authorId\".isNotNull)\n\n//OA_S2_acm_signatures_dedup.printSchema()\n\nval OA_S2_acm_signatures_ol_nondedup = OA_S2_acm_signatures_dedup\n                   .join(broadcast(online_signatures), $\"OAdoi\" === lower($\"ol_doi\")  \n                           && (OA_S2_acm_signatures_dedup(\"OAauthorId\")===online_signatures(\"ol_OAAuthorId\") ||OA_S2_acm_signatures_dedup(\"orcid\")===online_signatures(\"ol_orcid\") || $\"OAshortNormName\"=== $\"ol_shortnormname\"  \n                            //|| (  jaro_winkler($\"ol_normname\", $\"OAnormName\") > 0.75 && levenshtein($\"ol_normname\", $\"OAnormName\")<4  )   || (soundex($\"ol_normname\") === soundex($\"OAnormName\"))\n                            ) \n                       , \"inner\")\n                       .select($\"OAdoi\", $\"OApaperId\",  $\"OAnormName\", $\"ol_normname\", $\"OAauthorId\", $\"orcid\", $\"OAname\",  $\"affiliationsIds\", $\"S2authorId\", $\"acm_author_id\", $\"acm_orcid\",  $\"acm_institution_id\", $\"ol_institutionId\", $\"ol_OAAuthorId\", $\"ol_orcid\", $\"ol_authorName\")\n                       .withColumn(\"affiliationId\", element_at($\"affiliationsIds\", 1))\n                       .withColumn(\"ol_affiliationId\", element_at($\"ol_institutionId\", 1))\n                       .withColumn(\"acm_author_id_int\",  regexp_replace($\"acm_author_id\", \"10.1145/contrib-\", \"\"))\n                       .filter($\"acm_author_id\".isNotNull)\n                       .filter($\"OAauthorId\".isNotNull)\n                       .filter($\"S2authorId\".isNotNull  && $\"S2authorId\"=!=\"null\")\n                       .cache() \n\nval wol = Window.partitionBy($\"OAdoi\", $\"OAauthorId\").orderBy( lit(1) - ($\"orcid\" === $\"ol_orcid\").cast(\"integer\"), levenshtein($\"OAnormName\", $\"ol_normname\") , lit(1) - (soundex($\"ol_normname\") === soundex($\"OAnormName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"ol_normname\", $\"OAnormName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA_S2_acm_signatures_ol = OA_S2_acm_signatures_ol_nondedup.withColumn(\"rn\", row_number.over(wol)).where($\"rn\" === 1).drop(\"rn\").cache()\n\nOA_S2_acm_signatures_ol.printSchema()\nOA_S2_acm_signatures_ol.show(20)\n\n                       \nprintln(\"OA_S2_acm_signatures_ol joined to OA_S2_ACM:\" + OA_S2_acm_signatures_ol.count())\nprintln(\"OA_S2_acm_signatures_ol acm_institution_id is null:\" + OA_S2_acm_signatures_ol.filter($\"acm_institution_id\".isNull).count())\nprintln(\"OA_S2_acm_signatures_ol affiliationId is null:\" + OA_S2_acm_signatures_ol.filter($\"affiliationId\".isNull).count())\nprintln(\"OA_S2_acm_signatures_ol ol_affiliationId is null:\" + OA_S2_acm_signatures_ol.filter($\"ol_affiliationId\".isNull).count())\n\nprintln(\"OA_S2_acm_signatures_ol OAauthorId= ol_OAAuthorId:\" + OA_S2_acm_signatures_ol.filter($\"OAauthorId\"===$\"ol_OAAuthorId\").count())\nprintln(\"OA_S2_acm_signatures_ol affiliationId = ol_affiliationId:\" + OA_S2_acm_signatures_ol.filter($\"affiliationId\"===$\"ol_affiliationId\").count())\n\n                                       \nval acm_author_ids = OA_S2_acm_signatures_ol.select( $\"acm_author_id\".as(\"ol_acm_author_id\")).distinct();\nval OAauthorIds = OA_S2_acm_signatures_ol.select( $\"OAauthorId\".as(\"ol_OAauthorId\")).distinct();\nval S2authorIds = OA_S2_acm_signatures_ol.select( $\"S2authorId\".as(\"ol_S2authorId\")).distinct();\n \nprintln(\"OAdois:\" + OA_S2_acm_signatures_ol.select( $\"OAdoi\").distinct().count())\nprintln(\"acm_author_ids:\" + acm_author_ids.count())\nprintln(\"OAauthorIds:\" + OAauthorIds.count())\nprintln(\"S2authorIds:\" + S2authorIds.count())\n\nprintln(\"ol_OAAuthorId:\" + OA_S2_acm_signatures_ol.select( $\"ol_OAAuthorId\").distinct().count())\nprintln(\"acm_orcid:\" + OA_S2_acm_signatures_ol.select( $\"acm_orcid\").distinct().count())\nprintln(\"orcid:\" + OA_S2_acm_signatures_ol.select( $\"orcid\").distinct().count())\n\n\nval OA_S2_acm_signatures_dedup_ol_acm =  OA_S2_acm_signatures_dedup.join(broadcast(acm_author_ids),$\"ol_acm_author_id\" === $\"acm_author_id\", \"inner\" )\n.drop(\"ol_acm_author_id\")\nprintln(\"OA_S2_acm_signatures_dedup_ol_acm:\" + OA_S2_acm_signatures_dedup_ol_acm.count())\n\n\nval OA_S2_acm_signatures_dedup_ol_s2 =  OA_S2_acm_signatures_dedup.join(broadcast(S2authorIds),$\"ol_S2authorId\" === $\"S2authorId\", \"inner\" )\n.drop(\"ol_S2authorId\")\nprintln(\"OA_S2_acm_signatures_dedup_ol_s2:\" + OA_S2_acm_signatures_dedup_ol_s2.count())\n\n\nval OA_S2_acm_signatures_dedup_ol_oa =  OA_S2_acm_signatures_dedup.join(broadcast(OAauthorIds),$\"ol_OAauthorId\" === $\"OAauthorId\", \"inner\" )\n.drop(\"ol_OAauthorId\")\nprintln(\"OA_S2_acm_signatures_dedup_ol_oa:\" + OA_S2_acm_signatures_dedup_ol_oa.count())\n\n\n//val OA_S2_acm_signatures_dedup_ol = OA_S2_acm_signatures_dedup_ol_acm.union(OA_S2_acm_signatures_dedup_ol_s2).distinct()\n//println(\"OA_S2_acm_signatures_dedup_ol:\" + OA_S2_acm_signatures_dedup_ol.count())\n\nval OA_S2_acm_signatures_dedup_ol = OA_S2_acm_signatures_dedup_ol_acm.union(OA_S2_acm_signatures_dedup_ol_s2).distinct()\nprintln(\"OA_S2_acm_signatures_dedup_ol:\" + OA_S2_acm_signatures_dedup_ol.count())\n\n\nprintln(\"acm_author_ids:\" + OA_S2_acm_signatures_dedup_ol.select( $\"acm_author_id\").distinct().count())\n//println(\"PKGauthorIds:\" + OA_S2_acm_signatures_dedup.select( $\"pkgAuthorId\").distinct().count())\nprintln(\"OAauthorIds:\" + OA_S2_acm_signatures_dedup_ol.select( $\"OAauthorId\").distinct().count())\n//println(\"ol_OAAuthorId:\" + OA_S2_acm_signatures_dedup_ol.select( $\"ol_OAAuthorId\").distinct().count())\nprintln(\"S2authorIds:\" + OA_S2_acm_signatures_dedup_ol.select( $\"S2authorId\").distinct().count())\nprintln(\"acm_orcid:\" + OA_S2_acm_signatures_dedup_ol.select( $\"acm_orcid\").distinct().count())\nprintln(\"orcid:\" + OA_S2_acm_signatures_dedup_ol.select( $\"orcid\").distinct().count())\n\n\n//analyze 1-1 & 1-many matches & compute parity profile count\nval pkgPerAcm =  OA_S2_acm_signatures_dedup_ol.\n  groupBy($\"acm_author_id\")                \n                .agg(                 \n                 countDistinct(\"OAauthorId\").as(\"OAauthorCnt\")\n                 ,countDistinct(\"S2authorId\").as(\"S2authorCnt\")\n                 //,countDistinct(\"ol_OAAuthorId\").as(\"ol_OAAuthorIdCnt\")                 \n                ,count(\"OAdoi\").as(\"acmAuthorPubCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup(\"OAname\")).as(\"oaAuthorName\")\n                )\n                \n println(\"pkgPerAcm count: \" + pkgPerAcm.count())\n println(\"pkgPerAcm acmAuthorPubCnt=1 count: \" + pkgPerAcm.filter($\"acmAuthorPubCnt\"===1).count())\n println(\"pkgPerAcm acmAuthorPubCnt=1 in ol records count: \" + pkgPerAcm.join(broadcast(acm_author_ids), $\"acm_author_id\"===$\"ol_acm_author_id\", \"inner\").filter($\"acmAuthorPubCnt\"===1).count())\n \n println(\"OAPerAcm count 1-1: \" + pkgPerAcm.filter($\"OAauthorCnt\"===1).count())\n println(\"S2PerAcm count 1-1: \" + pkgPerAcm.filter($\"S2authorCnt\"===1).count())\n //println(\"ol_OAAuthorIdCnt count 1-1: \" + pkgPerAcm.filter($\"ol_OAAuthorIdCnt\"===1).count())\n \nval acmPerPkg =  OA_S2_acm_signatures_dedup_ol.\n  groupBy($\"S2authorId\")                \n                .agg(countDistinct(\"acm_author_id\").as(\"ACMauthorCnt\")\n                , collect_set(OA_S2_acm_signatures_dedup_ol(\"acm_author_id_int\")).as(\"acm_author_ids\")\n                , collect_set(OA_S2_acm_signatures_dedup_ol(\"OAname\")).as(\"altAuthorNames\")                                \n                ,countDistinct(\"OAname\").as(\"altNamesCnt\")                \n                , collect_set(OA_S2_acm_signatures_dedup_ol(\"OAauthorId\")).as(\"OAauthorIds\")\n                ,countDistinct(\"OAauthorId\").as(\"OAauthorCnt\")\n                ,count(\"OAdoi\").as(\"authorPubCnt\")                                \n                , collect_set(OA_S2_acm_signatures_dedup_ol(\"affiliationId\")).as(\"altAffiliationIds\")\n                ,countDistinct(\"affiliationId\").as(\"affiliationIdCnt\")\n                \n                \n                )\n                \nprintln(\"acmPerPkg count: \" + acmPerPkg.count())\nprintln(\"acmPerPkg authorPubCnt=1 count: \" + acmPerPkg.filter($\"authorPubCnt\"===1).count())\nprintln(\"acmPerPkg authorPubCnt=1 in ol records count: \" + acmPerPkg.join(broadcast(S2authorIds), $\"S2authorId\"===$\"ol_S2authorId\", \"inner\").filter($\"authorPubCnt\"===1).count())\n\nprintln(\"acmPerPkg count 1-1: \" + acmPerPkg.filter($\"ACMauthorCnt\"===1).count())\nacmPerPkg.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n////////////////////\n \n //get all signatures related to non-resolved Authors\nval non_resolved_AcmAuthors = pkgPerAcm.filter($\"acmAuthorPubCnt\"===1).join(broadcast(acm_author_ids),$\"ol_acm_author_id\" === $\"acm_author_id\", \"inner\" )\n.select($\"acm_author_id\".as(\"nonResolved_acmAuthorId\"))\n//.drop(\"ol_acm_author_id\")\n\nval non_resolved_AcmAuthors_signatures = OA_S2_acm_signatures_dedup_ol.join(non_resolved_AcmAuthors, non_resolved_AcmAuthors(\"nonResolved_acmAuthorId\") === OA_S2_acm_signatures_dedup_ol(\"acm_author_id\"), \"inner\").cache()\nnon_resolved_AcmAuthors_signatures.printSchema() \n\nprintln(\"non_resolved_AcmAuthors count: \" + non_resolved_AcmAuthors.count())\nprintln(\"non_resolved_AcmAuthors_signatures authorPubCnt=1 count: \" + non_resolved_AcmAuthors_signatures.count())\n\n\nval related_S2authorIds = non_resolved_AcmAuthors_signatures.select($\"S2authorId\".as(\"corresponding_S2authorId\")).distinct()\nprintln(\"related_S2authorIds:\" + related_S2authorIds.count())\n\n//OA_S2_acm_signatures_ol.select( $\"OAdoi\").distinct()\n\nval acmPerPkg_related_S2authorIds = acmPerPkg.join(broadcast(related_S2authorIds), related_S2authorIds(\"corresponding_S2authorId\")===acmPerPkg(\"S2authorId\"), \"inner\")\n.drop(acmPerPkg(\"S2authorId\"))\n//.drop(related_S2authorIds(\"S2authorId\"))\n\nval related_existing_S2authorIds = acmPerPkg_related_S2authorIds.filter($\"authorPubCnt\">1).cache()\n//.filter($\"S2authorId\"===\"100469616\")\n\nrelated_existing_S2authorIds.printSchema()\nOA_S2_acm_signatures_dedup_ol.printSchema()\n\nrelated_existing_S2authorIds.show(20, false)\n//related_existing_S2authorIds.orderBy($\"ACMauthorCnt\" desc).show(20, true)\n//related_existing_S2authorIds.orderBy(size($\"oaAuthorName\") desc).show(20, true)\n\nval related_S2_signatures = OA_S2_acm_signatures_dedup_ol.join(broadcast(related_existing_S2authorIds), OA_S2_acm_signatures_dedup_ol(\"S2authorId\")===related_existing_S2authorIds(\"corresponding_S2authorId\"),\"inner\").cache()\n\nrelated_S2_signatures.show(20)\nrelated_S2_signatures.printSchema()\n\n//println(\"related_S2authorIds with only 1 pub:\" + acmPerPkg_related_S2authorIds.filter($\"OAauthorPubCnt\"===1).count())\n//val related_existing_S2authorIds = acmPerPkg_related_S2authorIds.filter($\"OAauthorPubCnt\">1)\n//related_existing_S2authorIds.show(20)\n\n\n\n\n/*\n\nprintln(\"acmPerPkg_related_S2authorIds count 1-1: \" + acmPerPkg_related_S2authorIds.filter($\"ACMauthorCnt\"===1).count())\nacmPerPkg_related_S2authorIds.orderBy($\"ACMauthorCnt\" desc).show(20)\n\n\n\n//Find best match & compute similarity\nval acm2pkg =  OA_S2_acm_signatures_dedup_ol.\n  groupBy($\"acm_author_id\", $\"S2authorId\")                \n                .agg(count(\"OAdoi\").as(\"commonPubCnt\"))\n                \nval w = Window.partitionBy($\"acm_author_id\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval acm2pkg_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"acm2pkg_bestMatch count: \" + acm2pkg_bestMatch.count())\n\n//acm2pkg_bestMatch.printSchema()\n//pkgPerAcm.printSchema()\n//acmPerPkg.printSchema()\n//acm2pkg_bestMatch.show(20)\n\nval acm2pkg_bestMatch_ext = acm2pkg_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === acm2pkg_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"S2authorId\") === acm2pkg_bestMatch(\"S2authorId\"), \"inner\")\n.select(acm2pkg_bestMatch(\"acm_author_id\"), acm2pkg_bestMatch(\"S2authorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")   \n            .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n            .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n            .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \n               \n println(\"acm2pkg_bestMatch_ext count: \" + acm2pkg_bestMatch_ext.count())\n acm2pkg_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n \n //acm2pkg_bestMatch_ext.show(20)            \n //acm2pkg_bestMatch_ext.join(broadcast(acm_claimed_profiles), $\"acm_author_id\" === $\"profile_id\", \"inner\" ).show(20)\n //acm2pkg_bestMatch_ext.printSchema()                 \n\n//////////////////////////////////\n\n//Find best match & compute similarity\n\nval w1 = Window.partitionBy($\"S2authorId\").orderBy( $\"commonPubCnt\" desc)\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval pkg2acm_bestMatch = acm2pkg.withColumn(\"rn\", row_number.over(w1))\n.where($\"rn\" === 1)\n.drop(\"rn\")\n.cache()\n\nprintln(\"pkg2acm_bestMatch count: \" + pkg2acm_bestMatch.count())\n//pkg2acm_bestMatch.printSchema()\n//pkg2acm_bestMatch.show(20)\n\n\nval pkg2acm_bestMatch_ext = pkg2acm_bestMatch\n.join(pkgPerAcm, pkgPerAcm(\"acm_author_id\") === pkg2acm_bestMatch(\"acm_author_id\"), \"inner\")\n.join(acmPerPkg, acmPerPkg(\"S2authorId\") === pkg2acm_bestMatch(\"S2authorId\"), \"inner\")\n.select(pkg2acm_bestMatch(\"acm_author_id\"), pkg2acm_bestMatch(\"S2authorId\"), $\"commonPubCnt\", $\"acmAuthorPubCnt\" , $\"OAauthorPubCnt\")\n           .withColumn(\"ParityProfileCoverage\", $\"commonPubCnt\" / $\"acmAuthorPubCnt\" )\n           .withColumn(\"PKGProfileCoverage\", $\"commonPubCnt\" / $\"OAauthorPubCnt\" )\n           .withColumn(\"jaccSimilarity\", $\"commonPubCnt\" / ($\"acmAuthorPubCnt\"+ $\"OAauthorPubCnt\" - $\"commonPubCnt\"))     \n  \n.cache()\n               \nprintln(\"pkg2acm_bestMatch_ext count: \" + pkg2acm_bestMatch_ext.count())\npkg2acm_bestMatch_ext.select(avg($\"ParityProfileCoverage\"), avg($\"PKGProfileCoverage\"),  avg($\"jaccSimilarity\")).show()\n\n */\n ",
   "id": "",
   "dateCreated": "2023-03-24 11:06:16.927",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-03-28 10:30:40.071",
   "dateUpdated": "2023-03-28 10:35:14.842",
   "dateFinished": "2023-03-28 10:35:14.841",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mone feature warning; for details, enable `:setting -feature' or `:replay -feature'\nonline_profiles count: 1058\nonline_signatures total count: 3606\nroot\n |-- OAdoi: string (nullable = true)\n |-- OApaperId: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- ol_normname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- ol_institutionId: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- ol_OAAuthorId: string (nullable = true)\n |-- ol_orcid: string (nullable = true)\n |-- ol_authorName: string (nullable = true)\n |-- affiliationId: string (nullable = true)\n |-- ol_affiliationId: string (nullable = true)\n |-- acm_author_id_int: string (nullable = true)\n\n+--------------------+-----------+--------------------+--------------------+-----------+-------------------+--------------------+---------------+----------+--------------------+--------------------+--------------------+--------------------+-------------+-------------------+--------------------+-------------+----------------+-----------------+\n|               OAdoi|  OApaperId|          OAnormName|         ol_normname| OAauthorId|              orcid|              OAname|affiliationsIds|S2authorId|       acm_author_id|           acm_orcid|  acm_institution_id|    ol_institutionId|ol_OAAuthorId|           ol_orcid|       ol_authorName|affiliationId|ol_affiliationId|acm_author_id_int|\n+--------------------+-----------+--------------------+--------------------+-----------+-------------------+--------------------+---------------+----------+--------------------+--------------------+--------------------+--------------------+-------------+-------------------+--------------------+-------------+----------------+-----------------+\n|10.1007/s00245-02...|W4308463808|           wenjuzhao|           wenjuzhao|A2797221828|0000-0002-5418-2626|          Wenju Zhao|   [I154099455]|   1686553|10.1145/contrib-9...|http://orcid.org/...|10.1145/instituti...|        [I154099455]|  A2797221828|0000-0002-5418-2626|          Wenju Zhao|   I154099455|      I154099455|      99660646166|\n|10.1007/s00453-02...|W4290613789|      gruiacalinescu|      gruiacalinescu|A2198922719|               null|     Gruia Calinescu|   [I180949307]|   1746764|10.1145/contrib-8...|                null|10.1145/instituti...|        [I180949307]|  A4290616438|               null|     Gruia Călinescu|   I180949307|      I180949307|      81100346429|\n|10.1007/s00542-02...|W4309081218|hosseinnejatpishk...|hosseinnejatpishk...|A4223163833|               null|Hossein Nejat Pis...|             []|  30418915|10.1145/contrib-9...|                null|10.1145/instituti...|        [I133529467]|  A4223163833|               null|Hossein Nejat Pis...|         null|      I133529467|      99660717200|\n|10.1007/s10015-02...|W4308985819|          satorugoto|          satorugoto|A4308986296|               null|         Satoru Goto|             []| 144149203|10.1145/contrib-8...|                null|10.1145/instituti...|        [I177136067]|  A2937214438|               null|         Satoru Goto|         null|      I177136067|      81553775356|\n|10.1007/s10015-02...|W4309082770|      takashishimada|      takashishimada|A4309083185|               null|     Takashi Shimada|             []| 145757779|10.1145/contrib-9...|                null|10.1145/instituti...|  [null, I125602781]|  A2939314286|               null|     Takashi Shimada|         null|            null|      99660648938|\n|10.1007/s10015-02...|W4310219824|         xiaotongnie|         xiaotongnie|A4310234006|               null|        Xiaotong Nie|   [I113306721]| 108177585|10.1145/contrib-9...|                null|10.1145/instituti...|        [I113306721]|  A4310234006|               null|        Xiaotong Nie|   I113306721|      I113306721|      99660646854|\n|10.1007/s10015-02...|W4310219824|         yupengliang|         yupengliang|A4310234007|               null|        Yupeng Liang|             []| 153556710|10.1145/contrib-9...|                null|10.1145/instituti...|        [I113306721]|  A4299029444|               null|        Yupeng Liang|         null|      I113306721|      99659980684|\n|10.1007/s10044-02...|W4296049954|              jieguo|              jieguo|A2300252443|               null|             Jie Guo|    [I96733725]|2007705864|10.1145/contrib-9...|                null|                null|         [I96733725]|  A3043106719|               null|             Jie Guo|    I96733725|       I96733725|      99660729692|\n|10.1007/s10489-02...|W4283025404|         yanshendong|         yanshendong|A4283504205|               null|        Yanshen Dong|             []|2170960793|10.1145/contrib-9...|                null|                null|              [null]|  A4283504205|               null|        Yanshen Dong|         null|            null|      99660725347|\n|10.1007/s10796-02...|W3161596717|         yichuanwang|         yichuanwang|A2305194601|0000-0003-1575-0245|        Yichuan Wang|    [I91136226]|  49415495|10.1145/contrib-9...|                null|10.1145/instituti...|         [I91136226]|  A2305194601|0000-0003-1575-0245|        Yichuan Wang|    I91136226|       I91136226|      99660736864|\n|10.1007/s10836-02...|W4311848315|           g ksharma|            gksharma|A4311848366|               null|        G. K. Sharma|             []| 143916767|10.1145/contrib-9...|                null|10.1145/instituti...|          [I9747756]|  A3025154251|               null|        G. K. Sharma|         null|        I9747756|      99660719033|\n|10.1007/s10836-02...|W4311230538|    abalhassansheikh|    abalhassansheikh|A4283358083|               null|   Abalhassan Sheikh|             []|  66035907|10.1145/contrib-9...|http://orcid.org/...|                null|         [I74760111]|  A3034630201|               null|   Abalhassan Sheikh|         null|       I74760111|      99660718507|\n|10.1007/s11222-02...|W4319791259|    delphinesinoquet|    delphinesinoquet|A4319833745|               null|   Delphine Sinoquet|             []|   6932638|10.1145/contrib-9...|                null|                null|        [I265217849]|  A4297391123|               null|   Delphine Sinoquet|         null|      I265217849|      99659955445|\n|10.1007/s11222-02...|W4319233910|          rosaelillo|          rosaelillo|A4319235270|               null|       Rosa E. Lillo|             []|   2772744|10.1145/contrib-8...|                null|10.1145/instituti...|[I50357001, I5035...|  A4229100287|               null|       Rosa E. Lillo|         null|       I50357001|      81100350875|\n|10.1007/s11225-02...|W4307404346|       sergioacelani|       sergioacelani|A4307404602|               null|    Sergio A. Celani|  [I3130805194]|   2342523|10.1145/contrib-8...|                null|10.1145/instituti...|       [I3130805194]|  A4307404602|               null|    Sergio A. Celani|  I3130805194|     I3130805194|      81488662314|\n|10.1016/j.amc.202...|W4295879654|          likangfeng|          likangfeng|A3159187339|0000-0002-9061-4211|         Likang Feng|    [I18452120]|  30963898|10.1145/contrib-9...|                null|10.1145/instituti...|         [I18452120]|  A2225579983|               null|         Likang Feng|    I18452120|       I18452120|      99660725923|\n|10.1016/j.comcom....|W4309293867|     enricocavallini|     enricocavallini|A4309295262|0000-0002-8098-1851|    Enrico Cavallini|             []|  93556491|10.1145/contrib-9...|                null|10.1145/instituti...|       [I2800530175]|  A4309295262|0000-0002-8098-1851|    Enrico Cavallini|         null|     I2800530175|      99660723676|\n|10.1016/j.elerap....|W4307154455|              nanliu|              nanliu|A4307154609|               null|             Nan Liu|             []| 123808893|10.1145/contrib-8...|                null|10.1145/instituti...|       [I4210108865]|  A2628109286|               null|             Nan Liu|         null|     I4210108865|      81551995956|\n|10.1016/j.ijcci.2...|W4296792073|   bartoszgzerebecki|    bartoszzerebecki|A3025521207|0000-0001-5735-9506|Bartosz G. Żerebecki|   [I913958620]|1742303196|10.1145/contrib-9...|                null|10.1145/instituti...|        [I913958620]|  A3153015963|               null|   Bartosz Żerebecki|   I913958620|      I913958620|      99660569754|\n|10.1016/j.is.2022...|W4296311716|  rafaelseidioyamada|      rafaelsoyamada|A3008744924|               null|Rafael Seidi Oyamada|   [I127110123]|1585007908|10.1145/contrib-9...|                null|10.1145/instituti...|        [I189158943]|  A4296316920|0000-0002-4408-9575|   Rafael S. Oyamada|   I127110123|      I189158943|      99659943038|\n+--------------------+-----------+--------------------+--------------------+-----------+-------------------+--------------------+---------------+----------+--------------------+--------------------+--------------------+--------------------+-------------+-------------------+--------------------+-------------+----------------+-----------------+\nonly showing top 20 rows\n\nOA_S2_acm_signatures_ol joined to OA_S2_ACM:2199\nOA_S2_acm_signatures_ol acm_institution_id is null:174\nOA_S2_acm_signatures_ol affiliationId is null:1490\nOA_S2_acm_signatures_ol ol_affiliationId is null:225\nOA_S2_acm_signatures_ol OAauthorId= ol_OAAuthorId:727\nOA_S2_acm_signatures_ol affiliationId = ol_affiliationId:570\nOAdois:730\nacm_author_ids:2185\nOAauthorIds:2193\nS2authorIds:2182\nol_OAAuthorId:2192\nacm_orcid:349\norcid:721\nOA_S2_acm_signatures_dedup_ol_acm:26436\nOA_S2_acm_signatures_dedup_ol_s2:27428\nOA_S2_acm_signatures_dedup_ol_oa:34582\nOA_S2_acm_signatures_dedup_ol:33196\nacm_author_ids:5330\nOAauthorIds:4311\nS2authorIds:2868\nacm_orcid:1019\norcid:1468\npkgPerAcm count: 5330\npkgPerAcm acmAuthorPubCnt=1 count: 3544\npkgPerAcm acmAuthorPubCnt=1 in ol records count: 960\nOAPerAcm count 1-1: 4304\nS2PerAcm count 1-1: 4966\nacmPerPkg count: 2868\nacmPerPkg authorPubCnt=1 count: 1058\nacmPerPkg authorPubCnt=1 in ol records count: 716\nacmPerPkg count 1-1: 2082\n+----------+------------+--------------------+--------------------+-----------+--------------------+-----------+------------+--------------------+----------------+\n|S2authorId|ACMauthorCnt|      acm_author_ids|      altAuthorNames|altNamesCnt|         OAauthorIds|OAauthorCnt|authorPubCnt|   altAffiliationIds|affiliationIdCnt|\n+----------+------------+--------------------+--------------------+-----------+--------------------+-----------+------------+--------------------+----------------+\n|  46276037|         273|[81442601373, 815...|[Jing Li, Jun Li,...|          8|[A2617638183, A43...|         19|         364|[I4210108629, I42...|             122|\n|  47740650|         234|[81554891556, 814...|[J. Bradley Chen,...|         12|[A2942611377, A21...|         20|         310|[I148099405, I225...|              99|\n|   1688428|         176|[99660367849, 996...|[J. yang, Ji-yue ...|          4|[A4317939603, A43...|         15|         270|[I4210165038, I39...|              58|\n| 144142354|         124|[99660131920, 996...|[Rui Zhang, Ruiha...|          2|[A2413204075, A26...|         10|         188|[I86501945, I4210...|              81|\n|   1682058|         107|[81408595269, 996...|[Haopu Zhang, Hao...|          4|[A4311361288, A43...|          9|         126|[I95457486, I4610...|              62|\n|   1690341|          57|[99659607391, 996...|[Larence T. Yang,...|          6|[A2688898532, A27...|         11|         408|[I4210145393, I71...|              10|\n|  40457423|          54|[99659535998, 996...|[Boyang Li, Yang ...|          2|[A4224605159, A43...|         11|          76|[I194450716, I969...|              20|\n|  47067803|          53|[99658630222, 996...|         [Hao Jiang]|          1|[A2422258175, A43...|          4|          96|[I2250955327, I19...|              37|\n| 101829183|          39|[81548811556, 996...|[Wei ZHOU, Wei-ca...|          4|[A2440390095, A43...|         10|          53|[I49185572, I4210...|              31|\n|  50212920|          36|[99660374537, 996...|         [Fan Zhang]|          1|[A4308651304, A43...|          6|          58|[I173899330, I140...|              28|\n|  47909531|          30|[99659563136, 996...|           [Yan Liu]|          1|[A2683063310, A43...|          4|          45|[I4210137199, I10...|              11|\n|  40478976|          30|[99660727562, 815...|[Junhui Liu, Jung...|          5|[A2718546190, A21...|          8|          32|[I4210093028, I19...|              17|\n| 145837053|          29|[99660614964, 996...|[Mohsen Guizani, ...|          4|[A2292838553, A43...|          7|         291|[I83683471, I4210...|              17|\n| 144335971|          28|[81336488722, 996...|[Xiaojiang Du, Xi...|          2|[A4314050763, A21...|          5|         157|[I125467818, I881...|               8|\n|  46399556|          27|[99660721714, 996...|[Yanggege Liu, Bi...|          3|[A3207266226, A24...|          8|          32|[I170215575, I394...|              15|\n|  34767970|          23|[99660624074, 996...|[Jinde Cao, Junwe...|          2|[A4310847675, A43...|          8|         373|[I177725633, I193...|              13|\n|  46509200|          22|[99659317796, 996...|[Jing-zhuan Zhao,...|          2|[A4286407738, A25...|          3|          25|[I37461747, I4119...|              16|\n| 144018867|          18|[99659924325, 996...|[Tao Liu, Qian Li...|          3|[A2698815022, A43...|          9|          26|[I4800084, I88176...|               9|\n|   1747316|          18|[99660093621, 996...|[H. Fujita, Hiroy...|          3|[A4309484502, A21...|         20|         177|[I173304897, I472...|               5|\n|  50876633|          18|[99659568927, 996...|           [Li Wang]|          1|[A3022106393, A43...|          3|          19|[I9086337, I15337...|               8|\n+----------+------------+--------------------+--------------------+-----------+--------------------+-----------+------------+--------------------+----------------+\nonly showing top 20 rows\n\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n |-- affiliationId: string (nullable = true)\n |-- acm_author_id_int: string (nullable = true)\n |-- nonResolved_acmAuthorId: string (nullable = true)\n\nnon_resolved_AcmAuthors count: 960\nnon_resolved_AcmAuthors_signatures authorPubCnt=1 count: 960\nrelated_S2authorIds:960\nroot\n |-- ACMauthorCnt: long (nullable = false)\n |-- acm_author_ids: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- altAuthorNames: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- altNamesCnt: long (nullable = false)\n |-- OAauthorIds: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- OAauthorCnt: long (nullable = false)\n |-- authorPubCnt: long (nullable = false)\n |-- altAffiliationIds: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- affiliationIdCnt: long (nullable = false)\n |-- corresponding_S2authorId: string (nullable = true)\n\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n |-- affiliationId: string (nullable = true)\n |-- acm_author_id_int: string (nullable = true)\n\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+-----------+-----------------------------------------------------------------+-----------+------------+-------------------------------------------------+----------------+------------------------+\n|ACMauthorCnt|acm_author_ids                                                                                                                                 |altAuthorNames                        |altNamesCnt|OAauthorIds                                                      |OAauthorCnt|authorPubCnt|altAffiliationIds                                |affiliationIdCnt|corresponding_S2authorId|\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+-----------+-----------------------------------------------------------------+-----------+------------+-------------------------------------------------+----------------+------------------------+\n|2           |[99660575289, 99660224779]                                                                                                                     |[Linkun Fan]                          |1          |[A3048390371, A4309104051]                                       |2          |2           |[I25355098]                                      |1               |2036438043              |\n|2           |[99660722481, 99660722474]                                                                                                                     |[Yunong Zhang]                        |1          |[A4304704810, A4306303893]                                       |2          |2           |[I113940042]                                     |1               |2145025373              |\n|2           |[99660484105, 99660734239]                                                                                                                     |[Jiankun Gong]                        |1          |[A4208345259, A4308887748]                                       |2          |2           |[I33849332]                                      |1               |100469616               |\n|2           |[99658641283, 99660728649]                                                                                                                     |[Nikolay Kazantsev, Nikolai Kazantsev]|2          |[A4307056239, A2172424950]                                       |2          |2           |[I118501908]                                     |1               |116513769               |\n|3           |[99660727550, 99660622678, 99659854676]                                                                                                        |[Jiehao Liu]                          |1          |[A2137664877, A4309881451]                                       |2          |3           |[I37987034]                                      |1               |2146653122              |\n|3           |[99660539548, 99660659439, 99660736816]                                                                                                        |[Yan Wang]                            |1          |[A2899757074, A4307088042]                                       |2          |3           |[I67001856, I40963666]                           |2               |2152542942              |\n|2           |[99660691009, 99660734860]                                                                                                                     |[Meng Xu]                             |1          |[A3051656802, A4308082362]                                       |2          |2           |[I21193070]                                      |1               |2180532903              |\n|4           |[81100618840, 81430607712, 99660717323, 99660717324]                                                                                           |[Peter Jonsson]                       |1          |[A2280075293]                                                    |1          |50          |[I102134673, I4210151885]                        |2               |7539122                 |\n|10          |[99660246533, 99660209069, 81461650203, 81392597067, 99660095434, 99659949491, 99660209086, 99660095443, 99660733439, 99660095427]             |[Yuchun Fang]                         |1          |[A2169962679]                                                    |1          |27          |[I113940042, I1326498283]                        |2               |8589942                 |\n|3           |[99660729380, 99659851068, 99659930001]                                                                                                        |[Zifan Wang]                          |1          |[A3015953336, A4308902344]                                       |2          |3           |[I183067930, I74973139]                          |2               |2117418493              |\n|3           |[99660156097, 99660717810, 81452602799]                                                                                                        |[Huai Liu]                            |1          |[A4317657715, A2135958066]                                       |2          |3           |[I57093077]                                      |1               |2145489341              |\n|4           |[99659242234, 99660730908, 81100281817, 99659307338]                                                                                           |[Tomislav Šmuc]                       |1          |[A232623065]                                                     |1          |5           |[I4210123216]                                    |1               |2251743                 |\n|11          |[99659820433, 99660273549, 99660683562, 99660683560, 99659749869, 99660273328, 99660683573, 99660731639, 99660683584, 99660273140, 99660273255]|[Jiaole Wang]                         |1          |[A2166282853, A4313918089, A4309335213, A4314781841, A3214900840]|5          |18          |[I136199984, I204983213, I2800748030, I177725633]|4               |3291742                 |\n|8           |[99660372663, 99659255948, 99659806609, 99659251669, 99660736864, 99658705035, 99659144180, 99660231705]                                       |[Yichuan Wang]                        |1          |[A2305194601]                                                    |1          |10          |[I84884186, I91136226, I82497590]                |3               |49415495                |\n|3           |[99660001821, 99660729223, 99660380140]                                                                                                        |[Tong Zhou]                           |1          |[A2523953695, A4310718058]                                       |2          |3           |[I116953780]                                     |1               |1380575050              |\n|2           |[99660646981, 99659122183]                                                                                                                     |[Ganshan Yang]                        |1          |[A4308471743, A2558449379]                                       |2          |2           |[I120825670]                                     |1               |144574963               |\n|2           |[99660729491, 99660584287]                                                                                                                     |[Guangjun Zhu]                        |1          |[A2948138318]                                                    |1          |2           |[]                                               |0               |15931840                |\n|2           |[99660117926, 99660733783]                                                                                                                     |[Shanshan Hong]                       |1          |[A4310062598, A2306855877]                                       |2          |2           |[I116953780]                                     |1               |2110925302              |\n|3           |[99660357055, 99660717953, 99659616738]                                                                                                        |[Lin Cheng]                           |1          |[A2620295374, A4226610476, A2534361394]                          |3          |3           |[I141649380, I191208505, I125839683]             |3               |47768647                |\n|10          |[99660296643, 99659347256, 99660721646, 99659334835, 99659194075, 81384606220, 99659176101, 99660027740, 81482661203, 99660553677]             |[Xianghua Li]                         |1          |[A2170036040]                                                    |1          |13          |[I39343248, I194450716, I17145004, I142108993]   |4               |48568389                |\n+------------+-----------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+-----------+-----------------------------------------------------------------+-----------+------------+-------------------------------------------------+----------------+------------------------+\nonly showing top 20 rows\n\n+-----------+--------------------+----------------+-----------+-------------------+---------------+-------------+---------------+----------------------+----------+--------------------+---------+-------------+--------------------+-------------------+--------------------+--------------------+----------------+-------------+-----------------+-------------+-----------------+------------+--------------------+--------------------+-----------+--------------------+-----------+------------+--------------------+----------------+------------------------+\n|  OApaperId|               OAdoi|          OAname| OAauthorId|              orcid|OAshortNormName|   OAnormName|affiliationsIds|coAuthorShortNormNames|S2authorId|               S2doi|S2paperId|   S2normName|             acm_doi|          acm_orcid|       acm_author_id|  acm_institution_id| acm_author_name| acm_normname|acm_shortnormname|affiliationId|acm_author_id_int|ACMauthorCnt|      acm_author_ids|      altAuthorNames|altNamesCnt|         OAauthorIds|OAauthorCnt|authorPubCnt|   altAffiliationIds|affiliationIdCnt|corresponding_S2authorId|\n+-----------+--------------------+----------------+-----------+-------------------+---------------+-------------+---------------+----------------------+----------+--------------------+---------+-------------+--------------------+-------------------+--------------------+--------------------+----------------+-------------+-----------------+-------------+-----------------+------------+--------------------+--------------------+-----------+--------------------+-----------+------------+--------------------+----------------+------------------------+\n|W4313400194|10.1016/j.adhoc.2...|    Jiankuo Dong|A4315964147|               null|          jdong|  jiankuodong|             []|  [yteng, hshi, pzh...|  31649700|10.1016/j.adhoc.2...|255045814|  jiankuodong|10.1016/j.adhoc.2...|               null|10.1145/contrib-9...|10.1145/instituti...|    Jiankuo Dong|  jiankuodong|            jdong|         null|      99660730248|           3|[99660585753, 996...|      [Jiankuo Dong]|          1|[A4296870863, A43...|          4|           6|         [I41198531]|               1|                31649700|\n|W4294031701|     10.1145/3560487|     Desheng Cai|A2892492486|               null|           dcai|   deshengcai|    [I16365422]|  [dcai, sqian, qfa...|2052543487|     10.1145/3560487|251954148|   deshengcai|     10.1145/3560487|0000-0002-7464-9115|10.1145/contrib-9...|10.1145/instituti...|     Desheng Cai|   deshengcai|             dcai|    I16365422|      99660720266|           2|[99660720266, 996...|       [Desheng Cai]|          1|       [A2892492486]|          1|           2|         [I16365422]|               1|              2052543487|\n|W2891571368|10.1007/s11042-01...|       Hao Zhang|A2538038556|0000-0001-5089-1196|         hzhang|     haozhang|    [I59028903]|      [xliang, hzhang]|   1682058|10.1007/s11042-01...| 52272808|       hzhang|10.1007/s11042-01...|               null|10.1145/contrib-8...|10.1145/instituti...|       Hao Zhang|     haozhang|           hzhang|    I59028903|      81488668640|         107|[99658664859, 814...|[Haopu Zhang, Hao...|          4|[A4311361288, A43...|          9|         126|[I95457486, I4610...|              62|                 1682058|\n|W2154041442|10.1109/icgec.201...|     Xianghua Li|A2170036040|0000-0001-8749-3810|            xli|   xianghuali|   [I194450716]|   [xli, zwang, schen]|  48568389|10.1109/icgec.201...| 17169744|   xianghuali|10.1109/icgec.201...|               null|10.1145/contrib-8...|                null|     Xianghua Li|   xianghuali|              xli|   I194450716|      81482661203|          10|[99660296643, 996...|       [Xianghua Li]|          1|       [A2170036040]|          1|          13|[I39343248, I1944...|               4|                48568389|\n|W2128785065|10.1287/msom.2.4....|         Teck Ho|A2585307770|               null|            tho|       teckho|             []|  [mcohen, jeliashb...|  39643451|10.1287/msom.2.4....|  1532650|    teckhuaho|10.1287/msom.2.4....|               null|10.1145/contrib-8...|                null|      Teck H. Ho|      teckhho|              tho|         null|      81100317564|           7|[99658714366, 815...|[Teck Ho, Tse‐Lok...|          3|[A2162444377, A43...|          4|          26|[I95457486, I1613...|               3|                39643451|\n|W2040707826|10.1109/iccis.201...|   Jungcheng Liu|A2223145605|               null|           jliu| jungchengliu|   [I168337820]|  [jwang, wma, jliu...|  40478976|10.1109/iccis.201...| 14925216|         jliu|10.1109/iccis.201...|               null|10.1145/contrib-8...|                null|   Jungcheng Liu| jungchengliu|             jliu|   I168337820|      81548037587|          30|[99660727562, 815...|[Junhui Liu, Jung...|          5|[A2718546190, A21...|          8|          32|[I4210093028, I19...|              17|                40478976|\n|W3184732260|10.1145/3460824.3...|       Jing Zhao|A2599777642|0000-0002-3208-9009|          jzhao|     jingzhao|   [I216513404]|   [jzhao, gjang, fye]|  46509200|10.1145/3460824.3...|236145473|     jingzhao|10.1145/3460824.3...|               null|10.1145/contrib-9...|                null|       Jing Zhao|     jingzhao|            jzhao|   I216513404|      99659744807|          22|[99659317796, 996...|[Jing-zhuan Zhao,...|          2|[A4286407738, A25...|          3|          25|[I37461747, I4119...|              16|                46509200|\n|W3159427232|10.1016/j.neucom....|      Jiehao Liu|A2137664877|               null|           jliu|    jiehaoliu|    [I37987034]|  [zyang, jliu, tli...|2146653122|10.1016/j.neucom....|235545756|    jiehaoliu|10.1016/j.neucom....|               null|10.1145/contrib-9...|10.1145/instituti...|      Jiehao Liu|    jiehaoliu|             jliu|    I37987034|      99659854676|           3|[99660727550, 996...|        [Jiehao Liu]|          1|[A2137664877, A43...|          2|           3|         [I37987034]|               1|              2146653122|\n|W2171147163|10.1109/itcc.2005...|      J. C. Chen|A3147636976|               null|          jchen|       jcchen|    [I91045830]|  [jchen, yguan, up...|  47740650|10.1109/itcc.2005...|  9663015|     jingchen|10.1109/itcc.2005...|               null|10.1145/contrib-8...|10.1145/instituti...|       Jian Chen|     jianchen|            jchen|    I91045830|      81342491147|         234|[81554891556, 814...|[J. Bradley Chen,...|         12|[A2942611377, A21...|         20|         310|[I148099405, I421...|              99|                47740650|\n|W4295778225|10.1109/tits.2022...|Laurence T. Yang|A2145586806|0000-0002-7986-4244|          lyang|laurencetyang|   [I197191942]|  [sahmed, vpiuri, ...|   1690341|10.1109/tits.2022...|252290518|        lyang|10.1109/tits.2022...|0000-0002-7986-4244|10.1145/contrib-8...|10.1145/instituti...|Laurence T. Yang|laurencetyang|            lyang|   I197191942|      81452592885|          57|[99659607391, 996...|[Larence T. Yang,...|          6|[A2688898532, A27...|         11|         408|[I4210145393, I71...|              10|                 1690341|\n|W2808479959|10.1007/s10458-02...|     Yuzhe Zhang|A2801313817|               null|         yzhang|   yuzhezhang|   [I135598925]|  [kyahiro, yzhang,...|2108353691|10.1007/s10458-02...| 51872477|   yuzhezhang|10.1007/s10458-02...|               null|10.1145/contrib-9...|                null|     Yuzhe Zhang|   yuzhezhang|           yzhang|   I135598925|      99659972051|           3|[99660318561, 996...|       [Yuzhe Zhang]|          1|[A2801313817, A43...|          3|           3|[I135598925, I126...|               2|              2108353691|\n|W1972250536|10.1007/s11704-01...|    Licheng Jiao|A2166558591|0000-0001-7097-5186|          ljiao|  lichengjiao|   [I149594827]|  [rliu, cma, fhe, ...| 144125122|10.1007/s11704-01...|  3397338|        ljiao|10.1007/s11704-01...|               null|10.1145/contrib-8...|10.1145/instituti...|    Licheng Jiao|  lichengjiao|            ljiao|   I149594827|      81413597310|          12|[99660729930, 996...|[Long R. Jiao, Li...|          3|[A2112142782, A21...|          4|         407|[I149594827, I132...|               2|               144125122|\n|W4310073090|10.1016/j.compbio...|    Zhoufeng Liu|A4310073998|               null|           zliu|  zhoufengliu|             []|  [bli, jhwang, zli...|   2131137|10.1016/j.compbio...|254009380|  zhoufengliu|10.1016/j.compbio...|               null|10.1145/contrib-9...|10.1145/instituti...|    Zhoufeng Liu|  zhoufengliu|             zliu|         null|      99660726847|           6|[99660595729, 815...|      [Zhoufeng Liu]|          1|[A4310078364, A43...|          5|          23|        [I132586189]|               1|                 2131137|\n|W4200144003|10.1016/j.cose.20...|      Ping Xiong|A2020434285|0000-0003-3289-3061|         pxiong|    pingxiong|   [I158934434]|  [cwang, ztianqing...|  46277805|10.1016/j.cose.20...|245026394|       pxiong|10.1016/j.cose.20...|               null|10.1145/contrib-8...|10.1145/instituti...|      Ping Xiong|    pingxiong|           pxiong|   I158934434|      81552011356|           3|[81552011356, 996...|        [Ping Xiong]|          1|       [A2020434285]|          1|          18|        [I158934434]|               1|                46277805|\n|W2098687730|10.1109/icpads.20...|    Jing M. Chen|A2148776510|0000-0001-8244-2408|          jchen|    jingmchen|    [I91807558]|    [jchen, jliu, hsu]|  47740650|10.1109/icpads.20...| 17209161|     jingchen|10.1109/icpads.20...|               null|10.1145/contrib-9...|                null|       Jing Chen|     jingchen|            jchen|    I91807558|      99659384781|         234|[81554891556, 814...|[J. Bradley Chen,...|         12|[A2942611377, A21...|         20|         310|[I148099405, I421...|              99|                47740650|\n|W2163256854|10.1109/csse.2008...|    Jing M. Chen|A2148776510|0000-0001-8244-2408|          jchen|    jingmchen|    [I59028903]|  [ywang, gji, jche...|  47740650|10.1109/csse.2008...| 10881609|     jingchen|10.1109/csse.2008...|               null|10.1145/contrib-9...|                null|       Jing Chen|     jingchen|            jchen|    I59028903|      99659384743|         234|[81554891556, 814...|[J. Bradley Chen,...|         12|[A2942611377, A21...|         20|         310|[I148099405, I421...|              99|                47740650|\n|W4312423716|10.1007/978-3-031...|        Yang Liu|A4315258546|               null|           yliu|      yangliu|             []|  [yliu, wyang, hyu...|  40457423|10.1007/978-3-031...|253448497|      yangliu|10.1007/978-3-031...|               null|10.1145/contrib-9...|10.1145/instituti...|        Yang Liu|      yangliu|             yliu|         null|      99660640845|          54|[99659535998, 996...|[Boyang Li, Yang ...|          2|[A4224605159, A43...|         11|          76|[I194450716, I969...|              20|                40457423|\n|W1995826645|10.1109/cit.2010.303|Laurence T. Yang|A2145586806|0000-0002-7986-4244|          lyang|laurencetyang|   [I197191942]|  [wsun, nxiong, ly...|   1690341|10.1109/cit.2010.303| 10245303|        lyang|10.1109/cit.2010.303|               null|10.1145/contrib-9...|                null|Laurence T. Yang|laurencetyang|            lyang|   I197191942|      99659847716|          57|[99659607391, 996...|[Larence T. Yang,...|          6|[A2688898532, A27...|         11|         408|[I4210145393, I71...|              10|                 1690341|\n|W1993859224|10.1145/2559206.2...|  Dongsong Zhang|A2108158804|               null|         dzhang|dongsongzhang|    [I79272384]|        [jlai, dzhang]|  33006924|10.1145/2559206.2...| 18813355|dongsongzhang|10.1145/2559206.2...|               null|10.1145/contrib-8...|10.1145/instituti...|  Dongsong Zhang|dongsongzhang|           dzhang|    I79272384|      81100115513|          12|[99659515536, 996...|[Dongsong Zhang, ...|          2|[A2899818489, A21...|          3|          49|[I138006243, I669...|               6|                33006924|\n|W3083267849|     10.1145/3422937|         Tao Liu|A3083336140|               null|           tliu|       taoliu|     [I2276074]|                [tliu]| 144018867|     10.1145/3422937|221498888|       taoliu|     10.1145/3422937|               null|10.1145/contrib-9...|10.1145/instituti...|         Tao Liu|       taoliu|             tliu|     I2276074|      99659576610|          18|[99659924325, 996...|[Tao Liu, Qian Li...|          3|[A2698815022, A43...|          9|          26|[I4800084, I88176...|               9|               144018867|\n+-----------+--------------------+----------------+-----------+-------------------+---------------+-------------+---------------+----------------------+----------+--------------------+---------+-------------+--------------------+-------------------+--------------------+--------------------+----------------+-------------+-----------------+-------------+-----------------+------------+--------------------+--------------------+-----------+--------------------+-----------+------------+--------------------+----------------+------------------------+\nonly showing top 20 rows\n\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n |-- affiliationId: string (nullable = true)\n |-- acm_author_id_int: string (nullable = true)\n |-- ACMauthorCnt: long (nullable = false)\n |-- acm_author_ids: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- altAuthorNames: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- altNamesCnt: long (nullable = false)\n |-- OAauthorIds: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- OAauthorCnt: long (nullable = false)\n |-- authorPubCnt: long (nullable = false)\n |-- altAffiliationIds: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- affiliationIdCnt: long (nullable = false)\n |-- corresponding_S2authorId: string (nullable = true)\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34monline_profiles\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<institutions:array<struct<resolvedData:struct<funderfIds:array<string>,isniIds:array<string>,name:string,openalexId:string,pkgId:string,ringgoldId:string,rorId:string,score:double,wikidataIds:array<string>>,uniqueId:string,xmlName:string>>,resolvedData:struct<name:string,openalexId:string,orcidId:string,pkgId:string,s2Id:string,score:double>,uniqueId:string,xmlName:string,xmlOrcidId:string...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%spark\n",
   "id": "",
   "dateCreated": "2023-03-28 14:07:40.599",
   "config": {}
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\n\nprintln(\"non_resolved_AcmAuthors count: \" + non_resolved_AcmAuthors.count())\nprintln(\"non_resolved_AcmAuthors_signatures OAauthorPubCnt=1 count: \" + non_resolved_AcmAuthors_signatures.count())\nprintln(\"related_existing_S2authorIds:\" + related_existing_S2authorIds.count())\nnon_resolved_AcmAuthors_signatures.printSchema()\nrelated_existing_S2authorIds.printSchema()\n\nval pkgresolved_signatures = non_resolved_AcmAuthors_signatures\n.join(related_existing_S2authorIds, $\"corresponding_S2authorId\"===$\"S2authorId\", \"inner\")\n.select($\"OAdoi\".as(\"doi\"),$\"OAauthorId\", $\"OAname\".as(\"pkg_authorName\"), $\"orcid\".as(\"pkgOrcid\"), $\"affiliationId\".as(\"pkg_affiliationId\"), $\"nonResolved_acmAuthorId\", $\"acm_author_name\",  $\"ACMauthorCnt\" ,$\"altAuthorNames\", $\"altNamesCnt\", $\"OAauthorCnt\", $\"affiliationIdCnt\", $\"authorPubCnt\",  $\"acm_author_ids\", $\"OAauthorIds\",$\"corresponding_S2authorId\".as(\"bestMatchS2authorId\"), $\"altAffiliationIds\")\n\n.withColumn(\"nonResolved_acmAuthorId\",  regexp_replace($\"nonResolved_acmAuthorId\", \"10.1145/contrib-\", \"\"))\n\n\npkgresolved_signatures.orderBy($\"ACMauthorCnt\" desc).write.mode(\"overwrite\").json(s\"file://$path/resolvedByPkg_ACMsignatures.json\")\n//pkgresolved_signatures.orderBy($\"ACMauthorCnt\" desc).write.mode(\"overwrite\").csv(s\"file://$path/resolvedByPkg_signatures.csv\")\n\n//pkgresolved_signatures.printSchema()\npkgresolved_signatures.orderBy($\"ACMauthorCnt\" desc).show(20)\n",
   "id": "",
   "dateCreated": "2023-03-27 19:24:24.241",
   "config": {},
   "dateStarted": "2023-03-28 11:31:28.315",
   "dateUpdated": "2023-03-28 11:32:05.468",
   "dateFinished": "2023-03-28 11:32:05.467",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mtwo feature warnings; for details, enable `:setting -feature' or `:replay -feature'\nnon_resolved_AcmAuthors count: 960\nnon_resolved_AcmAuthors_signatures OAauthorPubCnt=1 count: 960\nrelated_existing_S2authorIds:323\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n |-- affiliationId: string (nullable = true)\n |-- acm_author_id_int: string (nullable = true)\n |-- nonResolved_acmAuthorId: string (nullable = true)\n\nroot\n |-- ACMauthorCnt: long (nullable = false)\n |-- acm_author_ids: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- altAuthorNames: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- altNamesCnt: long (nullable = false)\n |-- OAauthorIds: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- OAauthorCnt: long (nullable = false)\n |-- authorPubCnt: long (nullable = false)\n |-- altAffiliationIds: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- affiliationIdCnt: long (nullable = false)\n |-- corresponding_S2authorId: string (nullable = true)\n\n+--------------------+-----------+----------------+-------------------+-----------------+-----------------------+----------------+------------+--------------------+-----------+-----------+----------------+------------+--------------------+--------------------+-------------------+--------------------+\n|                 doi| OAauthorId|  pkg_authorName|           pkgOrcid|pkg_affiliationId|nonResolved_acmAuthorId| acm_author_name|ACMauthorCnt|      altAuthorNames|altNamesCnt|OAauthorCnt|affiliationIdCnt|authorPubCnt|      acm_author_ids|         OAauthorIds|bestMatchS2authorId|   altAffiliationIds|\n+--------------------+-----------+----------------+-------------------+-----------------+-----------------------+----------------+------------+--------------------+-----------+-----------+----------------+------------+--------------------+--------------------+-------------------+--------------------+\n|10.1007/s11276-02...|A4308908333|       Jing Chen|               null|             null|            99660719998|       Jing Chen|         234|[J. Bradley Chen,...|         12|         20|              99|         310|[81554891556, 814...|[A2942611377, A21...|           47740650|[I148099405, I421...|\n|10.1007/s10115-02...|A2949253712|       Hao Zhang|0000-0002-2058-7123|             null|            99660719760|       Hao Zhang|         107|[Haopu Zhang, Hao...|          4|          9|              62|         126|[99658664859, 814...|[A4311361288, A43...|            1682058|[I95457486, I4610...|\n|10.1007/s10845-00...|A2145586806|Laurence T. Yang|0000-0002-7986-4244|       I197191942|            99660719434|Laurence T. Yang|          57|[Larence T. Yang,...|          6|         11|              10|         408|[99659607391, 996...|[A2688898532, A27...|            1690341|[I4210145393, I71...|\n|10.1007/s00521-02...|A2776297621|        Yang Liu|0000-0001-7495-282X|             null|            99660721715|        Yang Liu|          54|[Boyang Li, Yang ...|          2|         11|              20|          76|[99659535998, 996...|[A4224605159, A43...|           40457423|[I194450716, I969...|\n|10.1007/s11704-02...|A4317658018|       Hao Jiang|               null|             null|            99660722111|       Hao Jiang|          53|         [Hao Jiang]|          1|          4|              37|          96|[99658630222, 996...|[A2422258175, A43...|           47067803|[I2250955327, I19...|\n|10.1016/j.ins.202...|A4307902643|         Jun Liu|               null|             null|            99660727562|         Jun Liu|          30|[Junhui Liu, Jung...|          5|          8|              17|          32|[99660727562, 815...|[A2718546190, A21...|           40478976|[I4210093028, I19...|\n|10.1016/j.cmpb.20...|A4309773227|         Yan Liu|0000-0002-4902-0139|             null|            99660730089|         Yan Liu|          30|           [Yan Liu]|          1|          4|              11|          45|[99659563136, 996...|[A2683063310, A43...|           47909531|[I4210137199, I10...|\n|10.1007/s00466-02...|A4302484364|        Yang Liu|               null|       I150744194|            99660721714|        Yang Liu|          27|[Yanggege Liu, Bi...|          3|          8|              15|          32|[99660721714, 996...|[A3207266226, A24...|           46399556|[I170215575, I394...|\n|10.1007/s10489-02...|A2599777642|       Jing Zhao|0000-0002-3208-9009|             null|            99660735367|       Jing Zhao|          22|[Jing-zhuan Zhao,...|          2|          3|              16|          25|[99659317796, 996...|[A4286407738, A25...|           46509200|[I37461747, I4119...|\n|10.1177/003754972...|A2698815022|         Tao Liu|0000-0002-0146-729X|         I4800084|            99660733797|         Tao Liu|          18|[Tao Liu, Qian Li...|          3|          9|               9|          26|[99659924325, 996...|[A2698815022, A43...|          144018867|[I4800084, I88176...|\n|10.1007/s00466-02...|A2922890431|         Li Wang|0000-0003-1688-064X|             null|            99660719503|         Li Wang|          18|           [Li Wang]|          1|          3|               8|          19|[99659568927, 996...|[A3022106393, A43...|           50876633|[I9086337, I15337...|\n|10.1016/j.future....|A4308345407|        Hao Wang|               null|             null|            99660718332|        Hao Wang|          13|[Haoyang Wang, Ha...|          3|          6|               9|          13|[99660653992, 996...|[A2133196671, A43...|           48016309|[I136199984, I433...|\n|10.1016/j.specom....|A2112455254|     Xuanze Wang|               null|             null|            99660736517|    Xuan-Ze Wang|          13|[Xuanze Wang, Xua...|          3|          5|               8|          14|[99660586940, 996...|[A4313951077, A26...|           39849136|[I174216632, I196...|\n|10.1016/j.ins.202...|A4307902641|    Xiaokui Xiao|               null|             null|            99660726808|    Xiaokui Xiao|          13|[Xiao Xiao, Xiaok...|          4|          8|               8|          18|[99660187437, 996...|[A2615385742, A21...|          152496559|[I113940042, I106...|\n|10.1016/j.image.2...|A4308459342|    Licheng Jiao|               null|             null|            99660729930|    Licheng Jiao|          12|[Long R. Jiao, Li...|          3|          4|               2|         407|[99660729930, 996...|[A2112142782, A21...|          144125122|[I149594827, I132...|\n|10.1016/j.inffus....|A4309770095|          Lu Liu|               null|       I149594827|            99660732300|          Lu Liu|          12|            [Lu Liu]|          1|          5|              11|          20|[99659944078, 996...|[A4297091264, A43...|          145412331|[I153648349, I801...|\n|10.1007/s00245-02...|A2713481101|   Shanjian Tang|               null|             null|            99660648214|   Shanjian Tang|          12|[Shanjiang Tang, ...|          2|          4|               4|          32|[99660648214, 996...|[A4316715462, A43...|           39362451|[I136765683, I172...|\n|10.1016/j.dss.202...|A4308153636|  Dongsong Zhang|               null|             null|            99660728951|  Dongsong Zhang|          12|[Dongsong Zhang, ...|          2|          3|               6|          49|[99659515536, 996...|[A2899818489, A21...|           33006924|[I138006243, I669...|\n|10.1016/j.sigpro....|A2242978988|    Sung Won Kim|0000-0001-8454-6980|             null|            99660732058|    Sung Won Kim|          12|[Sung Wan Kim, Su...|          2|          2|               3|          36|[99660217965, 996...|[A2157147157, A22...|         2152666784|[I94588446, I4210...|\n|10.1016/j.matcom....|A4308151308|           Qi Qi|               null|             null|            99660719399|           Qi Qi|          11|[Qiqi Qi, Qianqin...|          6|          9|               8|          51|[99659729897, 813...|[A4310511596, A43...|           40806187|[I37461747, I9009...|\n+--------------------+-----------+----------------+-------------------+-----------------+-----------------------+----------------+------------+--------------------+-----------+-----------+----------------+------------+--------------------+--------------------+-------------------+--------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34mpkgresolved_signatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [doi: string, OAauthorId: string ... 15 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval path = \"/media/ometaxas/nvme/datasets/ACM\"\nval curated_pkgresolved_signatures = spark.read.json(s\"file://$path/curated_nonresolved_signatures.json\")\n.select($\"doi\", $\"pkg_authorName\", $\"pkgOrcid\", $\"new_acmAuthorId\", $\"linked_acmAuthorIds\", $\"acm_author_name\", $\"row_OAauthorId\",  $\"row_OAaffiliationId\", $\"altAuthorNames\", $\"linked_OAauthorIds\",$\"bestMatchS2authorId\", $\"altAffiliationIds\")\n.withColumn(\"ACMlinkedAuthorCnt\",  size($\"linked_acmAuthorIds\"))\n\n\ncurated_pkgresolved_signatures.printSchema()\nprintln(\"curated_pkgresolved_signatures count: \" + curated_pkgresolved_signatures.count())\ncurated_pkgresolved_signatures.orderBy($\"ACMlinkedAuthorCnt\" desc).write.mode(\"overwrite\").json(s\"file://$path/nonresolved_ACMsignatures.json\")\n//pkgresolved_signatures.orderBy($\"ACMauthorCnt\" desc).write.mode(\"overwrite\").csv(s\"file://$path/resolvedByPkg_signatures.csv\")\n\n//pkgresolved_signatures.printSchema()\ncurated_pkgresolved_signatures.orderBy($\"ACMlinkedAuthorCnt\" desc).show(20)\n",
   "id": "",
   "dateCreated": "2023-04-01 12:30:08.015",
   "config": {},
   "dateStarted": "2023-04-02 16:20:05.269",
   "dateUpdated": "2023-04-02 16:20:06.708",
   "dateFinished": "2023-04-02 16:20:06.708",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mtwo feature warnings; for details, enable `:setting -feature' or `:replay -feature'\nroot\n |-- doi: string (nullable = true)\n |-- pkg_authorName: string (nullable = true)\n |-- pkgOrcid: string (nullable = true)\n |-- new_acmAuthorId: string (nullable = true)\n |-- linked_acmAuthorIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- acm_author_name: string (nullable = true)\n |-- row_OAauthorId: string (nullable = true)\n |-- row_OAaffiliationId: string (nullable = true)\n |-- altAuthorNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- linked_OAauthorIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- bestMatchS2authorId: string (nullable = true)\n |-- altAffiliationIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- ACMlinkedAuthorCnt: integer (nullable = false)\n\ncurated_pkgresolved_signatures count: 227\n+--------------------+--------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+--------------------+--------------------+-------------------+--------------------+------------------+\n|                 doi|pkg_authorName|           pkgOrcid|new_acmAuthorId| linked_acmAuthorIds|acm_author_name|row_OAauthorId|row_OAaffiliationId|      altAuthorNames|  linked_OAauthorIds|bestMatchS2authorId|   altAffiliationIds|ACMlinkedAuthorCnt|\n+--------------------+--------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+--------------------+--------------------+-------------------+--------------------+------------------+\n|10.1007/s00245-02...| Shanjian Tang|               null|    99660648214|[99660648214, 996...|  Shanjian Tang|   A2713481101|               null|[Shanjiang Tang, ...|[A4316715462, A43...|           39362451|[I136765683, I172...|                11|\n|10.1016/j.asoc.20...|      Lei Wang|               null|    99660734269|[99660586140, 996...|       Lei Wang|   A4310721947|               null|          [Lei Wang]|[A2722169877, A25...|           38949835|[I181679659, I116...|                11|\n|10.1007/s10489-02...|   Yuchun Fang|0000-0002-7085-8876|    99660733439|[99660246533, 996...|    Yuchun Fang|   A2169962679|         I113940042|       [Yuchun Fang]|       [A2169962679]|            8589942|[I113940042, I132...|                10|\n|10.1007/s11704-02...|       Zhi Jin|               null|    99660717578|[99659994612, 996...|        Zhi Jin|   A4317657716|               null|           [Zhi Jin]|[A4317657716, A42...|            1700880|[I4210092262, I19...|                10|\n|10.1016/j.inffus....|   Jiaole Wang|               null|    99660731639|[99660683562, 996...|    Jiaole Wang|   A4309335213|               null|       [Jiaole Wang]|[A2166282853, A43...|            3291742|[I136199984, I204...|                 9|\n|10.1177/016555152...|         Yi Bu|0000-0003-2549-4580|    99660725240|[99660271125, 996...|          Yi Bu|   A2932501736|          I20231570|             [Yi Bu]|[A4304999884, A29...|          145239893|[I4210119109, I20...|                 9|\n|10.1016/j.jcta.20...|      Yan Wang|               null|    99660736835|[99658953180, 996...|       Yan Wang|   A4312162099|               null|          [Yan Wang]|[A2899757074, A43...|         2152542548|[I18452120, I4096...|                 9|\n|10.1016/j.jcta.20...|   Xingxing Yu|               null|    99660724284|[99659611572, 996...|    Xingxing Yu|   A4312162100|               null|[Xingxing Yu, Xin...|[A2265646012, A43...|            1709752|[I130701444, I200...|                 8|\n|10.1007/s10836-02...| Srivaths Ravi|               null|    99660718997|[87259103557, 996...|  Srivaths Ravi|   A4283358084|               null|[S. Ravi, Selvara...|[A2296024563, A42...|          144940517|[I20089843, I2948...|                 8|\n|10.1016/j.neucom....|      Han Zhao|               null|    99660730969|[99660730969, 876...|       Han Zhao|   A4309472347|               null|          [Han Zhao]|[A2313486351, A43...|          145034731|         [I16365422]|                 8|\n|10.1016/j.image.2...|  Licheng Jiao|               null|    99660729930|[99660729930, 996...|   Licheng Jiao|   A4308459342|               null|[Licheng Jiao, Lc...|[A2112142782, A43...|          144125122|[I149594827, I132...|                 8|\n|10.1016/j.comnet....|  Jianchun Liu|               null|    99660727565|[99660727565, 996...|   Jianchun Liu|   A4310078672|               null|      [Jianchun Liu]|[A4310078672, A29...|           46700208|        [I126520041]|                 8|\n|10.1007/s10489-02...|   Jiquan Yang|               null|    99660730443|[99660266390, 996...|    Jiquan Yang|   A2098987082|               null|       [Jiquan Yang]|       [A2098987082]|         2144519914|[I152031979, I118...|                 7|\n|10.1007/s11554-02...| Szu-Hong Wang|               null|    99660719654|[81452602345, 996...|  Szu-Hong Wang|   A4318507030|               null|     [Szu-Hong Wang]|[A3084822037, A43...|            2935238|[I109289231, I753...|                 7|\n|10.1016/j.im.2022...|      Yuzhu Li|0000-0002-7571-8258|    99660732679|[99658970537, 811...|       Yuzhu Li|   A2129882176|               null|          [Yuzhu Li]|       [A2129882176]|         2110457252|[I183067930, I100...|                 6|\n|10.1016/j.asoc.20...|  Zhoufeng Liu|               null|    99660726834|[99660595729, 815...|   Zhoufeng Liu|   A4310078364|               null|      [Zhoufeng Liu]|[A4310078364, A43...|            2131137|        [I132586189]|                 6|\n|10.1007/s11235-02...|       Xu Wang|               null|    99660736479|[99660114151, 996...|        Xu Wang|   A4316650695|               null|           [Xu Wang]|[A4316650695, A26...|         2108601214|          [I4880106]|                 6|\n|10.1007/s10845-02...|   Shichang Du|0000-0003-2408-722X|    99660721039|[99660372157, 996...|    Shichang Du|   A2615386278|         I183067930|       [Shichang Du]|       [A2615386278]|            1757133|        [I183067930]|                 6|\n|10.1016/j.jnca.20...|  Zijian Zhang|               null|    99660729969|[99659932899, 996...|   Zijian Zhang|   A4309184928|               null|      [Zijian Zhang]|[A2709768070, A43...|         1993577888|[I154130895, I125...|                 6|\n|10.1016/j.bdr.202...| Xinhong Zhang|0000-0003-2403-4777|    99660718065|[99660718065, 996...|  Xinhong Zhang|   A2113252037|         I173899330|     [Xinhong Zhang]|       [A2113252037]|           46448447|[I173899330, I125...|                 6|\n+--------------------+--------------+-------------------+---------------+--------------------+---------------+--------------+-------------------+--------------------+--------------------+-------------------+--------------------+------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mpath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/ACM\n\u001b[1m\u001b[34mcurated_pkgresolved_signatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [doi: string, pkg_authorName: string ... 11 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\nval w = Window.partitionBy($\"OApaperId\", $\"S2authorId\").orderBy( lit(1) - ($\"OAshortNormName\" === $\"S2shortNormName\").cast(\"integer\"), levenshtein($\"S2normName\", $\"OAnormName\") , lit(1) - (soundex($\"OAnormName\") === soundex($\"S2normName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"OAnormName\", $\"S2normName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n//val related_S2_signatures_dedup = related_S2_signatures.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\n\nrelated_S2_signatures.filter($\"S2authorId\"===\"144018867\").show(20, false)",
   "id": "",
   "dateCreated": "2023-03-26 15:20:21.099",
   "config": {},
   "dateStarted": "2023-03-26 21:55:06.258",
   "dateUpdated": "2023-03-26 21:55:48.928",
   "dateFinished": "2023-03-26 21:55:48.928",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+-----------+---------------------------------+----------+-----------+-------------------+---------------+----------+---------------+--------------------------------------+----------+---------------------------------+---------+----------+---------------------------------+-------------------------------------+---------------------------+----------------------------+---------------+------------+-----------------+------------+-------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------------+\n|OApaperId  |OAdoi                            |OAname    |OAauthorId |orcid              |OAshortNormName|OAnormName|affiliationsIds|coAuthorShortNormNames                |S2authorId|S2doi                            |S2paperId|S2normName|acm_doi                          |acm_orcid                            |acm_author_id              |acm_institution_id          |acm_author_name|acm_normname|acm_shortnormname|ACMauthorCnt|oaAuthorName                   |acm_author_ids                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |OAauthorPubCnt|related_S2authorId|\n+-----------+---------------------------------+----------+-----------+-------------------+---------------+----------+---------------+--------------------------------------+----------+---------------------------------+---------+----------+---------------------------------+-------------------------------------+---------------------------+----------------------------+---------------+------------+-----------------+------------+-------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------------+\n|W4289550404|10.1177/00375497221112915        |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I4800084]     |[xwang, tliu, mxu]                    |144018867 |10.1177/00375497221112915        |251337183|taoliu    |10.1177/00375497221112915        |null                                 |10.1145/contrib-99660733797|10.1145/institution-60010421|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W2043139822|10.1109/cisp.2008.590            |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[]             |[tliu, cpang]                         |144018867 |10.1109/cisp.2008.590            |16482586 |taoliu    |10.1109/cisp.2008.590            |null                                 |10.1145/contrib-81375621625|null                        |Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4281257927|10.1007/s11042-022-13187-2       |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I80143920]    |[sliu, hyang, jpan, tliu, byan]       |144018867 |10.1007/s11042-022-13187-2       |248974169|taoliu    |10.1007/s11042-022-13187-2       |null                                 |10.1145/contrib-99659924325|10.1145/institution-60001429|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W3119234845|10.1145/3444370.3444627          |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[null]         |[tliu, swu, jli, yma, fduan, ylu]     |144018867 |10.1145/3444370.3444627          |230507352|taoliu    |10.1145/3444370.3444627          |null                                 |10.1145/contrib-99659670333|10.1145/institution-60021684|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W3119444835|10.1145/3444370.3444624          |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[null]         |[tliu, xcao, jhefang, jxi, swu, ylu]  |144018867 |10.1145/3444370.3444624          |230507552|taoliu    |10.1145/3444370.3444624          |null                                 |10.1145/contrib-99659670333|10.1145/institution-60021684|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W3083267849|10.1145/3422937                  |Tao Liu   |A3083336140|null               |tliu           |taoliu    |[I2276074]     |[tliu]                                |144018867 |10.1145/3422937                  |221498888|taoliu    |10.1145/3422937                  |null                                 |10.1145/contrib-99659576610|10.1145/institution-60005059|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W2017990935|10.1109/icicci.2010.64           |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I4210092223]  |[yliu, tliu]                          |144018867 |10.1109/icicci.2010.64           |18666239 |taoliu    |10.1109/icicci.2010.64           |null                                 |10.1145/contrib-81467665673|null                        |Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W3120379774|10.1145/3444370.3444616          |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[null]         |[tliu, xcao, jli, swu, xchen, ylu]    |144018867 |10.1145/3444370.3444616          |230507401|taoliu    |10.1145/3444370.3444616          |null                                 |10.1145/contrib-99659670333|10.1145/institution-60021684|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4312361270|10.1109/case49997.2022.9926543   |Tao Liu   |A4314797744|null               |tliu           |taoliu    |[I76130692]    |[xhuang, fhan, yhan, swang, tliu, jyi]|144018867 |10.1109/case49997.2022.9926543   |253186183|taoliu    |10.1109/case49997.2022.9926543   |null                                 |10.1145/contrib-99659338105|10.1145/institution-60117982|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4283589046|10.1155/2022/4617885             |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I80143920]    |[yliu, tliu, byan, jpan, hyang]       |144018867 |10.1155/2022/4617885             |250101311|taoliu    |10.1155/2022/4617885             |null                                 |10.1145/contrib-99659924325|null                        |Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W2542762438|10.1109/dmamh.2007.81            |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I76130692]    |[cyang, ssun, kzhang, tliu]           |144018867 |10.1109/dmamh.2007.81            |16692536 |taoliu    |10.1109/dmamh.2007.81            |null                                 |10.1145/contrib-81361608703|null                        |Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W2979360010|10.1016/j.camwa.2019.09.023      |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[null]         |[tliu]                                |144018867 |10.1016/j.camwa.2019.09.023      |209990989|taoliu    |10.1016/j.camwa.2019.09.023      |null                                 |10.1145/contrib-99658969848|10.1145/institution-60022527|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4302759279|10.1155/2022/4794073             |Qian Liu  |A4302783223|null               |qliu           |qianliu   |[null]         |[qliu, tliu, wzhang, fzhang]          |144018867 |10.1155/2022/4794073             |252757202|taoliu    |10.1155/2022/4794073             |null                                 |10.1145/contrib-99660626327|null                        |Qian Liu       |qianliu     |qliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W2901941709|10.1007/s11704-018-8095-8        |Taohua Liu|A2799438145|null               |tliu           |taohualiu |[I139660479]   |[mhou, yyang, tliu, wpeng]            |144018867 |10.1007/s11704-018-8095-8        |255391109|taoliu    |10.1007/s11704-018-8095-8        |null                                 |10.1145/contrib-99659334303|10.1145/institution-60017060|Taohua Liu     |taohualiu   |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4308080986|10.1109/itsc55140.2022.9922393   |Tao Liu   |A4308082198|null               |tliu           |taoliu    |[I4800084]     |[ypeng, tliu]                         |144018867 |10.1109/itsc55140.2022.9922393   |253250817|taoliu    |10.1109/itsc55140.2022.9922393   |null                                 |10.1145/contrib-99659865090|10.1145/institution-60010421|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4212903432|10.1109/asp-dac52403.2022.9712528|Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I2276074]     |[wzhang, tliu, mxie, lli, dkar, cpan] |144018867 |10.1109/asp-dac52403.2022.9712528|247047926|taoliu    |10.1109/asp-dac52403.2022.9712528|null                                 |10.1145/contrib-99660361946|10.1145/institution-60005059|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W3111614445|10.1145/3427228.3427268          |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I2276074]     |[tliu, zliu, qliu, wwen, wxu, mli]    |144018867 |10.1145/3427228.3427268          |227910139|taoliu    |10.1145/3427228.3427268          |null                                 |10.1145/contrib-99659254629|10.1145/institution-60005059|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4302759279|10.1155/2022/4794073             |Tao Liu   |A4302783224|null               |tliu           |taoliu    |[null]         |[qliu, tliu, wzhang, fzhang]          |144018867 |10.1155/2022/4794073             |252757202|taoliu    |10.1155/2022/4794073             |null                                 |10.1145/contrib-99660630146|null                        |Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4225163485|10.1007/s11042-022-13011-x       |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I80143920]    |[tliu, byan, hyang, schu, jpan]       |144018867 |10.1007/s11042-022-13011-x       |248488925|taoliu    |10.1007/s11042-022-13011-x       |null                                 |10.1145/contrib-99659924325|10.1145/institution-60001429|Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n|W4223913785|10.1155/2022/4927239             |Tao Liu   |A2698815022|0000-0002-0146-729X|tliu           |taoliu    |[I80143920]    |[jpan, tliu, byan, hyang, schu, mwang]|144018867 |10.1155/2022/4927239             |248160657|taoliu    |10.1155/2022/4927239             |https://orcid.org/0000-0002-5212-2806|10.1145/contrib-99659924325|null                        |Tao Liu        |taoliu      |tliu             |18          |[Tao Liu, Qian Liu, Taohua Liu]|[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867         |\n+-----------+---------------------------------+----------+-----------+-------------------+---------------+----------+---------------+--------------------------------------+----------+---------------------------------+---------+----------+---------------------------------+-------------------------------------+---------------------------+----------------------------+---------------+------------+-----------------+------------+-------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------------+\nonly showing top 20 rows\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@47c06c2b\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "ERROR",
   "text": "%spark\nval related_existing_S2authorIds = acmPerPkg_related_S2authorIds.filter($\"OAauthorPubCnt\">1)\n\nrelated_existing_S2authorIds.printSchema()\nOA_S2_acm_signatures_dedup_ol.printSchema()\n\nrelated_existing_S2authorIds.show(20, false)\n//related_existing_S2authorIds.orderBy($\"ACMauthorCnt\" desc).show(20, true)\n//related_existing_S2authorIds.orderBy(size($\"oaAuthorName\") desc).show(20, true)\n\nval related_S2_signatures = OA_S2_acm_signatures_dedup_ol.join(broadcast(related_existing_S2authorIds), OA_S2_acm_signatures_dedup_ol(\"S2authorId\")===related_existing_S2authorIds(\"S2authorId\"),\"inner\")\n\n//related_S2_signatures.show(20)\nrelated_S2_signatures.printSchema()\n",
   "id": "",
   "dateCreated": "2023-03-26 12:06:54.337",
   "config": {},
   "dateStarted": "2023-03-26 12:18:44.595",
   "dateUpdated": "2023-03-26 12:18:44.890",
   "dateFinished": "2023-03-26 12:18:44.890",
   "results": {
    "code": "ERROR",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- ACMauthorCnt: long (nullable = false)\n |-- oaAuthorName: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- acm_author_ids: array (nullable = false)\n |    |-- element: string (containsNull = false)\n |-- OAauthorPubCnt: long (nullable = false)\n |-- S2authorId: string (nullable = true)\n\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2authorId: string (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- acm_doi: string (nullable = true)\n |-- acm_orcid: string (nullable = true)\n |-- acm_author_id: string (nullable = true)\n |-- acm_institution_id: string (nullable = true)\n |-- acm_author_name: string (nullable = true)\n |-- acm_normname: string (nullable = true)\n |-- acm_shortnormname: string (nullable = true)\n\norg.apache.spark.sql.AnalysisException:  Column S2authorId#191908 are ambiguous. It's probably because you joined several Datasets together, and some of these Datasets are the same. This column points to one of the Datasets but Spark is unable to figure out which one. Please alias the Datasets with different names via `Dataset.as` before joining them, and specify the column using qualified name, e.g. `df.as(\"a\").join(df.as(\"b\"), $\"a.id\" > $\"b.id\")`. You can also set spark.sql.analyzer.failAmbiguousSelfJoin to false to disable this check.\n  at org.apache.spark.sql.errors.QueryCompilationErrors$.ambiguousAttributesInSelfJoinError(QueryCompilationErrors.scala:1344)\n  at org.apache.spark.sql.execution.analysis.DetectAmbiguousSelfJoin$.apply(DetectAmbiguousSelfJoin.scala:158)\n  at org.apache.spark.sql.execution.analysis.DetectAmbiguousSelfJoin$.apply(DetectAmbiguousSelfJoin.scala:44)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$2(RuleExecutor.scala:211)\n  at scala.collection.LinearSeqOptimized.foldLeft(LinearSeqOptimized.scala:126)\n  at scala.collection.LinearSeqOptimized.foldLeft$(LinearSeqOptimized.scala:122)\n  at scala.collection.immutable.List.foldLeft(List.scala:91)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1(RuleExecutor.scala:208)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1$adapted(RuleExecutor.scala:200)\n  at scala.collection.immutable.List.foreach(List.scala:431)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:200)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:215)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:209)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:172)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:179)\n  at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:88)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:179)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:193)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:330)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:192)\n  at org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:88)\n  at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\n  at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:196)\n  at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n  at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:196)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:88)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:86)\n  at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:78)\n  at org.apache.spark.sql.Dataset$.$anonfun$ofRows$1(Dataset.scala:90)\n  at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n  at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:88)\n  at org.apache.spark.sql.Dataset.withPlan(Dataset.scala:3734)\n  at org.apache.spark.sql.Dataset.join(Dataset.scala:1084)\n  ... 56 elided\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "ERROR",
   "text": "%spark\nval related_S2_signatures = OA_S2_acm_signatures_dedup_ol.join(broadcast(related_existing_S2authorIds), OA_S2_acm_signatures_dedup_ol(\"S2authorId\")===related_existing_S2authorIds(\"S2authorId\"),\"inner\")\n\n//related_S2_signatures.show(20)\nrelated_S2_signatures.printSchema()\n",
   "id": "",
   "dateCreated": "2023-03-26 12:25:32.294",
   "config": {},
   "dateStarted": "2023-03-26 12:25:34.629",
   "dateUpdated": "2023-03-26 12:25:34.718",
   "results": {
    "code": "ERROR",
    "msg": [
     {
      "type": "TEXT",
      "data": "<console>:25: \u001b[31merror: \u001b[0mnot found: value OA_S2_acm_signatures_dedup_ol\n       val related_S2_signatures = OA_S2_acm_signatures_dedup_ol.join(broadcast(related_existing_S2authorIds), OA_S2_acm_signatures_dedup_ol(\"S2authorId\")===related_existing_S2authorIds(\"S2authorId\"),\"inner\")\n                                   ^\n<console>:25: \u001b[31merror: \u001b[0mnot found: value related_existing_S2authorIds\n       val related_S2_signatures = OA_S2_acm_signatures_dedup_ol.join(broadcast(related_existing_S2authorIds), OA_S2_acm_signatures_dedup_ol(\"S2authorId\")===related_existing_S2authorIds(\"S2authorId\"),\"inner\")\n                                                                                ^\n<console>:25: \u001b[31merror: \u001b[0mnot found: value OA_S2_acm_signatures_dedup_ol\n       val related_S2_signatures = OA_S2_acm_signatures_dedup_ol.join(broadcast(related_existing_S2authorIds), OA_S2_acm_signatures_dedup_ol(\"S2authorId\")===related_existing_S2authorIds(\"S2authorId\"),\"inner\")\n                                                                                                               ^\n<console>:25: \u001b[31merror: \u001b[0mnot found: value related_existing_S2authorIds\n       val related_S2_signatures = OA_S2_acm_signatures_dedup_ol.join(broadcast(related_existing_S2authorIds), OA_S2_acm_signatures_dedup_ol(\"S2authorId\")===related_existing_S2authorIds(\"S2authorId\"),\"inner\")\n                                                                                                                                                             ^\n"
     }
    ]
   },
   "dateFinished": "2023-03-26 12:25:34.718"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval related_existing_S2authorIds = acmPerPkg_related_S2authorIds.filter($\"OAauthorPubCnt\">1)\n\nrelated_existing_S2authorIds.show(20, false)\nrelated_existing_S2authorIds.orderBy($\"ACMauthorCnt\" desc).show(20, true)\nrelated_existing_S2authorIds.orderBy(size($\"oaAuthorName\") desc).show(20, true)\n\n//related_existing_S2authorIds\n",
   "id": "",
   "dateCreated": "2023-03-25 21:27:52.477",
   "config": {},
   "dateStarted": "2023-03-26 12:00:24.661",
   "dateUpdated": "2023-03-26 12:01:54.244",
   "dateFinished": "2023-03-26 12:01:54.244",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[33mwarning: \u001b[0mtwo feature warnings; for details, enable `:setting -feature' or `:replay -feature'\n+----------+------------+-----------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+----------+\n|S2authorId|ACMauthorCnt|oaAuthorName                                   |acm_author_ids                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |OAauthorPubCnt|S2authorId|\n+----------+------------+-----------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+----------+\n|100469616 |3           |[Jiankun Gong]                                 |[10.1145/contrib-99660484693, 10.1145/contrib-99660734239, 10.1145/contrib-99660484105]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |3             |100469616 |\n|100865022 |3           |[Yi-Huang Shen]                                |[10.1145/contrib-81479648351, 10.1145/contrib-99660560072, 10.1145/contrib-99660729067]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |3             |100865022 |\n|103008275 |3           |[Yiquan Fang]                                  |[10.1145/contrib-99660095436, 10.1145/contrib-99659898279, 10.1145/contrib-99660733441]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |3             |103008275 |\n|103750594 |2           |[Chengjin Xu]                                  |[10.1145/contrib-99660725589, 10.1145/contrib-99660013192]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |5             |103750594 |\n|116513769 |2           |[Nikolay Kazantsev, Nikolai Kazantsev]         |[10.1145/contrib-99660728649, 10.1145/contrib-99658641283]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |2             |116513769 |\n|122945591 |2           |[Said El Alaoui Ouatik]                        |[10.1145/contrib-99660726640, 10.1145/contrib-99659646268]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |3             |122945591 |\n|1380575050|3           |[Tong Zhou]                                    |[10.1145/contrib-99660729223, 10.1145/contrib-99660380140, 10.1145/contrib-99660001821]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |3             |1380575050|\n|1405207866|2           |[Alan O'Connor, Alan O’Connor]                 |[10.1145/contrib-99660725600, 10.1145/contrib-99659222719]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |2             |1405207866|\n|143702936 |2           |[Chenguang Yang]                               |[10.1145/contrib-99660731370, 10.1145/contrib-81550615156]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |2             |143702936 |\n|143758963 |3           |[Marc Thomas, Mike Thomas]                     |[10.1145/contrib-81430669633, 10.1145/contrib-99660719303, 10.1145/contrib-81350591364]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |6             |143758963 |\n|143863949 |2           |[Jian Dong]                                    |[10.1145/contrib-99660730249, 10.1145/contrib-81100276373]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |8             |143863949 |\n|143916767 |3           |[G. K. Sharma, G. K. Sharma, Gaurav Sharma]    |[10.1145/contrib-87258854257, 10.1145/contrib-81331503762, 10.1145/contrib-99660719033]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |12            |143916767 |\n|144018867 |18          |[Tao Liu, Qian Liu, Taohua Liu]                |[10.1145/contrib-99659334303, 10.1145/contrib-99660361946, 10.1145/contrib-99659338105, 10.1145/contrib-99659865090, 10.1145/contrib-99659670333, 10.1145/contrib-99658969848, 10.1145/contrib-81375621625, 10.1145/contrib-81467665673, 10.1145/contrib-81361608703, 10.1145/contrib-99660630146, 10.1145/contrib-99659924325, 10.1145/contrib-99659254629, 10.1145/contrib-81553104356, 10.1145/contrib-99660733797, 10.1145/contrib-99660626327, 10.1145/contrib-99659989817, 10.1145/contrib-99659576610, 10.1145/contrib-99659484377]|26            |144018867 |\n|144125122 |12          |[Long R. Jiao, Licheng Jiao, Lc Jiao]          |[10.1145/contrib-99659831627, 10.1145/contrib-81541467556, 10.1145/contrib-99659831626, 10.1145/contrib-99660134043, 10.1145/contrib-99660729930, 10.1145/contrib-99660219426, 10.1145/contrib-81548041483, 10.1145/contrib-99659779018, 10.1145/contrib-81413597310, 10.1145/contrib-99659627370, 10.1145/contrib-99659752389, 10.1145/contrib-99659940820]                                                                                                                                                                              |407           |144125122 |\n|144320816 |2           |[Francisco Fraile, Francisco José López Fraile]|[10.1145/contrib-81392598505, 10.1145/contrib-99660726182]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |10            |144320816 |\n|144387987 |3           |[Ayman Atia]                                   |[10.1145/contrib-99659184048, 10.1145/contrib-99660720947, 10.1145/contrib-99660209384]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |7             |144387987 |\n|144420745 |3           |[Mohd. Hasan]                                  |[10.1145/contrib-81350569091, 10.1145/contrib-99660719023, 10.1145/contrib-99659935527]                                                                                                                                                                                                                                                                                                                                                                                                                                                   |6             |144420745 |\n|144552850 |2           |[M. Antony Robert Raj]                         |[10.1145/contrib-99660721470, 10.1145/contrib-99659944020]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |2             |144552850 |\n|144574963 |2           |[Ganshan Yang]                                 |[10.1145/contrib-99659122183, 10.1145/contrib-99660646981]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |2             |144574963 |\n|144808809 |2           |[Dmitry Romanov]                               |[10.1145/contrib-99660730837, 10.1145/contrib-81496666716]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |3             |144808809 |\n+----------+------------+-----------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+----------+\nonly showing top 20 rows\n\n+----------+------------+--------------------+--------------------+--------------+----------+\n|S2authorId|ACMauthorCnt|        oaAuthorName|      acm_author_ids|OAauthorPubCnt|S2authorId|\n+----------+------------+--------------------+--------------------+--------------+----------+\n|  47740650|         235|[J. Bradley Chen,...|[10.1145/contrib-...|           311|  47740650|\n|  48379623|         228|[Yu Zhang, Y. Zha...|[10.1145/contrib-...|           291|  48379623|\n|   1682058|         107|[Haopu Zhang, Hao...|[10.1145/contrib-...|           126|   1682058|\n|   1690341|          58|[Larence T. Yang,...|[10.1145/contrib-...|           411|   1690341|\n|  40457423|          55|[Boyang Li, Yang ...|[10.1145/contrib-...|            77|  40457423|\n|  47067803|          53|         [Hao Jiang]|[10.1145/contrib-...|            96|  47067803|\n|  47909531|          30|           [Yan Liu]|[10.1145/contrib-...|            45|  47909531|\n|  40478976|          30|[Jungcheng Liu, J...|[10.1145/contrib-...|            32|  40478976|\n|  46399556|          27|[Yanggege Liu, Bi...|[10.1145/contrib-...|            32|  46399556|\n|  46509200|          22|[Jing-zhuan Zhao,...|[10.1145/contrib-...|            25|  46509200|\n|  50876633|          18|           [Li Wang]|[10.1145/contrib-...|            19|  50876633|\n| 144018867|          18|[Tao Liu, Qian Li...|[10.1145/contrib-...|            26| 144018867|\n|  39849136|          13|[Xuanze Wang, Xua...|[10.1145/contrib-...|            14|  39849136|\n|  48016309|          13|[Haoyang Wang, Ha...|[10.1145/contrib-...|            13|  48016309|\n| 152496559|          13|[Xiao Xiao, Xiaok...|[10.1145/contrib-...|            18| 152496559|\n| 144125122|          12|[Long R. Jiao, Li...|[10.1145/contrib-...|           407| 144125122|\n|2152666784|          12|[Sung Wan Kim, Su...|[10.1145/contrib-...|            36|2152666784|\n| 145412331|          12|            [Lu Liu]|[10.1145/contrib-...|            20| 145412331|\n|  33006924|          12|[Dongsong Zhang, ...|[10.1145/contrib-...|            49|  33006924|\n|  39362451|          12|[Shanjiang Tang, ...|[10.1145/contrib-...|            32|  39362451|\n+----------+------------+--------------------+--------------------+--------------+----------+\nonly showing top 20 rows\n\n+----------+------------+--------------------+--------------------+--------------+----------+\n|S2authorId|ACMauthorCnt|        oaAuthorName|      acm_author_ids|OAauthorPubCnt|S2authorId|\n+----------+------------+--------------------+--------------------+--------------+----------+\n|  47740650|         235|[J. Bradley Chen,...|[10.1145/contrib-...|           311|  47740650|\n|  40806187|          11|[Qiqi Qi, Qianqin...|[10.1145/contrib-...|            51|  40806187|\n|   1690341|          58|[Larence T. Yang,...|[10.1145/contrib-...|           411|   1690341|\n|  40478976|          30|[Jungcheng Liu, J...|[10.1145/contrib-...|            32|  40478976|\n|  48379623|         228|[Yu Zhang, Y. Zha...|[10.1145/contrib-...|           291|  48379623|\n|   1682058|         107|[Haopu Zhang, Hao...|[10.1145/contrib-...|           126|   1682058|\n| 152496559|          13|[Xiao Xiao, Xiaok...|[10.1145/contrib-...|            18| 152496559|\n| 144940517|           9|[S. Ravi, Selvara...|[10.1145/contrib-...|            76| 144940517|\n| 145457811|           3|[A. S. Tolba, Ahm...|[10.1145/contrib-...|             4| 145457811|\n|  39643451|           7|[Teck Ho, Tse‐Lok...|[10.1145/contrib-...|            26|  39643451|\n| 143916767|           3|[G. K. Sharma, G....|[10.1145/contrib-...|            12| 143916767|\n|2006463434|           4|[Min Sen Chiu, Mi...|[10.1145/contrib-...|             5|2006463434|\n|2107696988|           3|[Lawrence Chang, ...|[10.1145/contrib-...|             4|2107696988|\n|  39849136|          13|[Xuanze Wang, Xua...|[10.1145/contrib-...|            14|  39849136|\n|  46399556|          27|[Yanggege Liu, Bi...|[10.1145/contrib-...|            32|  46399556|\n| 144018867|          18|[Tao Liu, Qian Li...|[10.1145/contrib-...|            26| 144018867|\n| 144125122|          12|[Long R. Jiao, Li...|[10.1145/contrib-...|           407| 144125122|\n|2145116724|           3|[Long Chen, Lei C...|[10.1145/contrib-...|             3|2145116724|\n|  47308956|           2|[J.M. Davila Delg...|[10.1145/contrib-...|             3|  47308956|\n|  48016309|          13|[Haoyang Wang, Ha...|[10.1145/contrib-...|            13|  48016309|\n+----------+------------+--------------------+--------------------+--------------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mrelated_existing_S2authorIds\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [S2authorId: string, ACMauthorCnt: bigint ... 4 more fields]\n"
     }
    ]
   }
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}