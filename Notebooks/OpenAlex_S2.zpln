{
 "paragraphs": [
  {
   "text": "%spark.conf\n\n# It is strongly recommended to set SPARK_HOME explictly instead of using the embedded spark of Zeppelin. As the function of embedded spark of Zeppelin is limited and can only run in local mode.\n\n#SPARK_HOME /home/ometaxas/Programs/spark-3.1.2-bin-hadoop3.2\nSPARK_HOME /home/ometaxas/Programs/spark-3.2.0-bin-hadoop3.2\n#SPARK_HOME /home/ometaxas/Programs/spark-3.3.1-bin-hadoop3\n\nSPARK_LOCAL_DIRS /media/ometaxas/nvme/spark\n\n#com.github.haifengl:smile-scala_2.12:2.5.3,com.databricks:spark-xml_2.12:0.10.0,com.github.mrpowers:spark-stringmetric_2.12:0.3.0\n\n#spark.jars /home/ometaxas/Programs/spark-3.1.2-bin-hadoop3.2/plugins/cudf-21.10.0-cuda11.jar, /home/ometaxas/Programs/spark-3.0\n#.1-bin-hadoop3.2/plugins/rapids-4-spark_2.12-21.10.0.jar\n\n#spark.sql.warehouse.dir /home/ometaxas/Programs/zeppelin-0.9.0-preview2-bin-all/spark-warehouse\n\n#spark.kryo.registrator com.nvidia.spark.rapids.GpuKryoRegistrator\nspark.serializer org.apache.spark.serializer.KryoSerializer\nspark.kryoserializer.buffer.max 1000M\nspark.driver.memory 80g\nspark.driver.maxResultSize 5g \n\n#spark.rapids.sql.concurrentGpuTasks=2\n#spark.rapids.sql.enabled true\n#spark.rapids.memory.pinnedPool.size 2G \n\n#spark.plugins com.nvidia.spark.SQLPlugin \n\n#spark.sql.autoBroadcastJoinThreshold 1\n#spark.sql.join.preferSortMergeJoin true\n#spark.locality.wait 0s \n#spark.sql.files.maxPartitionBytes 512m \n#spark.sql.shuffle.partitions 100 \n \n#spark.executor.resource.gpu.amount=1\n\n#, /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/tmp\n                                             \n# /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/tmp,/media/datadisk/Datasets/Spark\n#,/media/datadisk/Datasets/Spark \n#/media/datadisk/Datasets/Spark\n\n# set executor memrory 110g\n# spark.executor.memory  60g\n\n\n# set executor number to be 6\n# spark.executor.instances  6\n\n\n# Uncomment the following line if you want to use yarn-cluster mode (It is recommended to use yarn-cluster mode after Zeppelin 0.8, as the driver will run on the remote host of yarn cluster which can mitigate memory pressure of zeppelin server)\n# master yarn-cluster\n\n# Uncomment the following line if you want to use yarn-client mode (It is not recommended to use it after 0.8. Because it would launch the driver in the same host of zeppelin server which will increase memory pressure of zeppelin server)\n# master yarn-client\n\n# Uncomment the following line to enable HiveContext, and also put hive-site.xml under SPARK_CONF_DIR\n# zeppelin.spark.useHiveContext true\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-09 17:49:13.212",
   "progress": 0.0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12.0,
    "editorMode": "ace/mode/scala",
    "fontSize": 9.0,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670444422396_1109408681",
   "id": "paragraph_1670444422396_1109408681",
   "dateCreated": "2022-12-07T22:20:22+0200",
   "dateStarted": "2022-12-09 17:49:13.134",
   "dateFinished": "2022-12-09 17:49:13.212",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": []
   }
  },
  {
   "title": "S2 to Parquet",
   "text": "%spark\n\nval S2_HOME = \"/media/datadisk/Datasets/SemanticScholar/2022-11-11/papers\"\nval S2_sample = \"/media/datadisk/Datasets/SemanticScholar/2022-11-11/papers/20221111_080504_00014_xy2un_1c8b6645-d9f6-4a6c-9a4e-74bdde30fb92.gz\"\n\nimport  org.apache.spark.sql.functions._\n\n\n//Get Semantic Scholar articles \nval S2articlesdf = spark.read.json(s\"file://$S2_HOME\")\n\n//val S2articlesdf = spark.read.json(s\"file://$S2_sample\")\n//S2articlesdf.printSchema\n//S2articlesdf.show(5)\n//println(\"S2articlesdf  cnt:\"+S2articlesdf.count())\nS2articlesdf.write.mode(\"overwrite\").parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\n/*\n\nval S2subsetdf = S2articlesdf\n             //.join(broadcast(doisdf), lower(S2articlesdf(\"doi\"))===doisdf(\"doi\"), \"inner\")\n             //.filter(($\"magId\" =!= \"\") && ($\"magId\".isNotNull))\n             .select($\"title\", $\"id\",lower(S2articlesdf(\"doi\")).as(\"doi\"), $\"doiUrl\",$\"entities\", $\"magId\", $\"fieldsOfStudy\".as(\"S2fos\"), $\"pmid\".as(\"pmId\"), \n                 $\"inCitations\", $\"outCitations\", $\"authors\", $\"journalName\", $\"venue\", $\"year\", $\"paperAbstract\", $\"s2PdfUrl\", $\"s2Url\", $\"sources\")\n\n//S2subsetdf.printSchema\n//S2subsetdf.show(10,false)\nSubsetdf.write.mode(\"overwrite\").parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\n\n*/\n",
   "user": "anonymous",
   "dateUpdated": "2022-11-28T15:06:06+0200",
   "progress": 96.0,
   "config": {
    "title": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mS2_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/datadisk/Datasets/SemanticScholar/2022-11-11/papers\n\u001b[1m\u001b[34mS2_sample\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/datadisk/Datasets/SemanticScholar/2022-11-11/papers/20221111_080504_00014_xy2un_1c8b6645-d9f6-4a6c-9a4e-74bdde30fb92.gz\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34mS2articlesdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<authorId:string,name:string>>, citationcount: bigint ... 14 more fields]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=4"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=5"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1669640766588_871741978",
   "id": "paragraph_1669640766588_871741978",
   "dateCreated": "2022-11-28T15:06:06+0200",
   "dateStarted": "2022-11-28T15:06:06+0200",
   "dateFinished": "2022-11-28T15:38:36+0200",
   "status": "FINISHED"
  },
  {
   "title": "Count Authors & Pubs in S2",
   "text": "%spark\nimport org.apache.spark.sql.functions.countDistinct;\n\nval S2_df = spark.read.parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\nval listValues = Seq(\"9444\",\"189538\",\"192656\",\"761215\",\"1388579\")\nS2_df.filter($\"corpusid\".isin(listValues:_*)).show(false)\n/*\n//println(\"S2_df  cnt:\"+S2_df.count())\n//207207224\nS2_df.printSchema()\n\nval stmp = S2_df.select($\"corpusid\", explode($\"authors.authorId\").as(\"authorId\"))\n        //.show(10)\n//stmp.filter($\"authorId\"===\"\"  && $\"authorId\".isNull)\n//stmp.select(countDistinct(array_max($\"authorId\"))).show(10)\nstmp.select(countDistinct($\"authorId\")).show(10)\n//78998524 \n*/",
   "user": "anonymous",
   "dateUpdated": "2022-12-08 19:08:05.427",
   "progress": 97.0,
   "config": {
    "title": true,
    "editorHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=12"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=13"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1669642964581_1924922475",
   "id": "paragraph_1669642964581_1924922475",
   "dateCreated": "2022-11-28T15:42:44+0200",
   "dateStarted": "2022-12-08 19:06:04.438",
   "dateFinished": "2022-12-08 19:08:05.426",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+----------------------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+---------------------------------------------------------------------------------------+------------------------+------------+--------------------------------------------------+---------------+----------------+--------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------+------------------------+------------------------------------------------------------------------------+-----------------------------------+----+\n|authors                                                                                                                                             |citationcount|corpusid|externalids                                                                            |influentialcitationcount|isopenaccess|journal                                           |publicationdate|publicationtypes|referencecount|s2fieldsofstudy                                                                           |title                                                                                                                          |updated                 |url                                                                           |venue                              |year|\n+----------------------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+---------------------------------------------------------------------------------------+------------------------+------------+--------------------------------------------------+---------------+----------------+--------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------+------------------------+------------------------------------------------------------------------------+-----------------------------------+----+\n|[{1442900530, Chun-Yen Chang}, {2086991524, Sun-Jay Chang}, {1443687851, Tien-Sheng Chao}, {2086991494, Sung-Dtr Wu}, {1442186302, Tiao-Yuan Huang}]|3            |9444    |{null, null, 9444, null, null, null, null, null}                                       |1                       |false       |{IEEE Electron Device Letters, 460-462, 21}       |null           |null            |14            |null                                                                                      |Reduced reverse narrow channel effect in thin SOI nMOSFETs                                                                     |2022-08-24T23:34:09.826Z|https://www.semanticscholar.org/paper/2809dd60115ebc69238650cec21a1e2d4219573b|IEEE Electron Device Letters       |2000|\n|[{2085325783, Hu Qingying}, {2108848816, Hongwei Zhang}]                                                                                            |2            |761215  |{null, null, 761215, null, null, null, null, null}                                     |0                       |false       |null                                              |null           |null            |25            |null                                                                                      |BLOWUP AND ASYMPTOTIC STABILITY OF WEAK SOLUTIONS TO WAVE EQUATIONS WITH NONLINEAR DEGENERATE DAMPING AND SOURCE TERMS         |2022-09-07T03:15:35.858Z|https://www.semanticscholar.org/paper/4e6c9f0d0b57be82b2222615c6047c12eef6c937|                                   |2007|\n|[{1844610353, Ning Ma}, {2108060438, Yijun Liu}, {1786077, Ruya Tian}, {144836951, Qianqian Li}]                                                    |3            |1388579 |{null, null, 1388579, conf/amt/MaLTL12, 10.1007/978-3-642-35236-2_48, null, null, null}|0                       |false       |{null, 483-492, null}                             |null           |[JournalArticle]|10            |[{Business, s2-fos-model}, {Computer Science, s2-fos-model}, {Computer Science, external}]|Recognition of Online Opinion Leaders Based on Social Network Analysis                                                         |2022-09-04T23:32:11.887Z|https://www.semanticscholar.org/paper/f04257f9d49f3eae3a66194b8de4b83855eac1a4|AMT                                |2012|\n|[{113563655, Jinliang He}, {30823570, Shanqiang Gu}, {31121381, Shejiao Han}, {113332096, Shuiming Chen}, {33066505, Guozheng Xu}]                  |0            |192656  |{null, null, 192656, null, null, null, null, null}                                     |0                       |false       |{IEEE Transactions on Power Delivery, 577-583, 21}|null           |null            |14            |null                                                                                      |Voltage distribution analysis of 500-kV DC transmission-line voltage divider under impulse voltages: stray parameter extraction|2022-02-13T15:51:20.163Z|https://www.semanticscholar.org/paper/29cb894e0e15845580fa867983376f8e4330c794|IEEE Transactions on Power Delivery|2006|\n|[{2095380504, WU Xiang-Yang}, {10727138, Peng Qun-sheng}, {9204593, Zhang Hong-xin}, {2111631336, Chen Wei}, {2060816189, Liu Gang}]                |0            |189538  |{null, null, 189538, null, null, null, null, null}                                     |0                       |false       |null                                              |null           |null            |21            |null                                                                                      |A real-time global relighting algorithm                                                                                        |2022-02-13T15:48:51.768Z|https://www.semanticscholar.org/paper/6303bfc6ac24b5e7303c4edf57e5db37346b0731|                                   |2005|\n+----------------------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+---------------------------------------------------------------------------------------+------------------------+------------+--------------------------------------------------+---------------+----------------+--------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------+------------------------+------------------------------------------------------------------------------+-----------------------------------+----+\n\nimport org.apache.spark.sql.functions.countDistinct\n\u001b[1m\u001b[34mS2_df\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<authorId:string,name:string>>, citationcount: bigint ... 14 more fields]\n\u001b[1m\u001b[34mlistValues\u001b[0m: \u001b[1m\u001b[32mSeq[String]\u001b[0m = List(9444, 189538, 192656, 761215, 1388579)\n"
     }
    ]
   }
  },
  {
   "text": "%spark\nimport org.apache.commons.lang3.StringUtils\nimport java.util.Locale;\n\n  def shortNormNameString( fullName: String) : String = {\n\n      if (fullName != null) {\n          val normname = org.apache.commons.lang3.StringUtils.stripAccents(fullName.toLowerCase(Locale.ENGLISH))\n                  //.replaceAll(\"[^\\\\p{ASCII}]\", \"\")\n                  .replaceAll(\"[<>:´,’./\\\\'\\\\\\\";(){}!@#$%^&+‐–*\\\\\\\\-]+\", \"\")\n                  .replaceAll(\"Æ\", \"AE\")\n                  .replaceAll(\"Ð\", \"D\")\n                  .replaceAll(\"Ø\", \"O\")\n                  .replaceAll(\"Þ\", \"TH\")\n                  .replaceAll(\"ß\", \"ss\")\n                  .replaceAll(\"ð\", \"d\")\n                  .replaceAll(\"æ\", \"ae\")\n                  .replaceAll(\"ø\", \"o\")\n                  .replaceAll(\"þ\", \"th\")\n                  .replaceAll(\"Œ\", \"OE\")\n                  .replaceAll(\"œ\", \"oe\")\n                  .replaceAll(\"ƒ\", \"f\")\n                  .trim().split(\" \")\n\n\n          val shortName = if (normname.length == 1) normname(0) else normname(0).take(1) + normname(normname.length - 1)\n          return shortName\n      }\n      else null\n  }\n   \nval shortNormName = udf[String, String]((e:String) => {\n    \n    shortNormNameString(e)\n    \n})\n\nspark.udf.register(\"shortNormName\", shortNormName)\n\nval shortNormNameList = udf[Seq[String], Seq[String]]((e:Seq[String]) => {\n    if (e!=null && e.size>0) {\n        e.map{x=> shortNormNameString(x)}        \n    }\n    else e\n})\nspark.udf.register(\"shortNormNameList\", shortNormNameList)\n\nval normName = udf[String, String]((e:String) => {\n \n if (e!=null) {\n     org.apache.commons.lang3.StringUtils.stripAccents(e.toLowerCase(Locale.ENGLISH))\n             .replaceAll(\"[ <>:´,’./\\\\'\\\\\\\";(){}!@#$%^&+‐–*\\\\\\\\-]+\", \"\")\n             .replaceAll(\"Æ\", \"AE\")\n             .replaceAll(\"Ð\", \"D\")\n             .replaceAll(\"Ø\", \"O\")\n             .replaceAll(\"Þ\", \"TH\")\n             .replaceAll(\"ß\", \"ss\")\n             .replaceAll(\"ð\", \"d\")\n             .replaceAll(\"æ\", \"ae\")\n             .replaceAll(\"ø\", \"o\")\n             .replaceAll(\"þ\", \"th\")\n             .replaceAll(\"Œ\", \"OE\")\n             .replaceAll(\"œ\", \"oe\")\n             .replaceAll(\"ƒ\", \"f\")\n             .trim()\n }\n else e\n     \n})\n\nspark.udf.register(\"normName\", normName)\n\nval workAbstractFromInverted = udf[String, Option[Map[String, Seq[Long]]]]((e:Option[Map[String, Seq[Long]]]) => {\n    \n   \n   val list = e.getOrElse(Map()).toList.flatMap { x => x._2.toList.map { e => (x._1, e) } }\n    list.sortBy(_._2).map(_._1).mkString(\" \")\n})\n\nspark.udf.register(\"workAbstractFromInverted\", workAbstractFromInverted)\n\nval removeDoiPrefix = udf[String, String]((e:String) => {\n   if (e!=null) {\n       e.replace(\"https://doi.org/\", \"\")\n   }\n    else e\n})\nspark.udf.register(\"removeDoiPrefix\", removeDoiPrefix)\n\n\n\nval removeOpenAlexPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://openalex.org/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removeOpenAlexPrefix\", removeOpenAlexPrefix)\n\n\nval removeOpenAlexPrefixList = udf[Seq[String], Seq[String]]((e:Seq[String]) => {\n    if (e!=null && e.size>0) {\n        e.map{x=> if (x==null) null else x.replace(\"https://openalex.org/\", \"\")}        \n    }\n    else e\n})\nspark.udf.register(\"removeOpenAlexPrefixList\", removeOpenAlexPrefixList)\n\n\nval removeWikiDataPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://www.wikidata.org/wiki/\", \"\").replace(\"http://www.wikidata.org/wiki/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removeWikiDataPrefix\", removeWikiDataPrefix)\n\nval removeOrcidPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://orcid.org/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removeOrcidPrefix\", removeOrcidPrefix)\n\nval removePmcPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://pubmed.ncbi.nlm.nih.gov/\", \"\")\n    }\n    else e\n   \n})\nspark.udf.register(\"removePmcPrefix\", removePmcPrefix)\n\nval removePubmedPrefix = udf[String, String]((e:String) => {\n    if (e!=null) {\n        e.replace(\"https://pubmed.ncbi.nlm.nih.gov/\", \"\")\n    }\n    else e\n})\nspark.udf.register(\"removePubmedPrefix\", removePubmedPrefix)\n\n\n\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-09 17:49:54.141",
   "progress": 0.0,
   "config": {},
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670430955490_1185020559",
   "id": "paragraph_1670430955490_1185020559",
   "dateCreated": "2022-12-07T18:35:55+0200",
   "dateStarted": "2022-12-09 17:49:37.653",
   "dateFinished": "2022-12-09 17:49:54.141",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "import org.apache.commons.lang3.StringUtils\nimport java.util.Locale\n\u001b[1m\u001b[34mshortNormNameString\u001b[0m: \u001b[1m\u001b[32m(fullName: String)String\u001b[0m\n\u001b[1m\u001b[34mshortNormName\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = SparkUserDefinedFunction($Lambda$2583/0x00007f04a3791040@b9603a,StringType,List(Some(class[value[0]: string])),Some(class[value[0]: string]),None,true,true)\n\u001b[1m\u001b[34mshortNormNameList\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = SparkUserDefinedFunction($Lambda$2690/0x00007f04a30f5040@3fbab6e1,ArrayType(StringType,true),List(Some(class[value[0]: array<string>])),Some(class[value[0]: array<string>]),None,true,true)\n\u001b[1m\u001b[34mnormName\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.UserDefinedFunction\u001b[0m = SparkUserDefinedFunction...\n"
     }
    ]
   }
  },
  {
   "title": "Open Alex to Parquet",
   "text": "%spark\n//import org.apache.spark.sql.types.{DataType, StructType}\nimport org.apache.spark.sql.types._                        \nimport org.apache.spark.sql.functions._   \n\nval OA_HOME = \"/media/datadisk/Datasets/OpenAlex/openalex-snapshot/data\"\nval WORKS_PATH = \"/works\"\n//val WORKS_PATH = \"/works/updated_date=2022-09-22\" \n\n//val WORKS_PATH = \"/samplework.json\"\n// /part_000.gz\"\n\n\nval jsonStringfull = \"{\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"abstract_inverted_index\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"alternate_host_venues\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": \\\"string\\\",\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"authorships\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"author\\\",\\\"type\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"display_name\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"id\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"orcid\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"author_position\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"institutions\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"display_name\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"id\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"type\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"country_code\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"ror\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"raw_affiliation_string\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"biblio\\\",\\\"type\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"first_page\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"issue\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"last_page\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"volume\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"cited_by_api_url\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"cited_by_count\\\",\\\"type\\\": \\\"long\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"concepts\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"display_name\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"id\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"level\\\",\\\"type\\\": \\\"long\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"score\\\",\\\"type\\\": \\\"double\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"wikidata\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"counts_by_year\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": \\\"string\\\",\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"created_date\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"display_name\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"doi\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"host_venue\\\",\\\"type\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"display_name\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"id\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"is_oa\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"issn\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"issn_l\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"license\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"publisher\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"type\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"url\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"version\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"id\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"ids\\\",\\\"type\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"mag\\\",\\\"type\\\": \\\"long\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"openalex\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"doi\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"pmid\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"pmcid\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"is_paratext\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"is_retracted\\\",\\\"type\\\": \\\"boolean\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"mesh\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": \\\"string\\\",\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"open_access\\\",\\\"type\\\": {\\\"type\\\": \\\"struct\\\",\\\"fields\\\": [{\\\"name\\\": \\\"is_oa\\\",\\\"type\\\": \\\"boolean\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"oa_status\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"oa_url\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"publication_date\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"publication_year\\\",\\\"type\\\": \\\"long\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"referenced_works\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": \\\"string\\\",\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"related_works\\\",\\\"type\\\": {\\\"type\\\": \\\"array\\\",\\\"elementType\\\": \\\"string\\\",\\\"containsNull\\\": true},\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"title\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"type\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}},{\\\"name\\\": \\\"updated_date\\\",\\\"type\\\": \\\"string\\\",\\\"nullable\\\": true,\\\"metadata\\\": {}}]}\"\n\nval schemaFromJson =  DataType.fromJson(jsonStringfull).asInstanceOf[StructType]\n\n//println(schemaFromJson)\n\n//val work_1 = spark.read.option(\"pathGlobFilter\", \"*.gz\").schema(schemaFromJson).json(s\"$OA_HOME$WORKS_PATH\")\nval work_1 = spark.read.schema(schemaFromJson).json(s\"$OA_HOME$WORKS_PATH\")\n        \nimport org.apache.spark.sql.types._                        \nimport org.apache.spark.sql.functions._   \n\n//work_1.filter($\"abstract_inverted_index\".isNotNull).select($\"abstract_inverted_index\").show(10, false)\nwork_1.printSchema()\n//work_1.show(5, false)\n//work_1.select()\n//work_1.filter($\"authorships.institutions\".isNotNull).select($\"authorships.institutions\",$\"concepts.display_name\", $\"authorships.raw_affiliation_string\").show(30, false)\n\n\n\nval work = work_1\n        .withColumn(\"abstractInvertedMap\",from_json(col(\"abstract_inverted_index\"),MapType(StringType, ArrayType(LongType, true))))\n        .withColumn(\"abstract\", workAbstractFromInverted(col(\"abstractInvertedMap\")) )\n        .withColumn(\"abstract\", workAbstractFromInverted(col(\"abstractInvertedMap\")) )\n        \n       \n\n//  work.filter($\"abstract_inverted_index\".isNotNull).select($\"abstract\", $\"abstractInvertedMap\", $\"abstract_inverted_index\").show(10, false)\n\nwork.drop($\"abstractInvertedMap\").drop($\"abstract_inverted_index\").drop($\"counts_by_year\").write.mode(\"overwrite\").parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")",
   "user": "anonymous",
   "dateUpdated": "2022-12-03T16:14:42+0200",
   "progress": 99.0,
   "config": {
    "title": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- abstract_inverted_index: string (nullable = true)\n |-- alternate_host_venues: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- authorships: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- author: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- orcid: string (nullable = true)\n |    |    |-- author_position: string (nullable = true)\n |    |    |-- institutions: array (nullable = true)\n |    |    |    |-- element: struct (containsNull = true)\n |    |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |    |-- id: string (nullable = true)\n |    |    |    |    |-- type: string (nullable = true)\n |    |    |    |    |-- country_code: string (nullable = true)\n |    |    |    |    |-- ror: string (nullable = true)\n |    |    |-- raw_affiliation_string: string (nullable = true)\n |-- biblio: struct (nullable = true)\n |    |-- first_page: string (nullable = true)\n |    |-- issue: string (nullable = true)\n |    |-- last_page: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- cited_by_api_url: string (nullable = true)\n |-- cited_by_count: long (nullable = true)\n |-- concepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- level: long (nullable = true)\n |    |    |-- score: double (nullable = true)\n |    |    |-- wikidata: string (nullable = true)\n |-- counts_by_year: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- created_date: string (nullable = true)\n |-- display_name: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- host_venue: struct (nullable = true)\n |    |-- display_name: string (nullable = true)\n |    |-- id: string (nullable = true)\n |    |-- is_oa: string (nullable = true)\n |    |-- issn: string (nullable = true)\n |    |-- issn_l: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- publisher: string (nullable = true)\n |    |-- type: string (nullable = true)\n |    |-- url: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- id: string (nullable = true)\n |-- ids: struct (nullable = true)\n |    |-- mag: long (nullable = true)\n |    |-- openalex: string (nullable = true)\n |    |-- doi: string (nullable = true)\n |    |-- pmid: string (nullable = true)\n |    |-- pmcid: string (nullable = true)\n |-- is_paratext: string (nullable = true)\n |-- is_retracted: boolean (nullable = true)\n |-- mesh: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- open_access: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- oa_status: string (nullable = true)\n |    |-- oa_url: string (nullable = true)\n |-- publication_date: string (nullable = true)\n |-- publication_year: long (nullable = true)\n |-- referenced_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- related_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- title: string (nullable = true)\n |-- type: string (nullable = true)\n |-- updated_date: string (nullable = true)\n\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34mOA_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/datadisk/Datasets/OpenAlex/openalex-snapshot/data\n\u001b[1m\u001b[34mWORKS_PATH\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /works\n\u001b[1m\u001b[34mjsonStringfull\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = {\"type\": \"struct\",\"fields\": [{\"name\": \"abstract_inverted_index\",\"type\": \"string\",\"nullable\": true,\"metadata\": {}},{\"name\": \"alternate_host_venues\",\"type\": {\"type\": \"array\",\"elementType\": \"string\",\"containsNull\": true},\"nullable\": true,\"metadata\": {}},{\"name\": \"authorships\",\"type\": {\"type\": \"array\",\"elementType\": {\"type\": \"struct\",\"fields\": [{\"name\": \"author\",\"type\": {\"type\": \"struct\",\"fields\": [{\"name\": \"display_name\",\"type\": \"string\",\"nullable\": true,\"metadata\": {}},{\"name\": \"id\",\"type\": \"string\",\"nullable\": ...\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=183"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=184"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670076882653_1959674661",
   "id": "paragraph_1670076882653_1959674661",
   "dateCreated": "2022-12-03T16:14:42+0200",
   "dateStarted": "2022-12-03T16:14:42+0200",
   "dateFinished": "2022-12-03T19:34:39+0200",
   "status": "FINISHED"
  },
  {
   "title": "Stats for OpenAlex",
   "text": "%spark\nval works =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\n\n// Reduced reverse narrow channel effect in thin SOI nMOSFETs 10.1109/55.863111\n\nworks.filter(lower(removeDoiPrefix(works(\"doi\")))===\"10.1007/978-3-642-35236-2_48\" || lower(removeDoiPrefix(works(\"doi\")))===\"10.1109/55.863111\").show(false)\n\n\n//{null, null, 1388579, conf/amt/MaLTL12, 10.1007/978-3-642-35236-2_48, null, null, null}\n\n//works.select($\"authorships.institutions\", $\"authorships.raw_affiliation_string\").show(1000)\n/*\nworks.printSchema()\nprintln(\"cnt:\"+works.count())\n\nval workswithdoi = works.filter(($\"doi\" =!= \"\") && ($\"doi\".isNotNull))\nprintln(\"workswithdoi  cnt:\"+workswithdoi.count())\n//cnt:245016719\n//workswithdoi  cnt:140216633\n\nval works_author_is = works.select($\"id\", explode($\"authorships.author.id\").as(\"authorId\"))\nworks_author_is.select(countDistinct($\"authorId\")).show(10)\n//261178288\n*/\n//val retracted_cnt = works.filter($\"is_retracted\")\n//println(\"retracted_cnt  cnt:\"+retracted_cnt.count())\n//9732\n\n//works.select($\"doi\", $\"ids.doi\").show(10)\n//works.show(10)\n\n/*\n\nval retracted_cnt2015 = works.filter($\"is_retracted\" && $\"publication_year\" === 2015)\nprintln(\"retracted_cnt2015  cnt:\"+retracted_cnt2015.count())\n\nval retracted_cnt2016 = works.filter($\"is_retracted\" && $\"publication_year\" === 2016)\nprintln(\"retracted_cnt2016  cnt:\"+retracted_cnt2016.count())\n\nval retracted_cnt2017 = works.filter($\"is_retracted\" && $\"publication_year\" === 2017)\nprintln(\"retracted_cnt2017  cnt:\"+retracted_cnt2017.count())\n\nval retracted_cnt2018 = works.filter($\"is_retracted\" && $\"publication_year\" === 2018)\nprintln(\"retracted_cnt2018  cnt:\"+retracted_cnt2018.count())\n\nval retracted_cnt2019 = works.filter($\"is_retracted\" && $\"publication_year\" === 2019)\nprintln(\"retracted_cnt2019  cnt:\"+retracted_cnt2019.count())\n\nval retracted_cnt2020 = works.filter($\"is_retracted\" && $\"publication_year\" === 2020)\nprintln(\"retracted_cnt2020  cnt:\"+retracted_cnt2020.count())\n\nval retracted_cnt2021 = works.filter($\"is_retracted\" && $\"publication_year\" === 2021)\nprintln(\"retracted_cnt2021  cnt:\"+retracted_cnt2021.count())\n*/\n//[{\"id\":\"https://openalex.org/V4306400349\",\"display_name\":\"The Pennsylvania State University - CiteSeer X\",\"type\":\"repository\",\"url\":\"https://ir.nctu.edu.tw:443/bitstream/11536/30284/1/000089132500014.pdf\",\"is_oa\":true,\"version\":\"publishedVersion\",\"license\":null}]\n\n//&& $\"publication_year\">2000\n/*\nval workswithabstract = works.filter(($\"host_venue.publisher\".contains(\"Wiley\") || $\"host_venue.publisher\".contains(\"wiley\")) && (($\"abstract_inverted_index\" =!= \"{}\") && ($\"abstract_inverted_index\".isNotNull)))\nprintln(\"workswithabstract  cnt:\"+workswithabstract.count())\n\nval worksnoabstract = works.filter(($\"host_venue.publisher\".contains(\"Wiley\") || $\"host_venue.publisher\".contains(\"wiley\"))  && (($\"abstract_inverted_index\" === \"{}\") || ($\"abstract_inverted_index\".isNull)))\nprintln(\"worksnoabstract  cnt:\"+worksnoabstract.count())\n*/\n//full\n//workswithabstract  cnt:8335978\n//worksnoabstract  cnt:152047\n    ",
   "user": "anonymous",
   "dateUpdated": "2022-12-08 19:36:16.369",
   "progress": 79.0,
   "config": {
    "title": true,
    "tableHide": true
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=185"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=186"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=187"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670091373327_110293791",
   "id": "paragraph_1670091373327_110293791",
   "dateCreated": "2022-12-03T20:16:13+0200",
   "dateStarted": "2022-12-08 19:16:25.791",
   "dateFinished": "2022-12-08 19:36:16.369",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------+-------------------------------------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+----------------------------------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------+------------------------------------------------------------------------------------------------------+-----------+------------+----+-------------------------------------------------------------------------------------+----------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------+---------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|alternate_host_venues                                                                                                                                                                                                                                                  |authorships                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |biblio                  |cited_by_api_url                                       |cited_by_count|concepts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |created_date|display_name                                                          |doi                                         |host_venue                                                                                                                                                                                                                          |id                              |ids                                                                                                   |is_paratext|is_retracted|mesh|open_access                                                                          |publication_date|publication_year|referenced_works                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |related_works                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |title                                                                 |type           |updated_date|abstract                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |\n+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------+-------------------------------------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+----------------------------------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------+------------------------------------------------------------------------------------------------------+-----------+------------+----+-------------------------------------------------------------------------------------+----------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------+---------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|[{\"id\":\"https://openalex.org/V4306400349\",\"display_name\":\"The Pennsylvania State University - CiteSeer X\",\"type\":\"repository\",\"url\":\"https://ir.nctu.edu.tw:443/bitstream/11536/30284/1/000089132500014.pdf\",\"is_oa\":true,\"version\":\"publishedVersion\",\"license\":null}]|[{{Chun-Yen Chang, https://openalex.org/A2154237833, https://orcid.org/0000-0001-6244-1977}, first, [{National Yang Ming Chiao Tung University, https://openalex.org/I148366613, education, TW, https://ror.org/00se2k293}], Inst. of Electron., Nat. Chiao-Tung Univ., Hsinchu, Taiwan}, {{Sun-Jay Chang, https://openalex.org/A2159892293, null}, middle, [{NATIONAL YANG MING CHIAO TUNG UNIVERSITY, null, null, null, null}], NATIONAL YANG MING CHIAO TUNG UNIVERSITY}, {{Tien-Sheng Chao, https://openalex.org/A2129553643, https://orcid.org/0000-0001-9618-207X}, middle, [{Department of Electrophysics, null, null, null, null}], Department of Electrophysics}, {{Sung-Dtr Wu, https://openalex.org/A2691002077, null}, middle, [{NATIONAL YANG MING CHIAO TUNG UNIVERSITY, null, null, null, null}], NATIONAL YANG MING CHIAO TUNG UNIVERSITY}, {{Tiao-Yuan Huang, https://openalex.org/A2096792833, null}, last, [{National Yang Ming Chiao Tung University, https://openalex.org/I148366613, education, TW, https://ror.org/00se2k293}], National Yang Ming Chiao Tung University}]                                                                                                                                                      |{null, null, null, null}|https://api.openalex.org/works?filter=cites:W2121893617|13            |[{Silicon on insulator, https://openalex.org/C53143962, 3, 0.89652056, https://www.wikidata.org/wiki/Q1478788}, {LOCOS, https://openalex.org/C195114451, 4, 0.8621814, https://www.wikidata.org/wiki/Q1798244}, {Materials science, https://openalex.org/C192562407, 0, 0.81816864, https://www.wikidata.org/wiki/Q228736}, {Silicon, https://openalex.org/C544956773, 2, 0.7184945, https://www.wikidata.org/wiki/Q670}, {Threshold voltage, https://openalex.org/C195370968, 4, 0.6915704, https://www.wikidata.org/wiki/Q1754002}, {Reverse short-channel effect, https://openalex.org/C33556034, 5, 0.6668261, https://www.wikidata.org/wiki/Q7318266}, {Optoelectronics, https://openalex.org/C49040817, 1, 0.64945704, https://www.wikidata.org/wiki/Q193091}, {MOSFET, https://openalex.org/C2778413303, 4, 0.526857, https://www.wikidata.org/wiki/Q210793}, {Transistor, https://openalex.org/C172385210, 3, 0.474942, https://www.wikidata.org/wiki/Q5339}, {Voltage, https://openalex.org/C165801399, 2, 0.31928885, https://www.wikidata.org/wiki/Q25428}, {Electrical engineering, https://openalex.org/C119599485, 1, 0.31801546, https://www.wikidata.org/wiki/Q43035}, {Monocrystalline silicon, https://openalex.org/C26953177, 3, 0.115184456, https://www.wikidata.org/wiki/Q3960534}, {Engineering, https://openalex.org/C127413603, 0, 0.0, https://www.wikidata.org/wiki/Q11023}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |2016-06-24  |Reduced reverse narrow channel effect in thin SOI nMOSFETs            |https://doi.org/10.1109/55.863111           |{IEEE Electron Device Letters, https://openalex.org/V19887683, true, [\"1558-0563\",\"0741-3106\"], 0741-3106, null, Institute of Electrical and Electronics Engineers, repository, https://doi.org/10.1109/55.863111, publishedVersion}|https://openalex.org/W2121893617|{2121893617, https://openalex.org/W2121893617, https://doi.org/10.1109/55.863111, null, null}         |false      |false       |[]  |{true, green, https://ir.nctu.edu.tw:443/bitstream/11536/30284/1/000089132500014.pdf}|2000-09-01      |2000            |[https://openalex.org/W1528549966, https://openalex.org/W1532286045, https://openalex.org/W1828670942, https://openalex.org/W2100150555, https://openalex.org/W2106538926, https://openalex.org/W2116419873, https://openalex.org/W2116506989, https://openalex.org/W2135508850, https://openalex.org/W2153253339, https://openalex.org/W2165677467, https://openalex.org/W2166890288, https://openalex.org/W2497389460, https://openalex.org/W2533651815, https://openalex.org/W2537113341, https://openalex.org/W2537589677]|[https://openalex.org/W1501180091, https://openalex.org/W1582906288, https://openalex.org/W1949657941, https://openalex.org/W1985759518, https://openalex.org/W2008533349, https://openalex.org/W2014210266, https://openalex.org/W2034941434, https://openalex.org/W2048392431, https://openalex.org/W2057073803, https://openalex.org/W2096828677, https://openalex.org/W2099446910, https://openalex.org/W2111932862, https://openalex.org/W2115175380, https://openalex.org/W2117879497, https://openalex.org/W2152304858, https://openalex.org/W2159779888, https://openalex.org/W2166890288, https://openalex.org/W2168820569, https://openalex.org/W2547037583, https://openalex.org/W2555698185]|Reduced reverse narrow channel effect in thin SOI nMOSFETs            |journal-article|2022-10-27  |The effects of narrow channel width on the threshold voltage of deep submicron silicon-on-insulator (SOI) nMOSFETs with LOCOS isolation have been investigated. The reverse narrow channel effect (RNCE) in SOI devices is found to be dependent on the thickness of the active silicon film. A thinner silicon film is found to depict less threshold voltage fall-off. These results can be explained by a reduced oxide/silicon interface area in the transistor width direction, thus the boron segregation due to silicon interstitials with high recombination rate is reduced.                                                                                                                                                                                                                                                              |\n|[]                                                                                                                                                                                                                                                                     |[{{Ma Ning, https://openalex.org/A1826675856, null}, first, [{University of Chinese Academy of Sciences, https://openalex.org/I4210165038, education, CN, https://ror.org/05qbk4x57}], Institute of Policy and Management, Chinese Academy of Sciences, Beijing, China, Graduate University of Chinese Academy of Sciences, Beijing, China#TAB#}, {{Liu Yijun, https://openalex.org/A2080237121, null}, middle, [{Institute of Policy & Management, Chinese Academy of Sciences, Beijing, China, null, null, null, null}], Institute of Policy & Management, Chinese Academy of Sciences, Beijing, China}, {{Tian Ruya, https://openalex.org/A230799947, null}, middle, [{University of Chinese Academy of Sciences, https://openalex.org/I4210165038, education, CN, https://ror.org/05qbk4x57}], Institute of Policy and Management, Chinese Academy of Sciences, Beijing, China, Graduate University of Chinese Academy of Sciences, Beijing, China#TAB#}, {{Li Qianqian, https://openalex.org/A1975475994, https://orcid.org/0000-0003-0749-5811}, last, [{Institute of Policy & Management, Chinese Academy of Sciences, Beijing, China, null, null, null, null}], Institute of Policy & Management, Chinese Academy of Sciences, Beijing, China}]|{null, null, null, null}|https://api.openalex.org/works?filter=cites:W185602429 |5             |[{Public opinion, https://openalex.org/C134698397, 3, 0.8185694, https://www.wikidata.org/wiki/Q17946}, {Computer science, https://openalex.org/C41008148, 0, 0.7846728, https://www.wikidata.org/wiki/Q21198}, {Opinion leadership, https://openalex.org/C139268390, 2, 0.7683067, https://www.wikidata.org/wiki/Q1850904}, {Construct (python library), https://openalex.org/C2780801425, 2, 0.6761187, https://www.wikidata.org/wiki/Q5164392}, {Sentiment analysis, https://openalex.org/C66402592, 2, 0.60019773, https://www.wikidata.org/wiki/Q2271421}, {Social network service, https://openalex.org/C2988957881, 3, 0.5393742, https://www.wikidata.org/wiki/Q3220391}, {Value (mathematics), https://openalex.org/C2776291640, 2, 0.48090672, https://www.wikidata.org/wiki/Q2912517}, {The Internet, https://openalex.org/C110875604, 2, 0.45448115, https://www.wikidata.org/wiki/Q75}, {Social network analysis, https://openalex.org/C114713312, 3, 0.4234664, https://www.wikidata.org/wiki/Q7551269}, {Social network (sociolinguistics), https://openalex.org/C4727928, 3, 0.42146975, https://www.wikidata.org/wiki/Q17164759}, {Social media, https://openalex.org/C518677369, 2, 0.33990532, https://www.wikidata.org/wiki/Q202833}, {Data science, https://openalex.org/C2522767166, 1, 0.3345506, https://www.wikidata.org/wiki/Q2374463}, {Artificial intelligence, https://openalex.org/C154945302, 1, 0.29089016, https://www.wikidata.org/wiki/Q11660}, {Public relations, https://openalex.org/C39549134, 1, 0.28631285, https://www.wikidata.org/wiki/Q133080}, {World Wide Web, https://openalex.org/C136764020, 1, 0.26638934, https://www.wikidata.org/wiki/Q466}, {Political science, https://openalex.org/C17744445, 0, 0.17481479, https://www.wikidata.org/wiki/Q36442}, {Law, https://openalex.org/C199539241, 1, 0.106263876, https://www.wikidata.org/wiki/Q7748}, {Machine learning, https://openalex.org/C119857082, 1, 0.08908549, https://www.wikidata.org/wiki/Q2539}, {Politics, https://openalex.org/C94625758, 2, 0.0, https://www.wikidata.org/wiki/Q7163}, {Programming language, https://openalex.org/C199360897, 1, 0.0, https://www.wikidata.org/wiki/Q9143}]|2016-06-24  |Recognition of Online Opinion Leaders Based on Social Network Analysis|https://doi.org/10.1007/978-3-642-35236-2_48|{Lecture Notes in Computer Science, https://openalex.org/V106296714, false, [\"1611-3349\",\"0302-9743\"], 0302-9743, null, null, journal, https://doi.org/10.1007/978-3-642-35236-2_48, null}                                          |https://openalex.org/W185602429 |{185602429, https://openalex.org/W185602429, https://doi.org/10.1007/978-3-642-35236-2_48, null, null}|false      |false       |[]  |{false, closed, null}                                                                |2012-12-04      |2012            |[https://openalex.org/W193276431, https://openalex.org/W1534539087, https://openalex.org/W1971788485, https://openalex.org/W2358017837, https://openalex.org/W2360045856, https://openalex.org/W2372352073, https://openalex.org/W2386117281]                                                                                                                                                                                                                                                                                 |[https://openalex.org/W1583451649, https://openalex.org/W2056308775, https://openalex.org/W2063567195, https://openalex.org/W2234204602, https://openalex.org/W2281670763, https://openalex.org/W2372352073, https://openalex.org/W2381595507, https://openalex.org/W2386117281, https://openalex.org/W2536595682, https://openalex.org/W2755407201, https://openalex.org/W2798287431, https://openalex.org/W2876756551, https://openalex.org/W2884594661, https://openalex.org/W2894862584, https://openalex.org/W2952452437, https://openalex.org/W2991295218, https://openalex.org/W2997919536, https://openalex.org/W3039108277, https://openalex.org/W3136032213, https://openalex.org/W3169877297]|Recognition of Online Opinion Leaders Based on Social Network Analysis|book-chapter   |2022-11-09  |Opinion leaders on the internet play an important role in promoting the formation of online public opinion, which can influence the direction of public opinion. In this paper, we use social network analysis and content analysis to recognize the opinion leaders of online communities. First of all, we propose Eight Degree attribute indexes based on the characteristics of opinion leaders. Then, we construct an attribute matrix of the topic participants, and use the comprehensive evaluation to recognize opinion leaders. Finally, we divide the opinion leaders into the crucial active figure and the important position figure; we can also explore the potential opinion leader deeply by deleting the opinion leaders. The theoretical significance and practical value of this method have been demonstrated by a case study.|\n+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------+-------------------------------------------------------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+----------------------------------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------+------------------------------------------------------------------------------------------------------+-----------+------------+----+-------------------------------------------------------------------------------------+----------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------+---------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n\u001b[1m\u001b[34mworks\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [alternate_host_venues: array<string>, authorships: array<struct<author:struct<display_name:string,id:string,orcid:string>,author_position:string,institutions:array<struct<display_name:string,id:string,type:string,country_code:string,ror:string>>,raw_affiliation_string:string>> ... 22 more fields]\n"
     }
    ]
   }
  },
  {
   "text": "%spark\nval works =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\n/*\n(((Evidence review) OR (evidence synthesis) OR (evidence-based review) OR (evidence report) OR \"Evidence Reports Agency for Healthcare Research and Quality\" OR (publication bias) OR (Campbell Collaboration)) OR (meta-analysis OR meta-analyses OR metaanalyses OR metaanalysis) OR (((systematic review) OR (systematic overview) OR (systematic literature review) OR (systematically reviewed) OR (systematically review) OR (systemic review) OR (Cochrane review*) OR ((ab: Cochrane) AND (register OR library)) OR (Cochrane collaboration) OR (do:(\"jbi evidence synthesis\" OR \"veterinary evidence\")))) OR (((pooled analysis) OR systematic OR systematically OR (inclusion criteria) OR (exclusion criteria) OR (relevant articles) OR (study selection) OR (randomised controlled) OR (randomized controlled) OR (search strategy) OR evidence OR (literature review) OR (quantitative analysis) OR (qualitative analysis) OR (cohort studies) OR (case control studies) OR (reference list) OR (selection criteria) OR (data extraction)) AND ((Chinese National Knowledge Infrastructure) OR CNKI OR CINAHL OR Psychinfo OR Psycinfo OR (Chinese Biomedical Literature Database) OR Medline OR Pubmed OR Embase OR (CAB Abstracts) OR (Science Citation Index) OR (Web of Science) OR (Web of Knowledge) OR Scopus OR (Zoological Record) OR (Biological Abstracts) OR (Biosis Previews))) OR (\"evidence based practice\" OR \"evidence map\" OR \"evidence mapping\" OR \"indirect treatment comparison\" OR \"integrative review\" OR \"mapping evidence review\" OR \"mapping review\" OR \"meta narrative review\" OR \"meta review\" OR \"mixed methods review\" OR \"mixed methods synthesis\" OR \"mixed papers review\" OR \"mixed research synthesis\" OR \"mixed studies review\" OR \"mixed treatment comparison\" OR \"multiple treatment comparison\" OR \"overview of reviews\" OR \"rapid evidence assessment\" OR \"rapid evidence review\" OR \"rapid evidence summary\" OR \"rapid evidence summaries\" OR \"rapid realist synthesis\" OR \"rapid living review\" OR \"rapid review\" OR \"realist review\" OR \"realist synthesis\" OR \"review of complex interventions\" OR \"review of reviews\" OR \"scope of the evidence\" OR \"scoping content review\" OR \"scoping literature review\" OR \"scoping meta review\" OR \"scoping report\" OR \"scoping review\" OR \"scoping study\" OR \"strength of evidence\" or \"structured literature review\" OR \"synthesis of the evidence\" OR \"synthesis of review\" OR \"systematic map\" OR \"systematic mapping\" OR \"umbrella review\")) OR ((\"Critically appraised topic\") OR (\"knowledge summar*\"))\n */\n\nval evidenceResearch = works.filter(lower($\"abstract\").contains(\"evidence review\")||$\"abstract\".contains(\"(evidence synthesis\")||lower($\"abstract\").contains(\"evidence reports agency for healthcare research and quality\")||$\"abstract\".contains(\"systematic review\")||$\"abstract\".contains(\"systematic overview)\") || $\"abstract\".contains(\"ystematic literature review\") || $\"abstract\".contains(\"systematically reviewed\")|| $\"abstract\".contains(\"systematically review\")|| $\"abstract\".contains(\"systemic review\")|| lower($\"abstract\").like(\"cochrane review%\")|| lower($\"abstract\").contains(\"cochrane collaboration\")).cache()\n\nprintln(\"evidenceResearch  cnt:\"+evidenceResearch.count())\nevidenceResearch.show(10)\n\n\n\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-07T09:58:15+0200",
   "progress": 0.0,
   "config": {},
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "evidenceResearch  cnt:313122\n+---------------------+--------------------+--------------------+--------------------+--------------+--------------------+------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+------------+--------------------+--------------------+----------------+----------------+--------------------+--------------------+--------------------+---------------+------------+--------------------+\n|alternate_host_venues|         authorships|              biblio|    cited_by_api_url|cited_by_count|            concepts|created_date|        display_name|                 doi|          host_venue|                  id|                 ids|is_paratext|is_retracted|                mesh|         open_access|publication_date|publication_year|    referenced_works|       related_works|               title|           type|updated_date|            abstract|\n+---------------------+--------------------+--------------------+--------------------+--------------+--------------------+------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+------------+--------------------+--------------------+----------------+----------------+--------------------+--------------------+--------------------+---------------+------------+--------------------+\n| [{\"id\":\"https://o...|[{{Christian Beye...|{null, null, null...|https://api.opena...|             0|[{Hypopituitarism...|  2020-05-13|SUN-294 The Effec...|https://doi.org/1...|{Journal of the E...|https://openalex....|{3023774795, http...|      false|       false|                  []|{true, gold, http...|      2020-05-08|            2020|                  []|[https://openalex...|SUN-294 The Effec...|journal-article|  2022-10-12|Abstract Backgrou...|\n|                   []|[{{Miryam Yusufov...|{null, null, null...|https://api.opena...|             0|[{PsycINFO, https...|  2020-01-23|Sexual Health in ...|https://doi.org/1...|{Sexual medicine ...|https://openalex....|{2999308841, http...|      false|       false|                  []|{false, closed, n...|      2020-04-01|            2020|[https://openalex...|[https://openalex...|Sexual Health in ...|journal-article|  2022-10-12|Abstract Introduc...|\n|                   []|[{{Ibrahim Arpaci...|{114, null, 129, ...|https://api.opena...|             4|[{Information and...|  2019-01-25|A Theoretical Fra...|https://doi.org/1...|{Advances in huma...|https://openalex....|{2909586566, http...|      false|       false|                  []|{false, closed, n...|      2019-01-01|            2019|[https://openalex...|[https://openalex...|A Theoretical Fra...|   book-chapter|  2022-10-12|The chapter provi...|\n|                   []|[{{Athanasios Del...|{null, null, null...|https://api.opena...|             3|[{Medicine, https...|  2019-05-29|The efficacy and ...|https://doi.org/1...|{The Italian jour...|https://openalex....|{2946436868, http...|      false|       false|                  []|{false, closed, n...|      2019-05-07|            2019|[https://openalex...|[https://openalex...|The efficacy and ...|journal-article|  2022-10-12|Introduction Uret...|\n| [{\"id\":\"https://o...|[{{Shrina Parekh,...|{null, null, null...|https://api.opena...|             0|[{Medicine, https...|  2020-05-13|MON-289 Pituitary...|https://doi.org/1...|{Journal of the E...|https://openalex....|{3021406870, http...|      false|       false|                  []|{true, gold, http...|      2020-05-08|            2020|                  []|[https://openalex...|MON-289 Pituitary...|journal-article|  2022-10-12|Abstract Metastat...|\n|                   []|[{{Andoni García-...|{null, null, null...|https://api.opena...|             0|[{Etiology, https...|  2020-09-14|Abdominal pseudoc...|https://doi.org/1...|{Neurocirugía, ht...|https://openalex....|{3083865296, http...|      false|       false|                  []|{false, closed, n...|      2021-03-01|            2021|[https://openalex...|[https://openalex...|Abdominal pseudoc...|journal-article|  2022-10-12|Since the first r...|\n| [{\"id\":\"https://o...|[{{Syarifah Hasan...|{null, null, null...|https://api.opena...|             0|[{Tourism, https:...|  2020-04-10|MUSLIM FRIENDLY T...|https://doi.org/1...|{IJIBE (Internati...|https://openalex....|{3014754412, http...|      false|       false|                  []|{true, gold, http...|      2020-03-31|            2020|                  []|[https://openalex...|MUSLIM FRIENDLY T...|journal-article|  2022-10-12|With the present ...|\n|                   []|[{{Zhirui Zheng, ...|  {1, null, 7, 2022}|https://api.opena...|             0|[{Facet (psycholo...|  2022-05-05|A Systematic Revi...|https://doi.org/1...|{Journal of Healt...|https://openalex....|{null, https://op...|       null|       false|[{\"is_major_topic...| {false, null, null}|      2022-01-01|            2022|[https://openalex...|[https://openalex...|A Systematic Revi...|journal-article|  2022-10-12|Facet tropism is ...|\n| [{\"id\":null,\"disp...|[{{Amilee Srethbh...|{null, null, null...|https://api.opena...|             5|[{Cosmesis, https...|  2020-03-27|Contralateral pro...|https://doi.org/1...|{Psycho-oncology,...|https://openalex....|{3012679389, http...|      false|       false|                  []|{true, green, htt...|      2020-03-31|            2020|[https://openalex...|[https://openalex...|Contralateral pro...|journal-article|  2022-10-12|Objective The rat...|\n| [{\"id\":\"https://o...|[{{Seyma Tuncay, ...|{null, null, null...|https://api.opena...|             1|[{Parent training...|  2020-07-29|A meta review on ...|https://doi.org/1...|{Global Journal o...|https://openalex....|{3045412952, http...|      false|       false|                  []|{true, gold, http...|      2020-03-31|            2020|                  []|[https://openalex...|A meta review on ...|journal-article|  2022-10-12|This study aims t...|\n+---------------------+--------------------+--------------------+--------------------+--------------+--------------------+------------+--------------------+--------------------+--------------------+--------------------+--------------------+-----------+------------+--------------------+--------------------+----------------+----------------+--------------------+--------------------+--------------------+---------------+------------+--------------------+\nonly showing top 10 rows\n\n\u001b[1m\u001b[34mworks\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [alternate_host_venues: array<string>, authorships: array<struct<author:struct<display_name:string,id:string,orcid:string>,author_position:string,institutions:array<struct<display_name:string,id:string,type:string,country_code:string,ror:string>>,raw_affiliation_string:string>> ... 22 more fields]\n\u001b[1m\u001b[34mevidenceResearch\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [alternate_host_venues: array<string>, authorships: array<struct<author:struct<display_name:string,id:string,orcid:string>,author_position:string,institutions:array<struct<display_name:string,id:string,type:string,country_code:string,ror:string>>,raw_affiliation_string:string>> ... 22 more fields]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://192.168.2.15:4040/jobs/job?id=0"
      },
      {
       "jobUrl": "http://192.168.2.15:4040/jobs/job?id=1"
      },
      {
       "jobUrl": "http://192.168.2.15:4040/jobs/job?id=2"
      },
      {
       "jobUrl": "http://192.168.2.15:4040/jobs/job?id=3"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670399895879_631331391",
   "id": "paragraph_1670399895879_631331391",
   "dateCreated": "2022-12-07T09:58:15+0200",
   "dateStarted": "2022-12-07T09:58:15+0200",
   "dateFinished": "2022-12-07T10:17:48+0200",
   "status": "FINISHED"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%spark\nval works =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\nworks.printSchema()\nprintln(\"cnt:\"+works.count())\n\n\n",
   "id": "",
   "config": {}
  },
  {
   "text": "%spark\nval S2articlesdf = spark.read.parquet(\"/media/ometaxas/nvme/datasets/S2/S2.parquet\")\n//println(\"S2_df  cnt:\"+S2_df.count())\n//207207224\nS2articlesdf.printSchema()\n\n\n\nval S2subsetdf = S2articlesdf\n             //.join(broadcast(doisdf), lower(S2articlesdf(\"doi\"))===doisdf(\"doi\"), \"inner\")\n             //.filter(($\"magId\" =!= \"\") && ($\"magId\".isNotNull))\n             .select($\"title\".as(\"S2title\"), $\"corpusid\".as(\"S2paperId\"), lower(S2articlesdf(\"externalids.DOI\")).as(\"S2doi\"), S2articlesdf(\"externalids.MAG\").as(\"S2magId\"), array_distinct($\"s2fieldsofstudy.category\").as(\"S2fos\"), $\"authors\")\n             \n//S2subsetdf.show(10)\n\n\n//Create pub - author rows\nval S2flatdf = S2subsetdf.select($\"S2title\", $\"S2paperId\", $\"S2doi\", $\"S2magId\",  $\"S2fos\", explode($\"authors\").as(\"authorsflat\"))\n\nval S2_Pub_Authors = S2flatdf.select($\"S2title\", $\"S2paperId\", $\"S2doi\", $\"S2fos\", $\"S2magId\", $\"authorsflat.name\".as(\"S2name\"), $\"authorsflat.authorId\".as(\"S2authorId\"), shortNormName($\"authorsflat.name\").as(\"S2shortNormName\"), normName( $\"authorsflat.name\").as(\"S2normName\"))\n//.persist(StorageLevel.DISK_ONLY)\n//.cache()\n\n//S2_Pub_Authors.printSchema\n//S2_Pub_Authors.show(5, false)\n\n//println(\"S2_Author_Pub_Cnt:\" + S2_Pub_Authors.count())\nS2_Pub_Authors.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/MAG_S2/S2_Pub_Authors.parquet\")\n\n\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-02T18:14:13+0200",
   "progress": 99.0,
   "config": {
    "tableHide": true
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- authors: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- authorId: string (nullable = true)\n |    |    |-- name: string (nullable = true)\n |-- citationcount: long (nullable = true)\n |-- corpusid: long (nullable = true)\n |-- externalids: struct (nullable = true)\n |    |-- ACL: string (nullable = true)\n |    |-- ArXiv: string (nullable = true)\n |    |-- CorpusId: string (nullable = true)\n |    |-- DBLP: string (nullable = true)\n |    |-- DOI: string (nullable = true)\n |    |-- MAG: string (nullable = true)\n |    |-- PubMed: string (nullable = true)\n |    |-- PubMedCentral: string (nullable = true)\n |-- influentialcitationcount: long (nullable = true)\n |-- isopenaccess: boolean (nullable = true)\n |-- journal: struct (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- pages: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- publicationdate: string (nullable = true)\n |-- publicationtypes: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- referencecount: long (nullable = true)\n |-- s2fieldsofstudy: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- category: string (nullable = true)\n |    |    |-- source: string (nullable = true)\n |-- title: string (nullable = true)\n |-- updated: string (nullable = true)\n |-- url: string (nullable = true)\n |-- venue: string (nullable = true)\n |-- year: long (nullable = true)\n\n\u001b[1m\u001b[34mS2articlesdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [authors: array<struct<authorId:string,name:string>>, citationcount: bigint ... 14 more fields]\n\u001b[1m\u001b[34mS2subsetdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 4 more fields]\n\u001b[1m\u001b[34mS2flatdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 4 more fields]\n\u001b[1m\u001b[34mS2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 7 more fields]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=88"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=89"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1669997653377_656089271",
   "id": "paragraph_1669997653377_656089271",
   "dateCreated": "2022-12-02T18:14:13+0200",
   "dateStarted": "2022-12-02T18:14:13+0200",
   "dateFinished": "2022-12-02T18:39:25+0200",
   "status": "FINISHED"
  },
  {
   "text": "%spark\nval OAarticlesdf =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OpenAlex/works.parquet\")\nOAarticlesdf.printSchema()\n\n//{null, null, 1388579, conf/amt/MaLTL12, 10.1007/978-3-642-35236-2_48, null, null, null}\n\n//println(\"cnt:\"+works.count())\n\n//removeOpenAlexPrefix\n//removeOrcidPrefix\n//removeDoiPrefix\n\nval OAsubsetdf = OAarticlesdf             \n             .select($\"title\".as(\"OAtitle\"), removeOpenAlexPrefix($\"id\").as(\"OApaperId\"), lower(removeDoiPrefix(OAarticlesdf(\"doi\"))).as(\"OAdoi\"), OAarticlesdf(\"ids.mag\").as(\"OAmagId\"),$\"concepts\", $\"authorships\", $\"authorships.institutions\")      \n             .withColumn(\"OAfos_0_full\", expr(\"filter(concepts, concept -> concept.level == 0)\"))\n             .withColumn(\"OAfos_1_full\", expr(\"filter(concepts, concept -> concept.level == 1)\"))\n             .withColumn(\"OAfos_0\", $\"OAfos_0_full.display_name\")\n             .withColumn(\"OAfos_1\", $\"OAfos_1_full.display_name\")\n             \n//OAsubsetdf.select($\"OAfos_0_full.display_name\").show(20)\n//OAsubsetdf.show(20)\n//OAsubsetdf.printSchema()\n\n\n//Create pub - author rows\nval OAflatdf = OAsubsetdf.select($\"OAtitle\", $\"OApaperId\", $\"OAdoi\", $\"OAmagId\",  $\"OAfos_0\", $\"OAfos_1\", explode($\"authorships\").as(\"authorsflat\"), $\"authorships.author.display_name\".as(\"coAuthorName\"), \n    removeOpenAlexPrefixList($\"authorships.author.id\").as(\"coAuthorId\"))\n\nval OA_Pub_Authors = OAflatdf.select($\"OAtitle\", $\"OApaperId\", $\"OAdoi\", $\"OAfos_0\", $\"OAfos_1\", $\"OAmagId\", $\"authorsflat.author.display_name\".as(\"OAname\"), removeOpenAlexPrefix($\"authorsflat.author.id\").as(\"OAauthorId\"), \n    removeOrcidPrefix($\"authorsflat.author.orcid\").as(\"orcid\"),shortNormName($\"authorsflat.author.display_name\").as(\"OAshortNormName\"), normName( $\"authorsflat.author.display_name\").as(\"OAnormName\"),  \n    removeOpenAlexPrefixList($\"authorsflat.institutions.id\").as(\"affiliationsIds\"), $\"authorsflat.institutions.display_name\".as(\"affiliations\"),  $\"coAuthorId\", $\"coAuthorName\")\n//.persist(StorageLevel.DISK_ONLY)\n//.cache()\n\n//OA_Pub_Authors.printSchema\n//OA_Pub_Authors.show(10)\n\n//println(\"OA_Author_Pub_Cnt:\" + OA_Pub_Authors.count())\nOA_Pub_Authors.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/MAG_S2/OA_Pub_Authors.parquet\")\n\n\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-04T11:29:24+0200",
   "progress": 99.0,
   "config": {
    "tableHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- alternate_host_venues: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- authorships: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- author: struct (nullable = true)\n |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |-- id: string (nullable = true)\n |    |    |    |-- orcid: string (nullable = true)\n |    |    |-- author_position: string (nullable = true)\n |    |    |-- institutions: array (nullable = true)\n |    |    |    |-- element: struct (containsNull = true)\n |    |    |    |    |-- display_name: string (nullable = true)\n |    |    |    |    |-- id: string (nullable = true)\n |    |    |    |    |-- type: string (nullable = true)\n |    |    |    |    |-- country_code: string (nullable = true)\n |    |    |    |    |-- ror: string (nullable = true)\n |    |    |-- raw_affiliation_string: string (nullable = true)\n |-- biblio: struct (nullable = true)\n |    |-- first_page: string (nullable = true)\n |    |-- issue: string (nullable = true)\n |    |-- last_page: string (nullable = true)\n |    |-- volume: string (nullable = true)\n |-- cited_by_api_url: string (nullable = true)\n |-- cited_by_count: long (nullable = true)\n |-- concepts: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- display_name: string (nullable = true)\n |    |    |-- id: string (nullable = true)\n |    |    |-- level: long (nullable = true)\n |    |    |-- score: double (nullable = true)\n |    |    |-- wikidata: string (nullable = true)\n |-- created_date: string (nullable = true)\n |-- display_name: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- host_venue: struct (nullable = true)\n |    |-- display_name: string (nullable = true)\n |    |-- id: string (nullable = true)\n |    |-- is_oa: string (nullable = true)\n |    |-- issn: string (nullable = true)\n |    |-- issn_l: string (nullable = true)\n |    |-- license: string (nullable = true)\n |    |-- publisher: string (nullable = true)\n |    |-- type: string (nullable = true)\n |    |-- url: string (nullable = true)\n |    |-- version: string (nullable = true)\n |-- id: string (nullable = true)\n |-- ids: struct (nullable = true)\n |    |-- mag: long (nullable = true)\n |    |-- openalex: string (nullable = true)\n |    |-- doi: string (nullable = true)\n |    |-- pmid: string (nullable = true)\n |    |-- pmcid: string (nullable = true)\n |-- is_paratext: string (nullable = true)\n |-- is_retracted: boolean (nullable = true)\n |-- mesh: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- open_access: struct (nullable = true)\n |    |-- is_oa: boolean (nullable = true)\n |    |-- oa_status: string (nullable = true)\n |    |-- oa_url: string (nullable = true)\n |-- publication_date: string (nullable = true)\n |-- publication_year: long (nullable = true)\n |-- referenced_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- related_works: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- title: string (nullable = true)\n |-- type: string (nullable = true)\n |-- updated_date: string (nullable = true)\n |-- abstract: string (nullable = true)\n\n\u001b[1m\u001b[34mOAarticlesdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [alternate_host_venues: array<string>, authorships: array<struct<author:struct<display_name:string,id:string,orcid:string>,author_position:string,institutions:array<struct<display_name:string,id:string,type:string,country_code:string,ror:string>>,raw_affiliation_string:string>> ... 22 more fields]\n\u001b[1m\u001b[34mOAsubsetdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OAtitle: string, OApaperId: string ... 9 more fields]\n\u001b[1m\u001b[34mOAflatdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OAtitle: string, OApaperId: string ... 7 more fields]\n\u001b[1m\u001b[34mOA_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OAtitle: string, OApaperId: string ... 13 more fields]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=38"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=39"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670146164745_1584457546",
   "id": "paragraph_1670146164745_1584457546",
   "dateCreated": "2022-12-04T11:29:24+0200",
   "dateStarted": "2022-12-04T11:29:24+0200",
   "dateFinished": "2022-12-04T13:18:05+0200",
   "status": "FINISHED"
  },
  {
   "text": "%spark\n\n\n\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-04T13:42:40+0200",
   "progress": 0.0,
   "config": {},
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------------------+-----------+--------------------+--------------------+--------------------+----------+--------------------+-----------+-------------------+---------------+--------------------+---------------+--------------------+--------------------+--------------------+\n|             OAtitle|  OApaperId|               OAdoi|             OAfos_0|             OAfos_1|   OAmagId|              OAname| OAauthorId|              orcid|OAshortNormName|          OAnormName|affiliationsIds|        affiliations|          coAuthorId|        coAuthorName|\n+--------------------+-----------+--------------------+--------------------+--------------------+----------+--------------------+-----------+-------------------+---------------+--------------------+---------------+--------------------+--------------------+--------------------+\n|       The Heartland|W3092457074|10.17077/0003-482...| [Political science]|                  []|3092457074|  Andrew Offenburger|A2630711023|               null|   aoffenburger|   andrewoffenburger|    [I83328450]|  [Miami University]|       [A2630711023]|[Andrew Offenburger]|\n|Doença de Parkins...|W3100633338|10.33448/rsd-v9i1...|[Philosophy, Psyc...|        [Humanities]|3100633338|Noelma Gustava da...|A3100444679|0000-0001-6812-8092|       nmarques|noelmagustavadasi...|         [null]|[Centro Universit...|[A3100444679, A30...|[Noelma Gustava d...|\n|Doença de Parkins...|W3100633338|10.33448/rsd-v9i1...|[Philosophy, Psyc...|        [Humanities]|3100633338|Maria Iane da Sil...|A3099697244|0000-0003-4750-3839|      moliveira|mariaianedasilvao...|         [null]|[Centro Universit...|[A3100444679, A30...|[Noelma Gustava d...|\n|Doença de Parkins...|W3100633338|10.33448/rsd-v9i1...|[Philosophy, Psyc...|        [Humanities]|3100633338|Miquéias do Nasci...|A3104204201|0000-0003-4596-7250|         malves|miqueiasdonascime...|         [null]|[Centro Universit...|[A3100444679, A30...|[Noelma Gustava d...|\n|Doença de Parkins...|W3100633338|10.33448/rsd-v9i1...|[Philosophy, Psyc...|        [Humanities]|3100633338|Sandrelly Simas Leão|A3103706685|0000-0003-1343-736X|          sleao|  sandrellysimasleao|         [null]|[Centro Universit...|[A3100444679, A30...|[Noelma Gustava d...|\n|Doença de Parkins...|W3100633338|10.33448/rsd-v9i1...|[Philosophy, Psyc...|        [Humanities]|3100633338|Sara Daiana Bente...|A3098770336|0000-0001-6265-0592|         ssouza|saradaianabentesd...|         [null]|[Centro Universit...|[A3100444679, A30...|[Noelma Gustava d...|\n|Doença de Parkins...|W3100633338|10.33448/rsd-v9i1...|[Philosophy, Psyc...|        [Humanities]|3100633338|Graciana de Sousa...|A3101323827|0000-0003-3615-9040|         glopes|gracianadesousalopes|         [null]|[Centro Universit...|[A3100444679, A30...|[Noelma Gustava d...|\n|Evidence and Inhi...|W3016967509|10.1096/fasebj.20...|[Chemistry, Medic...|[Cancer research,...|3016967509|        Kira Steinke|A3017119649|               null|       ksteinke|         kirasteinke|      [I872719]|[Bellarmine Unive...|[A3017119649, A31...|[Kira Steinke, Ma...|\n|Evidence and Inhi...|W3016967509|10.1096/fasebj.20...|[Chemistry, Medic...|[Cancer research,...|3016967509|  Mary OˈMalley Huff|A3177193537|               null|          mhuff|    maryoˈmalleyhuff|      [I872719]|[Bellarmine Unive...|[A3017119649, A31...|[Kira Steinke, Ma...|\n|Expression of Mit...|W3017059968|10.1096/fasebj.20...|[Chemistry, Biolo...|[Cell biology, Pa...|3017059968|    Shanti Choudhary|A3016402093|               null|     schoudhary|     shantichoudhary|   [I111236770]|[University of Ve...|[A3016402093, A30...|[Shanti Choudhary...|\n|Expression of Mit...|W3017059968|10.1096/fasebj.20...|[Chemistry, Biolo...|[Cell biology, Pa...|3017059968|    Michelle Lacasse|A3017238724|               null|       mlacasse|     michellelacasse|   [I111236770]|[University of Ve...|[A3016402093, A30...|[Shanti Choudhary...|\n|Expression of Mit...|W3017059968|10.1096/fasebj.20...|[Chemistry, Biolo...|[Cell biology, Pa...|3017059968|  Ratan K. Choudhary|A2110385303|0000-0001-5601-7635|     rchoudhary|     ratankchoudhary|   [I111236770]|[University of Ve...|[A3016402093, A30...|[Shanti Choudhary...|\n|Expression of Mit...|W3017059968|10.1096/fasebj.20...|[Chemistry, Biolo...|[Cell biology, Pa...|3017059968|     Mercedes Rincon|A2151034460|0000-0002-6663-2225|        mrincon|      mercedesrincon|   [I111236770]|[University of Ve...|[A3016402093, A30...|[Shanti Choudhary...|\n|Expression of Mit...|W3017059968|10.1096/fasebj.20...|[Chemistry, Biolo...|[Cell biology, Pa...|3017059968|     Donald C. Beitz|A1962116232|0000-0002-2962-5480|         dbeitz|        donaldcbeitz|   [I173911158]|[Iowa State Unive...|[A3016402093, A30...|[Shanti Choudhary...|\n|Expression of Mit...|W3017059968|10.1096/fasebj.20...|[Chemistry, Biolo...|[Cell biology, Pa...|3017059968|    Eric D. Testroet|A3043951264|               null|      etestroet|       ericdtestroet|   [I111236770]|[University of Ve...|[A3016402093, A30...|[Shanti Choudhary...|\n|Penerapan Asuhan ...|W3111621762|10.35816/jiskh.v1...|          [Medicine]|        [Gynecology]|3111621762|        Ratna Mahmud|A3111774644|               null|        rmahmud|         ratnamahmud|             []|                  []|       [A3111774644]|      [Ratna Mahmud]|\n|Effect of Pre-Ope...|W3124596325|10.21608/ajdsm.20...| [Medicine, Physics]|[Dentistry, Surge...|3124596325|          Ali Hassan|A3123019972|               null|        ahassan|           alihassan|         [null]|[faculty of denta...|[A3123019972, A24...|[Ali Hassan, Moha...|\n|Effect of Pre-Ope...|W3124596325|10.21608/ajdsm.20...| [Medicine, Physics]|[Dentistry, Surge...|3124596325|       Mohamed Samir|A2462774666|0000-0002-1166-0480|         msamir|        mohamedsamir|             []|                  []|[A3123019972, A24...|[Ali Hassan, Moha...|\n|Examination of As...|W1534725891|                null|[Engineering, Soc...|[Engineering mana...|1534725891|      Todd W. Kelley|A2124285346|0000-0002-3620-7017|        tkelley|         toddwkelley|             []|                  []|[A2124285346, A12...|[Todd W. Kelley, ...|\n|Examination of As...|W1534725891|                null|[Engineering, Soc...|[Engineering mana...|1534725891|  Robert C. Wicklein|A1251819261|               null|      rwicklein|     robertcwicklein|             []|                  []|[A2124285346, A12...|[Todd W. Kelley, ...|\n+--------------------+-----------+--------------------+--------------------+--------------------+----------+--------------------+-----------+-------------------+---------------+--------------------+---------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=51"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670154160312_533314790",
   "id": "paragraph_1670154160312_533314790",
   "dateCreated": "2022-12-04T13:42:40+0200",
   "dateStarted": "2022-12-04T13:42:40+0200",
   "dateFinished": "2022-12-04T13:42:40+0200",
   "status": "FINISHED"
  },
  {
   "text": "%spark\nval OA_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/MAG_S2/OA_Pub_Authors.parquet\")\n                       .select( $\"OApaperId\", $\"OAdoi\", $\"OAmagId\".cast(\"string\").as(\"OAmagId\"), $\"OAauthorId\").cache()\n\nval S2_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/MAG_S2/S2_Pub_Authors.parquet\")\n                        .select( $\"S2paperId\", $\"S2doi\", $\"S2magId\", $\"S2authorId\").cache()\n\n\n\n/*\n//OA_Pub_Authors.show(10)\nprintln(\"OA_Author_Pub:\" + OA_Pub_Authors.count())\n\nval OA_Pub_AuthorsWithdoi = OA_Pub_Authors.filter(($\"OAdoi\" =!= \"\") && ($\"OAdoi\".isNotNull))\nprintln(\"OA_Pub_AuthorsWithdoi  cnt:\"+OA_Pub_AuthorsWithdoi.count())\n\nval OA_Pub_AuthorsWithMAG = OA_Pub_Authors.filter(($\"OAmagId\" =!= \"\") && ($\"OAmagId\".isNotNull))\nprintln(\"OA_Pub_AuthorsWithMAG  cnt:\"+OA_Pub_AuthorsWithMAG.count())\n\n\n\nprintln(\"S2_Author_Pub_Cnt:\" + S2_Pub_Authors.count())\n\nval S2_Pub_AuthorsWithdoi = S2_Pub_Authors.filter(($\"S2doi\" =!= \"\") && ($\"S2doi\".isNotNull))\nprintln(\"S2_Pub_AuthorsWithdoi  cnt:\"+S2_Pub_AuthorsWithdoi.count())\n\nval S2_Pub_AuthorsWithMAG = S2_Pub_Authors.filter(($\"S2magId\" =!= \"\") && ($\"S2magId\".isNotNull))\nprintln(\"S2_Pub_AuthorsWithMAG  cnt:\"+S2_Pub_AuthorsWithMAG.count())\n\n// ------------------------\n*/\nval OA_Pub_Authors_dois = OA_Pub_Authors.filter(($\"OAdoi\" =!= \"\") && ($\"OAdoi\".isNotNull)).select($\"OAdoi\", $\"OApaperId\").distinct()\nprintln(\"OA_Pub_Authors_dois  cnt:\"+OA_Pub_Authors_dois.count())\n\nval OA_Pub_Authors_magIds = OA_Pub_Authors.filter(($\"OAmagId\" =!= \"\") && ($\"OAmagId\".isNotNull)).select($\"OAmagId\", $\"OApaperId\").distinct()\nprintln(\"OA_Pub_Authors_magIds  cnt:\"+OA_Pub_Authors_magIds.count())\n\nval S2_Pub_Authors_dois = S2_Pub_Authors.select($\"S2doi\").distinct()\nprintln(\"S2_Pub_Authors_dois  cnt:\"+S2_Pub_Authors_dois.count())\n\nval S2_Pub_Authors_magIds = S2_Pub_Authors.select($\"S2magId\").distinct()\nprintln(\"S2_Pub_Authors_magIds  cnt:\"+S2_Pub_Authors_magIds.count())\n\n// ------------------------\n\nval OA_S2_dois = OA_Pub_Authors_dois.join(S2_Pub_Authors_dois, $\"OAdoi\" === $\"S2doi\", \"inner\")\nprintln(\"OA_S2_dois  cnt:\"+OA_S2_dois.count())\n\nval OA_S2_magIds = OA_Pub_Authors_magIds.join(S2_Pub_Authors_magIds, $\"OAmagId\" === $\"S2magId\", \"inner\")\nprintln(\"OA_S2_magIds  cnt:\"+OA_S2_magIds.count())\n\nval OA_S2_dois_OApaperIds = OA_S2_dois.select($\"OApaperId\")\nval OA_S2_magIds_OApaperIds = OA_S2_magIds.select($\"OApaperId\")\n\nprintln(\"OA_S2_paperIds  cnt:\"+OA_S2_dois_OApaperIds.union(OA_S2_magIds_OApaperIds).distinct().count())\n\n/*\n\nOA_Author_Pub:614146619\nOA_Pub_AuthorsWithdoi  cnt:394784026\nOA_Pub_AuthorsWithMAG  cnt:552951084\nS2_Author_Pub_Cnt:570228548\nS2_Pub_AuthorsWithdoi  cnt:368771902\nS2_Pub_AuthorsWithMAG  cnt:498207086\nOA_Pub_Authors_dois  cnt:120477000\nOA_Pub_Authors_magIds  cnt:203847293\nS2_Pub_Authors_dois  cnt:107481433\nS2_Pub_Authors_magIds  cnt:182178564\nOA_S2_dois  cnt:105591860\nOA_S2_magIds  cnt:174878852\nOA_S2_paperIds  cnt:189093462\n*/\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-05T13:52:34+0200",
   "progress": 0.0,
   "config": {
    "tableHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "results": {
    "code": "ERROR",
    "msg": [
     {
      "type": "TEXT",
      "data": "org.apache.zeppelin.interpreter.InterpreterException: java.lang.NoSuchMethodError: 'scala.tools.nsc.settings.AbsSettings$AbsSetting scala.tools.nsc.Settings.usejavacp()'\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.open(LazyOpenInterpreter.java:76)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:833)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:741)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:172)\n\tat org.apache.zeppelin.scheduler.AbstractScheduler.runJob(AbstractScheduler.java:132)\n\tat org.apache.zeppelin.scheduler.FIFOScheduler.lambda$runJobInScheduler$0(FIFOScheduler.java:42)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:834)\nCaused by: java.lang.NoSuchMethodError: 'scala.tools.nsc.settings.AbsSettings$AbsSetting scala.tools.nsc.Settings.usejavacp()'\n\tat org.apache.zeppelin.spark.SparkScala212Interpreter.open(SparkScala212Interpreter.scala:66)\n\tat org.apache.zeppelin.spark.SparkInterpreter.open(SparkInterpreter.java:121)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.open(LazyOpenInterpreter.java:70)\n\t... 8 more\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670241154785_142646609",
   "id": "paragraph_1670241154785_142646609",
   "dateCreated": "2022-12-05T13:52:34+0200",
   "dateStarted": "2022-12-05T13:52:34+0200",
   "dateFinished": "2022-12-05T13:52:44+0200",
   "status": "ERROR"
  },
  {
   "text": "%spark\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n//works.filter(lower(removeDoiPrefix(works(\"doi\")))===\"10.1007/978-3-642-35236-2_48\" \n\nval OA_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/OA_Pub_Authors.parquet\")        \n        .select( $\"OApaperId\", $\"OAdoi\", $\"OAfos_0\", $\"OAfos_1\", $\"OAmagId\", $\"OAname\", $\"OAauthorId\",$\"orcid\",$\"OAshortNormName\",$\"OAnormName\",$\"affiliationsIds\", $\"coAuthorId\"  \n    ,shortNormNameList($\"coAuthorName\").as(\"coAuthorShortNormNames\"))\n         \n//\"affiliations\", \n\n//OA_Pub_Authors.show(10)\n\n\nval S2_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/S2_Pub_Authors.parquet\")\n\n//S2_Pub_Authors.show()\n\n//val listValues = Seq(\"208518325\",\"135545499\",\"111061630\",\"714390\",\"56222208\")\n//OA_S2_Pub_Authors.filter($\"corpusid\".isin(listValues:_*)).show()\n\n///OA_S2_Pub_Authors.filter(lower(removeDoiPrefix(works(\"doi\")))===\"10.1007/978-3-642-35236-2_48\" || lower(removeDoiPrefix(works(\"doi\")))===\"10.1109/55.863111\").show(false)\n\n//OA_Pub_Authors.show(10)\n//println(\"OA_Author_Pub:\" + OA_Pub_Authors.count())\n\n//S2_Pub_Authors.show(10)\n//println(\"S2_Pub_Authors:\" + S2_Pub_Authors.count())\n\n//repartitioning to avoid huge shuffling and speed-up sort-merge join ()\n//val OA_Pub_Authors = OA_Pub_Authors1.repartition(500, OA_Pub_Authors1.col(\"OAmagId\"))\n//val S2_Pub_Authors = S2_Pub_Authors1.repartition(500, S2_Pub_Authors1.col(\"S2magId\"))\n\n\nval OA_S2_Pub_Authors = OA_Pub_Authors\n                   .join(S2_Pub_Authors, $\"OAmagId\" === $\"S2magId\"  \n                           && ( $\"S2shortNormName\"=== $\"OAshortNormName\"   || \n                           (  jaro_winkler($\"OAnormName\", $\"S2normName\") > 0.70 && levenshtein($\"OAnormName\", $\"S2normName\")<4)  || \n                           soundex($\"OAnormName\") === soundex($\"S2normName\") ) ) \n                       , \"left_outer\")                    \n                   //.dropDuplicates()\n                    \n//OA_S2_Pub_Authors.printSchema()\n\n//println(\"Join_S2_Mag_auth_pubCnt:\"+OA_S2_Pub_Authors.count())\n//OA_S2_Pub_Authors.show()\n\nOA_S2_Pub_Authors.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors.parquet\")\n\n\n/*\n\n// \n\nval ΟΑ_S2_Pub_Authors = OA_Pub_Authors\n                .groupBy($\"MAGpaperId\", $\"MAGauthorId\")\n                //.agg(count(\"S2authorId\").as(\"S2authorCnt\"))\n                .agg(count(\"S2authorId\").as(\"S2authorCnt\")\n                , collect_list(S2_MAG_df(\"S2authorId\")).as(\"S2authorIds\"), collect_set(S2_MAG_df(\"S2paperId\")).as(\"S2paperIds\"), collect_list(S2_MAG_df(\"S2name\")).as(\"S2names\"), collect_list(S2_MAG_df(\"S2shortNormName\")).as(\"S2shortNormNames\"), collect_list(S2_MAG_df(\"S2normName\")).as(\"S2normNames\") )\n                .where($\"S2authorCnt\">1)\n  //              .persist(StorageLevel.DISK_ONLY)\n\n//println(\"S2_MAG_fp_df cnt:\" + S2_MAG_fp_df.count())\n//S2_MAG_fp_df.show(50)\n//S2_MAG_fp_df.limit(200).coalesce(1).write.json(\"/media/ometaxas/nvme/datasets/MAG_S2/doubleMatch.json\")\n\nval S2_MAG_nonDoubles= S2_MAG_df.join(broadcast(S2_MAG_fp_df), S2_MAG_df(\"MAGpaperId\") === S2_MAG_fp_df(\"MAGpaperId\") && S2_MAG_df(\"MAGauthorId\") === S2_MAG_fp_df(\"MAGauthorId\") && S2_MAG_df(\"S2normName\")=!=S2_MAG_df(\"MAGnormName\"), \"leftanti\")\n\nS2_MAG_nonDoubles.write.parquet(\"/media/ometaxas/nvme/datasets/MAG_S2/S2_MAG_NFP_df.parquet\")\n\n//.coalesce(1).write.csv(\"PaperReferenceswithDOIs.csv\")\n//661546284\n//613818006\n\n//val S2_MAG_Orciddf = spark.read.parquet(\"/media/datadisk/Datasets/MAG_S2/S2_MAG_Orcid.parquet\").dropDuplicates()\n//802561855\n//println(\"S2_MAG cnt:\" + S2_MAG_df.count())\n\n//val S2_MAG_df1 = spark.read.parquet(\"/media/ometaxas/nvme/datasets/MAG_S2/S2_MAG_df.parquet\").dropDuplicates()\n//val S2_MAG_Orciddf = spark.read.parquet(\"/media/datadisk/Datasets/MAG_S2/S2_MAG_Orcid.parquet\").dropDuplicates()\n\n//println(\"S2_MAG1 cnt:\" + S2_MAG_df1.count())\n\n */\n",
   "user": "anonymous",
   "dateUpdated": "2022-12-08 21:25:45.467",
   "progress": 7.0,
   "config": {
    "tableHide": true
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=0"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=1"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=2"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=3"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=4"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=5"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670313076554_366402541",
   "id": "paragraph_1670313076554_366402541",
   "dateCreated": "2022-12-06T09:51:16+0200",
   "dateStarted": "2022-12-08 21:25:43.979",
   "dateFinished": "2022-12-08 21:25:45.466",
   "status": "ERROR",
   "results": {
    "code": "ERROR",
    "msg": [
     {
      "type": "TEXT",
      "data": "org.apache.spark.sql.AnalysisException: Cannot resolve column name \"OAdoi\" among (alternate_host_venues, authorships, biblio, cited_by_api_url, cited_by_count, concepts, created_date, display_name, doi, host_venue, id, ids, is_paratext, is_retracted, mesh, open_access, publication_date, publication_year, referenced_works, related_works, title, type, updated_date, abstract)\n  at org.apache.spark.sql.errors.QueryCompilationErrors$.cannotResolveColumnNameAmongFieldsError(QueryCompilationErrors.scala:2265)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$resolveException(Dataset.scala:258)\n  at org.apache.spark.sql.Dataset.$anonfun$resolve$1(Dataset.scala:250)\n  at scala.Option.getOrElse(Option.scala:189)\n  at org.apache.spark.sql.Dataset.resolve(Dataset.scala:250)\n  at org.apache.spark.sql.Dataset.col(Dataset.scala:1352)\n  at org.apache.spark.sql.Dataset.apply(Dataset.scala:1319)\n  ... 57 elided\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval OA_S2_Pub_Authors =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors.parquet\")\nOA_S2_Pub_Authors.printSchema()",
   "id": "",
   "dateCreated": "2022-12-09 10:03:39.221",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2022-12-09 10:03:56.815",
   "dateUpdated": "2022-12-09 10:03:57.029",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAfos_0: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- OAfos_1: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- OAmagId: long (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorId: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2title: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2fos: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2magId: string (nullable = true)\n |-- S2name: string (nullable = true)\n |-- S2authorId: string (nullable = true)\n |-- S2shortNormName: string (nullable = true)\n |-- S2normName: string (nullable = true)\n\n\u001b[1m\u001b[34mOA_S2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n"
     }
    ]
   },
   "dateFinished": "2022-12-09 10:03:57.029"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval OA_S2_Pub_Authors_magId =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors.parquet\")\n//OA_S2_Pub_Authors_magId.printSchema()\n//println(\"OA_S2_Pub_Authors_magId:\" + OA_S2_Pub_Authors_magId.count())\n\nval OA_S2_Pub_Authors_notMatched = OA_S2_Pub_Authors_magId.filter($\"S2paperId\".isNull && $\"OAdoi\" =!= \"\" && $\"OAdoi\".isNotNull)       \n//println(\"OA_S2_Pub_Authors_notMatched:\" + OA_S2_Pub_Authors_notMatched.count())\n//OA_S2_Pub_Authors.printSchema()\n        \nval OA_S2_Pub_Authors_matched = OA_S2_Pub_Authors_magId.filter( $\"S2paperId\".isNotNull  || $\"OAdoi\" === \"\" || $\"OAdoi\".isNull)\n//println(\"OA_S2_Pub_Authors_matched:\" + OA_S2_Pub_Authors_matched.count())\n\n\n\nval S2_Pub_Authors =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/S2_Pub_Authors.parquet\")\n//S2_Pub_Authors.printSchema()\n\nval OA_S2_Pub_Authors_doi= OA_S2_Pub_Authors_notMatched\n                   .join(S2_Pub_Authors, $\"OAdoi\" === S2_Pub_Authors(\"S2doi\")  \n                           && ( S2_Pub_Authors(\"S2shortNormName\")=== $\"OAshortNormName\"   || \n                           (  jaro_winkler($\"OAnormName\", S2_Pub_Authors(\"S2normName\")) > 0.70 && levenshtein($\"OAnormName\", S2_Pub_Authors(\"S2normName\"))<4)  \n                                   || soundex($\"OAnormName\") === soundex(S2_Pub_Authors(\"S2normName\"))  ) \n                       , \"left_outer\")              \n                    .select( $\"OApaperId\", $\"OAdoi\", $\"OAfos_0\", $\"OAfos_1\", $\"OAmagId\", $\"OAname\", $\"OAauthorId\",$\"orcid\",$\"OAshortNormName\",$\"OAnormName\",$\"affiliationsIds\", $\"coAuthorId\"  \n                    ,$\"coAuthorShortNormNames\", \n                        S2_Pub_Authors(\"S2title\"),S2_Pub_Authors(\"S2paperId\"),S2_Pub_Authors(\"S2doi\"),S2_Pub_Authors(\"S2fos\"),S2_Pub_Authors(\"S2magId\"),S2_Pub_Authors(\"S2name\"),S2_Pub_Authors(\"S2authorId\"),S2_Pub_Authors(\"S2shortNormName\"),S2_Pub_Authors(\"S2normName\"))\n\n\n\n\nval OA_S2_Pub_Authors_doi_mag = OA_S2_Pub_Authors_doi.union(OA_S2_Pub_Authors_matched)\n        \nOA_S2_Pub_Authors_doi_mag.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag.parquet\")\n        //.orderBy($\"OApaperId\", $\"OAauthorId\", )\n//println(\"OA_S2_Pub_Authors_doi:\" + OA_S2_Pub_Authors_doi.count())\n",
   "id": "",
   "dateCreated": "2022-12-09 09:27:21.249",
   "config": {
    "title": true
   },
   "title": "Join OA S2 based on DOI",
   "dateStarted": "2022-12-09 19:20:58.962",
   "dateUpdated": "2022-12-09 21:01:30.326",
   "dateFinished": "2022-12-09 21:01:30.326",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "import com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_magId\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_notMatched\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_matched\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mS2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [S2title: string, S2paperId: bigint ... 7 more fields]\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_doi\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.s...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\n\nval OA_S2_Pub_Authors_doi_mag  =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag.parquet\")\nprintln(\"OA_S2_Pub_Authors_doi_mag:\" + OA_S2_Pub_Authors_doi_mag.count())\n\nval w = Window.partitionBy($\"OApaperId\", $\"OAauthorId\").orderBy(levenshtein($\"OAnormName\", $\"S2normName\") , lit(1) - (soundex($\"OAnormName\") === soundex($\"S2normName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"OAnormName\", $\"S2normName\"))\n\n\nval OA_S2_Pub_Authors_doi_mag_dedup = OA_S2_Pub_Authors_doi_mag.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\n\nOA_S2_Pub_Authors_doi_mag_dedup.write.mode(\"overwrite\").parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n\n//println(\"OA_S2_Pub_Authors_doi_mag_dedup:\" + OA_S2_Pub_Authors_doi_mag_dedup.count())\n\n",
   "id": "",
   "dateCreated": "2022-12-09 09:48:42.890",
   "config": {
    "title": true
   },
   "title": "Remove duplicates",
   "dateStarted": "2022-12-09 21:01:30.333",
   "dateUpdated": "2022-12-09 23:53:24.197",
   "dateFinished": "2022-12-09 23:53:24.197",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "OA_S2_Pub_Authors_doi_mag:617733542\nimport org.apache.spark.sql.functions.row_number\nimport org.apache.spark.sql.expressions.Window\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_doi_mag\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@2c4f037a\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_doi_mag_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval OA_S2_Pub_Authors_doi_mag_dedup =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\nprintln(\"OA_S2_Pub_Authors_doi_mag_dedup:\" + OA_S2_Pub_Authors_doi_mag_dedup.count())\n\n//OA_S2_Pub_Authors_doi_mag:617733542\n//OA_S2_Pub_Authors_doi_mag_dedup:613818006",
   "id": "",
   "dateCreated": "2022-12-10 09:25:40.260",
   "config": {},
   "dateStarted": "2022-12-10 09:26:26.557",
   "dateUpdated": "2022-12-10 09:26:38.029",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "OA_S2_Pub_Authors_doi_mag_dedup:613818006\n\u001b[1m\u001b[34mOA_S2_Pub_Authors_doi_mag_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n"
     }
    ]
   },
   "dateFinished": "2022-12-10 09:26:38.029"
  },
  {
   "title": "Link S2AND Datasets",
   "text": "%spark\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval S2AND_HOME = \"/media/ometaxas/nvme/datasets/S2AND\"\n//val S2AND_HOME = \"/home/ometaxas/Projects/S2AND/S2AND/data/aminer\"\nimport  org.apache.spark.sql.functions._\n\nval aminersignatures = spark.read.json(s\"file://$S2AND_HOME/aminer-signatures.json\")\n                       .withColumn(\"dataset\", lit(\"aminer\"))\nval arnetminersignatures = spark.read.json(s\"file://$S2AND_HOME/arnetminer-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"arnetminer\"))\nval inspiresignatures = spark.read.json(s\"file://$S2AND_HOME/inspire-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"inspires\"))\nval zbmathsignatures = spark.read.json(s\"file://$S2AND_HOME/zbmath-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"zbmath\"))\nval pubmedsignatures = spark.read.json(s\"file://$S2AND_HOME/pubmed-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"pubmed\"))\nval kistisignatures = spark.read.json(s\"file://$S2AND_HOME/kisti-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"kisti\"))\nval qiansignatures = spark.read.json(s\"file://$S2AND_HOME/qian-signatures.json\")\n                        .withColumn(\"dataset\", lit(\"qian\"))\n\nval S2ANDsignatures = aminersignatures.union(arnetminersignatures).union(inspiresignatures).union(zbmathsignatures).union(pubmedsignatures).union(kistisignatures).union(qiansignatures)\n        .withColumn(\"author_info_fullname\", concat($\"author_info_first\", lit(\" \"), $\"author_info_last\"))\n        .withColumn(\"author_info_normname\", normName($\"author_info_fullname\"))\n        .withColumn(\"author_info_shortnormname\", shortNormName($\"author_info_fullname\"))\n\nS2ANDsignatures.printSchema()\nprintln(\"S2ANDsignatures count: \" + S2ANDsignatures.count())\nS2ANDsignatures.groupBy($\"dataset\").count().show()\n\nval OA_S2_Pub_Authors =   spark.read\n        //.parquet(\"/media/datadisk/Datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n\n val OA_S2_S2AND_signatures = OA_S2_Pub_Authors\n                   .join(broadcast(S2ANDsignatures), $\"paper_id\" === $\"S2paperId\"  \n                           && ( $\"S2shortNormName\"=== $\"author_info_shortnormname\"   || (  jaro_winkler($\"author_info_normname\", $\"S2normName\") > 0.75 && levenshtein($\"author_info_normname\", $\"S2normName\")<4  )   || (soundex($\"author_info_normname\") === soundex($\"S2normName\"))) \n                       , \"inner\").cache()                    \n \nprintln(\"OA_S2_S2AND_signatures:\" + OA_S2_S2AND_signatures.count())\nOA_S2_S2AND_signatures.groupBy($\"dataset\").count().show()\n\nval w = Window.partitionBy($\"dataset\", $\"signature_id\").orderBy(levenshtein($\"S2normName\", $\"author_info_normname\") , lit(1) - (soundex($\"author_info_normname\") === soundex($\"S2normName\")).cast(\"integer\"), lit(1)-jaro_winkler($\"author_info_normname\", $\"S2normName\"))\n        //orderBy(levenshtein($\"author_info_normname\", $\"S2normName\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\n\nval OA_S2_S2AND_signatures_dedup = OA_S2_S2AND_signatures.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\").cache()\n\nOA_S2_S2AND_signatures_dedup.write.mode(\"overwrite\").json(s\"file://$S2AND_HOME/OA_S2_S2AND_signatures_dedup.json\")\n\nprintln(\"OA_S2_S2AND_signatures_dedup:\" + OA_S2_S2AND_signatures_dedup.count())\nOA_S2_S2AND_signatures_dedup.groupBy($\"dataset\").count().show()\n\n/*\nOA_S2_S2AND_signatures:1158300\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 41266|\n|    zbmath| 14702|\n|      qian|  6763|\n|  inspires|910991|\n|arnetminer|  7419|\n|    aminer|174198|\n|    pubmed|  2961|\n+----------+------+\n\nOA_S2_S2AND_signatures_dedup:681010\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 37446|\n|      qian|  6081|\n|    zbmath| 14341|\n|  inspires|462700|\n|arnetminer|  6699|\n|    aminer|150930|\n|    pubmed|  2813|\n+----------+------+\n\n */",
   "user": "anonymous",
   "dateUpdated": "2022-12-12 19:08:40.278",
   "progress": 99.0,
   "config": {
    "title": true,
    "tableHide": false
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=0"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=1"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=2"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=3"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=4"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=5"
      },
      {
       "jobUrl": "http://PC192.168.2.15.station:4040/jobs/job?id=6"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1670444516598_748155554",
   "id": "paragraph_1670444516598_748155554",
   "dateCreated": "2022-12-07T22:21:56+0200",
   "dateStarted": "2022-12-12 18:46:36.747",
   "dateFinished": "2022-12-12 19:08:40.278",
   "status": "FINISHED",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- author_id: long (nullable = true)\n |-- author_info_affiliations: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- author_info_email: string (nullable = true)\n |-- author_info_first: string (nullable = true)\n |-- author_info_last: string (nullable = true)\n |-- author_info_middle: string (nullable = true)\n |-- author_info_position: long (nullable = true)\n |-- author_info_suffix: string (nullable = true)\n |-- paper_id: long (nullable = true)\n |-- signature_id: string (nullable = true)\n |-- dataset: string (nullable = false)\n |-- author_info_fullname: string (nullable = true)\n |-- author_info_normname: string (nullable = true)\n |-- author_info_shortnormname: string (nullable = true)\n\nS2ANDsignatures count: 766133\n+----------+------+\n|   dataset| count|\n+----------+------+\n|    aminer|157448|\n|arnetminer|  7144|\n|  inspires|536564|\n|    zbmath| 15181|\n|    pubmed|  2871|\n|     kisti| 40383|\n|      qian|  6542|\n+----------+------+\n\nOA_S2_S2AND_signatures:1158300\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 41266|\n|    zbmath| 14702|\n|      qian|  6763|\n|  inspires|910991|\n|arnetminer|  7419|\n|    aminer|174198|\n|    pubmed|  2961|\n+----------+------+\n\nOA_S2_S2AND_signatures_dedup:642908\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 27881|\n|    zbmath|  5870|\n|      qian|  2527|\n|  inspires|450866|\n|arnetminer|  2699|\n|    aminer|150930|\n|    pubmed|  2135|\n+----------+------+\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mS2AND_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/S2AND\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34maminersignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [author_id: bigint, author_info_affiliations: array<string> ... 9 more fields]\n\u001b[1m\u001b[34marnetminersignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [author_id: bigint, author_info_affiliations: array<string> ... 9 more fields]\n\u001b[1m\u001b[34minspiresignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [author_id: bigint, author_info_affiliations: array<string> ... 9 more fields]\n\u001b[1m\u001b[34mzbmathsignatures\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataF...\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval VECTORS_HOME = \"/media/datadisk/Datasets/OA_S2/WorkVectors\"\nval OA_S2_Pub_Vectors =   spark.read.parquet(\"/media/datadisk/Datasets/OA_S2/WorkVectors\")\nOA_S2_Pub_Vectors.printSchema()\nOA_S2_S2AND_signatures_dedup.printSchema()\nOA_S2_Pub_Vectors.show(5)\n//val OA_S2_S2AND_signatures_dedup = spark.read.json(s\"file://$S2AND_HOME/OA_S2_S2AND_signatures_dedup.json\")\n//val OA_S2_S2AND_signatures_dedup_vectors =  OA_S2_Pub_Vectors.join(broacast(OA_S2_S2AND_signatures_dedup), $\n\n \n\n",
   "id": "",
   "dateCreated": "2022-12-12 19:46:44.167",
   "config": {
    "title": true
   },
   "title": "Link with vectors",
   "dateStarted": "2022-12-12 19:56:44.207",
   "dateUpdated": "2022-12-12 19:56:48.846",
   "dateFinished": "2022-12-12 19:56:48.846",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- pkgId: string (nullable = true)\n |-- vector: array (nullable = true)\n |    |-- element: double (containsNull = true)\n\nroot\n |-- OApaperId: string (nullable = true)\n |-- OAdoi: string (nullable = true)\n |-- OAfos_0: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- OAfos_1: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- OAmagId: long (nullable = true)\n |-- OAname: string (nullable = true)\n |-- OAauthorId: string (nullable = true)\n |-- orcid: string (nullable = true)\n |-- OAshortNormName: string (nullable = true)\n |-- OAnormName: string (nullable = true)\n |-- affiliationsIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorId: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- coAuthorShortNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2title: string (nullable = true)\n |-- S2paperId: long (nullable = true)\n |-- S2doi: string (nullable = true)\n |-- S2fos: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- S2magId: string (nullable = true)\n |-- S2name: string (nullable = true)\n |-- S2authorId: string (nullable = true)\n |-- S2shortNormName: string (nullable = true)\n |-- S2normName: string (nullable = true)\n |-- author_id: long (nullable = true)\n |-- author_info_affiliations: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- author_info_email: string (nullable = true)\n |-- author_info_first: string (nullable = true)\n |-- author_info_last: string (nullable = true)\n |-- author_info_middle: string (nullable = true)\n |-- author_info_position: long (nullable = true)\n |-- author_info_suffix: string (nullable = true)\n |-- paper_id: long (nullable = true)\n |-- signature_id: string (nullable = true)\n |-- dataset: string (nullable = false)\n |-- author_info_fullname: string (nullable = true)\n |-- author_info_normname: string (nullable = true)\n |-- author_info_shortnormname: string (nullable = true)\n\n+--------------------+--------------------+\n|               pkgId|              vector|\n+--------------------+--------------------+\n|3dK6nwlthtcTEUS8G...|[-0.0164, 0.0826,...|\n|3dK6nwtOzzQ8cCNjg...|[0.0328, 0.0811, ...|\n|3dK6nxN8PjdHsYTYQ...|[-0.0845, -0.0989...|\n|3dK6nxUpnAD1b1QGC...|[0.0107, 0.0521, ...|\n|3dK6nxylIFBgyKTmU...|[0.0349, 0.0346, ...|\n+--------------------+--------------------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mVECTORS_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/datadisk/Datasets/OA_S2/WorkVectors\n\u001b[1m\u001b[34mOA_S2_Pub_Vectors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pkgId: string, vector: array<double>]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\n\nval S2AND_HOME = \"/media/ometaxas/nvme/datasets/S2AND\"\n\nval OA_S2_S2AND_signatures_lubos =   spark.read.parquet(s\"file://$S2AND_HOME/trainingSignatures\")\nOA_S2_S2AND_signatures_lubos.printSchema()\nprintln(\"OA_S2_S2AND_signatures_lubos count: \" + OA_S2_S2AND_signatures_lubos.count())\n\nOA_S2_S2AND_signatures_lubos.groupBy($\"sampleDataset\").count().show()\n\n\nval w = Window.partitionBy($\"signatureId\").orderBy(levenshtein($\"s2AuthorNormName\", $\"authorNormName\"), lit(1)-jaro_winkler($\"s2AuthorNormName\", $\"authorNormName\"))\n        //.orderBy(levenshtein($\"s2AuthorNormName\", $\"authorNormName\"))\n\nval OA_S2_S2AND_signatures_lubos_dedup = OA_S2_S2AND_signatures_lubos.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\n\nprintln(\"OA_S2_S2AND_signatures_lubos_dedup:\" + OA_S2_S2AND_signatures_lubos_dedup.count())\nOA_S2_S2AND_signatures_lubos_dedup.groupBy($\"sampleDataset\").count().show()\n\n/*\n\nS2ANDsignatures count: 766133\n+----------+------+\n|   dataset| count|\n+----------+------+\n|    aminer|157448|\n|arnetminer|  7144|\n|  inspires|536564|\n|    zbmath| 15181|\n|    pubmed|  2871|\n|     kisti| 40383|\n|      qian|  6542|\n+----------+------+\n\n\nOA_S2_S2AND_signatures_lubos count: 520976\n+-------------+------+\n|sampleDataset| count|\n+-------------+------+\n|        kisti| 33093|\n|         qian|  5406|\n|       zbmath| 12282|\n|   arnetminer|  5863|\n|       aminer|127186|\n|      inspire|334887|\n|       pubmed|  2259|\n+-------------+------+\n\nOA_S2_S2AND_signatures_lubos_dedup:502692\n+-------------+------+\n|sampleDataset| count|\n+-------------+------+\n|        kisti| 32301|\n|       zbmath| 12209|\n|         qian|  5265|\n|   arnetminer|  5582|\n|       aminer|123973|\n|      inspire|321137|\n|       pubmed|  2225|\n+-------------+------+\n\nOA_S2_S2AND_signatures_dedup:681010\n+----------+------+\n|   dataset| count|\n+----------+------+\n|     kisti| 37446|\n|      qian|  6081|\n|    zbmath| 14341|\n|  inspires|462700|\n|arnetminer|  6699|\n|    aminer|150930|\n|    pubmed|  2813|\n+----------+------+\n\n */\n",
   "id": "",
   "dateCreated": "2022-12-10 16:50:26.174",
   "config": {
    "tableHide": true,
    "title": true,
    "editorHide": false
   },
   "dateStarted": "2022-12-12 19:24:48.743",
   "dateUpdated": "2022-12-12 19:24:57.201",
   "dateFinished": "2022-12-12 19:24:57.201",
   "title": "Analyze Lubos S2AND linking results",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- s2CorpusId: long (nullable = true)\n |-- sampleDataset: string (nullable = true)\n |-- clusterS2AndId: string (nullable = true)\n |-- signatureS2AndId: string (nullable = true)\n |-- s2AuthorId2: long (nullable = true)\n |-- tsAuthorNormName: string (nullable = true)\n |-- tsAuthorShortNormName: string (nullable = true)\n |-- paperPkgId: string (nullable = true)\n |-- signatureId: long (nullable = true)\n |-- paperOpenAlexId: string (nullable = true)\n |-- doi: string (nullable = true)\n |-- conceptIdsLevel0: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- conceptIdsLevel1: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- conceptIdsOthers: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- authorPkgId: string (nullable = true)\n |-- orcIds: string (nullable = true)\n |-- affiliationIds: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- authorNormName: string (nullable = true)\n |-- authorShortNormName: string (nullable = true)\n |-- authorNormNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- authorShortNames: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- s2AuthorId: long (nullable = true)\n |-- s2AuthorName: string (nullable = true)\n |-- s2AuthorNormName: string (nullable = true)\n |-- s2AuthorShortNormName: string (nullable = true)\n |-- s2Orcids: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- paperVector: array (nullable = true)\n |    |-- element: double (containsNull = true)\n |-- soundex: string (nullable = true)\n\nOA_S2_S2AND_signatures_lubos count: 520976\n+-------------+------+\n|sampleDataset| count|\n+-------------+------+\n|        kisti| 33093|\n|         qian|  5406|\n|       zbmath| 12282|\n|   arnetminer|  5863|\n|       aminer|127186|\n|      inspire|334887|\n|       pubmed|  2259|\n+-------------+------+\n\nOA_S2_S2AND_signatures_lubos_dedup:502692\n+-------------+------+\n|sampleDataset| count|\n+-------------+------+\n|        kisti| 32301|\n|       zbmath| 12209|\n|         qian|  5265|\n|   arnetminer|  5582|\n|       aminer|123973|\n|      inspire|321137|\n|       pubmed|  2225|\n+-------------+------+\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\n\u001b[1m\u001b[34mS2AND_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/S2AND\n\u001b[1m\u001b[34mOA_S2_S2AND_signatures_lubos\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [s2CorpusId: bigint, sampleDataset: string ... 26 more fields]\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@cf6f608\n\u001b[1m\u001b[34mOA_S2_S2AND_signatures_lubos_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [s2CorpusId: bigint, sampleDataset: string ... 26 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval S2AND_HOME = \"/media/ometaxas/nvme/datasets/S2AND\"\n\nval s2and_omiros =   spark.read.json(s\"file://$S2AND_HOME/OA_S2_S2AND_signatures_dedup_Soundex.json\")\nval s2and_omiros_ids = s2and_omiros.select($\"S2paperId\").distinct()\nprintln(\"s2and_omiros_ids count: \" + s2and_omiros_ids.count())\n\nval s2and_lubos =   spark.read.parquet(s\"file://$S2AND_HOME/trainingSignatures\")\nval s2and_lubos_ids = s2and_lubos.select($\"s2CorpusId\").distinct()\n//s2and_lubos.printSchema()\nprintln(\"s2and_lubos_ids count: \" + s2and_lubos_ids.count())\n\nval notfound = s2and_lubos_ids.join(s2and_omiros_ids, $\"S2paperId\" === $\"s2CorpusId\", \"left_anti\")\nprintln(\"not found:\" + notfound.count())\n\ns2and_lubos.join(notfound, notfound(\"s2CorpusId\")===s2and_lubos(\"s2CorpusId\"), \"inner\").show(50)\n\n//\"W761096860\", \"W2012147031\",\"W1491642900\",\"W1612866960\"\n//\"119071033\",\"122098301\",\"8161426\",\"14726155\",\"206841351\"\n//not found 2763\n",
   "id": "",
   "dateCreated": "2022-12-10 12:47:42.568",
   "config": {
    "title": true,
    "tableHide": true,
    "editorHide": false
   },
   "dateStarted": "2022-12-11 18:27:45.710",
   "dateUpdated": "2022-12-11 18:28:00.994",
   "dateFinished": "2022-12-11 18:28:00.994",
   "title": "ANalyzing diffs between Lubos - Omiros linking",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "s2and_omiros_ids count: 413212\ns2and_lubos_ids count: 346511\nnot found:25726\n+----------+-------------+--------------------+--------------------+-----------+-----------------+---------------------+--------------------+-----------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------------------+--------------------+-------------------+-------------------+--------------------+--------------------+----------+---------------+----------------+---------------------+--------------------+--------------------+-------+----------+\n|s2CorpusId|sampleDataset|      clusterS2AndId|    signatureS2AndId|s2AuthorId2| tsAuthorNormName|tsAuthorShortNormName|          paperPkgId|signatureId|paperOpenAlexId|                 doi|    conceptIdsLevel0|    conceptIdsLevel1|    conceptIdsOthers|         authorPkgId|             orcIds|      affiliationIds|     authorNormName|authorShortNormName|     authorNormNames|    authorShortNames|s2AuthorId|   s2AuthorName|s2AuthorNormName|s2AuthorShortNormName|            s2Orcids|         paperVector|soundex|s2CorpusId|\n+----------+-------------+--------------------+--------------------+-----------+-----------------+---------------------+--------------------+-----------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------------------+--------------------+-------------------+-------------------+--------------------+--------------------+----------+---------------+----------------+---------------------+--------------------+--------------------+-------+----------+\n| 119071033|       zbmath|aizenberg.lev-zbmath|          126-zbmath|    6796616|    lev aizenberg|           laizenberg|3dK6yWusdPt2x63Al...|  426729954|     W761096860|10.1007/978-94-01...|[3dP9Tk3iyZHc49pp...|[3dP9TIZm0kn980Pc...|[3dP9UIxaWdxwIzOm...|3dP9Y5pSjEGv8RRou...|               null|[3dP9TPQ6cWto7Jk9...|      lev aizenberg|         laizenberg|[lev aizenberg, l...|[laizenberg, laiz...|  36314623|   L. Aĭzenberg|     l aizenberg|           laizenberg|                null|[-0.0251, 0.083, ...|   L125| 119071033|\n| 122098301|       zbmath|olver.frank-willi...|         3310-zbmath|   12663205|          f olver|               folver|3dK6xhSFshLOUgVZM...|   68561068|    W2012147031|     10.1137/0508053|[3dP9Tk3iyZHc49pp...|[3dP9TIZm0kn980Pc...|[3dP9TygHxYDD5M5s...|3dP9ZOYBVDaWUtZxW...|               null|                  []|    frank w j olver|             folver|[frank w j olver,...|    [folver, folver]|   2668590|       F. Olver|         f olver|               folver|                null|[-0.0452, 0.0182,...|   F652| 122098301|\n|   8161426|        kisti|    D.Miller_1-kisti|         20464-kisti| 1227879194|      dale miller|              dmiller|3dK6xyG7iCAJLMryu...|    9208937|    W1491642900|                null|[3dP9T9wbfTNfnCko...|[3dP9UgSp1o3apwzX...|[3dP9UBHIkqXJlBWP...|3dP9Wt5e0EQtYdXct...|0000-0003-0274-4954|                  []|        dale miller|            dmiller|[dale miller, dal...|  [dmiller, dmiller]| 145547269|    Dale Miller|     dale miller|              dmiller|                null|[0.0011, 0.0587, ...|   D454|   8161426|\n|  14726155|         qian|            191-qian|            853-qian| 1227834772|       david ford|                dford|3dK6yj2eEJ3LDWHXO...|   23422483|    W1612866960|                null|[3dP9T9wbfTNfnCko...|[3dP9TqB1SPQkj3DE...|[3dP9Ty5XT3GvkAVU...|3dP9bfcsqmLF1GROV...|               null|                  []|         david ford|              dford|[david ford, davi...|      [dford, dford]|2053921696|        D. Ford|          d ford|                dford|                null|[-0.0973, 0.1201,...|   D131|  14726155|\n| 206841351|         qian|            968-qian|           5050-qian|    7979154|   stefan fischer|             sfischer|3dK6yVxPnvWl8eVEk...|   46157124|      W19766212|  10.1007/bfb0015975|[3dP9T9wbfTNfnCko...|[3dP9UEWJAGGxS6hW...|[3dP9UCTHxBRWHWzn...|3dP9bxG1XcgzCPSGH...|               null|[3dP9TtIK71ONwmgc...|     stefan fischer|           sfischer|[stefan fischer, ...|[sfischer, sfischer]|2061647120|     S. Fischer|       s fischer|             sfischer|                null|[-0.1038, -0.0109...|   S315| 206841351|\n|  96780259|       aminer|5b5433e6e1cd8e4e1...|5b5433e5e1cd8e4e1...|   10803013|      qianqian li|                  qli|3dK6xB4kmm3QYG4hy...|  114611451|    W2080795468|10.1007/s11426-01...|[3dP9Tpw6XW0RaifD...|[3dP9TStXM7osFR6W...|[3dP9TiqxQt68zJP9...|3dP9XFmBWgDleSVv8...|0000-0002-1512-1345|[3dP9UXSkGCVOk4N2...|        qianqian li|                qli|[qianqian li, qia...|          [qli, qli]|  39115757|    Qianqian Li|     qianqian li|                  qli|                null|[-0.0995, -0.0148...|   Q525|  96780259|\n|  31760643|       pubmed|      PM_1008-pubmed|        20055-pubmed| 1228155751|      jiyoung lee|                 jlee|3dK6yQgf7UK6Ummlc...|  135688298|    W2124064745|     10.1002/bio.753|[3dP9Tpw6XW0RaifD...|[3dP9TBrvV7h5Mal9...|[3dP9TRKvrSwtkUjL...|3dP9YPjMeeu11u0Qj...|0000-0001-8936-1555|[3dP9TBkPpeeG7vZc...|        jiyoung lee|               jlee|[jiyoung lee, jiy...|        [jlee, jlee]|  51471926|    Jiyoung Lee|     jiyoung lee|                 jlee|                null|[0.0345, 0.063, 0...|   J524|  31760643|\n|  32889588|        kisti|    L.Zhang_19-kisti|          5868-kisti|   13310080|         li zhang|               lzhang|3dK6ylnilGhWJ9P7k...|   31276093|     W186371445|                null|[3dP9T9wbfTNfnCko...|[3dP9U6puyQBECN1M...|[3dP9TAXM9yJb2RQR...|3dP9WnhmCN1gJvM24...|               null|[3dP9UVup4DS5Ng25...|           li zhang|             lzhang|[li zhang, li zhang]|    [lzhang, lzhang]|2152827094|       Li Zhang|        li zhang|               lzhang|                null|[-0.0163, 0.0393,...|   L252|  32889588|\n|  32889588|        kisti|     A.Zhang_2-kisti|          5869-kisti| 1226240405|     aidong zhang|               azhang|3dK6ylnilGhWJ9P7k...|   31276293|     W186371445|                null|[3dP9T9wbfTNfnCko...|[3dP9U6puyQBECN1M...|[3dP9TAXM9yJb2RQR...|3dP9XbF57RFYFiVaS...|0000-0001-9723-3246|[3dP9UVup4DS5Ng25...|       aidong zhang|             azhang|[aidong zhang, ai...|    [azhang, azhang]| 145395060|       A. Zhang|         a zhang|               azhang|                null|[-0.0163, 0.0393,...|   A352|  32889588|\n| 116933461|      inspire|       24443-inspire|        2769-inspire| 1027932011|    michael grefe|               mgrefe|3dK6y6I9OIykrudqm...|   11620014|    W1510185555|                null|[3dP9UJg8REsVEGxt...|[3dP9Tf8Dz6L2XJK7...|[3dP9TYX00BFQCoBz...|3dP9aKGHxAgu2nvLy...|               null|                  []|      michael grefe|             mgrefe|[michael grefe, m...|    [mgrefe, mgrefe]| 102039792|       M. Grefe|         m grefe|               mgrefe|                null|[-0.0142, -0.0701...|   M242| 116933461|\n|  17081857|        kisti|       X.Gao_1-kisti|        101135-kisti|   10717739|     xiaoying gao|                 xgao|3dK6y8gVxePSsL3lv...|   15077805|    W1528771545|10.1007/978-3-540...|[3dP9T9wbfTNfnCko...|[3dP9U9MxjFUPogWz...|[3dP9T3La9GEOZL0r...|3dP9bwB9Si2PRAvx4...|0000-0002-6115-1342|[3dP9TBVDA8JatiSn...|       xiaoying gao|               xgao|[xiaoying gao, xi...|        [xgao, xgao]|  33411926|   Xiaoying Gao|    xiaoying gao|                 xgao|                null|[0.0334, -0.0599,...|   X522|  17081857|\n|   1852937|        kisti|      G.Chen_6-kisti|         26759-kisti|    9670311|    guanling chen|                gchen|3dK6yMxdXhOYtF2W3...|  146899031|    W2150003034|10.1109/percom.20...|[3dP9T9wbfTNfnCko...|[3dP9TW1EBPS7cVop...|[3dP9UO7E5ey7y3aX...|3dP9aWUmUoS5iqPfe...|0000-0003-4796-3931|[3dP9U5Hi1o8ZMZcX...|      guanling chen|              gchen|[guanling chen, g...|      [gchen, gchen]|   3045450|  Guanling Chen|   guanling chen|                gchen|                null|[-0.0464, 0.0119,...|   G545|   1852937|\n|   8003995|         qian|            398-qian|           1926-qian|    9635745|  jianzhong zhang|               jzhang|3dK6yDbd9ouHPU0ed...|  117227576|    W2086162420|10.1109/hpcc.2008.26|[3dP9T9wbfTNfnCko...|[3dP9U6puyQBECN1M...|[3dP9UFxOzSAud6lE...|3dP9Y6mp8g1yFcPXg...|               null|[3dP9U9Ea394Inbes...|    jianzhong zhang|             jzhang|[jianzhong zhang,...|    [jzhang, jzhang]|2108278042|Jianzhong Zhang| jianzhong zhang|               jzhang|                null|[-0.0595, 0.009, ...|   J525|   8003995|\n| 206034930|        kisti|      M.Sato_1-kisti|         68534-kisti| 1225502946|   mitsuhisa sato|                msato|3dK6yNngkO7F9EvYn...|   98037652|    W2056890985|10.1016/s0167-819...|[3dP9T9wbfTNfnCko...|[3dP9TethEseNtOAw...|[3dP9TwsfshgX5Y2D...|3dP9cnmvjsKwlsD1j...|               null|[3dP9UTGZWfn4rGsF...|     mitsuhisa sato|              msato|[mitsuhisa sato, ...|      [msato, msato]| 145063450|        M. Sato|          m sato|                msato|                null|[0.0216, 0.0458, ...|   M322| 206034930|\n|   8459736|   arnetminer|AM_wen gao_1-arne...|     6288-arnetminer|    4920321|          wen gao|                 wgao|3dK6yfButiIhmy30a...|  134831047|    W2124312647|10.1093/bioinform...|[3dP9Tpw6XW0RaifD...|[3dP9TK93o5RCYZyj...|[3dP9UBObxbU7CjXO...|3dP9XIt6NznTs5IsB...|               null|[3dP9URE8ZbKsVgs0...|            wen gao|               wgao|  [wen gao, wen gao]|        [wgao, wgao]|2153575717|        Wen Gao|         wen gao|                 wgao|                null|[-0.0419, 0.047, ...|   W520|   8459736|\n|   8459736|        kisti|        Y.Fu_4-kisti|        106724-kisti| 1227345813|           yan fu|                  yfu|3dK6yfButiIhmy30a...|  134831447|    W2124312647|10.1093/bioinform...|[3dP9Tpw6XW0RaifD...|[3dP9TK93o5RCYZyj...|[3dP9UBObxbU7CjXO...|3dP9Y2akRojJoxjSO...|0000-0001-6896-5931|[3dP9URE8ZbKsVgs0...|             yan fu|                yfu|[yan fu, yan fu, ...|[yfu, yfu, fy, fyan]| 145817033|         Yan Fu|          yan fu|                  yfu|                null|[-0.0419, 0.047, ...|   Y510|   8459736|\n| 119225094|      inspire|      413828-inspire|      752039-inspire|    4418283|    zygmunt patyk|               zpatyk|3dK6xz65FagIUqPMJ...|  116753998|    W2084090842|10.1103/physrevc....|[3dP9UJg8REsVEGxt...|[3dP9ULM38epuKq79...|[3dP9ThXSwSR73qVR...|3dP9Y48xlnxpwR4By...|               null|                  []|      zygmunt patyk|             zpatyk|[zygmunt patyk, z...|    [zpatyk, zpatyk]|  10417526|       Z. Patyk|         z patyk|               zpatyk|                null|[0.0407, 0.0927, ...|   Z255| 119225094|\n|  10011177|   arnetminer|AM_mark davis_1-a...|     4382-arnetminer| 1225457579|       mark davis|               mdavis|3dK6yDr1ug2zEiLBT...|   94870360|    W2052002929|10.1145/1641776.1...|[3dP9T9wbfTNfnCko...|[3dP9UB9bNPrBfdVG...|[3dP9Ta6HnVxT6NV1...|3dP9YWKaGCo3vAYoQ...|0000-0003-3688-8868|[3dP9U44wU81BXgL1...|         mark davis|             mdavis|[mark davis, mark...|    [mdavis, mdavis]| 144150498|       M. Davis|         m davis|               mdavis|                null|[-0.0894, 0.0222,...|   M623|  10011177|\n|  11832902|      inspire|      455976-inspire|      925084-inspire|     763050|       tsvi piran|               tpiran|3dK6ymOlNlnq8H3mh...|   54887392|    W1991189630|10.1088/1475-7516...|[3dP9UJg8REsVEGxt...|[3dP9U2OjehtBdj3v...|[3dP9T21hU9xYTGaa...|3dP9WX1bkIo3t3bsM...|0000-0002-7964-5420|[3dP9Uls3R154JCZw...|         tsvi piran|             tpiran|[tsvi piran, tsvi...|    [tpiran, tpiran]|   5718218|       T. Piran|         t piran|               tpiran|                null|[-0.0756, -0.0217...|   T211|  11832902|\n|  15623725|        kisti|G.Wiederhold_1-kisti|         28278-kisti|    9591877|   gio wiederhold|          gwiederhold|3dK6y4r9bmWfRasEz...|   71532170|    W2016622100| 10.1145/74382.74425|[3dP9T9wbfTNfnCko...|[3dP9UQW4sLQkOdRS...|[3dP9UPR6klLN8XSi...|3dP9ZSHJV36zTY8tF...|               null|[3dP9UB2IAewRLloz...|     gio wiederhold|        gwiederhold|[gio wiederhold, ...|[gwiederhold, gwi...|   1683556|  G. Wiederhold|    g wiederhold|          gwiederhold|                null|[-0.0181, 0.0462,...|   G364|  15623725|\n|   2486535|        kisti| A.Choudhary_1-kisti|           807-kisti| 1223277450|   alok choudhary|           achoudhary|3dK6yHDLWqmudzcXA...|  136399484|    W2126155101|10.1109/icnp.1995...|[3dP9T9wbfTNfnCko...|[3dP9UDK1pv8nqq2J...|[3dP9TVmDbDozTKUQ...|3dP9XGUjRHCvS4wsg...|               null|[3dP9UgSp1o4MCi08...|     alok choudhary|         achoudhary|[alok choudhary, ...|[achoudhary, acho...| 143975793|   A. Choudhary|     a choudhary|           achoudhary|                null|[-0.0147, -0.0096...|   A422|   2486535|\n|  16992213|      inspire|      505667-inspire|     1080266-inspire|   11773995|      z silagadze|           zsilagadze|3dK6yR2nCTKuK8gBf...|   31994921|    W1876032328|                null|[3dP9UJg8REsVEGxt...|[3dP9UW28eLfckTBn...|[3dP9UXwflHStzNNt...|3dP9VeZU8RQyX4DHV...|               null|                  []|      z k silagadze|         zsilagadze|[z k silagadze, z...|[zsilagadze, zsil...|   5038166|   Z. Silagadze|     z silagadze|           zsilagadze|                null|[0.0029, -0.0998,...|   Z224|  16992213|\n|  16989082|        kisti|   A.Agarwal_2-kisti|            16-kisti| 1227597619|    ankur agarwal|             aagarwal|3dK6ydOaws49dY9MR...|  417313949|      W57724758|                null|[3dP9T9wbfTNfnCko...|[3dP9Tu7nR4wxjO2J...|[3dP9U5WuhKVdmeOR...|3dP9bBGjrCv8pQAQc...|               null|[3dP9UFMYSHoPl852...|      ankur agarwal|           aagarwal|[ankur agarwal, a...|[aagarwal, aagarwal]| 150004677|     A. Agarwal|       a agarwal|             aagarwal|                null|[0.0158, -0.0372,...|   A526|  16989082|\n| 121496414|       zbmath| falk.michael-zbmath|        13391-zbmath|    3491638|     michael falk|                mfalk|3dK6yeMe2MlLM4Iry...|   99834866|    W2058927538|10.1214/aos/10347...|[3dP9Tk3iyZHc49pp...|[3dP9US4C9fKo8B86...|[3dP9TyoHqMD6QRd5...|3dP9W6cv24aaoS0KC...|0000-0003-1423-7503|                  []|       michael falk|              mfalk|[michael falk, mi...|      [mfalk, mfalk]|  48331364|        M. Falk|          m falk|                mfalk|                null|[-0.0345, 0.0307,...|   M241| 121496414|\n|  16447326|   arnetminer|AM_lei wang_77-ar...|     3840-arnetminer| 1225388651|         lei wang|                lwang|3dK6y0HyPGCNtlbzD...|   88486043|    W2042735629| 10.1109/cit.2006.38|[3dP9T9wbfTNfnCko...|[3dP9U52zCFZgm8L7...|[3dP9TWcGnucelmRX...|3dP9WoApJRInxClJR...|0000-0002-0077-145X|[3dP9TA4P5ZO6kA1q...|           lei wang|              lwang|[lei wang, lei wang]|      [lwang, lwang]|2152504041|       Lei Wang|        lei wang|                lwang|                null|[-0.0606, 0.0014,...|   L520|  16447326|\n| 122809963|       zbmath|de-la-sen.manuel-...|         1000-zbmath|    1365574|            m sen|                 msen|3dK6yjOryaF40jzWH...|  150260115|    W2156394705|10.1080/002077293...|[3dP9Tk3iyZHc49pp...|[3dP9TIZm0kn980Pc...|[3dP9U0xLK8dVt4ww...|3dP9YeN69eeKGymaX...|0000-0001-9320-9433|[3dP9TnlyaOABTrQE...|        m de la sen|               msen|[m de la sen, m  ...|        [msen, msen]|   1752529|         M. Sen|           m sen|                 msen|                null|[-0.0657, 0.0253,...|   M342| 122809963|\n|   6771960|        kisti|       G.Fox_1-kisti|         26841-kisti| 1226550300|     geoffrey fox|                 gfox|3dK6yqwm4HGSLy76J...|   14674002|    W1534676529|10.1109/icdcs.199...|[3dP9T9wbfTNfnCko...|[3dP9TqB1SPQkj3DE...|[3dP9UUEQWpmnGcMh...|3dP9WtZHNJ9UilMGh...|0000-0003-1017-1391|[3dP9UgSp1o4MCi08...|     geoffrey c fox|               gfox|[geoffrey c fox, ...|        [gfox, gfox]| 145943292|         G. Fox|           g fox|                 gfox|                null|[-0.079, -0.0243,...|   G162|   6771960|\n| 122350583|       zbmath| frey.gerhard-zbmath|        14006-zbmath|   15364660|     gerhard frey|                gfrey|3dK6ykLeVOl1pY9tr...|  104563774|    W2065585869|  10.1007/bf01323464|[3dP9Tk3iyZHc49pp...|[3dP9TMX8FQi8eIxj...|[3dP9TPInPlulmBnl...|3dP9bmaQce6xm6o3m...|               null|[3dP9UnJLLXnagoov...|       gerhard frey|              gfrey|[gerhard frey, ge...|      [gfrey, gfrey]| 143968192|        G. Frey|          g frey|                gfrey|                null|[-0.0083, 0.0413,...|   G663| 122350583|\n|  37555026|   arnetminer|AM_feng liu_2-arn...|     1564-arnetminer|   16767059|         feng liu|                 fliu|3dK6y1xz9LW7fJR4x...|  149659194|    W2153766125|10.1109/icip.2002...|[3dP9T9wbfTNfnCko...|[3dP9TpKZhfrRyIE0...|[3dP9TtXF1ukmyBXT...|3dP9ZVHOzZWRJJzoc...|0000-0002-5399-6214|[3dP9UdSd7F67EBQK...|           feng liu|               fliu|[feng liu, feng liu]|        [fliu, fliu]|  50207926|         F. Liu|           f liu|                 fliu|                null|[-0.0414, 0.0212,...|   F524|  37555026|\n|   1721968|   arnetminer|AM_david c. wilso...|      959-arnetminer| 1227899152|     david wilson|              dwilson|3dK6y6HlDdOntwrNV...|   21421294|    W1591776485|10.1007/978-3-642...|[3dP9T9wbfTNfnCko...|[3dP9U9MxjFUPogWz...|[3dP9TXvxNg8xil40...|3dP9WkohmbNIgtTeL...|0000-0002-0611-3431|[3dP9TZymVQ8I5fen...|       david wilson|            dwilson|[david wilson, da...|  [dwilson, dwilson]| 144254638|David C. Wilson|  david c wilson|              dwilson|                null|[0.0093, -0.0413,...|   D134|   1721968|\n|    939940|   arnetminer|AM_david e. goldb...|     1063-arnetminer|   14795947|   david goldberg|            dgoldberg|3dK6y2Zo7Bt7GRbyu...|   50547031|    W1984836227|10.1145/1276958.1...|[3dP9T9wbfTNfnCko...|[3dP9U9MxjFUPogWz...|[3dP9TmRbKZe9AqZn...|3dP9XeEIDx1VpiymC...|               null|[3dP9UMCOqiuWI7bX...|   david e goldberg|          dgoldberg|[david e goldberg...|[dgoldberg, dgold...|   1715339|    D. Goldberg|      d goldberg|            dgoldberg|                null|[0.0391, -0.0139,...|   D132|    939940|\n|   9317964|        kisti|        D.Du_2-kisti|         17877-kisti| 1227840599|       dingzhu du|                  ddu|3dK6xvV2nrL5UYswa...|   69394971|    W2011697440|10.1016/s0012-365...|[3dP9Tk3iyZHc49pp...|[3dP9T9hIxHd4X0gm...|[3dP9THyjOFdskFkf...|3dP9VdMialJ0DgjW1...|0000-0002-7345-2185|[3dP9TpJzRfUkrpsg...|         dingzhu du|                ddu|[dingzhu du, ding...|          [ddu, ddu]| 145902418|          D. Du|            d du|                  ddu|                null|[0.0717, -0.0464,...|   D523|   9317964|\n|    777086|         qian|           1147-qian|           6385-qian|   16142513|         yan wang|                ywang|3dK6yE62Urdl46hoR...|   75637550|    W2021753913| 10.1155/2008/402519|[3dP9T9wbfTNfnCko...|[3dP9TSf6eZUfO2Hu...|[3dP9UA4vNpyutpm7...|3dP9ZLJBTAzb02wS9...|0000-0001-9052-5756|[3dP9TmgQCncZ229U...|           yan wang|              ywang|[yan wang, yan wang]|      [ywang, ywang]|  35855941|       Yan Wang|        yan wang|                ywang|[0000-0002-5344-1...|[-0.0365, 0.0889,...|   Y552|    777086|\n|  13991140|        kisti|     C.Giles_1-kisti|         10555-kisti| 1224874636|          c giles|               cgiles|3dK6yhwzo37yUWePY...|  144469324|    W2145846169|10.1007/3-540-609...|[3dP9T9wbfTNfnCko...|[3dP9UHe62DGWvNwv...|[3dP9TtIQ9goyHRDA...|3dP9XATyCDwinzdBB...|0000-0002-1931-585X|[3dP9UHWCZRqSAxhA...|        c lee giles|             cgiles|[c lee giles, c  ...|    [cgiles, cgiles]| 145157784|   C. Lee Giles|     c lee giles|               cgiles|                null|[-0.08, -0.0884, ...|   C424|  13991140|\n|   5895184|        kisti|       A.Jr._1-kisti|          2990-kisti| 1224716586|     alceu britto|              abritto|3dK6y5SOJcRaiQK6t...|   42551567|    W1970571079|10.1007/s10032-00...|[3dP9T9wbfTNfnCko...|[3dP9U9MxjFUPogWz...|[3dP9UZVTLH8AmyMN...|3dP9b6Ehcx1tXTnKL...|0000-0002-3064-3563|[3dP9UFLm6waWgTKG...|     alceu s britto|            abritto|[alceu s britto, ...|  [abritto, abritto]| 143772141|      A. Britto|        a britto|              abritto|                null|[-5.0E-4, 0.0535,...|   A422|   5895184|\n|  18032150|      inspire|      461627-inspire|      945737-inspire|    4699671| tsutomu yanagida|            tyanagida|3dK6yjVgy0CgIhVgh...|   54756143|    W1990606744|10.1016/0370-2693...|[3dP9UJg8REsVEGxt...|[3dP9U2OjehtBdj3v...|[3dP9TOoNhLshguUZ...|3dP9XMiepCWbtnzxg...|               null|[3dP9UVnJm7dHF1Bs...|    toshio yanagida|          tyanagida|[toshio yanagida,...|[tyanagida, tyana...|  41221720|    T. Yanagida|      t yanagida|            tyanagida|                null|[-0.1777, -0.0493...|   T252|  18032150|\n| 121375499|       zbmath|weber.helmut-geor...|        15813-zbmath|  929295156|          h weber|               hweber|3dK6xIkwVu8aER4Tl...|   69883171|    W2012404336|     10.1137/0905025|[3dP9Tk3iyZHc49pp...|[3dP9US4C9fKo8B86...|[3dP9UQlBsZcZWWDu...|3dP9XG7dIzJVCaoFH...|               null|                  []|            h weber|             hweber| [h weber, h  weber]|    [hweber, hweber]| 144286315|       H. Weber|         h weber|               hweber|                null|[-0.1144, 0.0075,...|   H160| 121375499|\n|  14783009|      inspire|      256628-inspire|       71131-inspire| 1025354752|mikhail smolyakov|           msmolyakov|3dK6xuebQV2AiNWi3...|   79512559|    W2029262071|10.1088/0264-9381...|[3dP9UJg8REsVEGxt...|[3dP9U2OjehtBdj3v...|[3dP9UARpoABX9qFX...|3dP9WjrEx73M9QBQe...|0000-0002-8736-838X|                  []|mikhail n smolyakov|         msmolyakov|[mikhail n smolya...|[msmolyakov, msmo...| 100532719|   M. Smolyakov|     m smolyakov|           msmolyakov|                null|[0.0266, -0.029, ...|   M245|  14783009|\n|  39778387|         qian|            410-qian|           2004-qian|   16171120|        jing wang|                jwang|3dK6yofokMGucgJGm...|   64598359|    W2006341396|10.4304/jmm.4.6.4...|[3dP9T9wbfTNfnCko...|[3dP9UEWJAGGxS6hW...|[3dP9TGeYb97GBRBp...|3dP9WWQ4uSZy2Im5q...|               null|[3dP9TXa7o4WH1YVY...|          jing wang|              jwang|[jing wang, jing ...|      [jwang, jwang]|2152445877|      Jing Wang|       jing wang|                jwang|                null|[-0.0122, 0.1001,...|   J525|  39778387|\n| 121302757|       zbmath|falin.gennadi-i-z...|         1360-zbmath|    9175414|    gennadi falin|               gfalin|3dK6yruj76aUknfQQ...|   76438126|    W2022510778|10.1080/153263495...|[3dP9Tk3iyZHc49pp...|[3dP9TvgUb21hMNEB...|[3dP9TsviC4YsI8jE...|3dP9YOPg4tM0NqsyQ...|               null|[3dP9Tet0wCpHNmEm...|          g i falin|             gfalin|[g i falin, g  i ...|    [gfalin, gfalin]|2084156231|       G. Falin|         g falin|               gfalin|                null|[-0.0601, 0.0684,...|   G145| 121302757|\n|  17000458|      inspire|      253046-inspire|       57952-inspire|   13711488|    harald grosse|              hgrosse|3dK6yFOr3zhgBAVaA...|   57850374|    W1995578123|10.1088/0305-4470...|[3dP9UJg8REsVEGxt...|[3dP9TqPRmabto6nI...|[3dP9T596BRIvvYr5...|3dP9ZZ7FYmR1ygdFR...|               null|                  []|      harald grosse|            hgrosse|[harald grosse, h...|  [hgrosse, hgrosse]|   2908786|      H. Grosse|        h grosse|              hgrosse|                null|[-0.1608, 0.0252,...|   H643|  17000458|\n|  41849088|        kisti|       K.Lai_5-kisti|         56390-kisti|    7898044|        kwong lai|                 klai|3dK6xepArAYemMMDe...|  127183562|    W2104390490| 10.1155/2005/513531|[3dP9T9wbfTNfnCko...|[3dP9UB9bNPrBfdVG...|[3dP9TNrbAXNmLrAI...|3dP9ZAshB3Lqt4HXQ...|               null|[3dP9TtWeluOMABUX...|     kwong yuen lai|               klai|[kwong yuen lai, ...|        [klai, klai]|   2054811|      K. Y. Lai|         k y lai|                 klai|                null|[0.0632, 0.0298, ...|   K525|  41849088|\n|  15562752|   arnetminer|AM_qiang shen_1-a...|     4855-arnetminer|    3724813|       qiang shen|                qshen|3dK6yF9w96JUqtHej...|  129002795|    W2108571399|10.1109/tsmca.200...|[3dP9T9wbfTNfnCko...|                  []|[3dP9UQlHvF2odG5v...|3dP9at9xPubrD3xns...|0000-0001-9333-4605|[3dP9TLLdGQmE6vru...|         qiang shen|              qshen|[qiang shen, qian...|      [qshen, qshen]| 144576537|        Q. Shen|          q shen|                qshen|                null|[-0.126, 8.0E-4, ...|   Q522|  15562752|\n| 117368208|      inspire|      395072-inspire|      668228-inspire| 1339904544|            k bos|                 kbos|3dK6xvjldPzJ78Xwu...|  127685642|    W2100567518|10.1103/physrevd....|[3dP9UJg8REsVEGxt...|[3dP9TeX5Jvpi0UZn...|[3dP9UITr6tp9aTlk...|3dP9XzEEkJ9tXWG0m...|               null|[3dP9TZceQRA3sYiz...|              k bos|               kbos|     [k bos, k  bos]|        [kbos, kbos]| 152579218|         K. Bos|           k bos|                 kbos|                null|[-0.0806, 0.1022,...|   K120| 117368208|\n| 117368208|      inspire|      374816-inspire|      582820-inspire| 1380897403|           p balm|                pbalm|3dK6xvjldPzJ78Xwu...|  127685842|    W2100567518|10.1103/physrevd....|[3dP9UJg8REsVEGxt...|[3dP9TeX5Jvpi0UZn...|[3dP9UITr6tp9aTlk...|3dP9c4hUoZPL8X49Q...|               null|[3dP9TZceQRA3sYiz...|           p w balm|              pbalm|[p w balm, p  w  ...|      [pbalm, pbalm]|   4178573|        P. Balm|          p balm|                pbalm|                null|[-0.0806, 0.1022,...|   P145| 117368208|\n| 117368208|      inspire|      293647-inspire|      244882-inspire| 1088359893|        f blekman|             fblekman|3dK6xvjldPzJ78Xwu...|  127686042|    W2100567518|10.1103/physrevd....|[3dP9UJg8REsVEGxt...|[3dP9TeX5Jvpi0UZn...|[3dP9UITr6tp9aTlk...|3dP9Wn6RRrfK5fLRJ...|               null|[3dP9TZceQRA3sYiz...|          f blekman|           fblekman|[f blekman, f  bl...|[fblekman, fblekman]| 117926956|     F. Blekman|       f blekman|             fblekman|                null|[-0.0806, 0.1022,...|   F142| 117368208|\n| 117368208|      inspire|      148484-inspire|       20064-inspire| 1033080338|         v abazov|              vabazov|3dK6xvjldPzJ78Xwu...|  127686442|    W2100567518|10.1103/physrevd....|[3dP9UJg8REsVEGxt...|[3dP9TeX5Jvpi0UZn...|[3dP9UITr6tp9aTlk...|3dP9WbSVJO21yNFY3...|               null|[3dP9UdxR0KfisC03...|         v m abazov|            vabazov|[v m abazov, v  m...|  [vabazov, vabazov]| 102637965|      V. Abazov|        v abazov|              vabazov|                null|[-0.0806, 0.1022,...|   V512| 117368208|\n|   1945331|        kisti|     H.Chang_3-kisti|         29562-kisti|   14527824|      herve chang|               hchang|3dK6y8RhSnfAj5veB...|  128359313|    W2107722730|  10.1007/11839569_8|[3dP9TpKNcL4BZ4fP...|                  []|[3dP9TRwShJ8kzgjn...|3dP9ayn2GfY4IsXx5...|               null|[3dP9TRSvMtjbDfnG...|        herve chang|             hchang|[herve chang, her...|    [hchang, hchang]|  35441037|    Hervé Chang|     herve chang|               hchang|                null|[-0.1254, 0.027, ...|   H612|   1945331|\n|  29622238|        kisti|       K.Lam_1-kisti|         56491-kisti|    7312663|       kamyiu lam|                 klam|3dK6yBCy563oeMO97...|   47547981|    W1979776771|10.1016/s0164-121...|[3dP9T9wbfTNfnCko...|[3dP9UaE1FsAEVJrM...|[3dP9TFaYuF1OaOKZ...|3dP9bpSih4SI7OQTg...|               null|[3dP9TmgWFT2M1AlL...|         kamyiu lam|               klam|[kamyiu lam, kam ...|        [klam, klam]|  34454712|         K. Lam|           k lam|                 klam|                null|[-0.0917, 0.0237,...|   K545|  29622238|\n|  29622238|        kisti|       K.Lam_1-kisti|         56491-kisti|    7312663|       kamyiu lam|                 klam|3dK6yBCy563oeMO97...|   47547981|    W1979776771|10.1016/s0164-121...|[3dP9T9wbfTNfnCko...|[3dP9UaE1FsAEVJrM...|[3dP9TFaYuF1OaOKZ...|3dP9bpSih4SI7OQTg...|               null|[3dP9TmgWFT2M1AlL...|         kamyiu lam|               klam|[kamyiu lam, kam ...|        [klam, klam]|   1773118|         K. Lam|           k lam|                 klam|                null|[-0.0917, 0.0237,...|   K545|  29622238|\n+----------+-------------+--------------------+--------------------+-----------+-----------------+---------------------+--------------------+-----------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------------------+--------------------+-------------------+-------------------+--------------------+--------------------+----------+---------------+----------------+---------------------+--------------------+--------------------+-------+----------+\nonly showing top 50 rows\n\n\u001b[1m\u001b[34mS2AND_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/S2AND\n\u001b[1m\u001b[34ms2and_omiros\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OAauthorId: string, OAdoi: string ... 34 more fields]\n\u001b[1m\u001b[34ms2and_omiros_ids\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [S2paperId: bigint]\n\u001b[1m\u001b[34ms2and_lubos\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [s2CorpusId: bigint, sampleDataset: string ... 26 more fields]\n\u001b[1m\u001b[34ms2and_lubos_ids\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [s2CorpusId: bigint]\n\u001b[1m\u001b[34mnotfound\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [s2CorpusId: bigint]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {}
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nval OA_S2_Pub_Authors =   spark.read.parquet(\"/media/ometaxas/nvme/datasets/OA_S2/OA_S2_Pub_Authors_doi_mag_dedup.parquet\")\n//OA_S2_Pub_Authors.printSchema()\n/*\nval listValues = Seq(119071033,122098301,8161426,14726155,206841351)\nval OA_S2_Pub_Authors_notMatched =  OA_S2_Pub_Authors\n//.filter($\"S2paperId\"===119071033)\n .filter($\"S2paperId\".isin(listValues:_*))\n .cache()\n\nOA_S2_Pub_Authors_notMatched.show()\n\n */\n\nval OA_S2_S2AND_signatures_notMatched = OA_S2_Pub_Authors_notMatched\n  //.filter($\"S2paperId\"===\"17081857\")\n //.join(broadcast(S2ANDsignatures), $\"paper_id\" === $\"S2paperId\"  \n   //                        && ( $\"S2shortNormName\"=== $\"author_info_shortnormname\"  || (  jaro_winkler($\"author_info_normname\", $\"S2normName\") > 0.82 && levenshtein($\"author_info_normname\", $\"S2normName\")<3     && (soundex($\"author_info_normname\") === soundex($\"S2normName\")))) \n     //                  , \"inner\")   \n                      \n                     \n                   .join(broadcast(S2ANDsignatures), $\"paper_id\" === $\"S2paperId\"  \n                           && ( $\"S2shortNormName\"=== $\"author_info_shortnormname\"   || (  jaro_winkler($\"author_info_normname\", $\"S2normName\") > 0.7 && levenshtein($\"author_info_normname\", $\"S2normName\")<4  )   || (soundex($\"author_info_normname\") === soundex($\"S2normName\"))) \n                       , \"inner\")                  \n //laizenberg laizenberg\n //S2ANDsignatures.filter($\"paper_id\".isin(listValues:_*)).show() //.cache()\n//.filter($\"S2paperId\"===\"17081857\")\n //                  .join(broadcast(S2ANDsignatures), $\"paper_id\" === $\"S2paperId\"  \n   //                        && ( $\"S2shortNormName\"=== $\"author_info_shortnormname\"   || (  jaro_winkler($\"author_info_normname\", $\"S2normName\") > 0.7 && levenshtein($\"author_info_normname\", $\"S2normName\")<4  )   || (soundex($\"author_info_normname\") === soundex($\"S2normName\"))) \n     //                  , \"inner\")                    \n OA_S2_S2AND_signatures_notMatched.show()\n \nval w = Window.partitionBy($\"signature_id\").orderBy(levenshtein($\"S2normName\", $\"author_info_normname\"), lit(1)-jaro_winkler($\"S2normName\", $\"author_info_normname\") )\n\nval OA_S2_S2AND_signatures_notMatched_dedup = OA_S2_S2AND_signatures_notMatched.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\n\n OA_S2_S2AND_signatures_notMatched_dedup.show()\n \n ",
   "id": "",
   "dateCreated": "2022-12-11 20:52:35.374",
   "config": {
    "tableHide": false,
    "title": true
   },
   "dateStarted": "2022-12-12 17:57:16.342",
   "dateUpdated": "2022-12-12 17:57:28.197",
   "dateFinished": "2022-12-12 17:57:28.197",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+-----------+--------------------+--------------------+--------------------+----------+-----------------+-----------+-------------------+---------------+-------------+---------------+--------------------+----------------------+--------------------+---------+--------------------+------------------+----------+--------------+----------+---------------+-----------+----------+------------------------+-----------------+-----------------+----------------+------------------+--------------------+------------------+---------+------------+-------+--------------------+--------------------+-------------------------+\n|  OApaperId|               OAdoi|             OAfos_0|             OAfos_1|   OAmagId|           OAname| OAauthorId|              orcid|OAshortNormName|   OAnormName|affiliationsIds|          coAuthorId|coAuthorShortNormNames|             S2title|S2paperId|               S2doi|             S2fos|   S2magId|        S2name|S2authorId|S2shortNormName| S2normName| author_id|author_info_affiliations|author_info_email|author_info_first|author_info_last|author_info_middle|author_info_position|author_info_suffix| paper_id|signature_id|dataset|author_info_fullname|author_info_normname|author_info_shortnormname|\n+-----------+--------------------+--------------------+--------------------+----------+-----------------+-----------+-------------------+---------------+-------------+---------------+--------------------+----------------------+--------------------+---------+--------------------+------------------+----------+--------------+----------+---------------+-----------+----------+------------------------+-----------------+-----------------+----------------+------------------+--------------------+------------------+---------+------------+-------+--------------------+--------------------+-------------------------+\n|W2012147031|     10.1137/0508053|[Mathematics, Phy...|[Mathematical ana...|2012147031|Frank W. J. Olver|A2281505006|               null|         folver| frankwjolver|             []|       [A2281505006]|              [folver]|Connection Formul...|122098301|     10.1137/0508053|     [Mathematics]|2012147031|      F. Olver|   2668590|         folver|     folver|  12663205|                      []|             null|               F.|           Olver|             W. J.|                   0|              null|122098301|        3310| zbmath|            F. Olver|              folver|                   folver|\n|  W19766212|  10.1007/bfb0015975|[Computer science...|[Artificial intel...|  19766212|   Stefan Fischer|A2874095390|               null|       sfischer|stefanfischer|     [I5124864]|[A2874095390, A21...|      [sfischer, bduc]|Shape Normalisait...|206841351|  10.1007/bfb0015975|[Computer Science]|  19766212|    S. Fischer|2061647120|       sfischer|   sfischer|   7979154|    [ecole polytechni...|             null|           Stefan|         Fischer|              null|                   0|              null|206841351|        5050|   qian|      Stefan Fischer|       stefanfischer|                 sfischer|\n|W1612866960|                null|[Computer science...|[Risk analysis (e...|1612866960|       David Ford|A2703121602|               null|          dford|    davidford|             []|[A2528315235, A27...|  [mglass, dford, s...|Reducing the Risk...| 14726155|                null|[Computer Science]|1612866960|       D. Ford|2053921696|          dford|      dford|1227834772|                      []|             null|            David|            Ford|              null|                   1|              null| 14726155|         853|   qian|          David Ford|           davidford|                    dford|\n|W1491642900|                null|[Computer science...|[Programming lang...|1491642900|      Dale Miller|A2144406363|0000-0003-0274-4954|        dmiller|   dalemiller|             []|[A714397532, A214...|  [rpareschi, dmiller]|Extending Definit...|  8161426|                null|[Computer Science]|1491642900|Dale A. Miller| 145547269|        dmiller|daleamiller|1227879194|                      []|             null|             Dale|          Miller|              null|                   1|              null|  8161426|       20464|  kisti|         Dale Miller|          dalemiller|                  dmiller|\n| W761096860|10.1007/978-94-01...|[Mathematics, Pol...|[Combinatorics, M...| 761096860|    Lev Aizenberg|A2477570733|               null|     laizenberg| levaizenberg|         [null]|       [A2477570733]|          [laizenberg]|Multidimensional ...|119071033|10.1007/978-94-01...|     [Mathematics]| 761096860|  L. Aĭzenberg|  36314623|     laizenberg| laizenberg|   6796616|                      []|             null|              Lev|       Aizenberg|              null|                   0|              null|119071033|         126| zbmath|       Lev Aizenberg|        levaizenberg|               laizenberg|\n+-----------+--------------------+--------------------+--------------------+----------+-----------------+-----------+-------------------+---------------+-------------+---------------+--------------------+----------------------+--------------------+---------+--------------------+------------------+----------+--------------+----------+---------------+-----------+----------+------------------------+-----------------+-----------------+----------------+------------------+--------------------+------------------+---------+------------+-------+--------------------+--------------------+-------------------------+\n\n+-----------+--------------------+--------------------+--------------------+----------+-----------------+-----------+-------------------+---------------+-------------+---------------+--------------------+----------------------+--------------------+---------+--------------------+------------------+----------+--------------+----------+---------------+-----------+----------+------------------------+-----------------+-----------------+----------------+------------------+--------------------+------------------+---------+------------+-------+--------------------+--------------------+-------------------------+\n|  OApaperId|               OAdoi|             OAfos_0|             OAfos_1|   OAmagId|           OAname| OAauthorId|              orcid|OAshortNormName|   OAnormName|affiliationsIds|          coAuthorId|coAuthorShortNormNames|             S2title|S2paperId|               S2doi|             S2fos|   S2magId|        S2name|S2authorId|S2shortNormName| S2normName| author_id|author_info_affiliations|author_info_email|author_info_first|author_info_last|author_info_middle|author_info_position|author_info_suffix| paper_id|signature_id|dataset|author_info_fullname|author_info_normname|author_info_shortnormname|\n+-----------+--------------------+--------------------+--------------------+----------+-----------------+-----------+-------------------+---------------+-------------+---------------+--------------------+----------------------+--------------------+---------+--------------------+------------------+----------+--------------+----------+---------------+-----------+----------+------------------------+-----------------+-----------------+----------------+------------------+--------------------+------------------+---------+------------+-------+--------------------+--------------------+-------------------------+\n| W761096860|10.1007/978-94-01...|[Mathematics, Pol...|[Combinatorics, M...| 761096860|    Lev Aizenberg|A2477570733|               null|     laizenberg| levaizenberg|         [null]|       [A2477570733]|          [laizenberg]|Multidimensional ...|119071033|10.1007/978-94-01...|     [Mathematics]| 761096860|  L. Aĭzenberg|  36314623|     laizenberg| laizenberg|   6796616|                      []|             null|              Lev|       Aizenberg|              null|                   0|              null|119071033|         126| zbmath|       Lev Aizenberg|        levaizenberg|               laizenberg|\n|W1491642900|                null|[Computer science...|[Programming lang...|1491642900|      Dale Miller|A2144406363|0000-0003-0274-4954|        dmiller|   dalemiller|             []|[A714397532, A214...|  [rpareschi, dmiller]|Extending Definit...|  8161426|                null|[Computer Science]|1491642900|Dale A. Miller| 145547269|        dmiller|daleamiller|1227879194|                      []|             null|             Dale|          Miller|              null|                   1|              null|  8161426|       20464|  kisti|         Dale Miller|          dalemiller|                  dmiller|\n|W2012147031|     10.1137/0508053|[Mathematics, Phy...|[Mathematical ana...|2012147031|Frank W. J. Olver|A2281505006|               null|         folver| frankwjolver|             []|       [A2281505006]|              [folver]|Connection Formul...|122098301|     10.1137/0508053|     [Mathematics]|2012147031|      F. Olver|   2668590|         folver|     folver|  12663205|                      []|             null|               F.|           Olver|             W. J.|                   0|              null|122098301|        3310| zbmath|            F. Olver|              folver|                   folver|\n|  W19766212|  10.1007/bfb0015975|[Computer science...|[Artificial intel...|  19766212|   Stefan Fischer|A2874095390|               null|       sfischer|stefanfischer|     [I5124864]|[A2874095390, A21...|      [sfischer, bduc]|Shape Normalisait...|206841351|  10.1007/bfb0015975|[Computer Science]|  19766212|    S. Fischer|2061647120|       sfischer|   sfischer|   7979154|    [ecole polytechni...|             null|           Stefan|         Fischer|              null|                   0|              null|206841351|        5050|   qian|      Stefan Fischer|       stefanfischer|                 sfischer|\n|W1612866960|                null|[Computer science...|[Risk analysis (e...|1612866960|       David Ford|A2703121602|               null|          dford|    davidford|             []|[A2528315235, A27...|  [mglass, dford, s...|Reducing the Risk...| 14726155|                null|[Computer Science]|1612866960|       D. Ford|2053921696|          dford|      dford|1227834772|                      []|             null|            David|            Ford|              null|                   1|              null| 14726155|         853|   qian|          David Ford|           davidford|                    dford|\n+-----------+--------------------+--------------------+--------------------+----------+-----------------+-----------+-------------------+---------------+-------------+---------------+--------------------+----------------------+--------------------+---------+--------------------+------------------+----------+--------------+----------+---------------+-----------+----------+------------------------+-----------------+-----------------+----------------+------------------+--------------------+------------------+---------+------------+-------+--------------------+--------------------+-------------------------+\n\n\u001b[1m\u001b[34mOA_S2_Pub_Authors\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 20 more fields]\n\u001b[1m\u001b[34mOA_S2_S2AND_signatures_notMatched\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 34 more fields]\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@7de748f2\n\u001b[1m\u001b[34mOA_S2_S2AND_signatures_notMatched_dedup\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [OApaperId: string, OAdoi: string ... 34 more fields]\n"
     }
    ]
   },
   "title": "Analyze signatures not found"
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "%spark\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions._\n\nval simpleData = Seq((\"James\",\"Jamie\", 111), \n    (\"James\",\"james\", 111), \n    (\"James\",\"Jamis\", 111), \n    (\"James\",\"Jameson\", 111), \n    (\"James\", \"James11\", 111), \n    (\"maria\",\"Maria\", 222), \n    (\"maria\",\"moria\",222), \n    (\"maria\",\"maria1\",222),\n    (\"maria\",\"Marianna\",222)   \n    )\n  \n\nval df = simpleData.toDF(\"name1\",\"name2\", \"id\")\ndf.printSchema()\ndf.show(false)\n\nval w = Window.partitionBy($\"id\").orderBy(levenshtein($\"name1\", $\"name2\") , lit(1) - (soundex($\"name1\") === soundex($\"name2\")).cast(\"integer\"), lit(1)-jaro_winkler($\"name1\", $\"name2\"))\n        //.orderBy(levenshtein($\"s2AuthorNormName\", $\"authorNormName\"))\n\nval df1 = df\n.withColumn(\"levenshtein\",levenshtein($\"name1\", $\"name2\"))\n.withColumn(\"jaro_winkler\",lit(1)-jaro_winkler($\"name1\", $\"name2\"))\n.withColumn(\"soundex\", (soundex($\"name1\") === soundex($\"name2\")).cast(\"integer\"))\n.withColumn(\"rn\", row_number.over(w)) //.where($\"rn\" === 1).drop(\"rn\")\ndf1.show()\n\nval df_dedup = df.withColumn(\"rn\", row_number.over(w)).where($\"rn\" === 1).drop(\"rn\")\ndf_dedup.show()\n\n\n",
   "id": "",
   "dateCreated": "2022-12-11 17:26:26.588",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2022-12-11 18:05:09.479",
   "dateUpdated": "2022-12-11 18:05:10.671",
   "dateFinished": "2022-12-11 18:05:10.671",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- name1: string (nullable = true)\n |-- name2: string (nullable = true)\n |-- id: integer (nullable = false)\n\n+-----+--------+---+\n|name1|name2   |id |\n+-----+--------+---+\n|James|Jamie   |111|\n|James|james   |111|\n|James|Jamis   |111|\n|James|Jameson |111|\n|James|James11 |111|\n|maria|Maria   |222|\n|maria|moria   |222|\n|maria|maria1  |222|\n|maria|Marianna|222|\n+-----+--------+---+\n\n+-----+--------+---+-----------+--------------------+-------+---+\n|name1|   name2| id|levenshtein|        jaro_winkler|soundex| rn|\n+-----+--------+---+-----------+--------------------+-------+---+\n|James|   Jamis|111|          1| 0.09333333333333327|      1|  1|\n|James|   james|111|          1|  0.1333333333333333|      1|  2|\n|James| James11|111|          2| 0.05714285714285716|      1|  3|\n|James| Jameson|111|          2| 0.05714285714285716|      0|  4|\n|James|   Jamie|111|          2| 0.09333333333333327|      0|  5|\n|maria|  maria1|222|          1|0.033333333333333326|      1|  1|\n|maria|   moria|222|          1|                0.12|      1|  2|\n|maria|   Maria|222|          1|  0.1333333333333333|      1|  3|\n|maria|Marianna|222|          4|  0.2333333333333334|      0|  4|\n+-----+--------+---+-----------+--------------------+-------+---+\n\n+-----+------+---+\n|name1| name2| id|\n+-----+------+---+\n|James| Jamis|111|\n|maria|maria1|222|\n+-----+------+---+\n\nimport com.github.mrpowers.spark.stringmetric.SimilarityFunctions._\nimport com.github.mrpowers.spark.stringmetric.PhoneticAlgorithms._\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34msimpleData\u001b[0m: \u001b[1m\u001b[32mSeq[(String, String, Int)]\u001b[0m = List((James,Jamie,111), (James,james,111), (James,Jamis,111), (James,Jameson,111), (James,James11,111), (maria,Maria,222), (maria,moria,222), (maria,maria1,222), (maria,Marianna,222))\n\u001b[1m\u001b[34mdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [name1: string, name2: string ... 1 more field]\n\u001b[1m\u001b[34mw\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@351500f3\n\u001b[1m\u001b[34mdf1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [name1: string, name2: string ... 5 more fields]\n\u001b[1m\u001b[34mdf_dedup\u001b[...\n"
     }
    ]
   }
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}