{
 "paragraphs": [
  {
   "text": "%spark.conf\n# It is strongly recommended to set SPARK_HOME explictly instead of using the embedded spark of Zeppelin. As the function of embedded spark of Zeppelin is limited and can only run in local mode.\nSPARK_HOME /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2\n#com.github.haifengl:smile-scala_2.12:2.5.3,com.databricks:spark-xml_2.12:0.10.0,com.github.mrpowers:spark-stringmetric_2.12:0.3.0\n#spark.jars /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/plugins/rapids-4-spark_2.12-0.3.0.jar, /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/plugins/cudf-0.17-cuda10-1.jar\n\n#spark.sql.warehouse.dir /home/ometaxas/Programs/zeppelin-0.9.0-preview2-bin-all/spark-warehouse\n\nspark.serializer org.apache.spark.serializer.KryoSerializer\nspark.kryoserializer.buffer.max 1000M\nspark.driver.memory 95g\nspark.driver.maxResultSize 5g \n\n#spark.rapids.sql.concurrentGpuTasks=2\n#spark.rapids.sql.enabled true\n#spark.rapids.memory.pinnedPool.size 2G \n\n#spark.plugins com.nvidia.spark.SQLPlugin \n\n#spark.locality.wait 0s \n#spark.sql.files.maxPartitionBytes 512m \n#spark.sql.shuffle.partitions 100 \n#spark.executor.resource.gpu.amount=1\n\n\nSPARK_LOCAL_DIRS /media/ometaxas/nvme/spark\n#, /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/tmp\n                                             \n# /home/ometaxas/Programs/spark-3.0.1-bin-hadoop3.2/tmp,/media/datadisk/Datasets/Spark\n#,/media/datadisk/Datasets/Spark \n#/media/datadisk/Datasets/Spark\n\n# set executor memrory 110g\n# spark.executor.memory  60g\n\n\n# set executor number to be 6\n# spark.executor.instances  6\n\n\n# Uncomment the following line if you want to use yarn-cluster mode (It is recommended to use yarn-cluster mode after Zeppelin 0.8, as the driver will run on the remote host of yarn cluster which can mitigate memory pressure of zeppelin server)\n# master yarn-cluster\n\n# Uncomment the following line if you want to use yarn-client mode (It is not recommended to use it after 0.8. Because it would launch the driver in the same host of zeppelin server which will increase memory pressure of zeppelin server)\n# master yarn-client\n\n# Uncomment the following line to enable HiveContext, and also put hive-site.xml under SPARK_CONF_DIR\n# zeppelin.spark.useHiveContext true\n\n",
   "user": "anonymous",
   "dateUpdated": "2021-05-06T14:37:56+0300",
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12.0,
    "editorMode": "ace/mode/scala",
    "fontSize": 9.0,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": []
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1620301076860_1738101612",
   "id": "paragraph_1620301076860_1738101612",
   "dateCreated": "2021-05-06T14:37:56+0300",
   "dateStarted": "2021-05-06T14:37:56+0300",
   "dateFinished": "2021-05-06T14:37:56+0300",
   "status": "FINISHED"
  },
  {
   "title": "Read Initial file",
   "text": "%spark\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions.countDistinct;\n\nval ORGS_HOME = \"/media/ometaxas/nvme/datasets/institutions\"\n\n/*\naffId: string (nullable = true)\n |-- magId: long (nullable = true)\n |-- gridId: string (nullable = true)\n |-- ringgoldId: string (nullable = true)\n |-- wikiIds: string (nullable = true)\n |-- isniIds: string (nullable = true)\n |-- rorIds: string (nullable = true)\n |-- fundrefIds: string (nullable = true)\n |-- name: string (nullable = true)\n |-- normalizedNames: string (nullable = true)\n |-- acronyms: string (nullable = true)\n |-- urls: string (nullable = true)\n |-- wikiPageUrls: string (nullable = true)\n |-- email: string (nullable = true)\n |-- city: string (nullable = true)\n |-- state: string (nullable = true)\n |-- postCode: string (nullable = true)\n |-- countryCode: string (nullable = true)\n |-- longitude: double (nullable = true)\n |-- latitude: double (nullable = true)\n |-- magRank: long (nullable = true)\n |-- paperCount: integer (nullable = true)\n |-- paperFamilyCount: integer (nullable = true)\n |-- citationCount: integer (nullable = true)\n */\nval institutionsTsvFilename = \"AffiliationsExtended.tsv\" \n                              \nval institutionsSchema = new StructType().\n                add(\"affId\", StringType, true).\n                add(\"magId\", LongType, false).\n                add(\"gridId\", StringType, true).                \n                add(\"ringgoldId\", StringType, true).\n                add(\"wikiIds\",StringType, true).\n                add(\"isniIds\",StringType, true).\n                add(\"rorIds\",StringType, true).\n                add(\"fundrefIds\", StringType, true).\n                add(\"name\", StringType, true).\n                add(\"normalizedNames\", StringType, true).\n                add(\"acronyms\", StringType, true).\n                add(\"urls\", StringType, true).\n                add(\"wikiPageUrls\", StringType, true).\n                add(\"email\", StringType, true).\n                add(\"city\", StringType, true).\n                add(\"state\", StringType, true).\n                add(\"postCode\", StringType, true).\n                add(\"countryCode\", StringType, true).\n                add(\"longitude\", DoubleType, true).\n                add(\"latitude\", DoubleType, true).\n                add(\"magRank\", LongType, false).\n                add(\"paperCount\", LongType, false).\n                add(\"paperFamilyCount\", LongType, false).\n                add(\"citationCount\", LongType, false)\n\n                \nval institutionsdf = spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"false\")).\n                schema(institutionsSchema).\n                csv(s\"file://$ORGS_HOME/$institutionsTsvFilename\")\n    .withColumn(\"normalizedNamesArr\", split(col(\"normalizedNames\"),\"\\\\|\\\\|\"))\n    .withColumn(\"urlsArr\", split(regexp_replace(col(\"urls\"),\"(https?\\\\://)|/\",\"\"),\"\\\\|\\\\|\"))\n    .withColumn(\"wikiPageUrlsArr\", split(col(\"wikiPageUrls\"),\"\\\\|\\\\|\"))\n        .withColumn(\"acronymsArr\", split(col(\"acronyms\"),\"\\\\|\\\\|\"))\n.withColumn(\"fundrefIdsArr\", split(col(\"fundrefIds\"),\"\\\\|\\\\|\"))\n.withColumn(\"rorIdsArr\", split(col(\"rorIds\"),\"\\\\|\\\\|\"))\n.withColumn(\"wikiIdsArr\", split(col(\"wikiIds\"),\"\\\\|\\\\|\"))        \n.withColumn(\"wikiPageUrlsArr\", split(col(\"wikiPageUrls\"),\"\\\\|\\\\|\"))\n        .cache()\n\ninstitutionsdf.printSchema()",
   "user": "anonymous",
   "dateUpdated": "2021-04-05T11:21:36+0300",
   "config": {
    "title": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1617610896042_636113427",
   "id": "paragraph_1617610896042_636113427",
   "dateCreated": "2021-04-05T11:21:36+0300",
   "dateStarted": "2021-04-05T11:21:36+0300",
   "dateFinished": "2021-04-05T11:21:43+0300",
   "status": "ERROR"
  },
  {
   "title": "Analyze problematic cases",
   "text": "%spark\n/*\ninstitutionsdf\n.filter( \n    //($\"normalizedNames\".contains(\"rio tinto\")    &&  $\"urls\".contains(\"riotinto.com\"))//            ||\n              array_contains($\"normalizedNamesArr\",\"university of paris\") ||\n    array_contains($\"normalizedNamesArr\",\"canon\") ||  \n    array_contains($\"normalizedNamesArr\",\"university of paris\") ||\n    array_contains($\"normalizedNamesArr\",\"oklahoma state university\") ||\n    array_contains($\"normalizedNamesArr\",\"rio tinto\") ||\n    array_contains($\"normalizedNamesArr\",\"mitsubishi electric\") ||\n    array_contains($\"normalizedNamesArr\",\"toyota\") ||\n    array_contains($\"normalizedNamesArr\",\"university of rennes\")  ||\n        array_contains($\"normalizedNamesArr\",\"world health organization\") \n            )\n        .show()\n        //.select(     $\"affId\", $\"magId\",$\"gridId\",$\"ringgoldId\",$\"wikiIds\",$\"rorIds\",$\"name\",$\"normalizedNames\",$\"urls\",$\"countryCode\", $\"wikiPageUrls\")\n//.coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/uniofParis.csv\")\n   //cases.coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/cases2.csv\")\n*/\n /*\nval unMatchedMAG = institutionsdf\n.filter(\n    ($\"gridId\"===\"\" || isnull($\"gridId\"))\n     && ($\"ringgoldId\"===\"\" || isnull($\"ringgoldId\"))        \n        &&  $\"magId\"=!=0 && !isnull($\"magId\")\n        \n            )        \n        .orderBy($\"paperCount\" desc)\n        .cache()\n\nunMatchedMAG.show(50)\nprintln(unMatchedMAG.count())\n*/\n\nval rin_grid = institutionsdf\n.filter(($\"gridId\"===\"\" || isnull($\"gridId\")) && \n        $\"ringgoldId\"=!=\"\" && !isnull($\"ringgoldId\") \n//&&  $\"magId\"=!=0 && !isnull($\"magId\")\n        &&  $\"wikiIds\"=!=\"\" && !isnull($\"wikiIds\")\n    //&& ($\"wikiIds\"===\"\" || isnull($\"wikiIds\"))\n        )\n        .cache()\n\nprintln(rin_grid.count())\nrin_grid.show(20)\n\n\n\n\nval grid_noRing = institutionsdf\n.filter(\n    $\"gridId\"=!=\"\" && !isnull($\"gridId\") \n        //&& \n   //$\"magId\"=!=0 && !isnull($\"magId\") \n        && ($\"ringgoldId\"===\"\" || isnull($\"ringgoldId\")) \n            )        \n        //.orderBy($\"paperCount\" desc)\n        .cache()\ngrid_noRing.show(true)\nprintln(grid_noRing.count())\n\n",
   "user": "anonymous",
   "dateUpdated": "2021-03-20T16:55:35+0200",
   "config": {
    "title": true,
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Table",
        "table": {
         "visibleRow": 3.0
        },
        "chart": {
         "series": [
          {
           "type": "Line",
           "x": {
            "column": "affId",
            "index": 0.0
           },
           "y": {
            "column": "ringgoldId",
            "index": 3.0
           }
          }
         ]
        }
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=31"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=32"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=33"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=34"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616252135687_113900305",
   "id": "paragraph_1616252135687_113900305",
   "dateCreated": "2021-03-20T16:55:35+0200",
   "dateStarted": "2021-03-20T16:55:35+0200",
   "dateFinished": "2021-03-20T16:55:36+0200",
   "status": "FINISHED"
  },
  {
   "title": "Name based matching on GRID - Ringgold",
   "text": "%spark\n\nimport org.apache.spark.sql.functions._\n\nval grid_noRing = institutionsdf\n.filter(\n    ($\"gridId\"=!=\"\" && !isnull($\"gridId\") \n     && ($\"ringgoldId\"===\"\" || isnull($\"ringgoldId\")))    \n            //||    ($\"magId\"=!=0 && !isnull($\"magId\") \n        //&& ($\"ringgoldId\"===\"\" || isnull($\"ringgoldId\"))\n        //&& ($\"gridId\"===\"\" || isnull($\"gridId\"))) \n            )        \n        .orderBy($\"paperCount\" desc)\n        .cache()\n//grid_noRing.show(50)\nprintln(grid_noRing.count())\n\nval name_based_matchesall = institutionsdf.filter($\"gridId\"===\"\" || isnull($\"gridId\") ).as(\"df1\").join(broadcast(grid_noRing.as(\"df2\")),  \n    arrays_overlap($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\") && $\"df1.affId\" =!=$\"df2.affId\" \n            && arrays_overlap($\"df1.urlsArr\",$\"df2.urlsArr\") \n&& $\"df2.countryCode\" === $\"df1.countryCode\"\n    , \"inner\")\n .select( $\"df2.affId\".as(\"affId2\"), $\"df1.ringgoldId\".as(\"ringgoldId\"),$\"df2.gridId\".as(\"gridId\"),\n     when($\"df2.magId\"=!=0 && !isnull($\"df2.magId\"),$\"df2.magId\").otherwise($\"df1.magId\").as(\"magId\"),     \n     $\"df1.affId\".as(\"affId1\"),  $\"df2.name\".as(\"name\"), $\"df1.name\".as(\"name1\"),   \n     \n             array_union($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\").as(\"normalizedNamesArr\"),\n            array_union($\"df1.urlsArr\",$\"df2.urlsArr\").as(\"urlsArr\"),\n            array_union($\"df1.wikiPageUrlsArr\",$\"df2.wikiPageUrlsArr\").as(\"wikiPageUrlsArr\"),\n            array_union($\"df1.acronymsArr\",$\"df2.acronymsArr\").as(\"acronymsArr\"),\n        array_union($\"df1.fundrefIdsArr\",$\"df2.fundrefIdsArr\").as(\"fundrefIdsArr\"),\n        array_union($\"df1.rorIdsArr\",$\"df2.rorIdsArr\").as(\"rorIdsArr\"),\n        array_union($\"df1.wikiIdsArr\",$\"df2.wikiIdsArr\").as(\"wikiIdsArr\"),\n     when($\"df2.email\"=!=0 && !isnull($\"df2.email\"),$\"df2.email\").otherwise($\"df1.email\").as(\"email\"),\n     when($\"df2.city\"=!=0 && !isnull($\"df2.city\"),$\"df2.city\").otherwise($\"df1.city\").as(\"city\"),\n     when($\"df2.state\"=!=0 && !isnull($\"df2.state\"),$\"df2.state\").otherwise($\"df1.state\").as(\"state\"),\n     $\"df2.countryCode\".as(\"countryCode\"),\n     when($\"df2.postCode\"=!=0 && !isnull($\"df2.postCode\"),$\"df2.postCode\").otherwise($\"df1.postCode\").as(\"postCode\"),\n     when($\"df2.latitude\"=!=0 && !isnull($\"df2.latitude\"),$\"df2.latitude\").otherwise($\"df1.latitude\").as(\"latitude\"),\n     when($\"df2.longitude\"=!=0 && !isnull($\"df2.longitude\"),$\"df2.longitude\").otherwise($\"df1.longitude\").as(\"longitude\"),\n     when($\"df2.papercount\"=!=0 && !isnull($\"df2.papercount\"),$\"df2.papercount\").otherwise($\"df1.papercount\").as(\"papercount\"),\n     when($\"df2.citationcount\"=!=0 && !isnull($\"df2.citationcount\"),$\"df2.citationcount\").otherwise($\"df1.citationcount\").as(\"citationcount\"),\n     when($\"df2.paperFamilyCount\"=!=0 && !isnull($\"df2.paperFamilyCount\"),$\"df2.paperFamilyCount\").otherwise($\"df1.paperFamilyCount\").as(\"paperFamilyCount\"),\n     when($\"df2.magrank\"=!=0 && !isnull($\"df2.magrank\"),$\"df2.magrank\").otherwise($\"df1.magrank\").as(\"magrank\"),\n              //array_join(array_union($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\"), \"||\").as(\"normalizedNamesAll\"),\n              //  array_join(array_union($\"df1.urlsArr\",$\"df2.urlsArr\"), \"||\").as(\"urlsAll\"), \n                ((size(array_intersect($\"df1.urlsArr\",$\"df2.urlsArr\")) / size(array_union($\"df1.urlsArr\",$\"df2.urlsArr\")))+\n                (size(array_intersect($\"df1.wikiPageUrlsArr\",$\"df2.wikiPageUrlsArr\")) / size(array_union($\"df1.wikiPageUrlsArr\",$\"df2.wikiPageUrlsArr\")))+\n                (size(array_intersect($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\")) / size(array_union($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\")))).as(\"jaccard\")\n         //, ($\"jaccurl\"+$\"jaccname\").as(\"jacc\")\n                \n                )\n        .orderBy($\"df2.name\")\n        .cache()\n\nprintln(name_based_matchesall.count())\nname_based_matchesall.show(false)\n",
   "user": "anonymous",
   "dateUpdated": "2021-03-20T18:13:57+0200",
   "config": {
    "title": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=54"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=56"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=57"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=58"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=59"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616256837345_763743374",
   "id": "paragraph_1616256837345_763743374",
   "dateCreated": "2021-03-20T18:13:57+0200",
   "dateStarted": "2021-03-20T18:13:57+0200",
   "dateFinished": "2021-03-20T18:18:59+0200",
   "status": "FINISHED"
  },
  {
   "title": "Analyze Matched data",
   "text": "%spark\n\n\nval df22 = name_based_matchesall.select(countDistinct(\"ringgoldId\"))\ndf22.show(false)\n\nval df3 = name_based_matchesall.select(countDistinct(\"gridId\"))\ndf3.show(false)\n\nval df4 = name_based_matchesall.select(countDistinct(\"magId\"))\ndf4.show(false)\n\nval double_Grids = name_based_matchesall.groupBy($\"gridId\")\n  .agg(count(\"gridId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_Grids.count())\n\nval double_Mag = name_based_matchesall.groupBy($\"magId\")\n  .agg(count(\"magId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_Mag.count())",
   "user": "anonymous",
   "dateUpdated": "2021-03-20T18:21:08+0200",
   "config": {
    "title": true,
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Console"
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=60"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=61"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=62"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=63"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=64"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616257268979_1544547740",
   "id": "paragraph_1616257268979_1544547740",
   "dateCreated": "2021-03-20T18:21:08+0200",
   "dateStarted": "2021-03-20T18:21:08+0200",
   "dateFinished": "2021-03-20T18:21:12+0200",
   "status": "FINISHED"
  },
  {
   "title": "Merge Grid - Ringgold",
   "text": "%spark\nimport org.apache.spark.sql.expressions.Window\n\nval window = Window.partitionBy(\"gridId\").orderBy(\"jaccard\")\n\nval dist_rows = name_based_matchesall.withColumn(\"row_num\", row_number().over(window))\n  .filter($\"row_num\" === 1)\n  .drop(\"row_num\").cache()\n\nval double_Grids = dist_rows.groupBy($\"gridId\")\n  .agg(count(\"gridId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_Grids.count())\n//double_Grids.show(false)\n \nval ids2drop = dist_rows.select($\"affId2\".as(\"affId\")).union(dist_rows.select($\"affId1\".as(\"affId\")).distinct())\nprintln(ids2drop.count())\n\nprintln(institutionsdf.count())\n\nval remainingInstitutions = institutionsdf.join(ids2drop,ids2drop(\"affId\") === institutionsdf(\"affId\"), \"leftanti\") \n.select( $\"affId\", $\"ringgoldId\",$\"gridId\",$\"magId\", $\"name\",\n           $\"normalizedNamesArr\",    $\"urlsArr\",     $\"wikiPageUrlsArr\",\n           $\"acronymsArr\",  $\"fundrefIdsArr\",  $\"rorIdsArr\",   $\"wikiIdsArr\",\n     $\"email\", $\"city\",  $\"state\",  $\"countryCode\",   $\"postCode\",   $\"latitude\",    $\"longitude\",\n     $\"papercount\",     $\"citationcount\",     $\"paperFamilyCount\",     $\"magrank\")\n//select($\"affId\", $\"magId\",$\"gridId\",$\"ringgoldId\",$\"wikiIds\",$\"isniIds\" ,$\"rorIds\",$\"fundrefIds\", $\"name\", $\"normalizedNames\",$\"acronyms\", $\"urls\", $\"countryCode\", $\"papercount\")\n                      \nprintln(remainingInstitutions.count())\n\nval mergedInstances = dist_rows\n.select( \n         concat(when($\"magId\"=!=0 && !isnull($\"magId\"),$\"magId\").otherwise(\"\")\n         ,when($\"gridId\"=!=\"\" && !isnull($\"gridId\"), concat(lit(\"_\"), $\"gridId\")).otherwise(\"\")\n         ,when($\"ringgoldId\"=!=\"\" && !isnull($\"ringgoldId\"), concat(lit(\"_\"), $\"ringgoldId\")).otherwise(\"\")) \n    .as(\"affId\"),         \n    $\"ringgoldId\",$\"gridId\",$\"magId\", $\"name\",\n           $\"normalizedNamesArr\",    $\"urlsArr\",     $\"wikiPageUrlsArr\",\n           $\"acronymsArr\",  $\"fundrefIdsArr\",  $\"rorIdsArr\",   $\"wikiIdsArr\",\n     $\"email\", $\"city\",  $\"state\",  $\"countryCode\",   $\"postCode\",   $\"latitude\",    $\"longitude\",\n     $\"papercount\",     $\"citationcount\",     $\"paperFamilyCount\",     $\"magrank\")\n//.show(true)\n\nval  newInstitutionsdf =  remainingInstitutions.union(mergedInstances).cache()\n       \n       println(newInstitutionsdf.count())\n       newInstitutionsdf.show(true)\n       \n     //  newInsitutionsdf.select($\"affId\", $\"magId\",$\"gridId\",$\"ringgoldId\",$\"wikiIds\",$\"isniIds\" ,$\"rorIds\",$\"fundrefIds\", $\"name\", $\"normalizedNames\",$\"acronyms\", $\"urls\", $\"countryCode\", $\"papercount\").coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/PKGInstitutions.csv\")",
   "user": "anonymous",
   "dateUpdated": "2021-03-21T16:51:10+0200",
   "config": {
    "title": true,
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Console",
        "chart": {
         "series": [
          {
           "type": "Line",
           "x": {
            "column": "affId",
            "index": 0.0
           },
           "y": {
            "column": "latitude",
            "index": 17.0
           }
          }
         ]
        }
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=269"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=270"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=271"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=273"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=274"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=275"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616338270161_407408359",
   "id": "paragraph_1616338270161_407408359",
   "dateCreated": "2021-03-21T16:51:10+0200",
   "dateStarted": "2021-03-21T16:51:10+0200",
   "dateFinished": "2021-03-21T16:51:12+0200",
   "status": "FINISHED"
  },
  {
   "title": "Name based matching on unmatched MAG",
   "text": "%spark\nimport org.apache.spark.sql.functions._\n\nval unmatchedMag = newInstitutionsdf\n.filter(\n        \n       ($\"magId\"=!=0 && !isnull($\"magId\") \n        && ($\"ringgoldId\"===\"\" || isnull($\"ringgoldId\"))\n        && ($\"gridId\"===\"\" || isnull($\"gridId\"))) \n            )        \n        .orderBy($\"paperCount\" desc)\n        .cache()\nunmatchedMag.show(false)\nprintln(unmatchedMag.count())\n\nval name_based_matches_mag = newInstitutionsdf.filter($\"magId\"===\"\" || isnull($\"magId\") ).as(\"df1\").join(broadcast(unmatchedMag.as(\"df2\")),  \n    arrays_overlap($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\") && $\"df1.affId\" =!=$\"df2.affId\" \n            && (arrays_overlap($\"df1.urlsArr\",$\"df2.urlsArr\") || arrays_overlap($\"df1.wikiPageUrlsArr\",$\"df2.wikiPageUrlsArr\")) \n&& $\"df2.countryCode\" === $\"df1.countryCode\"\n    , \"inner\")\n .select( $\"df2.affId\".as(\"affId2\"), \n     $\"df1.ringgoldId\".as(\"ringgoldId\"),$\"df1.gridId\".as(\"gridId\"),\n     when($\"df2.magId\"=!=0 && !isnull($\"df2.magId\"),$\"df2.magId\").otherwise($\"df1.magId\").as(\"magId\"),    \n     \n     $\"df1.affId\".as(\"affId1\"),  $\"df2.name\".as(\"name\"), $\"df1.name\".as(\"name1\"),   \n     \n             array_union($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\").as(\"normalizedNamesArr\"),\n            array_union($\"df1.urlsArr\",$\"df2.urlsArr\").as(\"urlsArr\"),\n            array_union($\"df1.wikiPageUrlsArr\",$\"df2.wikiPageUrlsArr\").as(\"wikiPageUrlsArr\"),\n            array_union($\"df1.acronymsArr\",$\"df2.acronymsArr\").as(\"acronymsArr\"),\n        array_union($\"df1.fundrefIdsArr\",$\"df2.fundrefIdsArr\").as(\"fundrefIdsArr\"),\n        array_union($\"df1.rorIdsArr\",$\"df2.rorIdsArr\").as(\"rorIdsArr\"),\n        array_union($\"df1.wikiIdsArr\",$\"df2.wikiIdsArr\").as(\"wikiIdsArr\"),\n     when($\"df2.email\"=!=0 && !isnull($\"df2.email\"),$\"df2.email\").otherwise($\"df1.email\").as(\"email\"),\n     when($\"df2.city\"=!=0 && !isnull($\"df2.city\"),$\"df2.city\").otherwise($\"df1.city\").as(\"city\"),\n     when($\"df2.state\"=!=0 && !isnull($\"df2.state\"),$\"df2.state\").otherwise($\"df1.state\").as(\"state\"),\n     $\"df2.countryCode\".as(\"countryCode\"),\n     when($\"df2.postCode\"=!=0 && !isnull($\"df2.postCode\"),$\"df2.postCode\").otherwise($\"df1.postCode\").as(\"postCode\"),\n     when($\"df2.latitude\"=!=0 && !isnull($\"df2.latitude\"),$\"df2.latitude\").otherwise($\"df1.latitude\").as(\"latitude\"),\n     when($\"df2.longitude\"=!=0 && !isnull($\"df2.longitude\"),$\"df2.longitude\").otherwise($\"df1.longitude\").as(\"longitude\"),\n     when($\"df2.papercount\"=!=0 && !isnull($\"df2.papercount\"),$\"df2.papercount\").otherwise($\"df1.papercount\").as(\"papercount\"),\n     when($\"df2.citationcount\"=!=0 && !isnull($\"df2.citationcount\"),$\"df2.citationcount\").otherwise($\"df1.citationcount\").as(\"citationcount\"),\n     when($\"df2.paperFamilyCount\"=!=0 && !isnull($\"df2.paperFamilyCount\"),$\"df2.paperFamilyCount\").otherwise($\"df1.paperFamilyCount\").as(\"paperFamilyCount\"),\n     when($\"df2.magrank\"=!=0 && !isnull($\"df2.magrank\"),$\"df2.magrank\").otherwise($\"df1.magrank\").as(\"magrank\"),\n               \n                ((size(array_intersect($\"df1.urlsArr\",$\"df2.urlsArr\")) / size(array_union($\"df1.urlsArr\",$\"df2.urlsArr\")))+\n                (size(array_intersect($\"df1.wikiPageUrlsArr\",$\"df2.wikiPageUrlsArr\")) / size(array_union($\"df1.wikiPageUrlsArr\",$\"df2.wikiPageUrlsArr\")))+\n                (size(array_intersect($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\")) / size(array_union($\"df1.normalizedNamesArr\",$\"df2.normalizedNamesArr\")))).as(\"jaccard\")\n         //, ($\"jaccurl\"+$\"jaccname\").as(\"jacc\")\n                \n                )\n        .orderBy($\"df2.papercount\")\n        .cache()\n\nprintln(name_based_matches_mag.count())\nname_based_matches_mag.show(false)\n//4400\n//548",
   "user": "anonymous",
   "dateUpdated": "2021-03-21T16:52:15+0200",
   "config": {
    "title": true,
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Table",
        "chart": {
         "series": [
          {
           "type": "Line",
           "x": {
            "column": "papercount",
            "index": 19.0
           },
           "y": {
            "column": "affId",
            "index": 0.0
           }
          }
         ]
        }
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=276"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=277"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=278"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=279"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=280"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616338335587_1923499709",
   "id": "paragraph_1616338335587_1923499709",
   "dateCreated": "2021-03-21T16:52:15+0200",
   "dateStarted": "2021-03-21T16:52:15+0200",
   "dateFinished": "2021-03-21T16:52:17+0200",
   "status": "FINISHED"
  },
  {
   "text": "%spark\nval df22 = name_based_matches_mag.select(countDistinct(\"ringgoldId\"))\ndf22.show(false)\n\nval df3 = name_based_matches_mag.select(countDistinct(\"gridId\"))\ndf3.show(false)\n\nval df4 = name_based_matches_mag.select(countDistinct(\"magId\"))\ndf4.show(false)\n\nval double_Grids = name_based_matches_mag.groupBy($\"gridId\")\n  .agg(count(\"gridId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_Grids.count())\n\nval double_Mag = name_based_matches_mag.groupBy($\"magId\")\n  .agg(count(\"magId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_Mag.count())\n\nval double_ringgoldId= name_based_matches_mag.groupBy($\"ringgoldId\")\n  .agg(count(\"ringgoldId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_ringgoldId.count())\n\n",
   "user": "anonymous",
   "dateUpdated": "2021-03-21T16:43:52+0200",
   "config": {
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Console"
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=253"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=254"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=255"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=256"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=257"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=258"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616337832248_2047494183",
   "id": "paragraph_1616337832248_2047494183",
   "dateCreated": "2021-03-21T16:43:52+0200",
   "dateStarted": "2021-03-21T16:43:52+0200",
   "dateFinished": "2021-03-21T16:43:57+0200",
   "status": "FINISHED"
  },
  {
   "title": "Merge matched MAG",
   "text": "%spark\n\nimport org.apache.spark.sql.expressions.Window\n\nval window = Window.partitionBy(\"magId\").orderBy(\"jaccard\")\n\nval dist_rows_mag = name_based_matches_mag.withColumn(\"row_num\", row_number().over(window))\n  .filter($\"row_num\" === 1)\n  .drop(\"row_num\").cache()\n\n \nprintln(\"dist_rows_mag:\"+dist_rows_mag.count())\n\nval ids2drop_mag = dist_rows_mag.select($\"affId2\".as(\"affId\")).union(dist_rows_mag.select($\"affId1\".as(\"affId\")).distinct())\n\nprintln(\"ids2drop_mag:\"+ids2drop_mag.count())\nprintln(\"newInstitutionsdf:\"+newInstitutionsdf.count())\n\nval remainingInstitutions_mag = newInstitutionsdf.join(ids2drop_mag,ids2drop_mag(\"affId\") === newInstitutionsdf(\"affId\"), \"leftanti\") \n.select( $\"affId\", $\"ringgoldId\",$\"gridId\",$\"magId\", $\"name\",\n           $\"normalizedNamesArr\",    $\"urlsArr\",     $\"wikiPageUrlsArr\",\n           $\"acronymsArr\",  $\"fundrefIdsArr\",  $\"rorIdsArr\",   $\"wikiIdsArr\",\n     $\"email\", $\"city\",  $\"state\",  $\"countryCode\",   $\"postCode\",   $\"latitude\",    $\"longitude\",\n     $\"papercount\",     $\"citationcount\",     $\"paperFamilyCount\",     $\"magrank\")\n\n                      \nprintln(\"remainingInstitutions_mag:\"+remainingInstitutions_mag.count())\n\n          \nval mergedInstances_mag = dist_rows_mag\n.select( \n    concat(when($\"magId\"=!=0 && !isnull($\"magId\"),$\"magId\").otherwise(\"\")\n         ,when($\"gridId\"=!=\"\" && !isnull($\"gridId\"), concat(lit(\"_\"), $\"gridId\")).otherwise(\"\")\n         ,when($\"ringgoldId\"=!=\"\" && !isnull($\"ringgoldId\"), concat(lit(\"_\"), $\"ringgoldId\")).otherwise(\"\")) \n    .as(\"affId\"),                  \n    $\"ringgoldId\",$\"gridId\",$\"magId\", $\"name\",\n           $\"normalizedNamesArr\",    $\"urlsArr\",     $\"wikiPageUrlsArr\",\n           $\"acronymsArr\",  $\"fundrefIdsArr\",  $\"rorIdsArr\",   $\"wikiIdsArr\",\n     $\"email\", $\"city\",  $\"state\",  $\"countryCode\",   $\"postCode\",   $\"latitude\",    $\"longitude\",\n     $\"papercount\",     $\"citationcount\",     $\"paperFamilyCount\",     $\"magrank\")\n//.show(true)\n\nval  newInstitutionsdf_full =  remainingInstitutions_mag.union(mergedInstances_mag)\n        .withColumn(\"normalizedNames\",array_join($\"normalizedNamesArr\", \"||\"))\n          .withColumn(\"wikiPageUrls\",array_join($\"wikiPageUrlsArr\", \"||\"))\n          .withColumn(\"urls\",array_join($\"urlsArr\", \"||\"))\n          .withColumn(\"acronyms\",array_join($\"acronymsArr\", \"||\"))\n          .withColumn(\"fundrefIds\",array_join($\"fundrefIdsArr\", \"||\"))\n          .withColumn(\"rorIds\",array_join($\"rorIdsArr\", \"||\"))\n          .withColumn(\"wikiIds\",array_join($\"wikiIdsArr\", \"||\"))\n          .withColumn(\"urls\",array_join($\"urlsArr\", \"||\"))\n        .cache()\n    \nprintln(\"newInstitutionsdf_full:\"+newInstitutionsdf_full.count())\nnewInstitutionsdf_full.show(false)\n            \n//newInstitutionsdf_full.write.mode(\"overwrite\").parquet(s\"$ORGS_HOME/newInstitutions.parquet\")",
   "user": "anonymous",
   "dateUpdated": "2021-03-21T16:55:12+0200",
   "config": {
    "title": true,
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Console",
        "chart": {
         "series": [
          {
           "type": "Line",
           "x": {
            "column": "affId",
            "index": 0.0
           },
           "y": {
            "column": "latitude",
            "index": 17.0
           }
          }
         ]
        }
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=281"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=282"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=283"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=285"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=287"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=288"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616338512326_2018344210",
   "id": "paragraph_1616338512326_2018344210",
   "dateCreated": "2021-03-21T16:55:12+0200",
   "dateStarted": "2021-03-21T16:55:12+0200",
   "dateFinished": "2021-03-21T16:55:19+0200",
   "status": "FINISHED"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%spark\nnewInstitutionsdf_full.write.mode(\"overwrite\").parquet(s\"$ORGS_HOME/newInstitutions.parquet\")\n\nnewInstitutionsdf_full\n        .select($\"affId\", $\"ringgoldId\",$\"gridId\",$\"magId\", $\"name\",\n           $\"normalizedNames\",    $\"urls\",     $\"wikiPageUrls\",\n           $\"acronyms\",  $\"fundrefIds\",  $\"rorIds\",   $\"wikiIds\",\n     $\"email\", $\"city\",  $\"state\",  $\"countryCode\",   $\"postCode\",   $\"latitude\",    $\"longitude\",\n     $\"papercount\",     $\"citationcount\",     $\"paperFamilyCount\",     $\"magrank\")\n        .coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/PKGInstitutions.csv\")\n\nnewInstitutionsdf_full\n        .select($\"affId\", $\"ringgoldId\",$\"gridId\",$\"magId\",   $\"wikiIds\", $\"name\",           \n           $\"acronyms\",  $\"fundrefIds\",  $\"rorIds\", \n       $\"countryCode\", \n     $\"papercount\")\n        .coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/PKGInstitutions_basic.csv\")",
   "id": "",
   "config": {}
  },
  {
   "text": "%spark\n//newInsitutionsdf_full.filter($\"magId\"===\"9467721\").show(false)\nval df22 = newInstitutionsdf_full.select(countDistinct(\"ringgoldId\"))\ndf22.show(false)\n\nval df3 = newInstitutionsdf_full.select(countDistinct(\"gridId\"))\ndf3.show(false)\n\nval df4 = newInstitutionsdf_full.select(countDistinct(\"magId\"))\ndf4.show(false)\n\nval double_Grids = newInstitutionsdf_full.groupBy($\"gridId\")\n  .agg(count(\"gridId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_Grids.count())\n\nval double_Mag = newInstitutionsdf_full.groupBy($\"magId\")\n  .agg(count(\"magId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_Mag.count())\n\nval double_ringgoldId= newInstitutionsdf_full.groupBy($\"ringgoldId\")\n  .agg(count(\"ringgoldId\").alias(\"count\"))\n  .filter($\"count\">1)\n\nprintln(double_ringgoldId.count())\n\n\nprintln(\"newInstitutionsdf_full:\"+newInstitutionsdf_full.count())\nprintln(\"newInstitutionsdf_full_100pubs:\"+newInstitutionsdf_full.filter($\"paperCount\">100).count())\n\nval unMatchedMAG = newInstitutionsdf_full\n.filter(\n    ($\"gridId\"===\"\" || isnull($\"gridId\"))\n     && ($\"ringgoldId\"===\"\" || isnull($\"ringgoldId\"))        \n        &&  $\"magId\"=!=0 && !isnull($\"magId\")\n        //&& $\"paperCount\" > 1000\n            )        \n        .orderBy($\"paperCount\" desc)\n        .cache()\n\nunMatchedMAG.show(20)\nprintln(\"unMatchedMAG:\"+unMatchedMAG.count())\nprintln(\"unMatchedMAG_100pubs:\"+unMatchedMAG.filter($\"paperCount\">100).count())\n\n\n\n\nval grid_noRing = newInstitutionsdf_full\n.filter(\n    $\"gridId\"=!=\"\" && !isnull($\"gridId\")\n \n        && ($\"ringgoldId\"===\"\" || isnull($\"ringgoldId\")) \n            )        \n        .orderBy($\"paperCount\" desc)\n        .cache()\ngrid_noRing.show(true)\nprintln(\"grid_noRing:\"+grid_noRing.count())\nprintln(\"grid_noRing_100pubs:\"+grid_noRing.filter($\"paperCount\">100).count())\n\n\nval noRing = newInstitutionsdf_full\n.filter(\n    $\"ringgoldId\"===\"\" || isnull($\"ringgoldId\") \n            )        \n        .orderBy($\"paperCount\" desc)\n        .cache()\ngrid_noRing.show(true)\nprintln(\"noRing:\"+noRing.count())\nprintln(\"noRing_100pubs:\"+noRing.filter($\"paperCount\">100).count())\n\n\n//newInsitutionsdf_full.filter(array_contains($\"normalizedNamesArr\",\"university of paris\")).show(false)\n",
   "user": "anonymous",
   "dateUpdated": "2021-03-21T17:11:23+0200",
   "config": {
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {}
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=289"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=290"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=291"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=292"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=293"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=294"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=295"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=296"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=297"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=298"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=299"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=300"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=301"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=302"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=303"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=304"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=305"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=306"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=307"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=308"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=309"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=310"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=311"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=312"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616339483179_1421113444",
   "id": "paragraph_1616339483179_1421113444",
   "dateCreated": "2021-03-21T17:11:23+0200",
   "dateStarted": "2021-03-21T17:11:23+0200",
   "dateFinished": "2021-03-21T17:11:42+0200",
   "status": "FINISHED"
  },
  {
   "title": "Analyze problematic cases",
   "text": "%spark\n\n    \n/*\nnewInstitutionsdf_full.write.mode(\"overwrite\").parquet(s\"$ORGS_HOME/newInstitutions.parquet\")\n\nnewInstitutionsdf_full\n        .select($\"affId\", $\"ringgoldId\",$\"gridId\",$\"magId\", $\"name\",\n           $\"normalizedNames\",    $\"urls\",     $\"wikiPageUrls\",\n           $\"acronyms\",  $\"fundrefIds\",  $\"rorIds\",   $\"wikiIds\",\n     $\"email\", $\"city\",  $\"state\",  $\"countryCode\",   $\"postCode\",   $\"latitude\",    $\"longitude\",\n     $\"papercount\",     $\"citationcount\",     $\"paperFamilyCount\",     $\"magrank\")\n        .coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/PKGInstitutions.csv\")\n\nnewInstitutionsdf_full\n        .select($\"affId\", $\"ringgoldId\",$\"gridId\",$\"magId\",   $\"wikiIds\", $\"name\",           \n           $\"acronyms\",  $\"fundrefIds\",  $\"rorIds\", \n       $\"countryCode\", \n     $\"papercount\")\n        .coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/PKGInstitutions_basic.csv\")\n*/\nval ORGS_HOME = \"/media/ometaxas/nvme/datasets/institutions\"\nval newInstitutionsdf_full = spark.read.parquet(s\"$ORGS_HOME/newInstitutions.parquet\")\n\nval  cases = newInstitutionsdf_full\n.filter( \n    $\"normalizedNames\".contains(\"epsom and st helier university hospitals nhs trust\")  ||                        \n            $\"normalizedNames\".contains(\"barking havering and redbridge university hospitals nhs trust\") ||\n            $\"ringgoldid\"===\"6965\" ||   $\"ringgoldid\"===\"3237\" ||$\"ringgoldid\"===\"574519\" ||$\"ringgoldid\"===\"462587\" ||$\"ringgoldid\"===\"89542\" ||\n            $\"ringgoldid\"===\"2102\" ||$\"ringgoldid\"===\"98549\" ||$\"ringgoldid\"===\"92956\" ||$\"ringgoldid\"===\"122639\" ||$\"ringgoldid\"===\"2284\" ||\n            $\"ringgoldid\"===\"9898\" ||            \n            $\"gridId\"===\"grid.419496.7\" || $\"gridId\"===\"grid.493155.f\" || $\"gridId\"===\"grid.479983.8\" || $\"gridId\"===\"grid.508061.a\" || $\"gridId\"===\"grid.472379.c\" ||  \n            $\"gridId\"===\"grid.411255.6\" || $\"gridId\"===\"grid.439632.9\" || $\"gridId\"===\"grid.508499.9\" || $\"gridId\"===\"grid.501174.6\" || $\"gridId\"===\"grid.493150.a\" ||\n            $\"gridId\"===\"grid.412148.a\" || $\"gridId\"===\"grid.493132.e\" || $\"gridId\"===\"grid.451504.1\" || $\"gridId\"===\"grid.8155.9\" || $\"gridId\"===\"grid.449961.7\" ||\n            $\"gridId\"===\"grid.439752.e\" ||         \n            array_contains($\"normalizedNamesArr\",\"health protection research unit in emerging and zoonotic infections at university of liverpool\") || \n            array_contains($\"normalizedNamesArr\",\"aintree university hospital\") ||   \n            $\"normalizedNames\".contains(\"aintree university hospital\") ||\n     array_contains($\"normalizedNamesArr\",\"university of wales\") ||\n            $\"normalizedNames\".contains(\"harold wood hospital\") ||\n            \n             \n    array_contains($\"normalizedNamesArr\",\"university hospitals of north midlands nhs trust\") || \n            //|| array_contains($\"wikiIdsArr\",\"Q1155944\") || array_contains($\"wikiIdsArr\",\"Q1235608\") || \n    array_contains($\"normalizedNamesArr\",\"university of hassan ii casablanca\") ||\n    array_contains($\"normalizedNamesArr\",\"university college hospital at westmoreland street\") ||\n    array_contains($\"normalizedNamesArr\",\"schiller international university\")      \n             \n            ).select($\"affId\", $\"ringgoldId\",$\"gridId\",$\"magId\", $\"wikiIds\", $\"name\",  $\"fundrefIds\",  $\"rorIds\",    \n           $\"normalizedNames\",    $\"urls\",     $\"wikiPageUrls\",\n           $\"acronyms\", \n      $\"countryCode\",\n     $\"papercount\" ).cache()\n\n      cases.show()      \n        cases.coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\",\", \"header\"-> \"true\")).csv(s\"$ORGS_HOME/cases.csv\")\n\n",
   "user": "anonymous",
   "dateUpdated": "2021-03-25T11:15:09+0200",
   "config": {
    "title": true,
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Table",
        "table": {
         "columnWidths": {
          "urls": 255.0,
          "normalizedNames": 266.0,
          "name": 190.0
         }
        }
       }
      }
     }
    },
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=29"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=30"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=31"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1616663709401_441208152",
   "id": "paragraph_1616663709401_441208152",
   "dateCreated": "2021-03-25T11:15:09+0200",
   "dateStarted": "2021-03-25T11:15:09+0200",
   "dateFinished": "2021-03-25T11:15:13+0200",
   "status": "FINISHED"
  },
  {
   "text": "%spark\n\nval RES_HOME = \"/media/ometaxas/nvme/datasets/institutions/WILEY_Matching\"\nval ringgoldTsvFilename = \"ringgold.dump.tsv\"\nval ringgolddf = spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).                \n                csv(s\"file://$RES_HOME/$ringgoldTsvFilename\")\n\nringgolddf.printSchema()\nringgolddf.show(5)\n\n\nval nonMatchedTsvFilename = \"differentMatch - expectedNotFound.tsv\"\nval nonMatcheddf = spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).                \n                csv(s\"file://$RES_HOME/$nonMatchedTsvFilename\")\n        .withColumn(\"matchPosition\",lit(\"-1\"))\n        .select($\"inputName\", $\"expectedRinggoldId\", $\"bestMatchRinggoldIds\", $\"bestMatchPositionScore\", $\"matchPosition\", $\"bestMatchPkgId\"\n        ,$\"parsedFullName\",$\"parsedParentNames\",$\"parsedChildNames\",$\"countries\")\n\nnonMatcheddf.printSchema()\nnonMatcheddf.show(5)\n/*\nroot\n |-- uniqueId: string (nullable = true)\n |-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- bestMatchPkgId: string (nullable = true)\n |-- bestMatchPositionScore: string (nullable = true)\n |-- bestMatchName: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = true)\n |-- bestMatchParentPkgIds: string (nullable = true)\n |-- bestMatchParentNames: string (nullable = true)\n |-- resolvedParentRinggoldIds: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n\n */\n\nval exactMatchedTsvFilename = \"bestMatchSameAsExpected - expectedAsBestMatch.tsv\"\nval exactMatcheddf = spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).                \n                csv(s\"file://$RES_HOME/$exactMatchedTsvFilename\")\n        .withColumn(\"matchPosition\",lit(\"0\"))\n        .select($\"inputName\", $\"expectedRinggoldId\", $\"bestMatchRinggoldIds\", $\"bestMatchPositionScore\", $\"matchPosition\", $\"bestMatchPkgId\"\n        ,$\"parsedFullName\",$\"parsedParentNames\",$\"parsedChildNames\",$\"countries\")\n\nexactMatcheddf.printSchema()\nexactMatcheddf.show(5)\n\nval top3MatchedTsvFilename = \"lowerMatchSameAsExpected - expectedFound.tsv\"\nval top3Matcheddf = spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).                \n                csv(s\"file://$RES_HOME/$top3MatchedTsvFilename\")        \n        .select($\"inputName\", $\"expectedRinggoldId\", $\"bestMatchRinggoldIds\", $\"bestMatchPositionScore\", $\"expectedMatchPosition\".as(\"matchPosition\"), $\"bestMatchPkgId\"\n        ,$\"parsedFullName\",$\"parsedParentNames\",$\"parsedChildNames\",$\"countries\")\n\ntop3Matcheddf.printSchema()\ntop3Matcheddf.show(5)\n/*\nroot\n-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- bestMatchPkgId: string (nullable = true)\n |-- bestMatchPositionScore: string (nullable = true)\n |-- bestMatchName: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = true)\n |-- expectedMatchPkgId: string (nullable = true)\n |-- expectedMatchPosition: string (nullable = true)\n |-- expectedMatchScore: string (nullable = true)\n |-- expectedMatchResolvedName: string (nullable = true)\n |-- expectedMatchRinggoldIds: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n */\n\nval nonResolvedTsvFilename = \"NoMatchedAffiliationReturned - unresolved.tsv\"\nval nonResolveddf = spark.read.options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).                \n                csv(s\"file://$RES_HOME/$nonResolvedTsvFilename\")\n        .withColumn(\"matchPosition\",lit(\"-2\"))\n        .withColumn(\"bestMatchPkgId\",lit(\"\"))\n        .withColumn(\"bestMatchRinggoldIds\",lit(\"\"))\n        .withColumn(\"bestMatchPositionScore\",lit(\"\"))\n        .select($\"inputName\", $\"expectedRinggoldId\", $\"bestMatchRinggoldIds\", $\"bestMatchPositionScore\", $\"matchPosition\", $\"bestMatchPkgId\",\n            $\"parsedFullName\",$\"parsedParentNames\",$\"parsedChildNames\",$\"countries\" )\n\nnonResolveddf.printSchema()\nnonResolveddf.show(5)\n/*\n |-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n */\n\n\n\n\nval allMatcheddf = nonMatcheddf.union(exactMatcheddf).union(top3Matcheddf).union(nonResolveddf)\nallMatcheddf.printSchema()\nallMatcheddf.show(5)\nprintln(allMatcheddf.count())\n\n\nval allMatcheddf_ext = allMatcheddf\n        .join(ringgolddf.as(\"expectedRinggold\"), $\"expectedRinggoldId\"===$\"expectedRinggold.RINGGOLD_ID\", \"left\")\n        .join(ringgolddf.as(\"foundRinggold\"), $\"bestMatchRinggoldIds\"===$\"foundRinggold.RINGGOLD_ID\", \"left\")\n        .join(ringgolddf.as(\"expectedParent\"), $\"expectedRinggold.PARENT_IDS\"===$\"expectedParent.RINGGOLD_ID\", \"left\")\n        .join(ringgolddf.as(\"foundParent\"), $\"foundRinggold.PARENT_IDS\"===$\"foundParent.RINGGOLD_ID\", \"left\")\n        .withColumn(\"exp_parent_Ids\", split(regexp_replace($\"expectedRinggold.PARENT_IDS\",\"(null?)\",\"\"),\"\\\\|\"))\n        .withColumn(\"exp_parent_Name\", $\"expectedParent.NAME\")\n        .withColumn(\"fnd_parent_Name\", $\"foundParent.NAME\")\n        .withColumn(\"fnd_parent_Ids\", split(regexp_replace($\"foundRinggold.PARENT_IDS\",\"(null?)\",\"\"),\"\\\\|\"))\n        .withColumn(\"fnd_Ids\", array_union(split($\"foundRinggold.RINGGOLD_ID\",\"\\\\|\"), $\"fnd_parent_Ids\"))\n        .withColumn(\"exp_Ids\", array_union(split($\"expectedRinggold.NEW_RINGGOLD_ID\",\"\\\\|\"), $\"exp_parent_Ids\"))\n        .withColumn(\"exp_NewIds\", split($\"expectedRinggold.NEW_RINGGOLD_ID\",\"\\\\|\"))\n        .withColumn(\"found_Ids\",split($\"bestMatchRinggoldIds\",\"\\\\|\")) \n        .withColumn(\"matchAll\", size(array_intersect($\"fnd_Ids\",$\"exp_Ids\")) )\n        .withColumn(\"matchAtParent\", size(array_intersect($\"fnd_parent_Ids\",$\"exp_parent_Ids\")) )\n        .withColumn(\"exactMatch\", size(array_intersect($\"found_Ids\",$\"exp_NewIds\")) )\n       // .filter($\"exactMatch\">0 || $\"matchAtParent\">0 || $\"matchAll\">0)\n   //concat(when($\"magId\"=!=0 && !isnull($\"magId\"),$\"magId\").otherwise(\"\")\n        .select($\"inputName\", $\"expectedRinggold.RINGGOLD_ID\".as(\"exp_ringgoldId\"),$\"expectedRinggold.NEW_RINGGOLD_ID\".as(\"exp_new_ringgoldId\"),$\"bestMatchRinggoldIds\",\n            $\"expectedRinggold.NAME\".as(\"exp_name\"),$\"foundRinggold.NAME\".as(\"fnd_name\"), $\"expectedRinggold.PARENT_IDS\".as(\"exp_Parent_Ids\"), \n            $\"foundRinggold.PARENT_IDS\".as(\"fnd_Parent_Ids\"), $\"exp_parent_Name\",$\"fnd_parent_Name\",  $\"expectedRinggold.STATUS\".as(\"exp_status\")\n        ,$\"bestMatchPositionScore\", $\"matchPosition\", $\"exactMatch\",  $\"matchAtParent\", $\"matchAll\", $\"bestMatchPkgId\"\n        ,$\"parsedFullName\",$\"parsedParentNames\",$\"parsedChildNames\",$\"countries\" \n        ).cache()\n         //      $\"expectedRinggold.\",$\"expectedRinggold.\",$\"expectedRinggold.\",)\n\nprintln(\"All records:\"+allMatcheddf_ext.count())                      \nprintln(\"Exact Match at 1st:\"+allMatcheddf_ext.filter($\"exactMatch\">0 || $\"matchPosition\"===0).count())\n//println(\"Exact Match (pos=0):\"+allMatcheddf_ext.filter($\"matchPosition\"===0).count())\nprintln(\"Exact Match at 1st (parent):\"+allMatcheddf_ext.filter($\"matchAtParent\">0 ).count())\nprintln(\"Exact Match at 1st (parent or department):\"+allMatcheddf_ext.filter($\"matchAll\">0 ).count())\nprintln(\"Exact Match at lower positions:\"+allMatcheddf_ext.filter($\"matchPosition\">0).count())\nprintln(\"Exact Match at all positions:\"+allMatcheddf_ext.filter($\"matchPosition\">=0).count())\nprintln(\"No Exact Match (even at lower positions):\"+allMatcheddf_ext.filter($\"matchPosition\"===\"-1\" && $\"exactMatch\"<1).count())\nprintln(\"No Match (even at parent level at 1st):\"+allMatcheddf_ext.filter($\"matchPosition\"===\"-1\" && $\"exactMatch\"<1 && $\"matchAll\"<1).count())\nprintln(\"Non Resolved:\"+allMatcheddf_ext.filter($\"matchPosition\"===\"-2\" && $\"bestMatchPkgId\"===\"\").count())\n         \nallMatcheddf_ext.printSchema()\n\nallMatcheddf_ext.show(20,false)\n\n\nallMatcheddf_ext.coalesce(1).write.mode(\"overwrite\").options(Map(\"sep\"->\"\\t\", \"header\"-> \"true\")).csv(s\"file://$RES_HOME/allMatched_ext.tsv\")\n\n",
   "user": "anonymous",
   "dateUpdated": "2021-05-07T15:49:22+0300",
   "config": {
    "results": [
     {}
    ]
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "state": {
        "currentPage": "Console",
        "chart": {
         "series": [
          {
           "type": "Line",
           "x": {
            "column": "STATUS",
            "index": 2.0
           },
           "y": {
            "column": "RINGGOLD_ID",
            "index": 0.0
           }
          }
         ]
        }
       }
      }
     }
    },
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "root\n |-- RINGGOLD_ID: string (nullable = true)\n |-- NEW_RINGGOLD_ID: string (nullable = true)\n |-- STATUS: string (nullable = true)\n |-- PARENT_IDS: string (nullable = true)\n |-- NAME: string (nullable = true)\n |-- ALTERNATIVE_NAMES: string (nullable = true)\n |-- ISNI_ID: string (nullable = true)\n |-- OFR_ID: string (nullable = true)\n |-- COUNTRY: string (nullable = true)\n |-- TYPE: string (nullable = true)\n |-- URLS: string (nullable = true)\n |-- TIMESTAMP: string (nullable = true)\n |-- CITY: string (nullable = true)\n |-- POST_CODE: string (nullable = true)\n |-- PLACE_LONGITUDE: string (nullable = true)\n |-- PLACE_LATITUDE: string (nullable = true)\n\n+-----------+---------------+------+----------+--------------------+--------------------+----------------+--------------------+-------+------------+--------------------+--------------------+------------+----------+---------------+--------------+\n|RINGGOLD_ID|NEW_RINGGOLD_ID|STATUS|PARENT_IDS|                NAME|   ALTERNATIVE_NAMES|         ISNI_ID|              OFR_ID|COUNTRY|        TYPE|                URLS|           TIMESTAMP|        CITY| POST_CODE|PLACE_LONGITUDE|PLACE_LATITUDE|\n+-----------+---------------+------+----------+--------------------+--------------------+----------------+--------------------+-------+------------+--------------------+--------------------+------------+----------+---------------+--------------+\n|       1226|           1226|ACTIVE|      null|KIT Royal Tropica...|Koninklijk Instit...|0000000115122383|                null|     NL|other/social|          www.kit.nl|2020-09-02 13:26:...|   Amsterdam|   1092 AD|           null|          null|\n|       2975|           2975|ACTIVE|      null|              Saxion|Saxion University...|0000000403965668|                null|     NL|    academic|       www.saxion.nl|2020-11-11 20:09:...|    Enschede|   7500 KB|           null|          null|\n|       1656|           1656|ACTIVE|      null|      Bergen Kommune| Bergen Municipality|0000000403755599|                null|     NO|      public|www.bergen.kommun...|2020-11-02 13:37:...|      Bergen|      5020|           null|          null|\n|       2672|           2672|ACTIVE|      null|Coastal Carolina ...|                 CCU|0000000087389661|http://dx.doi.org...|     US|    academic|     www.coastal.edu|2020-10-28 11:17:...|      Conway|29528-6054|           null|          null|\n|       2375|           2375|ACTIVE|      null|      Galpin Society|                null|0000000403875961|                null|     GB| other/assoc|www.galpinsociety...|2018-12-17 21:21:...|Saint Albans|   AL3 5RF|           null|          null|\n+-----------+---------------+------+----------+--------------------+--------------------+----------------+--------------------+-------+------------+--------------------+--------------------+------------+----------+---------------+--------------+\nonly showing top 5 rows\n\nroot\n |-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = true)\n |-- bestMatchPositionScore: string (nullable = true)\n |-- matchPosition: string (nullable = false)\n |-- bestMatchPkgId: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|           inputName|expectedRinggoldId|bestMatchRinggoldIds|bestMatchPositionScore|matchPosition|      bestMatchPkgId|      parsedFullName|   parsedParentNames|    parsedChildNames|countries|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|Institute of Biom...|             14903|                9373|                  1.00|           -1|3cfyghjiFWXqmwodz...|institute of biom...|humboldt universi...|institute of biom...|       DE|\n|Instituto de Neur...|            119953|                7180|                  1.00|           -1|3cfygi6858YtGYCDX...|instituto de neur...|instituto de neur...|                null|     null|\n|Oulu University H...|            547316|                6370|                  1.00|           -1|3cfygDVqtO7MZ7W1h...|oulu university h...|oulu university h...|department of ane...|     null|\n|Shandong Universi...|            117966|               12589|                  1.00|           -1|3cfygnG9opBLHRROv...| shandong university| shandong university|                null|       CN|\n|Department of Nur...|            441410|               48407|                  1.00|           -1|3cfygoCqIyGuJ9QkJ...|department of nur...|                null|department of nur...|       IR|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\nonly showing top 5 rows\n\nroot\n |-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = true)\n |-- bestMatchPositionScore: string (nullable = true)\n |-- matchPosition: string (nullable = false)\n |-- bestMatchPkgId: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|           inputName|expectedRinggoldId|bestMatchRinggoldIds|bestMatchPositionScore|matchPosition|      bestMatchPkgId|      parsedFullName|   parsedParentNames|    parsedChildNames|countries|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|Department of Mic...|            274062|              274062|                     1|            0|3cfyhKMVKiq5hJBd1...|department of mic...|university of ten...|department of mic...|       US|\n|RIRD, Shivaji Uni...|             29422|               29422|                     1|            0|3cfyhaflMSoienXFW...|  shivaji university|  shivaji university|                null|       IN|\n|Centro de Ci√™nci...|             74383|               74383|                     1|            0|3cfygGcZHzfoi3Hlr...|centro de cincias...|centro de cincias...|               minas|       BR|\n|Department of Fut...|              8058|                8058|                     1|            0|3cfygxSPs6RVYBYiN...|department of fut...| university of turku|department of fut...|       FI|\n|Department of Soc...|             12570|               12570|                     1|            0|3cfyhFo0QsNRodgBw...|department of soc...|central south uni...|department of soc...|       CN|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\nonly showing top 5 rows\n\nroot\n |-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = true)\n |-- bestMatchPositionScore: string (nullable = true)\n |-- matchPosition: string (nullable = true)\n |-- bestMatchPkgId: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|           inputName|expectedRinggoldId|bestMatchRinggoldIds|bestMatchPositionScore|matchPosition|      bestMatchPkgId|      parsedFullName|   parsedParentNames|    parsedChildNames|countries|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|Department of Bio...|            213457|              157915|                  1.00|            1|3cfygvt84lnDyYa6K...|department of bio...|    sinop university|department of bio...|       TR|\n|Clinical Haematol...|             68792|               68791|                  1.00|            1|3cfyh6oWIeOezPBSe...|clinical haematol...|ain shams university|clinical haematol...|     null|\n|Department of Sci...|            541969|               16756|                  1.00|            1|3cfyhXKE5dKimJ3QC...|department of sci...|public university...|school of agricul...|     null|\n|Institute for Geo...|             54298|                9182|                  1.00|            1|3cfyhT6yslBqGY7Is...|institute for geo...| university of mainz|institute for geo...|       DE|\n|Kasturba Medical ...|             29224|              236665|                  0.98|            1|3cfyhoEorshOlzblJ...|kasturba medical ...|kasturba medical ...|department of cli...|       IN|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\nonly showing top 5 rows\n\nroot\n |-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = false)\n |-- bestMatchPositionScore: string (nullable = false)\n |-- matchPosition: string (nullable = false)\n |-- bestMatchPkgId: string (nullable = false)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n\n+--------------------+------------------+--------------------+----------------------+-------------+--------------+--------------------+--------------------+--------------------+---------+\n|           inputName|expectedRinggoldId|bestMatchRinggoldIds|bestMatchPositionScore|matchPosition|bestMatchPkgId|      parsedFullName|   parsedParentNames|    parsedChildNames|countries|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------+--------------------+--------------------+--------------------+---------+\n|Anhui Provincial ...|             12514|                    |                      |           -2|              |anhui provincial ...|                null|anhui provincial ...|     null|\n|University of Neb...|            118735|                    |                      |           -2|              |university of neb...|                null|                null|     null|\n|Mediant Mental He...|             26121|                    |                      |           -2|              |mediant mental he...|mediant mental he...|                null|       NL|\n|Royal Botanic Gar...|             41949|                    |                      |           -2|              |royal botanic gar...|                null|                null|     null|\n|Department of Ane...|              8772|                    |                      |           -2|              |department of ane...|                null|department of ane...|       NL|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------+--------------------+--------------------+--------------------+---------+\nonly showing top 5 rows\n\nroot\n |-- inputName: string (nullable = true)\n |-- expectedRinggoldId: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = true)\n |-- bestMatchPositionScore: string (nullable = true)\n |-- matchPosition: string (nullable = true)\n |-- bestMatchPkgId: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|           inputName|expectedRinggoldId|bestMatchRinggoldIds|bestMatchPositionScore|matchPosition|      bestMatchPkgId|      parsedFullName|   parsedParentNames|    parsedChildNames|countries|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\n|Institute of Biom...|             14903|                9373|                  1.00|           -1|3cfyghjiFWXqmwodz...|institute of biom...|humboldt universi...|institute of biom...|       DE|\n|Instituto de Neur...|            119953|                7180|                  1.00|           -1|3cfygi6858YtGYCDX...|instituto de neur...|instituto de neur...|                null|     null|\n|Oulu University H...|            547316|                6370|                  1.00|           -1|3cfygDVqtO7MZ7W1h...|oulu university h...|oulu university h...|department of ane...|     null|\n|Shandong Universi...|            117966|               12589|                  1.00|           -1|3cfygnG9opBLHRROv...| shandong university| shandong university|                null|       CN|\n|Department of Nur...|            441410|               48407|                  1.00|           -1|3cfygoCqIyGuJ9QkJ...|department of nur...|                null|department of nur...|       IR|\n+--------------------+------------------+--------------------+----------------------+-------------+--------------------+--------------------+--------------------+--------------------+---------+\nonly showing top 5 rows\n\n21867\nAll records:21867\nExact Match at 1st:8017\nExact Match at 1st (parent):8897\nExact Match at 1st (parent or department):14028\nExact Match at lower positions:7523\nExact Match at all positions:15530\nNo Exact Match (even at lower positions):4649\nNo Match (even at parent level at 1st):2601\nNon Resolved:1678\nroot\n |-- inputName: string (nullable = true)\n |-- exp_ringgoldId: string (nullable = true)\n |-- exp_new_ringgoldId: string (nullable = true)\n |-- bestMatchRinggoldIds: string (nullable = true)\n |-- exp_name: string (nullable = true)\n |-- fnd_name: string (nullable = true)\n |-- exp_Parent_Ids: string (nullable = true)\n |-- fnd_Parent_Ids: string (nullable = true)\n |-- exp_parent_Name: string (nullable = true)\n |-- fnd_parent_Name: string (nullable = true)\n |-- exp_status: string (nullable = true)\n |-- bestMatchPositionScore: string (nullable = true)\n |-- matchPosition: string (nullable = true)\n |-- exactMatch: integer (nullable = false)\n |-- matchAtParent: integer (nullable = false)\n |-- matchAll: integer (nullable = false)\n |-- bestMatchPkgId: string (nullable = true)\n |-- parsedFullName: string (nullable = true)\n |-- parsedParentNames: string (nullable = true)\n |-- parsedChildNames: string (nullable = true)\n |-- countries: string (nullable = true)\n\n+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------------+--------------------+----------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+--------------+-----------------------+--------------------------------------------------------+---------------------------------------------------------------------------+----------+----------------------+-------------+----------+-------------+--------+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+---------+\n|inputName                                                                                                                                                                                                                         |exp_ringgoldId|exp_new_ringgoldId|bestMatchRinggoldIds|exp_name                                                                                      |fnd_name                                                                                               |exp_Parent_Ids|fnd_Parent_Ids         |exp_parent_Name                                         |fnd_parent_Name                                                            |exp_status|bestMatchPositionScore|matchPosition|exactMatch|matchAtParent|matchAll|bestMatchPkgId       |parsedFullName                                                                                                                                                                                               |parsedParentNames                                                                      |parsedChildNames                                                                                                             |countries|\n+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------------+--------------------+----------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+--------------+-----------------------+--------------------------------------------------------+---------------------------------------------------------------------------+----------+----------------------+-------------+----------+-------------+--------+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+---------+\n|Equipe Odontol√≥gica do Instituto de Psiquiatria, Hospital das Cl√≠nicas HCFMUSP, Faculdade de Medicina, Universidade de Sao Paulo, Sao Paulo, SP, BR                                                                             |37884         |37884             |363307              |Universidade de Sao Paulo Faculdade de Medicina                                               |Universidade de Sao Paulo Centro de Estudos do Instituto de Psiquiatria                                |28133         |119537                 |Universidade de Sao Paulo                               |Universidade de Sao Paulo Instituto de Psiquiatria                         |ACTIVE    |0.97                  |2            |0         |0            |0       |3cfygXAptvHd5aAsX2E4s|equipe odontolgica do instituto de psiquiatria hospital das clnicas hcfmusp faculdade de medicina universidade de sao paulo                                                                                  |hospital das clnicas hcfmusp faculdade de medicina||universidade de sao paulo          |equipe odontolgica do instituto de psiquiatria                                                                               |null     |\n|National Institute of Public Health, University of Southern Denmark, Studiestr√¶de 6, Copenhagen, Denmark                                                                                                                         |58485         |58485             |354477              |Syddansk Universitet Statens Institut for Folkesundhed                                        |Syddansk Universitet Institut for Sprog og Kommunikation                                               |74340         |213696                 |Syddansk Universitet Det Sundhedsvidenskabelige Fakultet|Syddansk Universitet Humanistiske Fakultet                                 |ACTIVE    |0.92                  |1            |0         |0            |0       |3cfyhn23KCaVkrChMoeHn|national institute of public health university of southern denmark studiestr                                                                                                                                 |university of southern denmark studiestr                                               |national institute of public health                                                                                          |DK       |\n|Department of Computer Science and Engineering, Pondicherry Engineering College, Puducherry, India                                                                                                                                |232511        |232511            |232511              |Pondicherry Engineering College                                                               |Pondicherry Engineering College                                                                        |214235        |214235                 |Government of Puducherry                                |Government of Puducherry                                                   |ACTIVE    |0.9549242424          |0            |1         |1            |2       |3cfyhedtwTyUM7xzwXffN|department of computer science and engineering pondicherry engineering college                                                                                                                               |pondicherry engineering college                                                        |department of computer science and engineering                                                                               |IN       |\n|Center for Brain Imaging Science and Technology, Key Laboratory for Biomedical Engineering of Ministry of Education, College of Biomedical Engineering and Instrumental Science, Zhejiang University, 38 Zheda Rd, Hangzhou 310027|366108        |366108            |111901              |Zhejiang University College of Biomedical Engineering and Instrument Science                  |Centre d'imagerie biomedicale                                                                          |229033        |27213|27218|27230|30635|Zhejiang University Faculty of Information Technology   |null                                                                       |ACTIVE    |0.81                  |-1           |0         |0            |0       |3cfyh4XGqjBgw35Cfghor|center for brain imaging science and technology key laboratory for biomedical engineering of ministry of education college of biomedical engineering and instrumental science zhejiang university 38 zheda rd|center for brain imaging science and technology||zhejiang university 38 zheda rd       |key laboratory for biomedical engineering of ministry of education college of biomedical engineering and instrumental science|null     |\n|KEM Hospital, Pune, Maharastra                                                                                                                                                                                                    |72911         |72911             |75938               |KEM Hospital Pune                                                                             |King Edward Memorial Hospital                                                                          |376789        |29549                  |KEM Hospital Society                                    |King Edward Memorial Hospital and Seth Gordhandas Sunderdas Medical College|ACTIVE    |1.00                  |1            |0         |0            |0       |3cfyh4PrbInArKMgNJj99|kem hospital                                                                                                                                                                                                 |kem hospital                                                                           |null                                                                                                                         |null     |\n|Freie Universit√§t Berlin, Department of Biology, Chemistry, and Pharmacy, 14195 Berlin, Germany                                                                                                                                  |54203         |54203             |123167              |Freie Universitat Berlin Fachbereich Biologie Chemie Pharmazie                                |Universitat Siegen Department Chemie und Biologie                                                      |9166          |386218                 |Freie Universitat Berlin                                |Universitat Siegen Fakultat IV Naturwissenschaftlich-Technische Fakultat   |ACTIVE    |1.00                  |1            |0         |0            |0       |3cfyhCvKBmL70aL1zPgA0|freie universit department of biology chemistry and pharmacy                                                                                                                                                 |chemistry||and pharmacy||freie universit                                               |department of biology                                                                                                        |DE       |\n|Laboratoire G-Time, Universit√© libre de Bruxelles, Avenue F.D. Roosevelt 50, 1050 Bruxelles, Belgium                                                                                                                             |26659         |26659             |425644              |Universite Libre de Bruxelles                                                                 |Universite Libre de Bruxelles Laboratoire de Chimie des Polymeres                                      |204340        |425643                 |Academie Universitaire Wallonie-Bruxelles               |Universite Libre de Bruxelles Departement de Chimie                        |ACTIVE    |0.98                  |3            |0         |0            |0       |3cfyhMslMpfmeGDVzhFVX|laboratoire g time universit libre de bruxelles                                                                                                                                                              |universit libre de bruxelles                                                           |laboratoire g time                                                                                                           |BE       |\n|Department of Medicine, Icahn School of Medicine at Mount Sinai, NY                                                                                                                                                               |377569        |377569            |377569              |Icahn School of Medicine at Mount Sinai Department of Medicine                                |Icahn School of Medicine at Mount Sinai Department of Medicine                                         |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1                     |0            |1         |1            |2       |3cfyhYkw7WmHt5zJxAVaA|department of medicine icahn school of medicine at mount sinai                                                                                                                                               |icahn school of medicine at mount sinai                                                |department of medicine                                                                                                       |null     |\n|Icahn School of Medicine at Mount Sinai, Department of Medicine, New York, NY, USA                                                                                                                                                |377569        |377569            |377569              |Icahn School of Medicine at Mount Sinai Department of Medicine                                |Icahn School of Medicine at Mount Sinai Department of Medicine                                         |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1                     |0            |1         |1            |2       |3cfyhYkw7WmHt5zJxAVaA|icahn school of medicine at mount sinai department of medicine                                                                                                                                               |icahn school of medicine at mount sinai                                                |department of medicine                                                                                                       |US       |\n|Department of Radiology, Icahn School of Medicine at Mount Sinai, New York, USA                                                                                                                                                   |377569        |377569            |537359              |Icahn School of Medicine at Mount Sinai Department of Medicine                                |Icahn School of Medicine at Mount Sinai Department of Diagnostic Molecular and Interventional Radiology|5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1.00                  |3            |0         |1            |1       |3cfyhjBQPeOZg9Fd6YwlZ|department of radiology icahn school of medicine at mount sinai                                                                                                                                              |icahn school of medicine at mount sinai                                                |department of radiology                                                                                                      |US       |\n|Departments of Pathology, Molecular and Cell Based Medicine and Medicine, Icahn School of Medicine at Mount Sinai                                                                                                                 |377569        |377569            |537359              |Icahn School of Medicine at Mount Sinai Department of Medicine                                |Icahn School of Medicine at Mount Sinai Department of Diagnostic Molecular and Interventional Radiology|5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |0.98                  |9            |0         |1            |1       |3cfyhjBQPeOZg9Fd6YwlZ|departments of pathology molecular and cell based medicine and medicine icahn school of medicine at mount sinai                                                                                              |molecular and cell based medicine and medicine||icahn school of medicine at mount sinai|departments of pathology                                                                                                     |null     |\n|Departments of Neuroscience and Neurosurgery, Friedman Brain Institute, Icahn School of Medicine at Mount Sinai, New York, NY 10029, USA.                                                                                         |145801        |145801            |189441              |Icahn School of Medicine at Mount Sinai Friedman Brain Institute                              |Icahn School of Medicine at Mount Sinai Department of Neurosurgery                                     |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |0.97                  |1            |0         |1            |1       |3cfyhMHKZerWnrJl0obIh|departments of neuroscience and neurosurgery friedman brain institute icahn school of medicine at mount sinai                                                                                                |friedman brain institute||icahn school of medicine at mount sinai                      |departments of neuroscience and neurosurgery                                                                                 |US       |\n|Department of Genetics and Genomic Studies, Icahn School of Medicine at Mount Sinai, NY                                                                                                                                           |196257        |196257            |196257              |Icahn School of Medicine at Mount Sinai Department of Genetics and Genomic Sciences           |Icahn School of Medicine at Mount Sinai Department of Genetics and Genomic Sciences                    |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |0.9869791667          |0            |1         |1            |2       |3cfyhoSrOlSRHnlMtJtLN|department of genetics and genomic studies icahn school of medicine at mount sinai                                                                                                                           |icahn school of medicine at mount sinai                                                |department of genetics and genomic studies                                                                                   |null     |\n|Department of Pulmonary Medicine, Icahn School of Medicine at Mount Sinai, New York, NY                                                                                                                                           |377569        |377569            |174216              |Icahn School of Medicine at Mount Sinai Department of Medicine                                |Icahn School of Medicine at Mount Sinai Department of Psychiatry                                       |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |0.98                  |2            |0         |1            |1       |3cfygpIIdtPXSy3Buz4tL|department of pulmonary medicine icahn school of medicine at mount sinai                                                                                                                                     |icahn school of medicine at mount sinai                                                |department of pulmonary medicine                                                                                             |null     |\n|Department of Psychiatry, Icahn School of Medicine at Mount Sinai, New York, NY, USA                                                                                                                                              |174216        |174216            |174216              |Icahn School of Medicine at Mount Sinai Department of Psychiatry                              |Icahn School of Medicine at Mount Sinai Department of Psychiatry                                       |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1                     |0            |1         |1            |2       |3cfygpIIdtPXSy3Buz4tL|department of psychiatry icahn school of medicine at mount sinai                                                                                                                                             |icahn school of medicine at mount sinai                                                |department of psychiatry                                                                                                     |US       |\n|Department of Preventive Medicine, Icahn School of Medicine at Mount Sinai, New York City, New York, USA                                                                                                                          |465180        |465180            |465180              |Icahn School of Medicine at Mount Sinai Department of Environmental Medicine and Public Health|Icahn School of Medicine at Mount Sinai Department of Environmental Medicine and Public Health         |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1                     |0            |1         |1            |2       |3cfyhA2jzLj1Ql8ZuwdCv|department of preventive medicine icahn school of medicine at mount sinai                                                                                                                                    |icahn school of medicine at mount sinai                                                |department of preventive medicine                                                                                            |US       |\n|Department of Neuroscience,¬†Icahn School of Medicine at Mount Sinai, New York, NY, USA, 10029                                                                                                                                    |377569        |377569            |219196              |Icahn School of Medicine at Mount Sinai Department of Medicine                                |Icahn School of Medicine at Mount Sinai Fishberg Department of Neuroscience                            |5925          |5925                   |Icahn School of Medicine at Mount Sinai                 |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1.00                  |3            |0         |1            |1       |3cfyhLZSxjmYBobBQCGtP|department of neuroscience icahn school of medicine at mount sinai                                                                                                                                           |icahn school of medicine at mount sinai                                                |department of neuroscience                                                                                                   |US       |\n|Department of Population Health Science and Policy, Icahn School of Medicine at Mount Sinai, New York, NY                                                                                                                         |5925          |5925              |573357              |Icahn School of Medicine at Mount Sinai                                                       |Icahn School of Medicine at Mount Sinai Department of Population Health Science and Policy             |5944          |5925                   |Mount Sinai Health System                               |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1.00                  |1            |0         |0            |1       |3cfygzFjowgfUmu4cXGP0|department of population health science and policy icahn school of medicine at mount sinai                                                                                                                   |icahn school of medicine at mount sinai                                                |department of population health science and policy                                                                           |null     |\n|Department of Oncological Sciences, Icahn School of Medicine at Mount Sinai, New York, NY                                                                                                                                         |5925          |5925              |192707              |Icahn School of Medicine at Mount Sinai                                                       |Icahn School of Medicine at Mount Sinai Department of Oncological Sciences                             |5944          |5925                   |Mount Sinai Health System                               |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1.00                  |5            |0         |0            |1       |3cfyhPldhGR9FftkAnRm8|department of oncological sciences icahn school of medicine at mount sinai                                                                                                                                   |icahn school of medicine at mount sinai                                                |department of oncological sciences                                                                                           |null     |\n|Department of Neurology, Icahn School of Medicine at Mount Sinai, NY                                                                                                                                                              |5925          |5925              |219195              |Icahn School of Medicine at Mount Sinai                                                       |Icahn School of Medicine at Mount Sinai Estelle and Daniel Maggin Department of Neurology              |5944          |5925                   |Mount Sinai Health System                               |Icahn School of Medicine at Mount Sinai                                    |ACTIVE    |1.00                  |2            |0         |0            |1       |3cfyhKqWsTEHlzSPGh0VO|department of neurology icahn school of medicine at mount sinai                                                                                                                                              |icahn school of medicine at mount sinai                                                |department of neurology                                                                                                      |null     |\n+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------------+--------------------+----------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+--------------+-----------------------+--------------------------------------------------------+---------------------------------------------------------------------------+----------+----------------------+-------------+----------+-------------+--------+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+---------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mRES_HOME\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /media/ometaxas/nvme/datasets/institutions/WILEY_Matching\n\u001b[1m\u001b[34mringgoldTsvFilename\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = ringgold.dump.tsv\n\u001b[1m\u001b[34mringgolddf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [RINGGOLD_ID: string, NEW_RINGGOLD_ID: string ... 14 more fields]\n\u001b[1m\u001b[34mnonMatchedTsvFilename\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = differentMatch - expectedNotFound.tsv\n\u001b[1m\u001b[34mnonMatcheddf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [inputName: string, expectedRinggoldId: string ... 8 more fields]\n\u001b[1m\u001b[34mexactMatchedTsvFilename\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = bestMatchSameAsExpected - expectedAsBestMatch.tsv\n\u001b[1m\u001b[34mexactMatcheddf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [inputName: string, expectedRinggoldId: string ... 8 more field...\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=195"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=196"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=197"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=198"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=199"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=200"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=201"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=202"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=203"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=204"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=205"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=206"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=207"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=208"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=209"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=210"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=211"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=212"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=213"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=214"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=215"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=216"
      },
      {
       "jobUrl": "http://omiros.station:4040/jobs/job?id=217"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500.0,
   "jobName": "paragraph_1620391762447_213676756",
   "id": "paragraph_1620391762447_213676756",
   "dateCreated": "2021-05-07T15:49:22+0300",
   "dateStarted": "2021-05-07T15:49:22+0300",
   "dateFinished": "2021-05-07T15:49:26+0300",
   "status": "FINISHED"
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}